(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(s){if(s.ep)return;s.ep=!0;const l=r(s);fetch(s.href,l)}})();function Ch(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function SE(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),r}var Od={exports:{}},Rc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $p;function kE(){if($p)return Rc;$p=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(n,s,l){var o=null;if(l!==void 0&&(o=""+l),s.key!==void 0&&(o=""+s.key),"key"in s){l={};for(var u in s)u!=="key"&&(l[u]=s[u])}else l=s;return s=l.ref,{$$typeof:e,type:n,key:o,ref:s!==void 0?s:null,props:l}}return Rc.Fragment=t,Rc.jsx=r,Rc.jsxs=r,Rc}var Yp;function AE(){return Yp||(Yp=1,Od.exports=kE()),Od.exports}var d=AE(),Dd={exports:{}},lt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qp;function NE(){if(qp)return lt;qp=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),v=Symbol.iterator;function _(A){return A===null||typeof A!="object"?null:(A=v&&A[v]||A["@@iterator"],typeof A=="function"?A:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,b={};function E(A,K,N){this.props=A,this.context=K,this.refs=b,this.updater=N||y}E.prototype.isReactComponent={},E.prototype.setState=function(A,K){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,K,"setState")},E.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function j(){}j.prototype=E.prototype;function C(A,K,N){this.props=A,this.context=K,this.refs=b,this.updater=N||y}var S=C.prototype=new j;S.constructor=C,w(S,E.prototype),S.isPureReactComponent=!0;var L=Array.isArray,Z={H:null,A:null,T:null,S:null,V:null},W=Object.prototype.hasOwnProperty;function I(A,K,N,P,z,H){return N=H.ref,{$$typeof:e,type:A,key:K,ref:N!==void 0?N:null,props:H}}function X(A,K){return I(A.type,K,void 0,void 0,void 0,A.props)}function U(A){return typeof A=="object"&&A!==null&&A.$$typeof===e}function ee(A){var K={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(N){return K[N]})}var te=/\/+/g;function V(A,K){return typeof A=="object"&&A!==null&&A.key!=null?ee(""+A.key):K.toString(36)}function ge(){}function Re(A){switch(A.status){case"fulfilled":return A.value;case"rejected":throw A.reason;default:switch(typeof A.status=="string"?A.then(ge,ge):(A.status="pending",A.then(function(K){A.status==="pending"&&(A.status="fulfilled",A.value=K)},function(K){A.status==="pending"&&(A.status="rejected",A.reason=K)})),A.status){case"fulfilled":return A.value;case"rejected":throw A.reason}}throw A}function Se(A,K,N,P,z){var H=typeof A;(H==="undefined"||H==="boolean")&&(A=null);var se=!1;if(A===null)se=!0;else switch(H){case"bigint":case"string":case"number":se=!0;break;case"object":switch(A.$$typeof){case e:case t:se=!0;break;case p:return se=A._init,Se(se(A._payload),K,N,P,z)}}if(se)return z=z(A),se=P===""?"."+V(A,0):P,L(z)?(N="",se!=null&&(N=se.replace(te,"$&/")+"/"),Se(z,K,N,"",function(Ae){return Ae})):z!=null&&(U(z)&&(z=X(z,N+(z.key==null||A&&A.key===z.key?"":(""+z.key).replace(te,"$&/")+"/")+se)),K.push(z)),1;se=0;var ve=P===""?".":P+":";if(L(A))for(var be=0;be<A.length;be++)P=A[be],H=ve+V(P,be),se+=Se(P,K,N,H,z);else if(be=_(A),typeof be=="function")for(A=be.call(A),be=0;!(P=A.next()).done;)P=P.value,H=ve+V(P,be++),se+=Se(P,K,N,H,z);else if(H==="object"){if(typeof A.then=="function")return Se(Re(A),K,N,P,z);throw K=String(A),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.")}return se}function ae(A,K,N){if(A==null)return A;var P=[],z=0;return Se(A,P,"","",function(H){return K.call(N,H,z++)}),P}function ue(A){if(A._status===-1){var K=A._result;K=K(),K.then(function(N){(A._status===0||A._status===-1)&&(A._status=1,A._result=N)},function(N){(A._status===0||A._status===-1)&&(A._status=2,A._result=N)}),A._status===-1&&(A._status=0,A._result=K)}if(A._status===1)return A._result.default;throw A._result}var Q=typeof reportError=="function"?reportError:function(A){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var K=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A=="object"&&A!==null&&typeof A.message=="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent(K))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",A);return}console.error(A)};function G(){}return lt.Children={map:ae,forEach:function(A,K,N){ae(A,function(){K.apply(this,arguments)},N)},count:function(A){var K=0;return ae(A,function(){K++}),K},toArray:function(A){return ae(A,function(K){return K})||[]},only:function(A){if(!U(A))throw Error("React.Children.only expected to receive a single React element child.");return A}},lt.Component=E,lt.Fragment=r,lt.Profiler=s,lt.PureComponent=C,lt.StrictMode=n,lt.Suspense=h,lt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Z,lt.__COMPILER_RUNTIME={__proto__:null,c:function(A){return Z.H.useMemoCache(A)}},lt.cache=function(A){return function(){return A.apply(null,arguments)}},lt.cloneElement=function(A,K,N){if(A==null)throw Error("The argument must be a React element, but you passed "+A+".");var P=w({},A.props),z=A.key,H=void 0;if(K!=null)for(se in K.ref!==void 0&&(H=void 0),K.key!==void 0&&(z=""+K.key),K)!W.call(K,se)||se==="key"||se==="__self"||se==="__source"||se==="ref"&&K.ref===void 0||(P[se]=K[se]);var se=arguments.length-2;if(se===1)P.children=N;else if(1<se){for(var ve=Array(se),be=0;be<se;be++)ve[be]=arguments[be+2];P.children=ve}return I(A.type,z,void 0,void 0,H,P)},lt.createContext=function(A){return A={$$typeof:o,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null},A.Provider=A,A.Consumer={$$typeof:l,_context:A},A},lt.createElement=function(A,K,N){var P,z={},H=null;if(K!=null)for(P in K.key!==void 0&&(H=""+K.key),K)W.call(K,P)&&P!=="key"&&P!=="__self"&&P!=="__source"&&(z[P]=K[P]);var se=arguments.length-2;if(se===1)z.children=N;else if(1<se){for(var ve=Array(se),be=0;be<se;be++)ve[be]=arguments[be+2];z.children=ve}if(A&&A.defaultProps)for(P in se=A.defaultProps,se)z[P]===void 0&&(z[P]=se[P]);return I(A,H,void 0,void 0,null,z)},lt.createRef=function(){return{current:null}},lt.forwardRef=function(A){return{$$typeof:u,render:A}},lt.isValidElement=U,lt.lazy=function(A){return{$$typeof:p,_payload:{_status:-1,_result:A},_init:ue}},lt.memo=function(A,K){return{$$typeof:x,type:A,compare:K===void 0?null:K}},lt.startTransition=function(A){var K=Z.T,N={};Z.T=N;try{var P=A(),z=Z.S;z!==null&&z(N,P),typeof P=="object"&&P!==null&&typeof P.then=="function"&&P.then(G,Q)}catch(H){Q(H)}finally{Z.T=K}},lt.unstable_useCacheRefresh=function(){return Z.H.useCacheRefresh()},lt.use=function(A){return Z.H.use(A)},lt.useActionState=function(A,K,N){return Z.H.useActionState(A,K,N)},lt.useCallback=function(A,K){return Z.H.useCallback(A,K)},lt.useContext=function(A){return Z.H.useContext(A)},lt.useDebugValue=function(){},lt.useDeferredValue=function(A,K){return Z.H.useDeferredValue(A,K)},lt.useEffect=function(A,K,N){var P=Z.H;if(typeof N=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return P.useEffect(A,K)},lt.useId=function(){return Z.H.useId()},lt.useImperativeHandle=function(A,K,N){return Z.H.useImperativeHandle(A,K,N)},lt.useInsertionEffect=function(A,K){return Z.H.useInsertionEffect(A,K)},lt.useLayoutEffect=function(A,K){return Z.H.useLayoutEffect(A,K)},lt.useMemo=function(A,K){return Z.H.useMemo(A,K)},lt.useOptimistic=function(A,K){return Z.H.useOptimistic(A,K)},lt.useReducer=function(A,K,N){return Z.H.useReducer(A,K,N)},lt.useRef=function(A){return Z.H.useRef(A)},lt.useState=function(A){return Z.H.useState(A)},lt.useSyncExternalStore=function(A,K,N){return Z.H.useSyncExternalStore(A,K,N)},lt.useTransition=function(){return Z.H.useTransition()},lt.version="19.1.0",lt}var Xp;function Oh(){return Xp||(Xp=1,Dd.exports=NE()),Dd.exports}var re=Oh();const Gn=Ch(re);var Rd={exports:{}},jc={},jd={exports:{}},Id={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wp;function CE(){return Wp||(Wp=1,function(e){function t(ae,ue){var Q=ae.length;ae.push(ue);e:for(;0<Q;){var G=Q-1>>>1,A=ae[G];if(0<s(A,ue))ae[G]=ue,ae[Q]=A,Q=G;else break e}}function r(ae){return ae.length===0?null:ae[0]}function n(ae){if(ae.length===0)return null;var ue=ae[0],Q=ae.pop();if(Q!==ue){ae[0]=Q;e:for(var G=0,A=ae.length,K=A>>>1;G<K;){var N=2*(G+1)-1,P=ae[N],z=N+1,H=ae[z];if(0>s(P,Q))z<A&&0>s(H,P)?(ae[G]=H,ae[z]=Q,G=z):(ae[G]=P,ae[N]=Q,G=N);else if(z<A&&0>s(H,Q))ae[G]=H,ae[z]=Q,G=z;else break e}}return ue}function s(ae,ue){var Q=ae.sortIndex-ue.sortIndex;return Q!==0?Q:ae.id-ue.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var o=Date,u=o.now();e.unstable_now=function(){return o.now()-u}}var h=[],x=[],p=1,v=null,_=3,y=!1,w=!1,b=!1,E=!1,j=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function L(ae){for(var ue=r(x);ue!==null;){if(ue.callback===null)n(x);else if(ue.startTime<=ae)n(x),ue.sortIndex=ue.expirationTime,t(h,ue);else break;ue=r(x)}}function Z(ae){if(b=!1,L(ae),!w)if(r(h)!==null)w=!0,W||(W=!0,V());else{var ue=r(x);ue!==null&&Se(Z,ue.startTime-ae)}}var W=!1,I=-1,X=5,U=-1;function ee(){return E?!0:!(e.unstable_now()-U<X)}function te(){if(E=!1,W){var ae=e.unstable_now();U=ae;var ue=!0;try{e:{w=!1,b&&(b=!1,C(I),I=-1),y=!0;var Q=_;try{t:{for(L(ae),v=r(h);v!==null&&!(v.expirationTime>ae&&ee());){var G=v.callback;if(typeof G=="function"){v.callback=null,_=v.priorityLevel;var A=G(v.expirationTime<=ae);if(ae=e.unstable_now(),typeof A=="function"){v.callback=A,L(ae),ue=!0;break t}v===r(h)&&n(h),L(ae)}else n(h);v=r(h)}if(v!==null)ue=!0;else{var K=r(x);K!==null&&Se(Z,K.startTime-ae),ue=!1}}break e}finally{v=null,_=Q,y=!1}ue=void 0}}finally{ue?V():W=!1}}}var V;if(typeof S=="function")V=function(){S(te)};else if(typeof MessageChannel<"u"){var ge=new MessageChannel,Re=ge.port2;ge.port1.onmessage=te,V=function(){Re.postMessage(null)}}else V=function(){j(te,0)};function Se(ae,ue){I=j(function(){ae(e.unstable_now())},ue)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ae){ae.callback=null},e.unstable_forceFrameRate=function(ae){0>ae||125<ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):X=0<ae?Math.floor(1e3/ae):5},e.unstable_getCurrentPriorityLevel=function(){return _},e.unstable_next=function(ae){switch(_){case 1:case 2:case 3:var ue=3;break;default:ue=_}var Q=_;_=ue;try{return ae()}finally{_=Q}},e.unstable_requestPaint=function(){E=!0},e.unstable_runWithPriority=function(ae,ue){switch(ae){case 1:case 2:case 3:case 4:case 5:break;default:ae=3}var Q=_;_=ae;try{return ue()}finally{_=Q}},e.unstable_scheduleCallback=function(ae,ue,Q){var G=e.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?G+Q:G):Q=G,ae){case 1:var A=-1;break;case 2:A=250;break;case 5:A=1073741823;break;case 4:A=1e4;break;default:A=5e3}return A=Q+A,ae={id:p++,callback:ue,priorityLevel:ae,startTime:Q,expirationTime:A,sortIndex:-1},Q>G?(ae.sortIndex=Q,t(x,ae),r(h)===null&&ae===r(x)&&(b?(C(I),I=-1):b=!0,Se(Z,Q-G))):(ae.sortIndex=A,t(h,ae),w||y||(w=!0,W||(W=!0,V()))),ae},e.unstable_shouldYield=ee,e.unstable_wrapCallback=function(ae){var ue=_;return function(){var Q=_;_=ue;try{return ae.apply(this,arguments)}finally{_=Q}}}}(Id)),Id}var Zp;function OE(){return Zp||(Zp=1,jd.exports=CE()),jd.exports}var Md={exports:{}},Hr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kp;function DE(){if(Kp)return Hr;Kp=1;var e=Oh();function t(h){var x="https://react.dev/errors/"+h;if(1<arguments.length){x+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)x+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+x+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},s=Symbol.for("react.portal");function l(h,x,p){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:v==null?null:""+v,children:h,containerInfo:x,implementation:p}}var o=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,x){if(h==="font")return"";if(typeof x=="string")return x==="use-credentials"?x:""}return Hr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Hr.createPortal=function(h,x){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!x||x.nodeType!==1&&x.nodeType!==9&&x.nodeType!==11)throw Error(t(299));return l(h,x,null,p)},Hr.flushSync=function(h){var x=o.T,p=n.p;try{if(o.T=null,n.p=2,h)return h()}finally{o.T=x,n.p=p,n.d.f()}},Hr.preconnect=function(h,x){typeof h=="string"&&(x?(x=x.crossOrigin,x=typeof x=="string"?x==="use-credentials"?x:"":void 0):x=null,n.d.C(h,x))},Hr.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},Hr.preinit=function(h,x){if(typeof h=="string"&&x&&typeof x.as=="string"){var p=x.as,v=u(p,x.crossOrigin),_=typeof x.integrity=="string"?x.integrity:void 0,y=typeof x.fetchPriority=="string"?x.fetchPriority:void 0;p==="style"?n.d.S(h,typeof x.precedence=="string"?x.precedence:void 0,{crossOrigin:v,integrity:_,fetchPriority:y}):p==="script"&&n.d.X(h,{crossOrigin:v,integrity:_,fetchPriority:y,nonce:typeof x.nonce=="string"?x.nonce:void 0})}},Hr.preinitModule=function(h,x){if(typeof h=="string")if(typeof x=="object"&&x!==null){if(x.as==null||x.as==="script"){var p=u(x.as,x.crossOrigin);n.d.M(h,{crossOrigin:p,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0})}}else x==null&&n.d.M(h)},Hr.preload=function(h,x){if(typeof h=="string"&&typeof x=="object"&&x!==null&&typeof x.as=="string"){var p=x.as,v=u(p,x.crossOrigin);n.d.L(h,p,{crossOrigin:v,integrity:typeof x.integrity=="string"?x.integrity:void 0,nonce:typeof x.nonce=="string"?x.nonce:void 0,type:typeof x.type=="string"?x.type:void 0,fetchPriority:typeof x.fetchPriority=="string"?x.fetchPriority:void 0,referrerPolicy:typeof x.referrerPolicy=="string"?x.referrerPolicy:void 0,imageSrcSet:typeof x.imageSrcSet=="string"?x.imageSrcSet:void 0,imageSizes:typeof x.imageSizes=="string"?x.imageSizes:void 0,media:typeof x.media=="string"?x.media:void 0})}},Hr.preloadModule=function(h,x){if(typeof h=="string")if(x){var p=u(x.as,x.crossOrigin);n.d.m(h,{as:typeof x.as=="string"&&x.as!=="script"?x.as:void 0,crossOrigin:p,integrity:typeof x.integrity=="string"?x.integrity:void 0})}else n.d.m(h)},Hr.requestFormReset=function(h){n.d.r(h)},Hr.unstable_batchedUpdates=function(h,x){return h(x)},Hr.useFormState=function(h,x,p){return o.H.useFormState(h,x,p)},Hr.useFormStatus=function(){return o.H.useHostTransitionStatus()},Hr.version="19.1.0",Hr}var Jp;function RE(){if(Jp)return Md.exports;Jp=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Md.exports=DE(),Md.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qp;function jE(){if(Qp)return jc;Qp=1;var e=OE(),t=Oh(),r=RE();function n(a){var i="https://react.dev/errors/"+a;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)i+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+a+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function l(a){var i=a,c=a;if(a.alternate)for(;i.return;)i=i.return;else{a=i;do i=a,(i.flags&4098)!==0&&(c=i.return),a=i.return;while(a)}return i.tag===3?c:null}function o(a){if(a.tag===13){var i=a.memoizedState;if(i===null&&(a=a.alternate,a!==null&&(i=a.memoizedState)),i!==null)return i.dehydrated}return null}function u(a){if(l(a)!==a)throw Error(n(188))}function h(a){var i=a.alternate;if(!i){if(i=l(a),i===null)throw Error(n(188));return i!==a?null:a}for(var c=a,f=i;;){var m=c.return;if(m===null)break;var g=m.alternate;if(g===null){if(f=m.return,f!==null){c=f;continue}break}if(m.child===g.child){for(g=m.child;g;){if(g===c)return u(m),a;if(g===f)return u(m),i;g=g.sibling}throw Error(n(188))}if(c.return!==f.return)c=m,f=g;else{for(var T=!1,D=m.child;D;){if(D===c){T=!0,c=m,f=g;break}if(D===f){T=!0,f=m,c=g;break}D=D.sibling}if(!T){for(D=g.child;D;){if(D===c){T=!0,c=g,f=m;break}if(D===f){T=!0,f=g,c=m;break}D=D.sibling}if(!T)throw Error(n(189))}}if(c.alternate!==f)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?a:i}function x(a){var i=a.tag;if(i===5||i===26||i===27||i===6)return a;for(a=a.child;a!==null;){if(i=x(a),i!==null)return i;a=a.sibling}return null}var p=Object.assign,v=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),j=Symbol.for("react.provider"),C=Symbol.for("react.consumer"),S=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),Z=Symbol.for("react.suspense"),W=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),X=Symbol.for("react.lazy"),U=Symbol.for("react.activity"),ee=Symbol.for("react.memo_cache_sentinel"),te=Symbol.iterator;function V(a){return a===null||typeof a!="object"?null:(a=te&&a[te]||a["@@iterator"],typeof a=="function"?a:null)}var ge=Symbol.for("react.client.reference");function Re(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===ge?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case w:return"Fragment";case E:return"Profiler";case b:return"StrictMode";case Z:return"Suspense";case W:return"SuspenseList";case U:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case y:return"Portal";case S:return(a.displayName||"Context")+".Provider";case C:return(a._context.displayName||"Context")+".Consumer";case L:var i=a.render;return a=a.displayName,a||(a=i.displayName||i.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case I:return i=a.displayName||null,i!==null?i:Re(a.type)||"Memo";case X:i=a._payload,a=a._init;try{return Re(a(i))}catch{}}return null}var Se=Array.isArray,ae=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ue=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q={pending:!1,data:null,method:null,action:null},G=[],A=-1;function K(a){return{current:a}}function N(a){0>A||(a.current=G[A],G[A]=null,A--)}function P(a,i){A++,G[A]=a.current,a.current=i}var z=K(null),H=K(null),se=K(null),ve=K(null);function be(a,i){switch(P(se,i),P(H,a),P(z,null),i.nodeType){case 9:case 11:a=(a=i.documentElement)&&(a=a.namespaceURI)?_p(a):0;break;default:if(a=i.tagName,i=i.namespaceURI)i=_p(i),a=yp(i,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}N(z),P(z,a)}function Ae(){N(z),N(H),N(se)}function ye(a){a.memoizedState!==null&&P(ve,a);var i=z.current,c=yp(i,a.type);i!==c&&(P(H,a),P(z,c))}function Ye(a){H.current===a&&(N(z),N(H)),ve.current===a&&(N(ve),Ac._currentValue=Q)}var Y=Object.prototype.hasOwnProperty,ot=e.unstable_scheduleCallback,Xe=e.unstable_cancelCallback,gt=e.unstable_shouldYield,Je=e.unstable_requestPaint,Oe=e.unstable_now,Ot=e.unstable_getCurrentPriorityLevel,$t=e.unstable_ImmediatePriority,Le=e.unstable_UserBlockingPriority,Pe=e.unstable_NormalPriority,Ve=e.unstable_LowPriority,$e=e.unstable_IdlePriority,mr=e.log,Rr=e.unstable_setDisableYieldValue,pr=null,Yt=null;function yt(a){if(typeof mr=="function"&&Rr(a),Yt&&typeof Yt.setStrictMode=="function")try{Yt.setStrictMode(pr,a)}catch{}}var Qe=Math.clz32?Math.clz32:gr,et=Math.log,Pt=Math.LN2;function gr(a){return a>>>=0,a===0?32:31-(et(a)/Pt|0)|0}var Dt=256,qt=4194304;function sa(a){var i=a&42;if(i!==0)return i;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function xa(a,i,c){var f=a.pendingLanes;if(f===0)return 0;var m=0,g=a.suspendedLanes,T=a.pingedLanes;a=a.warmLanes;var D=f&134217727;return D!==0?(f=D&~g,f!==0?m=sa(f):(T&=D,T!==0?m=sa(T):c||(c=D&~a,c!==0&&(m=sa(c))))):(D=f&~g,D!==0?m=sa(D):T!==0?m=sa(T):c||(c=f&~a,c!==0&&(m=sa(c)))),m===0?0:i!==0&&i!==m&&(i&g)===0&&(g=m&-m,c=i&-i,g>=c||g===32&&(c&4194048)!==0)?i:m}function ma(a,i){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&i)===0}function or(a,i){switch(a){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function sn(){var a=Dt;return Dt<<=1,(Dt&4194048)===0&&(Dt=256),a}function Zr(){var a=qt;return qt<<=1,(qt&62914560)===0&&(qt=4194304),a}function yn(a){for(var i=[],c=0;31>c;c++)i.push(a);return i}function Ya(a,i){a.pendingLanes|=i,i!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function ln(a,i,c,f,m,g){var T=a.pendingLanes;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=c,a.entangledLanes&=c,a.errorRecoveryDisabledLanes&=c,a.shellSuspendCounter=0;var D=a.entanglements,J=a.expirationTimes,fe=a.hiddenUpdates;for(c=T&~c;0<c;){var we=31-Qe(c),ke=1<<we;D[we]=0,J[we]=-1;var xe=fe[we];if(xe!==null)for(fe[we]=null,we=0;we<xe.length;we++){var me=xe[we];me!==null&&(me.lane&=-536870913)}c&=~ke}f!==0&&qn(a,f,0),g!==0&&m===0&&a.tag!==0&&(a.suspendedLanes|=g&~(T&~i))}function qn(a,i,c){a.pendingLanes|=i,a.suspendedLanes&=~i;var f=31-Qe(i);a.entangledLanes|=i,a.entanglements[f]=a.entanglements[f]|1073741824|c&4194090}function Xn(a,i){var c=a.entangledLanes|=i;for(a=a.entanglements;c;){var f=31-Qe(c),m=1<<f;m&i|a[f]&i&&(a[f]|=i),c&=~m}}function wn(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function bn(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function Wn(){var a=ue.p;return a!==0?a:(a=window.event,a===void 0?32:Bp(a.type))}function Us(a,i){var c=ue.p;try{return ue.p=a,i()}finally{ue.p=c}}var ia=Math.random().toString(36).slice(2),Kt="__reactFiber$"+ia,Jt="__reactProps$"+ia,Ca="__reactContainer$"+ia,Rt="__reactEvents$"+ia,Zn="__reactListeners$"+ia,O="__reactHandles$"+ia,B="__reactResources$"+ia,k="__reactMarker$"+ia;function R(a){delete a[Kt],delete a[Jt],delete a[Rt],delete a[Zn],delete a[O]}function M(a){var i=a[Kt];if(i)return i;for(var c=a.parentNode;c;){if(i=c[Ca]||c[Kt]){if(c=i.alternate,i.child!==null||c!==null&&c.child!==null)for(a=Tp(a);a!==null;){if(c=a[Kt])return c;a=Tp(a)}return i}a=c,c=a.parentNode}return null}function F(a){if(a=a[Kt]||a[Ca]){var i=a.tag;if(i===5||i===6||i===13||i===26||i===27||i===3)return a}return null}function ce(a){var i=a.tag;if(i===5||i===26||i===27||i===6)return a.stateNode;throw Error(n(33))}function pe(a){var i=a[B];return i||(i=a[B]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function ie(a){a[k]=!0}var de=new Set,he={};function Ne(a,i){De(a,i),De(a+"Capture",i)}function De(a,i){for(he[a]=i,a=0;a<i.length;a++)de.add(i[a])}var Me=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ce={},q={};function _e(a){return Y.call(q,a)?!0:Y.call(Ce,a)?!1:Me.test(a)?q[a]=!0:(Ce[a]=!0,!1)}function Te(a,i,c){if(_e(i))if(c===null)a.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":a.removeAttribute(i);return;case"boolean":var f=i.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){a.removeAttribute(i);return}}a.setAttribute(i,""+c)}}function Ie(a,i,c){if(c===null)a.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(i);return}a.setAttribute(i,""+c)}}function Ue(a,i,c,f){if(f===null)a.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(c);return}a.setAttributeNS(i,c,""+f)}}var tt,vt;function dt(a){if(tt===void 0)try{throw Error()}catch(c){var i=c.stack.trim().match(/\n( *(at )?)/);tt=i&&i[1]||"",vt=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+tt+a+vt}var kt=!1;function Qt(a,i){if(!a||kt)return"";kt=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(i){var ke=function(){throw Error()};if(Object.defineProperty(ke.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ke,[])}catch(me){var xe=me}Reflect.construct(a,[],ke)}else{try{ke.call()}catch(me){xe=me}a.call(ke.prototype)}}else{try{throw Error()}catch(me){xe=me}(ke=a())&&typeof ke.catch=="function"&&ke.catch(function(){})}}catch(me){if(me&&xe&&typeof me.stack=="string")return[me.stack,xe.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=f.DetermineComponentFrameRoot(),T=g[0],D=g[1];if(T&&D){var J=T.split(`
`),fe=D.split(`
`);for(m=f=0;f<J.length&&!J[f].includes("DetermineComponentFrameRoot");)f++;for(;m<fe.length&&!fe[m].includes("DetermineComponentFrameRoot");)m++;if(f===J.length||m===fe.length)for(f=J.length-1,m=fe.length-1;1<=f&&0<=m&&J[f]!==fe[m];)m--;for(;1<=f&&0<=m;f--,m--)if(J[f]!==fe[m]){if(f!==1||m!==1)do if(f--,m--,0>m||J[f]!==fe[m]){var we=`
`+J[f].replace(" at new "," at ");return a.displayName&&we.includes("<anonymous>")&&(we=we.replace("<anonymous>",a.displayName)),we}while(1<=f&&0<=m);break}}}finally{kt=!1,Error.prepareStackTrace=c}return(c=a?a.displayName||a.name:"")?dt(c):""}function At(a){switch(a.tag){case 26:case 27:case 5:return dt(a.type);case 16:return dt("Lazy");case 13:return dt("Suspense");case 19:return dt("SuspenseList");case 0:case 15:return Qt(a.type,!1);case 11:return Qt(a.type.render,!1);case 1:return Qt(a.type,!0);case 31:return dt("Activity");default:return""}}function Oa(a){try{var i="";do i+=At(a),a=a.return;while(a);return i}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function er(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Bl(a){var i=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Ai(a){var i=Bl(a)?"checked":"value",c=Object.getOwnPropertyDescriptor(a.constructor.prototype,i),f=""+a[i];if(!a.hasOwnProperty(i)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var m=c.get,g=c.set;return Object.defineProperty(a,i,{configurable:!0,get:function(){return m.call(this)},set:function(T){f=""+T,g.call(this,T)}}),Object.defineProperty(a,i,{enumerable:c.enumerable}),{getValue:function(){return f},setValue:function(T){f=""+T},stopTracking:function(){a._valueTracker=null,delete a[i]}}}}function Kn(a){a._valueTracker||(a._valueTracker=Ai(a))}function Ni(a){if(!a)return!1;var i=a._valueTracker;if(!i)return!0;var c=i.getValue(),f="";return a&&(f=Bl(a)?a.checked?"true":"false":a.value),a=f,a!==c?(i.setValue(a),!0):!1}function Bs(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var Lt=/[\n"\\]/g;function ht(a){return a.replace(Lt,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function vr(a,i,c,f,m,g,T,D){a.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?a.type=T:a.removeAttribute("type"),i!=null?T==="number"?(i===0&&a.value===""||a.value!=i)&&(a.value=""+er(i)):a.value!==""+er(i)&&(a.value=""+er(i)):T!=="submit"&&T!=="reset"||a.removeAttribute("value"),i!=null?qa(a,T,er(i)):c!=null?qa(a,T,er(c)):f!=null&&a.removeAttribute("value"),m==null&&g!=null&&(a.defaultChecked=!!g),m!=null&&(a.checked=m&&typeof m!="function"&&typeof m!="symbol"),D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?a.name=""+er(D):a.removeAttribute("name")}function Ps(a,i,c,f,m,g,T,D){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(a.type=g),i!=null||c!=null){if(!(g!=="submit"&&g!=="reset"||i!=null))return;c=c!=null?""+er(c):"",i=i!=null?""+er(i):c,D||i===a.value||(a.value=i),a.defaultValue=i}f=f??m,f=typeof f!="function"&&typeof f!="symbol"&&!!f,a.checked=D?a.checked:!!f,a.defaultChecked=!!f,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(a.name=T)}function qa(a,i,c){i==="number"&&Bs(a.ownerDocument)===a||a.defaultValue===""+c||(a.defaultValue=""+c)}function pa(a,i,c,f){if(a=a.options,i){i={};for(var m=0;m<c.length;m++)i["$"+c[m]]=!0;for(c=0;c<a.length;c++)m=i.hasOwnProperty("$"+a[c].value),a[c].selected!==m&&(a[c].selected=m),m&&f&&(a[c].defaultSelected=!0)}else{for(c=""+er(c),i=null,m=0;m<a.length;m++){if(a[m].value===c){a[m].selected=!0,f&&(a[m].defaultSelected=!0);return}i!==null||a[m].disabled||(i=a[m])}i!==null&&(i.selected=!0)}}function Do(a,i,c){if(i!=null&&(i=""+er(i),i!==a.value&&(a.value=i),c==null)){a.defaultValue!==i&&(a.defaultValue=i);return}a.defaultValue=c!=null?""+er(c):""}function vx(a,i,c,f){if(i==null){if(f!=null){if(c!=null)throw Error(n(92));if(Se(f)){if(1<f.length)throw Error(n(93));f=f[0]}c=f}c==null&&(c=""),i=c}c=er(i),a.defaultValue=c,f=a.textContent,f===c&&f!==""&&f!==null&&(a.value=f)}function Ci(a,i){if(i){var c=a.firstChild;if(c&&c===a.lastChild&&c.nodeType===3){c.nodeValue=i;return}}a.textContent=i}var bw=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function _x(a,i,c){var f=i.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?f?a.setProperty(i,""):i==="float"?a.cssFloat="":a[i]="":f?a.setProperty(i,c):typeof c!="number"||c===0||bw.has(i)?i==="float"?a.cssFloat=c:a[i]=(""+c).trim():a[i]=c+"px"}function yx(a,i,c){if(i!=null&&typeof i!="object")throw Error(n(62));if(a=a.style,c!=null){for(var f in c)!c.hasOwnProperty(f)||i!=null&&i.hasOwnProperty(f)||(f.indexOf("--")===0?a.setProperty(f,""):f==="float"?a.cssFloat="":a[f]="");for(var m in i)f=i[m],i.hasOwnProperty(m)&&c[m]!==f&&_x(a,m,f)}else for(var g in i)i.hasOwnProperty(g)&&_x(a,g,i[g])}function Nu(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ew=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Tw=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ro(a){return Tw.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}var Cu=null;function Ou(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Oi=null,Di=null;function wx(a){var i=F(a);if(i&&(a=i.stateNode)){var c=a[Jt]||null;e:switch(a=i.stateNode,i.type){case"input":if(vr(a,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),i=c.name,c.type==="radio"&&i!=null){for(c=a;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+ht(""+i)+'"][type="radio"]'),i=0;i<c.length;i++){var f=c[i];if(f!==a&&f.form===a.form){var m=f[Jt]||null;if(!m)throw Error(n(90));vr(f,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(i=0;i<c.length;i++)f=c[i],f.form===a.form&&Ni(f)}break e;case"textarea":Do(a,c.value,c.defaultValue);break e;case"select":i=c.value,i!=null&&pa(a,!!c.multiple,i,!1)}}}var Du=!1;function bx(a,i,c){if(Du)return a(i,c);Du=!0;try{var f=a(i);return f}finally{if(Du=!1,(Oi!==null||Di!==null)&&(g0(),Oi&&(i=Oi,a=Di,Di=Oi=null,wx(i),a)))for(i=0;i<a.length;i++)wx(a[i])}}function Pl(a,i){var c=a.stateNode;if(c===null)return null;var f=c[Jt]||null;if(f===null)return null;c=f[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(a=a.type,f=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!f;break e;default:a=!1}if(a)return null;if(c&&typeof c!="function")throw Error(n(231,i,typeof c));return c}var En=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ru=!1;if(En)try{var Hl={};Object.defineProperty(Hl,"passive",{get:function(){Ru=!0}}),window.addEventListener("test",Hl,Hl),window.removeEventListener("test",Hl,Hl)}catch{Ru=!1}var Jn=null,ju=null,jo=null;function Ex(){if(jo)return jo;var a,i=ju,c=i.length,f,m="value"in Jn?Jn.value:Jn.textContent,g=m.length;for(a=0;a<c&&i[a]===m[a];a++);var T=c-a;for(f=1;f<=T&&i[c-f]===m[g-f];f++);return jo=m.slice(a,1<f?1-f:void 0)}function Io(a){var i=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&i===13&&(a=13)):a=i,a===10&&(a=13),32<=a||a===13?a:0}function Mo(){return!0}function Tx(){return!1}function la(a){function i(c,f,m,g,T){this._reactName=c,this._targetInst=m,this.type=f,this.nativeEvent=g,this.target=T,this.currentTarget=null;for(var D in a)a.hasOwnProperty(D)&&(c=a[D],this[D]=c?c(g):g[D]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?Mo:Tx,this.isPropagationStopped=Tx,this}return p(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Mo)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Mo)},persist:function(){},isPersistent:Mo}),i}var Hs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Lo=la(Hs),zl=p({},Hs,{view:0,detail:0}),Sw=la(zl),Iu,Mu,Gl,Fo=p({},zl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Fu,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==Gl&&(Gl&&a.type==="mousemove"?(Iu=a.screenX-Gl.screenX,Mu=a.screenY-Gl.screenY):Mu=Iu=0,Gl=a),Iu)},movementY:function(a){return"movementY"in a?a.movementY:Mu}}),Sx=la(Fo),kw=p({},Fo,{dataTransfer:0}),Aw=la(kw),Nw=p({},zl,{relatedTarget:0}),Lu=la(Nw),Cw=p({},Hs,{animationName:0,elapsedTime:0,pseudoElement:0}),Ow=la(Cw),Dw=p({},Hs,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),Rw=la(Dw),jw=p({},Hs,{data:0}),kx=la(jw),Iw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Mw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Lw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Fw(a){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(a):(a=Lw[a])?!!i[a]:!1}function Fu(){return Fw}var Uw=p({},zl,{key:function(a){if(a.key){var i=Iw[a.key]||a.key;if(i!=="Unidentified")return i}return a.type==="keypress"?(a=Io(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?Mw[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Fu,charCode:function(a){return a.type==="keypress"?Io(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Io(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),Bw=la(Uw),Pw=p({},Fo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ax=la(Pw),Hw=p({},zl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Fu}),zw=la(Hw),Gw=p({},Hs,{propertyName:0,elapsedTime:0,pseudoElement:0}),Vw=la(Gw),$w=p({},Fo,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),Yw=la($w),qw=p({},Hs,{newState:0,oldState:0}),Xw=la(qw),Ww=[9,13,27,32],Uu=En&&"CompositionEvent"in window,Vl=null;En&&"documentMode"in document&&(Vl=document.documentMode);var Zw=En&&"TextEvent"in window&&!Vl,Nx=En&&(!Uu||Vl&&8<Vl&&11>=Vl),Cx=" ",Ox=!1;function Dx(a,i){switch(a){case"keyup":return Ww.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Rx(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Ri=!1;function Kw(a,i){switch(a){case"compositionend":return Rx(i);case"keypress":return i.which!==32?null:(Ox=!0,Cx);case"textInput":return a=i.data,a===Cx&&Ox?null:a;default:return null}}function Jw(a,i){if(Ri)return a==="compositionend"||!Uu&&Dx(a,i)?(a=Ex(),jo=ju=Jn=null,Ri=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Nx&&i.locale!=="ko"?null:i.data;default:return null}}var Qw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jx(a){var i=a&&a.nodeName&&a.nodeName.toLowerCase();return i==="input"?!!Qw[a.type]:i==="textarea"}function Ix(a,i,c,f){Oi?Di?Di.push(f):Di=[f]:Oi=f,i=E0(i,"onChange"),0<i.length&&(c=new Lo("onChange","change",null,c,f),a.push({event:c,listeners:i}))}var $l=null,Yl=null;function eb(a){xp(a,0)}function Uo(a){var i=ce(a);if(Ni(i))return a}function Mx(a,i){if(a==="change")return i}var Lx=!1;if(En){var Bu;if(En){var Pu="oninput"in document;if(!Pu){var Fx=document.createElement("div");Fx.setAttribute("oninput","return;"),Pu=typeof Fx.oninput=="function"}Bu=Pu}else Bu=!1;Lx=Bu&&(!document.documentMode||9<document.documentMode)}function Ux(){$l&&($l.detachEvent("onpropertychange",Bx),Yl=$l=null)}function Bx(a){if(a.propertyName==="value"&&Uo(Yl)){var i=[];Ix(i,Yl,a,Ou(a)),bx(eb,i)}}function tb(a,i,c){a==="focusin"?(Ux(),$l=i,Yl=c,$l.attachEvent("onpropertychange",Bx)):a==="focusout"&&Ux()}function rb(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Uo(Yl)}function ab(a,i){if(a==="click")return Uo(i)}function nb(a,i){if(a==="input"||a==="change")return Uo(i)}function sb(a,i){return a===i&&(a!==0||1/a===1/i)||a!==a&&i!==i}var ga=typeof Object.is=="function"?Object.is:sb;function ql(a,i){if(ga(a,i))return!0;if(typeof a!="object"||a===null||typeof i!="object"||i===null)return!1;var c=Object.keys(a),f=Object.keys(i);if(c.length!==f.length)return!1;for(f=0;f<c.length;f++){var m=c[f];if(!Y.call(i,m)||!ga(a[m],i[m]))return!1}return!0}function Px(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Hx(a,i){var c=Px(a);a=0;for(var f;c;){if(c.nodeType===3){if(f=a+c.textContent.length,a<=i&&f>=i)return{node:c,offset:i-a};a=f}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=Px(c)}}function zx(a,i){return a&&i?a===i?!0:a&&a.nodeType===3?!1:i&&i.nodeType===3?zx(a,i.parentNode):"contains"in a?a.contains(i):a.compareDocumentPosition?!!(a.compareDocumentPosition(i)&16):!1:!1}function Gx(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var i=Bs(a.document);i instanceof a.HTMLIFrameElement;){try{var c=typeof i.contentWindow.location.href=="string"}catch{c=!1}if(c)a=i.contentWindow;else break;i=Bs(a.document)}return i}function Hu(a){var i=a&&a.nodeName&&a.nodeName.toLowerCase();return i&&(i==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||i==="textarea"||a.contentEditable==="true")}var ib=En&&"documentMode"in document&&11>=document.documentMode,ji=null,zu=null,Xl=null,Gu=!1;function Vx(a,i,c){var f=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Gu||ji==null||ji!==Bs(f)||(f=ji,"selectionStart"in f&&Hu(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),Xl&&ql(Xl,f)||(Xl=f,f=E0(zu,"onSelect"),0<f.length&&(i=new Lo("onSelect","select",null,i,c),a.push({event:i,listeners:f}),i.target=ji)))}function zs(a,i){var c={};return c[a.toLowerCase()]=i.toLowerCase(),c["Webkit"+a]="webkit"+i,c["Moz"+a]="moz"+i,c}var Ii={animationend:zs("Animation","AnimationEnd"),animationiteration:zs("Animation","AnimationIteration"),animationstart:zs("Animation","AnimationStart"),transitionrun:zs("Transition","TransitionRun"),transitionstart:zs("Transition","TransitionStart"),transitioncancel:zs("Transition","TransitionCancel"),transitionend:zs("Transition","TransitionEnd")},Vu={},$x={};En&&($x=document.createElement("div").style,"AnimationEvent"in window||(delete Ii.animationend.animation,delete Ii.animationiteration.animation,delete Ii.animationstart.animation),"TransitionEvent"in window||delete Ii.transitionend.transition);function Gs(a){if(Vu[a])return Vu[a];if(!Ii[a])return a;var i=Ii[a],c;for(c in i)if(i.hasOwnProperty(c)&&c in $x)return Vu[a]=i[c];return a}var Yx=Gs("animationend"),qx=Gs("animationiteration"),Xx=Gs("animationstart"),lb=Gs("transitionrun"),cb=Gs("transitionstart"),ob=Gs("transitioncancel"),Wx=Gs("transitionend"),Zx=new Map,$u="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");$u.push("scrollEnd");function Xa(a,i){Zx.set(a,i),Ne(i,[a])}var Kx=new WeakMap;function Da(a,i){if(typeof a=="object"&&a!==null){var c=Kx.get(a);return c!==void 0?c:(i={value:a,source:i,stack:Oa(i)},Kx.set(a,i),i)}return{value:a,source:i,stack:Oa(i)}}var Ra=[],Mi=0,Yu=0;function Bo(){for(var a=Mi,i=Yu=Mi=0;i<a;){var c=Ra[i];Ra[i++]=null;var f=Ra[i];Ra[i++]=null;var m=Ra[i];Ra[i++]=null;var g=Ra[i];if(Ra[i++]=null,f!==null&&m!==null){var T=f.pending;T===null?m.next=m:(m.next=T.next,T.next=m),f.pending=m}g!==0&&Jx(c,m,g)}}function Po(a,i,c,f){Ra[Mi++]=a,Ra[Mi++]=i,Ra[Mi++]=c,Ra[Mi++]=f,Yu|=f,a.lanes|=f,a=a.alternate,a!==null&&(a.lanes|=f)}function qu(a,i,c,f){return Po(a,i,c,f),Ho(a)}function Li(a,i){return Po(a,null,null,i),Ho(a)}function Jx(a,i,c){a.lanes|=c;var f=a.alternate;f!==null&&(f.lanes|=c);for(var m=!1,g=a.return;g!==null;)g.childLanes|=c,f=g.alternate,f!==null&&(f.childLanes|=c),g.tag===22&&(a=g.stateNode,a===null||a._visibility&1||(m=!0)),a=g,g=g.return;return a.tag===3?(g=a.stateNode,m&&i!==null&&(m=31-Qe(c),a=g.hiddenUpdates,f=a[m],f===null?a[m]=[i]:f.push(i),i.lane=c|536870912),g):null}function Ho(a){if(50<_c)throw _c=0,ed=null,Error(n(185));for(var i=a.return;i!==null;)a=i,i=a.return;return a.tag===3?a.stateNode:null}var Fi={};function ub(a,i,c,f){this.tag=a,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function va(a,i,c,f){return new ub(a,i,c,f)}function Xu(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Tn(a,i){var c=a.alternate;return c===null?(c=va(a.tag,i,a.key,a.mode),c.elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=i,c.type=a.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=a.flags&65011712,c.childLanes=a.childLanes,c.lanes=a.lanes,c.child=a.child,c.memoizedProps=a.memoizedProps,c.memoizedState=a.memoizedState,c.updateQueue=a.updateQueue,i=a.dependencies,c.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},c.sibling=a.sibling,c.index=a.index,c.ref=a.ref,c.refCleanup=a.refCleanup,c}function Qx(a,i){a.flags&=65011714;var c=a.alternate;return c===null?(a.childLanes=0,a.lanes=i,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=c.childLanes,a.lanes=c.lanes,a.child=c.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=c.memoizedProps,a.memoizedState=c.memoizedState,a.updateQueue=c.updateQueue,a.type=c.type,i=c.dependencies,a.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),a}function zo(a,i,c,f,m,g){var T=0;if(f=a,typeof a=="function")Xu(a)&&(T=1);else if(typeof a=="string")T=dE(a,c,z.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case U:return a=va(31,c,i,m),a.elementType=U,a.lanes=g,a;case w:return Vs(c.children,m,g,i);case b:T=8,m|=24;break;case E:return a=va(12,c,i,m|2),a.elementType=E,a.lanes=g,a;case Z:return a=va(13,c,i,m),a.elementType=Z,a.lanes=g,a;case W:return a=va(19,c,i,m),a.elementType=W,a.lanes=g,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case j:case S:T=10;break e;case C:T=9;break e;case L:T=11;break e;case I:T=14;break e;case X:T=16,f=null;break e}T=29,c=Error(n(130,a===null?"null":typeof a,"")),f=null}return i=va(T,c,i,m),i.elementType=a,i.type=f,i.lanes=g,i}function Vs(a,i,c,f){return a=va(7,a,f,i),a.lanes=c,a}function Wu(a,i,c){return a=va(6,a,null,i),a.lanes=c,a}function Zu(a,i,c){return i=va(4,a.children!==null?a.children:[],a.key,i),i.lanes=c,i.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},i}var Ui=[],Bi=0,Go=null,Vo=0,ja=[],Ia=0,$s=null,Sn=1,kn="";function Ys(a,i){Ui[Bi++]=Vo,Ui[Bi++]=Go,Go=a,Vo=i}function em(a,i,c){ja[Ia++]=Sn,ja[Ia++]=kn,ja[Ia++]=$s,$s=a;var f=Sn;a=kn;var m=32-Qe(f)-1;f&=~(1<<m),c+=1;var g=32-Qe(i)+m;if(30<g){var T=m-m%5;g=(f&(1<<T)-1).toString(32),f>>=T,m-=T,Sn=1<<32-Qe(i)+m|c<<m|f,kn=g+a}else Sn=1<<g|c<<m|f,kn=a}function Ku(a){a.return!==null&&(Ys(a,1),em(a,1,0))}function Ju(a){for(;a===Go;)Go=Ui[--Bi],Ui[Bi]=null,Vo=Ui[--Bi],Ui[Bi]=null;for(;a===$s;)$s=ja[--Ia],ja[Ia]=null,kn=ja[--Ia],ja[Ia]=null,Sn=ja[--Ia],ja[Ia]=null}var Kr=null,tr=null,jt=!1,qs=null,cn=!1,Qu=Error(n(519));function Xs(a){var i=Error(n(418,""));throw Kl(Da(i,a)),Qu}function tm(a){var i=a.stateNode,c=a.type,f=a.memoizedProps;switch(i[Kt]=a,i[Jt]=f,c){case"dialog":mt("cancel",i),mt("close",i);break;case"iframe":case"object":case"embed":mt("load",i);break;case"video":case"audio":for(c=0;c<wc.length;c++)mt(wc[c],i);break;case"source":mt("error",i);break;case"img":case"image":case"link":mt("error",i),mt("load",i);break;case"details":mt("toggle",i);break;case"input":mt("invalid",i),Ps(i,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0),Kn(i);break;case"select":mt("invalid",i);break;case"textarea":mt("invalid",i),vx(i,f.value,f.defaultValue,f.children),Kn(i)}c=f.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||i.textContent===""+c||f.suppressHydrationWarning===!0||vp(i.textContent,c)?(f.popover!=null&&(mt("beforetoggle",i),mt("toggle",i)),f.onScroll!=null&&mt("scroll",i),f.onScrollEnd!=null&&mt("scrollend",i),f.onClick!=null&&(i.onclick=T0),i=!0):i=!1,i||Xs(a)}function rm(a){for(Kr=a.return;Kr;)switch(Kr.tag){case 5:case 13:cn=!1;return;case 27:case 3:cn=!0;return;default:Kr=Kr.return}}function Wl(a){if(a!==Kr)return!1;if(!jt)return rm(a),jt=!0,!1;var i=a.tag,c;if((c=i!==3&&i!==27)&&((c=i===5)&&(c=a.type,c=!(c!=="form"&&c!=="button")||pd(a.type,a.memoizedProps)),c=!c),c&&tr&&Xs(a),rm(a),i===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));e:{for(a=a.nextSibling,i=0;a;){if(a.nodeType===8)if(c=a.data,c==="/$"){if(i===0){tr=Za(a.nextSibling);break e}i--}else c!=="$"&&c!=="$!"&&c!=="$?"||i++;a=a.nextSibling}tr=null}}else i===27?(i=tr,xs(a.type)?(a=yd,yd=null,tr=a):tr=i):tr=Kr?Za(a.stateNode.nextSibling):null;return!0}function Zl(){tr=Kr=null,jt=!1}function am(){var a=qs;return a!==null&&(ua===null?ua=a:ua.push.apply(ua,a),qs=null),a}function Kl(a){qs===null?qs=[a]:qs.push(a)}var ef=K(null),Ws=null,An=null;function Qn(a,i,c){P(ef,i._currentValue),i._currentValue=c}function Nn(a){a._currentValue=ef.current,N(ef)}function tf(a,i,c){for(;a!==null;){var f=a.alternate;if((a.childLanes&i)!==i?(a.childLanes|=i,f!==null&&(f.childLanes|=i)):f!==null&&(f.childLanes&i)!==i&&(f.childLanes|=i),a===c)break;a=a.return}}function rf(a,i,c,f){var m=a.child;for(m!==null&&(m.return=a);m!==null;){var g=m.dependencies;if(g!==null){var T=m.child;g=g.firstContext;e:for(;g!==null;){var D=g;g=m;for(var J=0;J<i.length;J++)if(D.context===i[J]){g.lanes|=c,D=g.alternate,D!==null&&(D.lanes|=c),tf(g.return,c,a),f||(T=null);break e}g=D.next}}else if(m.tag===18){if(T=m.return,T===null)throw Error(n(341));T.lanes|=c,g=T.alternate,g!==null&&(g.lanes|=c),tf(T,c,a),T=null}else T=m.child;if(T!==null)T.return=m;else for(T=m;T!==null;){if(T===a){T=null;break}if(m=T.sibling,m!==null){m.return=T.return,T=m;break}T=T.return}m=T}}function Jl(a,i,c,f){a=null;for(var m=i,g=!1;m!==null;){if(!g){if((m.flags&524288)!==0)g=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var T=m.alternate;if(T===null)throw Error(n(387));if(T=T.memoizedProps,T!==null){var D=m.type;ga(m.pendingProps.value,T.value)||(a!==null?a.push(D):a=[D])}}else if(m===ve.current){if(T=m.alternate,T===null)throw Error(n(387));T.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(a!==null?a.push(Ac):a=[Ac])}m=m.return}a!==null&&rf(i,a,c,f),i.flags|=262144}function $o(a){for(a=a.firstContext;a!==null;){if(!ga(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function Zs(a){Ws=a,An=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function Pr(a){return nm(Ws,a)}function Yo(a,i){return Ws===null&&Zs(a),nm(a,i)}function nm(a,i){var c=i._currentValue;if(i={context:i,memoizedValue:c,next:null},An===null){if(a===null)throw Error(n(308));An=i,a.dependencies={lanes:0,firstContext:i},a.flags|=524288}else An=An.next=i;return c}var fb=typeof AbortController<"u"?AbortController:function(){var a=[],i=this.signal={aborted:!1,addEventListener:function(c,f){a.push(f)}};this.abort=function(){i.aborted=!0,a.forEach(function(c){return c()})}},db=e.unstable_scheduleCallback,hb=e.unstable_NormalPriority,_r={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function af(){return{controller:new fb,data:new Map,refCount:0}}function Ql(a){a.refCount--,a.refCount===0&&db(hb,function(){a.controller.abort()})}var ec=null,nf=0,Pi=0,Hi=null;function xb(a,i){if(ec===null){var c=ec=[];nf=0,Pi=ld(),Hi={status:"pending",value:void 0,then:function(f){c.push(f)}}}return nf++,i.then(sm,sm),i}function sm(){if(--nf===0&&ec!==null){Hi!==null&&(Hi.status="fulfilled");var a=ec;ec=null,Pi=0,Hi=null;for(var i=0;i<a.length;i++)(0,a[i])()}}function mb(a,i){var c=[],f={status:"pending",value:null,reason:null,then:function(m){c.push(m)}};return a.then(function(){f.status="fulfilled",f.value=i;for(var m=0;m<c.length;m++)(0,c[m])(i)},function(m){for(f.status="rejected",f.reason=m,m=0;m<c.length;m++)(0,c[m])(void 0)}),f}var im=ae.S;ae.S=function(a,i){typeof i=="object"&&i!==null&&typeof i.then=="function"&&xb(a,i),im!==null&&im(a,i)};var Ks=K(null);function sf(){var a=Ks.current;return a!==null?a:zt.pooledCache}function qo(a,i){i===null?P(Ks,Ks.current):P(Ks,i.pool)}function lm(){var a=sf();return a===null?null:{parent:_r._currentValue,pool:a}}var tc=Error(n(460)),cm=Error(n(474)),Xo=Error(n(542)),lf={then:function(){}};function om(a){return a=a.status,a==="fulfilled"||a==="rejected"}function Wo(){}function um(a,i,c){switch(c=a[c],c===void 0?a.push(i):c!==i&&(i.then(Wo,Wo),i=c),i.status){case"fulfilled":return i.value;case"rejected":throw a=i.reason,dm(a),a;default:if(typeof i.status=="string")i.then(Wo,Wo);else{if(a=zt,a!==null&&100<a.shellSuspendCounter)throw Error(n(482));a=i,a.status="pending",a.then(function(f){if(i.status==="pending"){var m=i;m.status="fulfilled",m.value=f}},function(f){if(i.status==="pending"){var m=i;m.status="rejected",m.reason=f}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw a=i.reason,dm(a),a}throw rc=i,tc}}var rc=null;function fm(){if(rc===null)throw Error(n(459));var a=rc;return rc=null,a}function dm(a){if(a===tc||a===Xo)throw Error(n(483))}var es=!1;function cf(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function of(a,i){a=a.updateQueue,i.updateQueue===a&&(i.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function ts(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function rs(a,i,c){var f=a.updateQueue;if(f===null)return null;if(f=f.shared,(It&2)!==0){var m=f.pending;return m===null?i.next=i:(i.next=m.next,m.next=i),f.pending=i,i=Ho(a),Jx(a,null,c),i}return Po(a,f,i,c),Ho(a)}function ac(a,i,c){if(i=i.updateQueue,i!==null&&(i=i.shared,(c&4194048)!==0)){var f=i.lanes;f&=a.pendingLanes,c|=f,i.lanes=c,Xn(a,c)}}function uf(a,i){var c=a.updateQueue,f=a.alternate;if(f!==null&&(f=f.updateQueue,c===f)){var m=null,g=null;if(c=c.firstBaseUpdate,c!==null){do{var T={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};g===null?m=g=T:g=g.next=T,c=c.next}while(c!==null);g===null?m=g=i:g=g.next=i}else m=g=i;c={baseState:f.baseState,firstBaseUpdate:m,lastBaseUpdate:g,shared:f.shared,callbacks:f.callbacks},a.updateQueue=c;return}a=c.lastBaseUpdate,a===null?c.firstBaseUpdate=i:a.next=i,c.lastBaseUpdate=i}var ff=!1;function nc(){if(ff){var a=Hi;if(a!==null)throw a}}function sc(a,i,c,f){ff=!1;var m=a.updateQueue;es=!1;var g=m.firstBaseUpdate,T=m.lastBaseUpdate,D=m.shared.pending;if(D!==null){m.shared.pending=null;var J=D,fe=J.next;J.next=null,T===null?g=fe:T.next=fe,T=J;var we=a.alternate;we!==null&&(we=we.updateQueue,D=we.lastBaseUpdate,D!==T&&(D===null?we.firstBaseUpdate=fe:D.next=fe,we.lastBaseUpdate=J))}if(g!==null){var ke=m.baseState;T=0,we=fe=J=null,D=g;do{var xe=D.lane&-536870913,me=xe!==D.lane;if(me?(wt&xe)===xe:(f&xe)===xe){xe!==0&&xe===Pi&&(ff=!0),we!==null&&(we=we.next={lane:0,tag:D.tag,payload:D.payload,callback:null,next:null});e:{var Ze=a,qe=D;xe=i;var Bt=c;switch(qe.tag){case 1:if(Ze=qe.payload,typeof Ze=="function"){ke=Ze.call(Bt,ke,xe);break e}ke=Ze;break e;case 3:Ze.flags=Ze.flags&-65537|128;case 0:if(Ze=qe.payload,xe=typeof Ze=="function"?Ze.call(Bt,ke,xe):Ze,xe==null)break e;ke=p({},ke,xe);break e;case 2:es=!0}}xe=D.callback,xe!==null&&(a.flags|=64,me&&(a.flags|=8192),me=m.callbacks,me===null?m.callbacks=[xe]:me.push(xe))}else me={lane:xe,tag:D.tag,payload:D.payload,callback:D.callback,next:null},we===null?(fe=we=me,J=ke):we=we.next=me,T|=xe;if(D=D.next,D===null){if(D=m.shared.pending,D===null)break;me=D,D=me.next,me.next=null,m.lastBaseUpdate=me,m.shared.pending=null}}while(!0);we===null&&(J=ke),m.baseState=J,m.firstBaseUpdate=fe,m.lastBaseUpdate=we,g===null&&(m.shared.lanes=0),us|=T,a.lanes=T,a.memoizedState=ke}}function hm(a,i){if(typeof a!="function")throw Error(n(191,a));a.call(i)}function xm(a,i){var c=a.callbacks;if(c!==null)for(a.callbacks=null,a=0;a<c.length;a++)hm(c[a],i)}var zi=K(null),Zo=K(0);function mm(a,i){a=Mn,P(Zo,a),P(zi,i),Mn=a|i.baseLanes}function df(){P(Zo,Mn),P(zi,zi.current)}function hf(){Mn=Zo.current,N(zi),N(Zo)}var as=0,ct=null,Ft=null,ur=null,Ko=!1,Gi=!1,Js=!1,Jo=0,ic=0,Vi=null,pb=0;function ir(){throw Error(n(321))}function xf(a,i){if(i===null)return!1;for(var c=0;c<i.length&&c<a.length;c++)if(!ga(a[c],i[c]))return!1;return!0}function mf(a,i,c,f,m,g){return as=g,ct=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,ae.H=a===null||a.memoizedState===null?Jm:Qm,Js=!1,g=c(f,m),Js=!1,Gi&&(g=gm(i,c,f,m)),pm(a),g}function pm(a){ae.H=n0;var i=Ft!==null&&Ft.next!==null;if(as=0,ur=Ft=ct=null,Ko=!1,ic=0,Vi=null,i)throw Error(n(300));a===null||Sr||(a=a.dependencies,a!==null&&$o(a)&&(Sr=!0))}function gm(a,i,c,f){ct=a;var m=0;do{if(Gi&&(Vi=null),ic=0,Gi=!1,25<=m)throw Error(n(301));if(m+=1,ur=Ft=null,a.updateQueue!=null){var g=a.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}ae.H=Eb,g=i(c,f)}while(Gi);return g}function gb(){var a=ae.H,i=a.useState()[0];return i=typeof i.then=="function"?lc(i):i,a=a.useState()[0],(Ft!==null?Ft.memoizedState:null)!==a&&(ct.flags|=1024),i}function pf(){var a=Jo!==0;return Jo=0,a}function gf(a,i,c){i.updateQueue=a.updateQueue,i.flags&=-2053,a.lanes&=~c}function vf(a){if(Ko){for(a=a.memoizedState;a!==null;){var i=a.queue;i!==null&&(i.pending=null),a=a.next}Ko=!1}as=0,ur=Ft=ct=null,Gi=!1,ic=Jo=0,Vi=null}function ca(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ur===null?ct.memoizedState=ur=a:ur=ur.next=a,ur}function fr(){if(Ft===null){var a=ct.alternate;a=a!==null?a.memoizedState:null}else a=Ft.next;var i=ur===null?ct.memoizedState:ur.next;if(i!==null)ur=i,Ft=a;else{if(a===null)throw ct.alternate===null?Error(n(467)):Error(n(310));Ft=a,a={memoizedState:Ft.memoizedState,baseState:Ft.baseState,baseQueue:Ft.baseQueue,queue:Ft.queue,next:null},ur===null?ct.memoizedState=ur=a:ur=ur.next=a}return ur}function _f(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function lc(a){var i=ic;return ic+=1,Vi===null&&(Vi=[]),a=um(Vi,a,i),i=ct,(ur===null?i.memoizedState:ur.next)===null&&(i=i.alternate,ae.H=i===null||i.memoizedState===null?Jm:Qm),a}function Qo(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return lc(a);if(a.$$typeof===S)return Pr(a)}throw Error(n(438,String(a)))}function yf(a){var i=null,c=ct.updateQueue;if(c!==null&&(i=c.memoCache),i==null){var f=ct.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(i={data:f.data.map(function(m){return m.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),c===null&&(c=_f(),ct.updateQueue=c),c.memoCache=i,c=i.data[i.index],c===void 0)for(c=i.data[i.index]=Array(a),f=0;f<a;f++)c[f]=ee;return i.index++,c}function Cn(a,i){return typeof i=="function"?i(a):i}function e0(a){var i=fr();return wf(i,Ft,a)}function wf(a,i,c){var f=a.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=c;var m=a.baseQueue,g=f.pending;if(g!==null){if(m!==null){var T=m.next;m.next=g.next,g.next=T}i.baseQueue=m=g,f.pending=null}if(g=a.baseState,m===null)a.memoizedState=g;else{i=m.next;var D=T=null,J=null,fe=i,we=!1;do{var ke=fe.lane&-536870913;if(ke!==fe.lane?(wt&ke)===ke:(as&ke)===ke){var xe=fe.revertLane;if(xe===0)J!==null&&(J=J.next={lane:0,revertLane:0,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null}),ke===Pi&&(we=!0);else if((as&xe)===xe){fe=fe.next,xe===Pi&&(we=!0);continue}else ke={lane:0,revertLane:fe.revertLane,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null},J===null?(D=J=ke,T=g):J=J.next=ke,ct.lanes|=xe,us|=xe;ke=fe.action,Js&&c(g,ke),g=fe.hasEagerState?fe.eagerState:c(g,ke)}else xe={lane:ke,revertLane:fe.revertLane,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null},J===null?(D=J=xe,T=g):J=J.next=xe,ct.lanes|=ke,us|=ke;fe=fe.next}while(fe!==null&&fe!==i);if(J===null?T=g:J.next=D,!ga(g,a.memoizedState)&&(Sr=!0,we&&(c=Hi,c!==null)))throw c;a.memoizedState=g,a.baseState=T,a.baseQueue=J,f.lastRenderedState=g}return m===null&&(f.lanes=0),[a.memoizedState,f.dispatch]}function bf(a){var i=fr(),c=i.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=a;var f=c.dispatch,m=c.pending,g=i.memoizedState;if(m!==null){c.pending=null;var T=m=m.next;do g=a(g,T.action),T=T.next;while(T!==m);ga(g,i.memoizedState)||(Sr=!0),i.memoizedState=g,i.baseQueue===null&&(i.baseState=g),c.lastRenderedState=g}return[g,f]}function vm(a,i,c){var f=ct,m=fr(),g=jt;if(g){if(c===void 0)throw Error(n(407));c=c()}else c=i();var T=!ga((Ft||m).memoizedState,c);T&&(m.memoizedState=c,Sr=!0),m=m.queue;var D=wm.bind(null,f,m,a);if(cc(2048,8,D,[a]),m.getSnapshot!==i||T||ur!==null&&ur.memoizedState.tag&1){if(f.flags|=2048,$i(9,t0(),ym.bind(null,f,m,c,i),null),zt===null)throw Error(n(349));g||(as&124)!==0||_m(f,i,c)}return c}function _m(a,i,c){a.flags|=16384,a={getSnapshot:i,value:c},i=ct.updateQueue,i===null?(i=_f(),ct.updateQueue=i,i.stores=[a]):(c=i.stores,c===null?i.stores=[a]:c.push(a))}function ym(a,i,c,f){i.value=c,i.getSnapshot=f,bm(i)&&Em(a)}function wm(a,i,c){return c(function(){bm(i)&&Em(a)})}function bm(a){var i=a.getSnapshot;a=a.value;try{var c=i();return!ga(a,c)}catch{return!0}}function Em(a){var i=Li(a,2);i!==null&&Ea(i,a,2)}function Ef(a){var i=ca();if(typeof a=="function"){var c=a;if(a=c(),Js){yt(!0);try{c()}finally{yt(!1)}}}return i.memoizedState=i.baseState=a,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Cn,lastRenderedState:a},i}function Tm(a,i,c,f){return a.baseState=c,wf(a,Ft,typeof f=="function"?f:Cn)}function vb(a,i,c,f,m){if(a0(a))throw Error(n(485));if(a=i.action,a!==null){var g={payload:m,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){g.listeners.push(T)}};ae.T!==null?c(!0):g.isTransition=!1,f(g),c=i.pending,c===null?(g.next=i.pending=g,Sm(i,g)):(g.next=c.next,i.pending=c.next=g)}}function Sm(a,i){var c=i.action,f=i.payload,m=a.state;if(i.isTransition){var g=ae.T,T={};ae.T=T;try{var D=c(m,f),J=ae.S;J!==null&&J(T,D),km(a,i,D)}catch(fe){Tf(a,i,fe)}finally{ae.T=g}}else try{g=c(m,f),km(a,i,g)}catch(fe){Tf(a,i,fe)}}function km(a,i,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(f){Am(a,i,f)},function(f){return Tf(a,i,f)}):Am(a,i,c)}function Am(a,i,c){i.status="fulfilled",i.value=c,Nm(i),a.state=c,i=a.pending,i!==null&&(c=i.next,c===i?a.pending=null:(c=c.next,i.next=c,Sm(a,c)))}function Tf(a,i,c){var f=a.pending;if(a.pending=null,f!==null){f=f.next;do i.status="rejected",i.reason=c,Nm(i),i=i.next;while(i!==f)}a.action=null}function Nm(a){a=a.listeners;for(var i=0;i<a.length;i++)(0,a[i])()}function Cm(a,i){return i}function Om(a,i){if(jt){var c=zt.formState;if(c!==null){e:{var f=ct;if(jt){if(tr){t:{for(var m=tr,g=cn;m.nodeType!==8;){if(!g){m=null;break t}if(m=Za(m.nextSibling),m===null){m=null;break t}}g=m.data,m=g==="F!"||g==="F"?m:null}if(m){tr=Za(m.nextSibling),f=m.data==="F!";break e}}Xs(f)}f=!1}f&&(i=c[0])}}return c=ca(),c.memoizedState=c.baseState=i,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Cm,lastRenderedState:i},c.queue=f,c=Wm.bind(null,ct,f),f.dispatch=c,f=Ef(!1),g=Cf.bind(null,ct,!1,f.queue),f=ca(),m={state:i,dispatch:null,action:a,pending:null},f.queue=m,c=vb.bind(null,ct,m,g,c),m.dispatch=c,f.memoizedState=a,[i,c,!1]}function Dm(a){var i=fr();return Rm(i,Ft,a)}function Rm(a,i,c){if(i=wf(a,i,Cm)[0],a=e0(Cn)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var f=lc(i)}catch(T){throw T===tc?Xo:T}else f=i;i=fr();var m=i.queue,g=m.dispatch;return c!==i.memoizedState&&(ct.flags|=2048,$i(9,t0(),_b.bind(null,m,c),null)),[f,g,a]}function _b(a,i){a.action=i}function jm(a){var i=fr(),c=Ft;if(c!==null)return Rm(i,c,a);fr(),i=i.memoizedState,c=fr();var f=c.queue.dispatch;return c.memoizedState=a,[i,f,!1]}function $i(a,i,c,f){return a={tag:a,create:c,deps:f,inst:i,next:null},i=ct.updateQueue,i===null&&(i=_f(),ct.updateQueue=i),c=i.lastEffect,c===null?i.lastEffect=a.next=a:(f=c.next,c.next=a,a.next=f,i.lastEffect=a),a}function t0(){return{destroy:void 0,resource:void 0}}function Im(){return fr().memoizedState}function r0(a,i,c,f){var m=ca();f=f===void 0?null:f,ct.flags|=a,m.memoizedState=$i(1|i,t0(),c,f)}function cc(a,i,c,f){var m=fr();f=f===void 0?null:f;var g=m.memoizedState.inst;Ft!==null&&f!==null&&xf(f,Ft.memoizedState.deps)?m.memoizedState=$i(i,g,c,f):(ct.flags|=a,m.memoizedState=$i(1|i,g,c,f))}function Mm(a,i){r0(8390656,8,a,i)}function Lm(a,i){cc(2048,8,a,i)}function Fm(a,i){return cc(4,2,a,i)}function Um(a,i){return cc(4,4,a,i)}function Bm(a,i){if(typeof i=="function"){a=a();var c=i(a);return function(){typeof c=="function"?c():i(null)}}if(i!=null)return a=a(),i.current=a,function(){i.current=null}}function Pm(a,i,c){c=c!=null?c.concat([a]):null,cc(4,4,Bm.bind(null,i,a),c)}function Sf(){}function Hm(a,i){var c=fr();i=i===void 0?null:i;var f=c.memoizedState;return i!==null&&xf(i,f[1])?f[0]:(c.memoizedState=[a,i],a)}function zm(a,i){var c=fr();i=i===void 0?null:i;var f=c.memoizedState;if(i!==null&&xf(i,f[1]))return f[0];if(f=a(),Js){yt(!0);try{a()}finally{yt(!1)}}return c.memoizedState=[f,i],f}function kf(a,i,c){return c===void 0||(as&1073741824)!==0?a.memoizedState=i:(a.memoizedState=c,a=$1(),ct.lanes|=a,us|=a,c)}function Gm(a,i,c,f){return ga(c,i)?c:zi.current!==null?(a=kf(a,c,f),ga(a,i)||(Sr=!0),a):(as&42)===0?(Sr=!0,a.memoizedState=c):(a=$1(),ct.lanes|=a,us|=a,i)}function Vm(a,i,c,f,m){var g=ue.p;ue.p=g!==0&&8>g?g:8;var T=ae.T,D={};ae.T=D,Cf(a,!1,i,c);try{var J=m(),fe=ae.S;if(fe!==null&&fe(D,J),J!==null&&typeof J=="object"&&typeof J.then=="function"){var we=mb(J,f);oc(a,i,we,ba(a))}else oc(a,i,f,ba(a))}catch(ke){oc(a,i,{then:function(){},status:"rejected",reason:ke},ba())}finally{ue.p=g,ae.T=T}}function yb(){}function Af(a,i,c,f){if(a.tag!==5)throw Error(n(476));var m=$m(a).queue;Vm(a,m,i,Q,c===null?yb:function(){return Ym(a),c(f)})}function $m(a){var i=a.memoizedState;if(i!==null)return i;i={memoizedState:Q,baseState:Q,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Cn,lastRenderedState:Q},next:null};var c={};return i.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Cn,lastRenderedState:c},next:null},a.memoizedState=i,a=a.alternate,a!==null&&(a.memoizedState=i),i}function Ym(a){var i=$m(a).next.queue;oc(a,i,{},ba())}function Nf(){return Pr(Ac)}function qm(){return fr().memoizedState}function Xm(){return fr().memoizedState}function wb(a){for(var i=a.return;i!==null;){switch(i.tag){case 24:case 3:var c=ba();a=ts(c);var f=rs(i,a,c);f!==null&&(Ea(f,i,c),ac(f,i,c)),i={cache:af()},a.payload=i;return}i=i.return}}function bb(a,i,c){var f=ba();c={lane:f,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},a0(a)?Zm(i,c):(c=qu(a,i,c,f),c!==null&&(Ea(c,a,f),Km(c,i,f)))}function Wm(a,i,c){var f=ba();oc(a,i,c,f)}function oc(a,i,c,f){var m={lane:f,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(a0(a))Zm(i,m);else{var g=a.alternate;if(a.lanes===0&&(g===null||g.lanes===0)&&(g=i.lastRenderedReducer,g!==null))try{var T=i.lastRenderedState,D=g(T,c);if(m.hasEagerState=!0,m.eagerState=D,ga(D,T))return Po(a,i,m,0),zt===null&&Bo(),!1}catch{}finally{}if(c=qu(a,i,m,f),c!==null)return Ea(c,a,f),Km(c,i,f),!0}return!1}function Cf(a,i,c,f){if(f={lane:2,revertLane:ld(),action:f,hasEagerState:!1,eagerState:null,next:null},a0(a)){if(i)throw Error(n(479))}else i=qu(a,c,f,2),i!==null&&Ea(i,a,2)}function a0(a){var i=a.alternate;return a===ct||i!==null&&i===ct}function Zm(a,i){Gi=Ko=!0;var c=a.pending;c===null?i.next=i:(i.next=c.next,c.next=i),a.pending=i}function Km(a,i,c){if((c&4194048)!==0){var f=i.lanes;f&=a.pendingLanes,c|=f,i.lanes=c,Xn(a,c)}}var n0={readContext:Pr,use:Qo,useCallback:ir,useContext:ir,useEffect:ir,useImperativeHandle:ir,useLayoutEffect:ir,useInsertionEffect:ir,useMemo:ir,useReducer:ir,useRef:ir,useState:ir,useDebugValue:ir,useDeferredValue:ir,useTransition:ir,useSyncExternalStore:ir,useId:ir,useHostTransitionStatus:ir,useFormState:ir,useActionState:ir,useOptimistic:ir,useMemoCache:ir,useCacheRefresh:ir},Jm={readContext:Pr,use:Qo,useCallback:function(a,i){return ca().memoizedState=[a,i===void 0?null:i],a},useContext:Pr,useEffect:Mm,useImperativeHandle:function(a,i,c){c=c!=null?c.concat([a]):null,r0(4194308,4,Bm.bind(null,i,a),c)},useLayoutEffect:function(a,i){return r0(4194308,4,a,i)},useInsertionEffect:function(a,i){r0(4,2,a,i)},useMemo:function(a,i){var c=ca();i=i===void 0?null:i;var f=a();if(Js){yt(!0);try{a()}finally{yt(!1)}}return c.memoizedState=[f,i],f},useReducer:function(a,i,c){var f=ca();if(c!==void 0){var m=c(i);if(Js){yt(!0);try{c(i)}finally{yt(!1)}}}else m=i;return f.memoizedState=f.baseState=m,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:m},f.queue=a,a=a.dispatch=bb.bind(null,ct,a),[f.memoizedState,a]},useRef:function(a){var i=ca();return a={current:a},i.memoizedState=a},useState:function(a){a=Ef(a);var i=a.queue,c=Wm.bind(null,ct,i);return i.dispatch=c,[a.memoizedState,c]},useDebugValue:Sf,useDeferredValue:function(a,i){var c=ca();return kf(c,a,i)},useTransition:function(){var a=Ef(!1);return a=Vm.bind(null,ct,a.queue,!0,!1),ca().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,i,c){var f=ct,m=ca();if(jt){if(c===void 0)throw Error(n(407));c=c()}else{if(c=i(),zt===null)throw Error(n(349));(wt&124)!==0||_m(f,i,c)}m.memoizedState=c;var g={value:c,getSnapshot:i};return m.queue=g,Mm(wm.bind(null,f,g,a),[a]),f.flags|=2048,$i(9,t0(),ym.bind(null,f,g,c,i),null),c},useId:function(){var a=ca(),i=zt.identifierPrefix;if(jt){var c=kn,f=Sn;c=(f&~(1<<32-Qe(f)-1)).toString(32)+c,i=""+i+"R"+c,c=Jo++,0<c&&(i+="H"+c.toString(32)),i+=""}else c=pb++,i=""+i+"r"+c.toString(32)+"";return a.memoizedState=i},useHostTransitionStatus:Nf,useFormState:Om,useActionState:Om,useOptimistic:function(a){var i=ca();i.memoizedState=i.baseState=a;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=c,i=Cf.bind(null,ct,!0,c),c.dispatch=i,[a,i]},useMemoCache:yf,useCacheRefresh:function(){return ca().memoizedState=wb.bind(null,ct)}},Qm={readContext:Pr,use:Qo,useCallback:Hm,useContext:Pr,useEffect:Lm,useImperativeHandle:Pm,useInsertionEffect:Fm,useLayoutEffect:Um,useMemo:zm,useReducer:e0,useRef:Im,useState:function(){return e0(Cn)},useDebugValue:Sf,useDeferredValue:function(a,i){var c=fr();return Gm(c,Ft.memoizedState,a,i)},useTransition:function(){var a=e0(Cn)[0],i=fr().memoizedState;return[typeof a=="boolean"?a:lc(a),i]},useSyncExternalStore:vm,useId:qm,useHostTransitionStatus:Nf,useFormState:Dm,useActionState:Dm,useOptimistic:function(a,i){var c=fr();return Tm(c,Ft,a,i)},useMemoCache:yf,useCacheRefresh:Xm},Eb={readContext:Pr,use:Qo,useCallback:Hm,useContext:Pr,useEffect:Lm,useImperativeHandle:Pm,useInsertionEffect:Fm,useLayoutEffect:Um,useMemo:zm,useReducer:bf,useRef:Im,useState:function(){return bf(Cn)},useDebugValue:Sf,useDeferredValue:function(a,i){var c=fr();return Ft===null?kf(c,a,i):Gm(c,Ft.memoizedState,a,i)},useTransition:function(){var a=bf(Cn)[0],i=fr().memoizedState;return[typeof a=="boolean"?a:lc(a),i]},useSyncExternalStore:vm,useId:qm,useHostTransitionStatus:Nf,useFormState:jm,useActionState:jm,useOptimistic:function(a,i){var c=fr();return Ft!==null?Tm(c,Ft,a,i):(c.baseState=a,[a,c.queue.dispatch])},useMemoCache:yf,useCacheRefresh:Xm},Yi=null,uc=0;function s0(a){var i=uc;return uc+=1,Yi===null&&(Yi=[]),um(Yi,a,i)}function fc(a,i){i=i.props.ref,a.ref=i!==void 0?i:null}function i0(a,i){throw i.$$typeof===v?Error(n(525)):(a=Object.prototype.toString.call(i),Error(n(31,a==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":a)))}function e1(a){var i=a._init;return i(a._payload)}function t1(a){function i(le,ne){if(a){var oe=le.deletions;oe===null?(le.deletions=[ne],le.flags|=16):oe.push(ne)}}function c(le,ne){if(!a)return null;for(;ne!==null;)i(le,ne),ne=ne.sibling;return null}function f(le){for(var ne=new Map;le!==null;)le.key!==null?ne.set(le.key,le):ne.set(le.index,le),le=le.sibling;return ne}function m(le,ne){return le=Tn(le,ne),le.index=0,le.sibling=null,le}function g(le,ne,oe){return le.index=oe,a?(oe=le.alternate,oe!==null?(oe=oe.index,oe<ne?(le.flags|=67108866,ne):oe):(le.flags|=67108866,ne)):(le.flags|=1048576,ne)}function T(le){return a&&le.alternate===null&&(le.flags|=67108866),le}function D(le,ne,oe,Ee){return ne===null||ne.tag!==6?(ne=Wu(oe,le.mode,Ee),ne.return=le,ne):(ne=m(ne,oe),ne.return=le,ne)}function J(le,ne,oe,Ee){var Be=oe.type;return Be===w?we(le,ne,oe.props.children,Ee,oe.key):ne!==null&&(ne.elementType===Be||typeof Be=="object"&&Be!==null&&Be.$$typeof===X&&e1(Be)===ne.type)?(ne=m(ne,oe.props),fc(ne,oe),ne.return=le,ne):(ne=zo(oe.type,oe.key,oe.props,null,le.mode,Ee),fc(ne,oe),ne.return=le,ne)}function fe(le,ne,oe,Ee){return ne===null||ne.tag!==4||ne.stateNode.containerInfo!==oe.containerInfo||ne.stateNode.implementation!==oe.implementation?(ne=Zu(oe,le.mode,Ee),ne.return=le,ne):(ne=m(ne,oe.children||[]),ne.return=le,ne)}function we(le,ne,oe,Ee,Be){return ne===null||ne.tag!==7?(ne=Vs(oe,le.mode,Ee,Be),ne.return=le,ne):(ne=m(ne,oe),ne.return=le,ne)}function ke(le,ne,oe){if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return ne=Wu(""+ne,le.mode,oe),ne.return=le,ne;if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case _:return oe=zo(ne.type,ne.key,ne.props,null,le.mode,oe),fc(oe,ne),oe.return=le,oe;case y:return ne=Zu(ne,le.mode,oe),ne.return=le,ne;case X:var Ee=ne._init;return ne=Ee(ne._payload),ke(le,ne,oe)}if(Se(ne)||V(ne))return ne=Vs(ne,le.mode,oe,null),ne.return=le,ne;if(typeof ne.then=="function")return ke(le,s0(ne),oe);if(ne.$$typeof===S)return ke(le,Yo(le,ne),oe);i0(le,ne)}return null}function xe(le,ne,oe,Ee){var Be=ne!==null?ne.key:null;if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return Be!==null?null:D(le,ne,""+oe,Ee);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case _:return oe.key===Be?J(le,ne,oe,Ee):null;case y:return oe.key===Be?fe(le,ne,oe,Ee):null;case X:return Be=oe._init,oe=Be(oe._payload),xe(le,ne,oe,Ee)}if(Se(oe)||V(oe))return Be!==null?null:we(le,ne,oe,Ee,null);if(typeof oe.then=="function")return xe(le,ne,s0(oe),Ee);if(oe.$$typeof===S)return xe(le,ne,Yo(le,oe),Ee);i0(le,oe)}return null}function me(le,ne,oe,Ee,Be){if(typeof Ee=="string"&&Ee!==""||typeof Ee=="number"||typeof Ee=="bigint")return le=le.get(oe)||null,D(ne,le,""+Ee,Be);if(typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case _:return le=le.get(Ee.key===null?oe:Ee.key)||null,J(ne,le,Ee,Be);case y:return le=le.get(Ee.key===null?oe:Ee.key)||null,fe(ne,le,Ee,Be);case X:var ut=Ee._init;return Ee=ut(Ee._payload),me(le,ne,oe,Ee,Be)}if(Se(Ee)||V(Ee))return le=le.get(oe)||null,we(ne,le,Ee,Be,null);if(typeof Ee.then=="function")return me(le,ne,oe,s0(Ee),Be);if(Ee.$$typeof===S)return me(le,ne,oe,Yo(ne,Ee),Be);i0(ne,Ee)}return null}function Ze(le,ne,oe,Ee){for(var Be=null,ut=null,Ge=ne,We=ne=0,Ar=null;Ge!==null&&We<oe.length;We++){Ge.index>We?(Ar=Ge,Ge=null):Ar=Ge.sibling;var Nt=xe(le,Ge,oe[We],Ee);if(Nt===null){Ge===null&&(Ge=Ar);break}a&&Ge&&Nt.alternate===null&&i(le,Ge),ne=g(Nt,ne,We),ut===null?Be=Nt:ut.sibling=Nt,ut=Nt,Ge=Ar}if(We===oe.length)return c(le,Ge),jt&&Ys(le,We),Be;if(Ge===null){for(;We<oe.length;We++)Ge=ke(le,oe[We],Ee),Ge!==null&&(ne=g(Ge,ne,We),ut===null?Be=Ge:ut.sibling=Ge,ut=Ge);return jt&&Ys(le,We),Be}for(Ge=f(Ge);We<oe.length;We++)Ar=me(Ge,le,We,oe[We],Ee),Ar!==null&&(a&&Ar.alternate!==null&&Ge.delete(Ar.key===null?We:Ar.key),ne=g(Ar,ne,We),ut===null?Be=Ar:ut.sibling=Ar,ut=Ar);return a&&Ge.forEach(function(_s){return i(le,_s)}),jt&&Ys(le,We),Be}function qe(le,ne,oe,Ee){if(oe==null)throw Error(n(151));for(var Be=null,ut=null,Ge=ne,We=ne=0,Ar=null,Nt=oe.next();Ge!==null&&!Nt.done;We++,Nt=oe.next()){Ge.index>We?(Ar=Ge,Ge=null):Ar=Ge.sibling;var _s=xe(le,Ge,Nt.value,Ee);if(_s===null){Ge===null&&(Ge=Ar);break}a&&Ge&&_s.alternate===null&&i(le,Ge),ne=g(_s,ne,We),ut===null?Be=_s:ut.sibling=_s,ut=_s,Ge=Ar}if(Nt.done)return c(le,Ge),jt&&Ys(le,We),Be;if(Ge===null){for(;!Nt.done;We++,Nt=oe.next())Nt=ke(le,Nt.value,Ee),Nt!==null&&(ne=g(Nt,ne,We),ut===null?Be=Nt:ut.sibling=Nt,ut=Nt);return jt&&Ys(le,We),Be}for(Ge=f(Ge);!Nt.done;We++,Nt=oe.next())Nt=me(Ge,le,We,Nt.value,Ee),Nt!==null&&(a&&Nt.alternate!==null&&Ge.delete(Nt.key===null?We:Nt.key),ne=g(Nt,ne,We),ut===null?Be=Nt:ut.sibling=Nt,ut=Nt);return a&&Ge.forEach(function(TE){return i(le,TE)}),jt&&Ys(le,We),Be}function Bt(le,ne,oe,Ee){if(typeof oe=="object"&&oe!==null&&oe.type===w&&oe.key===null&&(oe=oe.props.children),typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case _:e:{for(var Be=oe.key;ne!==null;){if(ne.key===Be){if(Be=oe.type,Be===w){if(ne.tag===7){c(le,ne.sibling),Ee=m(ne,oe.props.children),Ee.return=le,le=Ee;break e}}else if(ne.elementType===Be||typeof Be=="object"&&Be!==null&&Be.$$typeof===X&&e1(Be)===ne.type){c(le,ne.sibling),Ee=m(ne,oe.props),fc(Ee,oe),Ee.return=le,le=Ee;break e}c(le,ne);break}else i(le,ne);ne=ne.sibling}oe.type===w?(Ee=Vs(oe.props.children,le.mode,Ee,oe.key),Ee.return=le,le=Ee):(Ee=zo(oe.type,oe.key,oe.props,null,le.mode,Ee),fc(Ee,oe),Ee.return=le,le=Ee)}return T(le);case y:e:{for(Be=oe.key;ne!==null;){if(ne.key===Be)if(ne.tag===4&&ne.stateNode.containerInfo===oe.containerInfo&&ne.stateNode.implementation===oe.implementation){c(le,ne.sibling),Ee=m(ne,oe.children||[]),Ee.return=le,le=Ee;break e}else{c(le,ne);break}else i(le,ne);ne=ne.sibling}Ee=Zu(oe,le.mode,Ee),Ee.return=le,le=Ee}return T(le);case X:return Be=oe._init,oe=Be(oe._payload),Bt(le,ne,oe,Ee)}if(Se(oe))return Ze(le,ne,oe,Ee);if(V(oe)){if(Be=V(oe),typeof Be!="function")throw Error(n(150));return oe=Be.call(oe),qe(le,ne,oe,Ee)}if(typeof oe.then=="function")return Bt(le,ne,s0(oe),Ee);if(oe.$$typeof===S)return Bt(le,ne,Yo(le,oe),Ee);i0(le,oe)}return typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint"?(oe=""+oe,ne!==null&&ne.tag===6?(c(le,ne.sibling),Ee=m(ne,oe),Ee.return=le,le=Ee):(c(le,ne),Ee=Wu(oe,le.mode,Ee),Ee.return=le,le=Ee),T(le)):c(le,ne)}return function(le,ne,oe,Ee){try{uc=0;var Be=Bt(le,ne,oe,Ee);return Yi=null,Be}catch(Ge){if(Ge===tc||Ge===Xo)throw Ge;var ut=va(29,Ge,null,le.mode);return ut.lanes=Ee,ut.return=le,ut}finally{}}}var qi=t1(!0),r1=t1(!1),Ma=K(null),on=null;function ns(a){var i=a.alternate;P(yr,yr.current&1),P(Ma,a),on===null&&(i===null||zi.current!==null||i.memoizedState!==null)&&(on=a)}function a1(a){if(a.tag===22){if(P(yr,yr.current),P(Ma,a),on===null){var i=a.alternate;i!==null&&i.memoizedState!==null&&(on=a)}}else ss()}function ss(){P(yr,yr.current),P(Ma,Ma.current)}function On(a){N(Ma),on===a&&(on=null),N(yr)}var yr=K(0);function l0(a){for(var i=a;i!==null;){if(i.tag===13){var c=i.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||_d(c)))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break;for(;i.sibling===null;){if(i.return===null||i.return===a)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}function Of(a,i,c,f){i=a.memoizedState,c=c(f,i),c=c==null?i:p({},i,c),a.memoizedState=c,a.lanes===0&&(a.updateQueue.baseState=c)}var Df={enqueueSetState:function(a,i,c){a=a._reactInternals;var f=ba(),m=ts(f);m.payload=i,c!=null&&(m.callback=c),i=rs(a,m,f),i!==null&&(Ea(i,a,f),ac(i,a,f))},enqueueReplaceState:function(a,i,c){a=a._reactInternals;var f=ba(),m=ts(f);m.tag=1,m.payload=i,c!=null&&(m.callback=c),i=rs(a,m,f),i!==null&&(Ea(i,a,f),ac(i,a,f))},enqueueForceUpdate:function(a,i){a=a._reactInternals;var c=ba(),f=ts(c);f.tag=2,i!=null&&(f.callback=i),i=rs(a,f,c),i!==null&&(Ea(i,a,c),ac(i,a,c))}};function n1(a,i,c,f,m,g,T){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(f,g,T):i.prototype&&i.prototype.isPureReactComponent?!ql(c,f)||!ql(m,g):!0}function s1(a,i,c,f){a=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(c,f),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(c,f),i.state!==a&&Df.enqueueReplaceState(i,i.state,null)}function Qs(a,i){var c=i;if("ref"in i){c={};for(var f in i)f!=="ref"&&(c[f]=i[f])}if(a=a.defaultProps){c===i&&(c=p({},c));for(var m in a)c[m]===void 0&&(c[m]=a[m])}return c}var c0=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)};function i1(a){c0(a)}function l1(a){console.error(a)}function c1(a){c0(a)}function o0(a,i){try{var c=a.onUncaughtError;c(i.value,{componentStack:i.stack})}catch(f){setTimeout(function(){throw f})}}function o1(a,i,c){try{var f=a.onCaughtError;f(c.value,{componentStack:c.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function Rf(a,i,c){return c=ts(c),c.tag=3,c.payload={element:null},c.callback=function(){o0(a,i)},c}function u1(a){return a=ts(a),a.tag=3,a}function f1(a,i,c,f){var m=c.type.getDerivedStateFromError;if(typeof m=="function"){var g=f.value;a.payload=function(){return m(g)},a.callback=function(){o1(i,c,f)}}var T=c.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(a.callback=function(){o1(i,c,f),typeof m!="function"&&(fs===null?fs=new Set([this]):fs.add(this));var D=f.stack;this.componentDidCatch(f.value,{componentStack:D!==null?D:""})})}function Tb(a,i,c,f,m){if(c.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(i=c.alternate,i!==null&&Jl(i,c,m,!0),c=Ma.current,c!==null){switch(c.tag){case 13:return on===null?rd():c.alternate===null&&rr===0&&(rr=3),c.flags&=-257,c.flags|=65536,c.lanes=m,f===lf?c.flags|=16384:(i=c.updateQueue,i===null?c.updateQueue=new Set([f]):i.add(f),nd(a,f,m)),!1;case 22:return c.flags|=65536,f===lf?c.flags|=16384:(i=c.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([f])},c.updateQueue=i):(c=i.retryQueue,c===null?i.retryQueue=new Set([f]):c.add(f)),nd(a,f,m)),!1}throw Error(n(435,c.tag))}return nd(a,f,m),rd(),!1}if(jt)return i=Ma.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=m,f!==Qu&&(a=Error(n(422),{cause:f}),Kl(Da(a,c)))):(f!==Qu&&(i=Error(n(423),{cause:f}),Kl(Da(i,c))),a=a.current.alternate,a.flags|=65536,m&=-m,a.lanes|=m,f=Da(f,c),m=Rf(a.stateNode,f,m),uf(a,m),rr!==4&&(rr=2)),!1;var g=Error(n(520),{cause:f});if(g=Da(g,c),vc===null?vc=[g]:vc.push(g),rr!==4&&(rr=2),i===null)return!0;f=Da(f,c),c=i;do{switch(c.tag){case 3:return c.flags|=65536,a=m&-m,c.lanes|=a,a=Rf(c.stateNode,f,a),uf(c,a),!1;case 1:if(i=c.type,g=c.stateNode,(c.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(fs===null||!fs.has(g))))return c.flags|=65536,m&=-m,c.lanes|=m,m=u1(m),f1(m,a,c,f),uf(c,m),!1}c=c.return}while(c!==null);return!1}var d1=Error(n(461)),Sr=!1;function jr(a,i,c,f){i.child=a===null?r1(i,null,c,f):qi(i,a.child,c,f)}function h1(a,i,c,f,m){c=c.render;var g=i.ref;if("ref"in f){var T={};for(var D in f)D!=="ref"&&(T[D]=f[D])}else T=f;return Zs(i),f=mf(a,i,c,T,g,m),D=pf(),a!==null&&!Sr?(gf(a,i,m),Dn(a,i,m)):(jt&&D&&Ku(i),i.flags|=1,jr(a,i,f,m),i.child)}function x1(a,i,c,f,m){if(a===null){var g=c.type;return typeof g=="function"&&!Xu(g)&&g.defaultProps===void 0&&c.compare===null?(i.tag=15,i.type=g,m1(a,i,g,f,m)):(a=zo(c.type,null,f,i,i.mode,m),a.ref=i.ref,a.return=i,i.child=a)}if(g=a.child,!Pf(a,m)){var T=g.memoizedProps;if(c=c.compare,c=c!==null?c:ql,c(T,f)&&a.ref===i.ref)return Dn(a,i,m)}return i.flags|=1,a=Tn(g,f),a.ref=i.ref,a.return=i,i.child=a}function m1(a,i,c,f,m){if(a!==null){var g=a.memoizedProps;if(ql(g,f)&&a.ref===i.ref)if(Sr=!1,i.pendingProps=f=g,Pf(a,m))(a.flags&131072)!==0&&(Sr=!0);else return i.lanes=a.lanes,Dn(a,i,m)}return jf(a,i,c,f,m)}function p1(a,i,c){var f=i.pendingProps,m=f.children,g=a!==null?a.memoizedState:null;if(f.mode==="hidden"){if((i.flags&128)!==0){if(f=g!==null?g.baseLanes|c:c,a!==null){for(m=i.child=a.child,g=0;m!==null;)g=g|m.lanes|m.childLanes,m=m.sibling;i.childLanes=g&~f}else i.childLanes=0,i.child=null;return g1(a,i,f,c)}if((c&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},a!==null&&qo(i,g!==null?g.cachePool:null),g!==null?mm(i,g):df(),a1(i);else return i.lanes=i.childLanes=536870912,g1(a,i,g!==null?g.baseLanes|c:c,c)}else g!==null?(qo(i,g.cachePool),mm(i,g),ss(),i.memoizedState=null):(a!==null&&qo(i,null),df(),ss());return jr(a,i,m,c),i.child}function g1(a,i,c,f){var m=sf();return m=m===null?null:{parent:_r._currentValue,pool:m},i.memoizedState={baseLanes:c,cachePool:m},a!==null&&qo(i,null),df(),a1(i),a!==null&&Jl(a,i,f,!0),null}function u0(a,i){var c=i.ref;if(c===null)a!==null&&a.ref!==null&&(i.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(a===null||a.ref!==c)&&(i.flags|=4194816)}}function jf(a,i,c,f,m){return Zs(i),c=mf(a,i,c,f,void 0,m),f=pf(),a!==null&&!Sr?(gf(a,i,m),Dn(a,i,m)):(jt&&f&&Ku(i),i.flags|=1,jr(a,i,c,m),i.child)}function v1(a,i,c,f,m,g){return Zs(i),i.updateQueue=null,c=gm(i,f,c,m),pm(a),f=pf(),a!==null&&!Sr?(gf(a,i,g),Dn(a,i,g)):(jt&&f&&Ku(i),i.flags|=1,jr(a,i,c,g),i.child)}function _1(a,i,c,f,m){if(Zs(i),i.stateNode===null){var g=Fi,T=c.contextType;typeof T=="object"&&T!==null&&(g=Pr(T)),g=new c(f,g),i.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=Df,i.stateNode=g,g._reactInternals=i,g=i.stateNode,g.props=f,g.state=i.memoizedState,g.refs={},cf(i),T=c.contextType,g.context=typeof T=="object"&&T!==null?Pr(T):Fi,g.state=i.memoizedState,T=c.getDerivedStateFromProps,typeof T=="function"&&(Of(i,c,T,f),g.state=i.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(T=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),T!==g.state&&Df.enqueueReplaceState(g,g.state,null),sc(i,f,g,m),nc(),g.state=i.memoizedState),typeof g.componentDidMount=="function"&&(i.flags|=4194308),f=!0}else if(a===null){g=i.stateNode;var D=i.memoizedProps,J=Qs(c,D);g.props=J;var fe=g.context,we=c.contextType;T=Fi,typeof we=="object"&&we!==null&&(T=Pr(we));var ke=c.getDerivedStateFromProps;we=typeof ke=="function"||typeof g.getSnapshotBeforeUpdate=="function",D=i.pendingProps!==D,we||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(D||fe!==T)&&s1(i,g,f,T),es=!1;var xe=i.memoizedState;g.state=xe,sc(i,f,g,m),nc(),fe=i.memoizedState,D||xe!==fe||es?(typeof ke=="function"&&(Of(i,c,ke,f),fe=i.memoizedState),(J=es||n1(i,c,J,f,xe,fe,T))?(we||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(i.flags|=4194308)):(typeof g.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=f,i.memoizedState=fe),g.props=f,g.state=fe,g.context=T,f=J):(typeof g.componentDidMount=="function"&&(i.flags|=4194308),f=!1)}else{g=i.stateNode,of(a,i),T=i.memoizedProps,we=Qs(c,T),g.props=we,ke=i.pendingProps,xe=g.context,fe=c.contextType,J=Fi,typeof fe=="object"&&fe!==null&&(J=Pr(fe)),D=c.getDerivedStateFromProps,(fe=typeof D=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(T!==ke||xe!==J)&&s1(i,g,f,J),es=!1,xe=i.memoizedState,g.state=xe,sc(i,f,g,m),nc();var me=i.memoizedState;T!==ke||xe!==me||es||a!==null&&a.dependencies!==null&&$o(a.dependencies)?(typeof D=="function"&&(Of(i,c,D,f),me=i.memoizedState),(we=es||n1(i,c,we,f,xe,me,J)||a!==null&&a.dependencies!==null&&$o(a.dependencies))?(fe||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(f,me,J),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(f,me,J)),typeof g.componentDidUpdate=="function"&&(i.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof g.componentDidUpdate!="function"||T===a.memoizedProps&&xe===a.memoizedState||(i.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||T===a.memoizedProps&&xe===a.memoizedState||(i.flags|=1024),i.memoizedProps=f,i.memoizedState=me),g.props=f,g.state=me,g.context=J,f=we):(typeof g.componentDidUpdate!="function"||T===a.memoizedProps&&xe===a.memoizedState||(i.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||T===a.memoizedProps&&xe===a.memoizedState||(i.flags|=1024),f=!1)}return g=f,u0(a,i),f=(i.flags&128)!==0,g||f?(g=i.stateNode,c=f&&typeof c.getDerivedStateFromError!="function"?null:g.render(),i.flags|=1,a!==null&&f?(i.child=qi(i,a.child,null,m),i.child=qi(i,null,c,m)):jr(a,i,c,m),i.memoizedState=g.state,a=i.child):a=Dn(a,i,m),a}function y1(a,i,c,f){return Zl(),i.flags|=256,jr(a,i,c,f),i.child}var If={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Mf(a){return{baseLanes:a,cachePool:lm()}}function Lf(a,i,c){return a=a!==null?a.childLanes&~c:0,i&&(a|=La),a}function w1(a,i,c){var f=i.pendingProps,m=!1,g=(i.flags&128)!==0,T;if((T=g)||(T=a!==null&&a.memoizedState===null?!1:(yr.current&2)!==0),T&&(m=!0,i.flags&=-129),T=(i.flags&32)!==0,i.flags&=-33,a===null){if(jt){if(m?ns(i):ss(),jt){var D=tr,J;if(J=D){e:{for(J=D,D=cn;J.nodeType!==8;){if(!D){D=null;break e}if(J=Za(J.nextSibling),J===null){D=null;break e}}D=J}D!==null?(i.memoizedState={dehydrated:D,treeContext:$s!==null?{id:Sn,overflow:kn}:null,retryLane:536870912,hydrationErrors:null},J=va(18,null,null,0),J.stateNode=D,J.return=i,i.child=J,Kr=i,tr=null,J=!0):J=!1}J||Xs(i)}if(D=i.memoizedState,D!==null&&(D=D.dehydrated,D!==null))return _d(D)?i.lanes=32:i.lanes=536870912,null;On(i)}return D=f.children,f=f.fallback,m?(ss(),m=i.mode,D=f0({mode:"hidden",children:D},m),f=Vs(f,m,c,null),D.return=i,f.return=i,D.sibling=f,i.child=D,m=i.child,m.memoizedState=Mf(c),m.childLanes=Lf(a,T,c),i.memoizedState=If,f):(ns(i),Ff(i,D))}if(J=a.memoizedState,J!==null&&(D=J.dehydrated,D!==null)){if(g)i.flags&256?(ns(i),i.flags&=-257,i=Uf(a,i,c)):i.memoizedState!==null?(ss(),i.child=a.child,i.flags|=128,i=null):(ss(),m=f.fallback,D=i.mode,f=f0({mode:"visible",children:f.children},D),m=Vs(m,D,c,null),m.flags|=2,f.return=i,m.return=i,f.sibling=m,i.child=f,qi(i,a.child,null,c),f=i.child,f.memoizedState=Mf(c),f.childLanes=Lf(a,T,c),i.memoizedState=If,i=m);else if(ns(i),_d(D)){if(T=D.nextSibling&&D.nextSibling.dataset,T)var fe=T.dgst;T=fe,f=Error(n(419)),f.stack="",f.digest=T,Kl({value:f,source:null,stack:null}),i=Uf(a,i,c)}else if(Sr||Jl(a,i,c,!1),T=(c&a.childLanes)!==0,Sr||T){if(T=zt,T!==null&&(f=c&-c,f=(f&42)!==0?1:wn(f),f=(f&(T.suspendedLanes|c))!==0?0:f,f!==0&&f!==J.retryLane))throw J.retryLane=f,Li(a,f),Ea(T,a,f),d1;D.data==="$?"||rd(),i=Uf(a,i,c)}else D.data==="$?"?(i.flags|=192,i.child=a.child,i=null):(a=J.treeContext,tr=Za(D.nextSibling),Kr=i,jt=!0,qs=null,cn=!1,a!==null&&(ja[Ia++]=Sn,ja[Ia++]=kn,ja[Ia++]=$s,Sn=a.id,kn=a.overflow,$s=i),i=Ff(i,f.children),i.flags|=4096);return i}return m?(ss(),m=f.fallback,D=i.mode,J=a.child,fe=J.sibling,f=Tn(J,{mode:"hidden",children:f.children}),f.subtreeFlags=J.subtreeFlags&65011712,fe!==null?m=Tn(fe,m):(m=Vs(m,D,c,null),m.flags|=2),m.return=i,f.return=i,f.sibling=m,i.child=f,f=m,m=i.child,D=a.child.memoizedState,D===null?D=Mf(c):(J=D.cachePool,J!==null?(fe=_r._currentValue,J=J.parent!==fe?{parent:fe,pool:fe}:J):J=lm(),D={baseLanes:D.baseLanes|c,cachePool:J}),m.memoizedState=D,m.childLanes=Lf(a,T,c),i.memoizedState=If,f):(ns(i),c=a.child,a=c.sibling,c=Tn(c,{mode:"visible",children:f.children}),c.return=i,c.sibling=null,a!==null&&(T=i.deletions,T===null?(i.deletions=[a],i.flags|=16):T.push(a)),i.child=c,i.memoizedState=null,c)}function Ff(a,i){return i=f0({mode:"visible",children:i},a.mode),i.return=a,a.child=i}function f0(a,i){return a=va(22,a,null,i),a.lanes=0,a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},a}function Uf(a,i,c){return qi(i,a.child,null,c),a=Ff(i,i.pendingProps.children),a.flags|=2,i.memoizedState=null,a}function b1(a,i,c){a.lanes|=i;var f=a.alternate;f!==null&&(f.lanes|=i),tf(a.return,i,c)}function Bf(a,i,c,f,m){var g=a.memoizedState;g===null?a.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:f,tail:c,tailMode:m}:(g.isBackwards=i,g.rendering=null,g.renderingStartTime=0,g.last=f,g.tail=c,g.tailMode=m)}function E1(a,i,c){var f=i.pendingProps,m=f.revealOrder,g=f.tail;if(jr(a,i,f.children,c),f=yr.current,(f&2)!==0)f=f&1|2,i.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=i.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&b1(a,c,i);else if(a.tag===19)b1(a,c,i);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break e;for(;a.sibling===null;){if(a.return===null||a.return===i)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}f&=1}switch(P(yr,f),m){case"forwards":for(c=i.child,m=null;c!==null;)a=c.alternate,a!==null&&l0(a)===null&&(m=c),c=c.sibling;c=m,c===null?(m=i.child,i.child=null):(m=c.sibling,c.sibling=null),Bf(i,!1,m,c,g);break;case"backwards":for(c=null,m=i.child,i.child=null;m!==null;){if(a=m.alternate,a!==null&&l0(a)===null){i.child=m;break}a=m.sibling,m.sibling=c,c=m,m=a}Bf(i,!0,c,null,g);break;case"together":Bf(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Dn(a,i,c){if(a!==null&&(i.dependencies=a.dependencies),us|=i.lanes,(c&i.childLanes)===0)if(a!==null){if(Jl(a,i,c,!1),(c&i.childLanes)===0)return null}else return null;if(a!==null&&i.child!==a.child)throw Error(n(153));if(i.child!==null){for(a=i.child,c=Tn(a,a.pendingProps),i.child=c,c.return=i;a.sibling!==null;)a=a.sibling,c=c.sibling=Tn(a,a.pendingProps),c.return=i;c.sibling=null}return i.child}function Pf(a,i){return(a.lanes&i)!==0?!0:(a=a.dependencies,!!(a!==null&&$o(a)))}function Sb(a,i,c){switch(i.tag){case 3:be(i,i.stateNode.containerInfo),Qn(i,_r,a.memoizedState.cache),Zl();break;case 27:case 5:ye(i);break;case 4:be(i,i.stateNode.containerInfo);break;case 10:Qn(i,i.type,i.memoizedProps.value);break;case 13:var f=i.memoizedState;if(f!==null)return f.dehydrated!==null?(ns(i),i.flags|=128,null):(c&i.child.childLanes)!==0?w1(a,i,c):(ns(i),a=Dn(a,i,c),a!==null?a.sibling:null);ns(i);break;case 19:var m=(a.flags&128)!==0;if(f=(c&i.childLanes)!==0,f||(Jl(a,i,c,!1),f=(c&i.childLanes)!==0),m){if(f)return E1(a,i,c);i.flags|=128}if(m=i.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),P(yr,yr.current),f)break;return null;case 22:case 23:return i.lanes=0,p1(a,i,c);case 24:Qn(i,_r,a.memoizedState.cache)}return Dn(a,i,c)}function T1(a,i,c){if(a!==null)if(a.memoizedProps!==i.pendingProps)Sr=!0;else{if(!Pf(a,c)&&(i.flags&128)===0)return Sr=!1,Sb(a,i,c);Sr=(a.flags&131072)!==0}else Sr=!1,jt&&(i.flags&1048576)!==0&&em(i,Vo,i.index);switch(i.lanes=0,i.tag){case 16:e:{a=i.pendingProps;var f=i.elementType,m=f._init;if(f=m(f._payload),i.type=f,typeof f=="function")Xu(f)?(a=Qs(f,a),i.tag=1,i=_1(null,i,f,a,c)):(i.tag=0,i=jf(null,i,f,a,c));else{if(f!=null){if(m=f.$$typeof,m===L){i.tag=11,i=h1(null,i,f,a,c);break e}else if(m===I){i.tag=14,i=x1(null,i,f,a,c);break e}}throw i=Re(f)||f,Error(n(306,i,""))}}return i;case 0:return jf(a,i,i.type,i.pendingProps,c);case 1:return f=i.type,m=Qs(f,i.pendingProps),_1(a,i,f,m,c);case 3:e:{if(be(i,i.stateNode.containerInfo),a===null)throw Error(n(387));f=i.pendingProps;var g=i.memoizedState;m=g.element,of(a,i),sc(i,f,null,c);var T=i.memoizedState;if(f=T.cache,Qn(i,_r,f),f!==g.cache&&rf(i,[_r],c,!0),nc(),f=T.element,g.isDehydrated)if(g={element:f,isDehydrated:!1,cache:T.cache},i.updateQueue.baseState=g,i.memoizedState=g,i.flags&256){i=y1(a,i,f,c);break e}else if(f!==m){m=Da(Error(n(424)),i),Kl(m),i=y1(a,i,f,c);break e}else{switch(a=i.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(tr=Za(a.firstChild),Kr=i,jt=!0,qs=null,cn=!0,c=r1(i,null,f,c),i.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(Zl(),f===m){i=Dn(a,i,c);break e}jr(a,i,f,c)}i=i.child}return i;case 26:return u0(a,i),a===null?(c=Np(i.type,null,i.pendingProps,null))?i.memoizedState=c:jt||(c=i.type,a=i.pendingProps,f=S0(se.current).createElement(c),f[Kt]=i,f[Jt]=a,Mr(f,c,a),ie(f),i.stateNode=f):i.memoizedState=Np(i.type,a.memoizedProps,i.pendingProps,a.memoizedState),null;case 27:return ye(i),a===null&&jt&&(f=i.stateNode=Sp(i.type,i.pendingProps,se.current),Kr=i,cn=!0,m=tr,xs(i.type)?(yd=m,tr=Za(f.firstChild)):tr=m),jr(a,i,i.pendingProps.children,c),u0(a,i),a===null&&(i.flags|=4194304),i.child;case 5:return a===null&&jt&&((m=f=tr)&&(f=Qb(f,i.type,i.pendingProps,cn),f!==null?(i.stateNode=f,Kr=i,tr=Za(f.firstChild),cn=!1,m=!0):m=!1),m||Xs(i)),ye(i),m=i.type,g=i.pendingProps,T=a!==null?a.memoizedProps:null,f=g.children,pd(m,g)?f=null:T!==null&&pd(m,T)&&(i.flags|=32),i.memoizedState!==null&&(m=mf(a,i,gb,null,null,c),Ac._currentValue=m),u0(a,i),jr(a,i,f,c),i.child;case 6:return a===null&&jt&&((a=c=tr)&&(c=eE(c,i.pendingProps,cn),c!==null?(i.stateNode=c,Kr=i,tr=null,a=!0):a=!1),a||Xs(i)),null;case 13:return w1(a,i,c);case 4:return be(i,i.stateNode.containerInfo),f=i.pendingProps,a===null?i.child=qi(i,null,f,c):jr(a,i,f,c),i.child;case 11:return h1(a,i,i.type,i.pendingProps,c);case 7:return jr(a,i,i.pendingProps,c),i.child;case 8:return jr(a,i,i.pendingProps.children,c),i.child;case 12:return jr(a,i,i.pendingProps.children,c),i.child;case 10:return f=i.pendingProps,Qn(i,i.type,f.value),jr(a,i,f.children,c),i.child;case 9:return m=i.type._context,f=i.pendingProps.children,Zs(i),m=Pr(m),f=f(m),i.flags|=1,jr(a,i,f,c),i.child;case 14:return x1(a,i,i.type,i.pendingProps,c);case 15:return m1(a,i,i.type,i.pendingProps,c);case 19:return E1(a,i,c);case 31:return f=i.pendingProps,c=i.mode,f={mode:f.mode,children:f.children},a===null?(c=f0(f,c),c.ref=i.ref,i.child=c,c.return=i,i=c):(c=Tn(a.child,f),c.ref=i.ref,i.child=c,c.return=i,i=c),i;case 22:return p1(a,i,c);case 24:return Zs(i),f=Pr(_r),a===null?(m=sf(),m===null&&(m=zt,g=af(),m.pooledCache=g,g.refCount++,g!==null&&(m.pooledCacheLanes|=c),m=g),i.memoizedState={parent:f,cache:m},cf(i),Qn(i,_r,m)):((a.lanes&c)!==0&&(of(a,i),sc(i,null,null,c),nc()),m=a.memoizedState,g=i.memoizedState,m.parent!==f?(m={parent:f,cache:f},i.memoizedState=m,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=m),Qn(i,_r,f)):(f=g.cache,Qn(i,_r,f),f!==m.cache&&rf(i,[_r],c,!0))),jr(a,i,i.pendingProps.children,c),i.child;case 29:throw i.pendingProps}throw Error(n(156,i.tag))}function Rn(a){a.flags|=4}function S1(a,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!jp(i)){if(i=Ma.current,i!==null&&((wt&4194048)===wt?on!==null:(wt&62914560)!==wt&&(wt&536870912)===0||i!==on))throw rc=lf,cm;a.flags|=8192}}function d0(a,i){i!==null&&(a.flags|=4),a.flags&16384&&(i=a.tag!==22?Zr():536870912,a.lanes|=i,Ki|=i)}function dc(a,i){if(!jt)switch(a.tailMode){case"hidden":i=a.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?a.tail=null:c.sibling=null;break;case"collapsed":c=a.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?i||a.tail===null?a.tail=null:a.tail.sibling=null:f.sibling=null}}function Zt(a){var i=a.alternate!==null&&a.alternate.child===a.child,c=0,f=0;if(i)for(var m=a.child;m!==null;)c|=m.lanes|m.childLanes,f|=m.subtreeFlags&65011712,f|=m.flags&65011712,m.return=a,m=m.sibling;else for(m=a.child;m!==null;)c|=m.lanes|m.childLanes,f|=m.subtreeFlags,f|=m.flags,m.return=a,m=m.sibling;return a.subtreeFlags|=f,a.childLanes=c,i}function kb(a,i,c){var f=i.pendingProps;switch(Ju(i),i.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zt(i),null;case 1:return Zt(i),null;case 3:return c=i.stateNode,f=null,a!==null&&(f=a.memoizedState.cache),i.memoizedState.cache!==f&&(i.flags|=2048),Nn(_r),Ae(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(a===null||a.child===null)&&(Wl(i)?Rn(i):a===null||a.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,am())),Zt(i),null;case 26:return c=i.memoizedState,a===null?(Rn(i),c!==null?(Zt(i),S1(i,c)):(Zt(i),i.flags&=-16777217)):c?c!==a.memoizedState?(Rn(i),Zt(i),S1(i,c)):(Zt(i),i.flags&=-16777217):(a.memoizedProps!==f&&Rn(i),Zt(i),i.flags&=-16777217),null;case 27:Ye(i),c=se.current;var m=i.type;if(a!==null&&i.stateNode!=null)a.memoizedProps!==f&&Rn(i);else{if(!f){if(i.stateNode===null)throw Error(n(166));return Zt(i),null}a=z.current,Wl(i)?tm(i):(a=Sp(m,f,c),i.stateNode=a,Rn(i))}return Zt(i),null;case 5:if(Ye(i),c=i.type,a!==null&&i.stateNode!=null)a.memoizedProps!==f&&Rn(i);else{if(!f){if(i.stateNode===null)throw Error(n(166));return Zt(i),null}if(a=z.current,Wl(i))tm(i);else{switch(m=S0(se.current),a){case 1:a=m.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:a=m.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":a=m.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":a=m.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":a=m.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild);break;case"select":a=typeof f.is=="string"?m.createElement("select",{is:f.is}):m.createElement("select"),f.multiple?a.multiple=!0:f.size&&(a.size=f.size);break;default:a=typeof f.is=="string"?m.createElement(c,{is:f.is}):m.createElement(c)}}a[Kt]=i,a[Jt]=f;e:for(m=i.child;m!==null;){if(m.tag===5||m.tag===6)a.appendChild(m.stateNode);else if(m.tag!==4&&m.tag!==27&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===i)break e;for(;m.sibling===null;){if(m.return===null||m.return===i)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}i.stateNode=a;e:switch(Mr(a,c,f),c){case"button":case"input":case"select":case"textarea":a=!!f.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&Rn(i)}}return Zt(i),i.flags&=-16777217,null;case 6:if(a&&i.stateNode!=null)a.memoizedProps!==f&&Rn(i);else{if(typeof f!="string"&&i.stateNode===null)throw Error(n(166));if(a=se.current,Wl(i)){if(a=i.stateNode,c=i.memoizedProps,f=null,m=Kr,m!==null)switch(m.tag){case 27:case 5:f=m.memoizedProps}a[Kt]=i,a=!!(a.nodeValue===c||f!==null&&f.suppressHydrationWarning===!0||vp(a.nodeValue,c)),a||Xs(i)}else a=S0(a).createTextNode(f),a[Kt]=i,i.stateNode=a}return Zt(i),null;case 13:if(f=i.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(m=Wl(i),f!==null&&f.dehydrated!==null){if(a===null){if(!m)throw Error(n(318));if(m=i.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(n(317));m[Kt]=i}else Zl(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Zt(i),m=!1}else m=am(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=m),m=!0;if(!m)return i.flags&256?(On(i),i):(On(i),null)}if(On(i),(i.flags&128)!==0)return i.lanes=c,i;if(c=f!==null,a=a!==null&&a.memoizedState!==null,c){f=i.child,m=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(m=f.alternate.memoizedState.cachePool.pool);var g=null;f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(g=f.memoizedState.cachePool.pool),g!==m&&(f.flags|=2048)}return c!==a&&c&&(i.child.flags|=8192),d0(i,i.updateQueue),Zt(i),null;case 4:return Ae(),a===null&&fd(i.stateNode.containerInfo),Zt(i),null;case 10:return Nn(i.type),Zt(i),null;case 19:if(N(yr),m=i.memoizedState,m===null)return Zt(i),null;if(f=(i.flags&128)!==0,g=m.rendering,g===null)if(f)dc(m,!1);else{if(rr!==0||a!==null&&(a.flags&128)!==0)for(a=i.child;a!==null;){if(g=l0(a),g!==null){for(i.flags|=128,dc(m,!1),a=g.updateQueue,i.updateQueue=a,d0(i,a),i.subtreeFlags=0,a=c,c=i.child;c!==null;)Qx(c,a),c=c.sibling;return P(yr,yr.current&1|2),i.child}a=a.sibling}m.tail!==null&&Oe()>m0&&(i.flags|=128,f=!0,dc(m,!1),i.lanes=4194304)}else{if(!f)if(a=l0(g),a!==null){if(i.flags|=128,f=!0,a=a.updateQueue,i.updateQueue=a,d0(i,a),dc(m,!0),m.tail===null&&m.tailMode==="hidden"&&!g.alternate&&!jt)return Zt(i),null}else 2*Oe()-m.renderingStartTime>m0&&c!==536870912&&(i.flags|=128,f=!0,dc(m,!1),i.lanes=4194304);m.isBackwards?(g.sibling=i.child,i.child=g):(a=m.last,a!==null?a.sibling=g:i.child=g,m.last=g)}return m.tail!==null?(i=m.tail,m.rendering=i,m.tail=i.sibling,m.renderingStartTime=Oe(),i.sibling=null,a=yr.current,P(yr,f?a&1|2:a&1),i):(Zt(i),null);case 22:case 23:return On(i),hf(),f=i.memoizedState!==null,a!==null?a.memoizedState!==null!==f&&(i.flags|=8192):f&&(i.flags|=8192),f?(c&536870912)!==0&&(i.flags&128)===0&&(Zt(i),i.subtreeFlags&6&&(i.flags|=8192)):Zt(i),c=i.updateQueue,c!==null&&d0(i,c.retryQueue),c=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),f=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),f!==c&&(i.flags|=2048),a!==null&&N(Ks),null;case 24:return c=null,a!==null&&(c=a.memoizedState.cache),i.memoizedState.cache!==c&&(i.flags|=2048),Nn(_r),Zt(i),null;case 25:return null;case 30:return null}throw Error(n(156,i.tag))}function Ab(a,i){switch(Ju(i),i.tag){case 1:return a=i.flags,a&65536?(i.flags=a&-65537|128,i):null;case 3:return Nn(_r),Ae(),a=i.flags,(a&65536)!==0&&(a&128)===0?(i.flags=a&-65537|128,i):null;case 26:case 27:case 5:return Ye(i),null;case 13:if(On(i),a=i.memoizedState,a!==null&&a.dehydrated!==null){if(i.alternate===null)throw Error(n(340));Zl()}return a=i.flags,a&65536?(i.flags=a&-65537|128,i):null;case 19:return N(yr),null;case 4:return Ae(),null;case 10:return Nn(i.type),null;case 22:case 23:return On(i),hf(),a!==null&&N(Ks),a=i.flags,a&65536?(i.flags=a&-65537|128,i):null;case 24:return Nn(_r),null;case 25:return null;default:return null}}function k1(a,i){switch(Ju(i),i.tag){case 3:Nn(_r),Ae();break;case 26:case 27:case 5:Ye(i);break;case 4:Ae();break;case 13:On(i);break;case 19:N(yr);break;case 10:Nn(i.type);break;case 22:case 23:On(i),hf(),a!==null&&N(Ks);break;case 24:Nn(_r)}}function hc(a,i){try{var c=i.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var m=f.next;c=m;do{if((c.tag&a)===a){f=void 0;var g=c.create,T=c.inst;f=g(),T.destroy=f}c=c.next}while(c!==m)}}catch(D){Ht(i,i.return,D)}}function is(a,i,c){try{var f=i.updateQueue,m=f!==null?f.lastEffect:null;if(m!==null){var g=m.next;f=g;do{if((f.tag&a)===a){var T=f.inst,D=T.destroy;if(D!==void 0){T.destroy=void 0,m=i;var J=c,fe=D;try{fe()}catch(we){Ht(m,J,we)}}}f=f.next}while(f!==g)}}catch(we){Ht(i,i.return,we)}}function A1(a){var i=a.updateQueue;if(i!==null){var c=a.stateNode;try{xm(i,c)}catch(f){Ht(a,a.return,f)}}}function N1(a,i,c){c.props=Qs(a.type,a.memoizedProps),c.state=a.memoizedState;try{c.componentWillUnmount()}catch(f){Ht(a,i,f)}}function xc(a,i){try{var c=a.ref;if(c!==null){switch(a.tag){case 26:case 27:case 5:var f=a.stateNode;break;case 30:f=a.stateNode;break;default:f=a.stateNode}typeof c=="function"?a.refCleanup=c(f):c.current=f}}catch(m){Ht(a,i,m)}}function un(a,i){var c=a.ref,f=a.refCleanup;if(c!==null)if(typeof f=="function")try{f()}catch(m){Ht(a,i,m)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(m){Ht(a,i,m)}else c.current=null}function C1(a){var i=a.type,c=a.memoizedProps,f=a.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":c.autoFocus&&f.focus();break e;case"img":c.src?f.src=c.src:c.srcSet&&(f.srcset=c.srcSet)}}catch(m){Ht(a,a.return,m)}}function Hf(a,i,c){try{var f=a.stateNode;Xb(f,a.type,c,i),f[Jt]=i}catch(m){Ht(a,a.return,m)}}function O1(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&xs(a.type)||a.tag===4}function zf(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||O1(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&xs(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Gf(a,i,c){var f=a.tag;if(f===5||f===6)a=a.stateNode,i?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(a,i):(i=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,i.appendChild(a),c=c._reactRootContainer,c!=null||i.onclick!==null||(i.onclick=T0));else if(f!==4&&(f===27&&xs(a.type)&&(c=a.stateNode,i=null),a=a.child,a!==null))for(Gf(a,i,c),a=a.sibling;a!==null;)Gf(a,i,c),a=a.sibling}function h0(a,i,c){var f=a.tag;if(f===5||f===6)a=a.stateNode,i?c.insertBefore(a,i):c.appendChild(a);else if(f!==4&&(f===27&&xs(a.type)&&(c=a.stateNode),a=a.child,a!==null))for(h0(a,i,c),a=a.sibling;a!==null;)h0(a,i,c),a=a.sibling}function D1(a){var i=a.stateNode,c=a.memoizedProps;try{for(var f=a.type,m=i.attributes;m.length;)i.removeAttributeNode(m[0]);Mr(i,f,c),i[Kt]=a,i[Jt]=c}catch(g){Ht(a,a.return,g)}}var jn=!1,lr=!1,Vf=!1,R1=typeof WeakSet=="function"?WeakSet:Set,kr=null;function Nb(a,i){if(a=a.containerInfo,xd=D0,a=Gx(a),Hu(a)){if("selectionStart"in a)var c={start:a.selectionStart,end:a.selectionEnd};else e:{c=(c=a.ownerDocument)&&c.defaultView||window;var f=c.getSelection&&c.getSelection();if(f&&f.rangeCount!==0){c=f.anchorNode;var m=f.anchorOffset,g=f.focusNode;f=f.focusOffset;try{c.nodeType,g.nodeType}catch{c=null;break e}var T=0,D=-1,J=-1,fe=0,we=0,ke=a,xe=null;t:for(;;){for(var me;ke!==c||m!==0&&ke.nodeType!==3||(D=T+m),ke!==g||f!==0&&ke.nodeType!==3||(J=T+f),ke.nodeType===3&&(T+=ke.nodeValue.length),(me=ke.firstChild)!==null;)xe=ke,ke=me;for(;;){if(ke===a)break t;if(xe===c&&++fe===m&&(D=T),xe===g&&++we===f&&(J=T),(me=ke.nextSibling)!==null)break;ke=xe,xe=ke.parentNode}ke=me}c=D===-1||J===-1?null:{start:D,end:J}}else c=null}c=c||{start:0,end:0}}else c=null;for(md={focusedElem:a,selectionRange:c},D0=!1,kr=i;kr!==null;)if(i=kr,a=i.child,(i.subtreeFlags&1024)!==0&&a!==null)a.return=i,kr=a;else for(;kr!==null;){switch(i=kr,g=i.alternate,a=i.flags,i.tag){case 0:break;case 11:case 15:break;case 1:if((a&1024)!==0&&g!==null){a=void 0,c=i,m=g.memoizedProps,g=g.memoizedState,f=c.stateNode;try{var Ze=Qs(c.type,m,c.elementType===c.type);a=f.getSnapshotBeforeUpdate(Ze,g),f.__reactInternalSnapshotBeforeUpdate=a}catch(qe){Ht(c,c.return,qe)}}break;case 3:if((a&1024)!==0){if(a=i.stateNode.containerInfo,c=a.nodeType,c===9)vd(a);else if(c===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":vd(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(n(163))}if(a=i.sibling,a!==null){a.return=i.return,kr=a;break}kr=i.return}}function j1(a,i,c){var f=c.flags;switch(c.tag){case 0:case 11:case 15:ls(a,c),f&4&&hc(5,c);break;case 1:if(ls(a,c),f&4)if(a=c.stateNode,i===null)try{a.componentDidMount()}catch(T){Ht(c,c.return,T)}else{var m=Qs(c.type,i.memoizedProps);i=i.memoizedState;try{a.componentDidUpdate(m,i,a.__reactInternalSnapshotBeforeUpdate)}catch(T){Ht(c,c.return,T)}}f&64&&A1(c),f&512&&xc(c,c.return);break;case 3:if(ls(a,c),f&64&&(a=c.updateQueue,a!==null)){if(i=null,c.child!==null)switch(c.child.tag){case 27:case 5:i=c.child.stateNode;break;case 1:i=c.child.stateNode}try{xm(a,i)}catch(T){Ht(c,c.return,T)}}break;case 27:i===null&&f&4&&D1(c);case 26:case 5:ls(a,c),i===null&&f&4&&C1(c),f&512&&xc(c,c.return);break;case 12:ls(a,c);break;case 13:ls(a,c),f&4&&L1(a,c),f&64&&(a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(c=Fb.bind(null,c),tE(a,c))));break;case 22:if(f=c.memoizedState!==null||jn,!f){i=i!==null&&i.memoizedState!==null||lr,m=jn;var g=lr;jn=f,(lr=i)&&!g?cs(a,c,(c.subtreeFlags&8772)!==0):ls(a,c),jn=m,lr=g}break;case 30:break;default:ls(a,c)}}function I1(a){var i=a.alternate;i!==null&&(a.alternate=null,I1(i)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(i=a.stateNode,i!==null&&R(i)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var Xt=null,oa=!1;function In(a,i,c){for(c=c.child;c!==null;)M1(a,i,c),c=c.sibling}function M1(a,i,c){if(Yt&&typeof Yt.onCommitFiberUnmount=="function")try{Yt.onCommitFiberUnmount(pr,c)}catch{}switch(c.tag){case 26:lr||un(c,i),In(a,i,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:lr||un(c,i);var f=Xt,m=oa;xs(c.type)&&(Xt=c.stateNode,oa=!1),In(a,i,c),Ec(c.stateNode),Xt=f,oa=m;break;case 5:lr||un(c,i);case 6:if(f=Xt,m=oa,Xt=null,In(a,i,c),Xt=f,oa=m,Xt!==null)if(oa)try{(Xt.nodeType===9?Xt.body:Xt.nodeName==="HTML"?Xt.ownerDocument.body:Xt).removeChild(c.stateNode)}catch(g){Ht(c,i,g)}else try{Xt.removeChild(c.stateNode)}catch(g){Ht(c,i,g)}break;case 18:Xt!==null&&(oa?(a=Xt,Ep(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,c.stateNode),Dc(a)):Ep(Xt,c.stateNode));break;case 4:f=Xt,m=oa,Xt=c.stateNode.containerInfo,oa=!0,In(a,i,c),Xt=f,oa=m;break;case 0:case 11:case 14:case 15:lr||is(2,c,i),lr||is(4,c,i),In(a,i,c);break;case 1:lr||(un(c,i),f=c.stateNode,typeof f.componentWillUnmount=="function"&&N1(c,i,f)),In(a,i,c);break;case 21:In(a,i,c);break;case 22:lr=(f=lr)||c.memoizedState!==null,In(a,i,c),lr=f;break;default:In(a,i,c)}}function L1(a,i){if(i.memoizedState===null&&(a=i.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{Dc(a)}catch(c){Ht(i,i.return,c)}}function Cb(a){switch(a.tag){case 13:case 19:var i=a.stateNode;return i===null&&(i=a.stateNode=new R1),i;case 22:return a=a.stateNode,i=a._retryCache,i===null&&(i=a._retryCache=new R1),i;default:throw Error(n(435,a.tag))}}function $f(a,i){var c=Cb(a);i.forEach(function(f){var m=Ub.bind(null,a,f);c.has(f)||(c.add(f),f.then(m,m))})}function _a(a,i){var c=i.deletions;if(c!==null)for(var f=0;f<c.length;f++){var m=c[f],g=a,T=i,D=T;e:for(;D!==null;){switch(D.tag){case 27:if(xs(D.type)){Xt=D.stateNode,oa=!1;break e}break;case 5:Xt=D.stateNode,oa=!1;break e;case 3:case 4:Xt=D.stateNode.containerInfo,oa=!0;break e}D=D.return}if(Xt===null)throw Error(n(160));M1(g,T,m),Xt=null,oa=!1,g=m.alternate,g!==null&&(g.return=null),m.return=null}if(i.subtreeFlags&13878)for(i=i.child;i!==null;)F1(i,a),i=i.sibling}var Wa=null;function F1(a,i){var c=a.alternate,f=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:_a(i,a),ya(a),f&4&&(is(3,a,a.return),hc(3,a),is(5,a,a.return));break;case 1:_a(i,a),ya(a),f&512&&(lr||c===null||un(c,c.return)),f&64&&jn&&(a=a.updateQueue,a!==null&&(f=a.callbacks,f!==null&&(c=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=c===null?f:c.concat(f))));break;case 26:var m=Wa;if(_a(i,a),ya(a),f&512&&(lr||c===null||un(c,c.return)),f&4){var g=c!==null?c.memoizedState:null;if(f=a.memoizedState,c===null)if(f===null)if(a.stateNode===null){e:{f=a.type,c=a.memoizedProps,m=m.ownerDocument||m;t:switch(f){case"title":g=m.getElementsByTagName("title")[0],(!g||g[k]||g[Kt]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=m.createElement(f),m.head.insertBefore(g,m.querySelector("head > title"))),Mr(g,f,c),g[Kt]=a,ie(g),f=g;break e;case"link":var T=Dp("link","href",m).get(f+(c.href||""));if(T){for(var D=0;D<T.length;D++)if(g=T[D],g.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&g.getAttribute("rel")===(c.rel==null?null:c.rel)&&g.getAttribute("title")===(c.title==null?null:c.title)&&g.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){T.splice(D,1);break t}}g=m.createElement(f),Mr(g,f,c),m.head.appendChild(g);break;case"meta":if(T=Dp("meta","content",m).get(f+(c.content||""))){for(D=0;D<T.length;D++)if(g=T[D],g.getAttribute("content")===(c.content==null?null:""+c.content)&&g.getAttribute("name")===(c.name==null?null:c.name)&&g.getAttribute("property")===(c.property==null?null:c.property)&&g.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&g.getAttribute("charset")===(c.charSet==null?null:c.charSet)){T.splice(D,1);break t}}g=m.createElement(f),Mr(g,f,c),m.head.appendChild(g);break;default:throw Error(n(468,f))}g[Kt]=a,ie(g),f=g}a.stateNode=f}else Rp(m,a.type,a.stateNode);else a.stateNode=Op(m,f,a.memoizedProps);else g!==f?(g===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):g.count--,f===null?Rp(m,a.type,a.stateNode):Op(m,f,a.memoizedProps)):f===null&&a.stateNode!==null&&Hf(a,a.memoizedProps,c.memoizedProps)}break;case 27:_a(i,a),ya(a),f&512&&(lr||c===null||un(c,c.return)),c!==null&&f&4&&Hf(a,a.memoizedProps,c.memoizedProps);break;case 5:if(_a(i,a),ya(a),f&512&&(lr||c===null||un(c,c.return)),a.flags&32){m=a.stateNode;try{Ci(m,"")}catch(me){Ht(a,a.return,me)}}f&4&&a.stateNode!=null&&(m=a.memoizedProps,Hf(a,m,c!==null?c.memoizedProps:m)),f&1024&&(Vf=!0);break;case 6:if(_a(i,a),ya(a),f&4){if(a.stateNode===null)throw Error(n(162));f=a.memoizedProps,c=a.stateNode;try{c.nodeValue=f}catch(me){Ht(a,a.return,me)}}break;case 3:if(N0=null,m=Wa,Wa=k0(i.containerInfo),_a(i,a),Wa=m,ya(a),f&4&&c!==null&&c.memoizedState.isDehydrated)try{Dc(i.containerInfo)}catch(me){Ht(a,a.return,me)}Vf&&(Vf=!1,U1(a));break;case 4:f=Wa,Wa=k0(a.stateNode.containerInfo),_a(i,a),ya(a),Wa=f;break;case 12:_a(i,a),ya(a);break;case 13:_a(i,a),ya(a),a.child.flags&8192&&a.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Kf=Oe()),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,$f(a,f)));break;case 22:m=a.memoizedState!==null;var J=c!==null&&c.memoizedState!==null,fe=jn,we=lr;if(jn=fe||m,lr=we||J,_a(i,a),lr=we,jn=fe,ya(a),f&8192)e:for(i=a.stateNode,i._visibility=m?i._visibility&-2:i._visibility|1,m&&(c===null||J||jn||lr||ei(a)),c=null,i=a;;){if(i.tag===5||i.tag===26){if(c===null){J=c=i;try{if(g=J.stateNode,m)T=g.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{D=J.stateNode;var ke=J.memoizedProps.style,xe=ke!=null&&ke.hasOwnProperty("display")?ke.display:null;D.style.display=xe==null||typeof xe=="boolean"?"":(""+xe).trim()}}catch(me){Ht(J,J.return,me)}}}else if(i.tag===6){if(c===null){J=i;try{J.stateNode.nodeValue=m?"":J.memoizedProps}catch(me){Ht(J,J.return,me)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===a)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break e;for(;i.sibling===null;){if(i.return===null||i.return===a)break e;c===i&&(c=null),i=i.return}c===i&&(c=null),i.sibling.return=i.return,i=i.sibling}f&4&&(f=a.updateQueue,f!==null&&(c=f.retryQueue,c!==null&&(f.retryQueue=null,$f(a,c))));break;case 19:_a(i,a),ya(a),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,$f(a,f)));break;case 30:break;case 21:break;default:_a(i,a),ya(a)}}function ya(a){var i=a.flags;if(i&2){try{for(var c,f=a.return;f!==null;){if(O1(f)){c=f;break}f=f.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var m=c.stateNode,g=zf(a);h0(a,g,m);break;case 5:var T=c.stateNode;c.flags&32&&(Ci(T,""),c.flags&=-33);var D=zf(a);h0(a,D,T);break;case 3:case 4:var J=c.stateNode.containerInfo,fe=zf(a);Gf(a,fe,J);break;default:throw Error(n(161))}}catch(we){Ht(a,a.return,we)}a.flags&=-3}i&4096&&(a.flags&=-4097)}function U1(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var i=a;U1(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),a=a.sibling}}function ls(a,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)j1(a,i.alternate,i),i=i.sibling}function ei(a){for(a=a.child;a!==null;){var i=a;switch(i.tag){case 0:case 11:case 14:case 15:is(4,i,i.return),ei(i);break;case 1:un(i,i.return);var c=i.stateNode;typeof c.componentWillUnmount=="function"&&N1(i,i.return,c),ei(i);break;case 27:Ec(i.stateNode);case 26:case 5:un(i,i.return),ei(i);break;case 22:i.memoizedState===null&&ei(i);break;case 30:ei(i);break;default:ei(i)}a=a.sibling}}function cs(a,i,c){for(c=c&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var f=i.alternate,m=a,g=i,T=g.flags;switch(g.tag){case 0:case 11:case 15:cs(m,g,c),hc(4,g);break;case 1:if(cs(m,g,c),f=g,m=f.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(fe){Ht(f,f.return,fe)}if(f=g,m=f.updateQueue,m!==null){var D=f.stateNode;try{var J=m.shared.hiddenCallbacks;if(J!==null)for(m.shared.hiddenCallbacks=null,m=0;m<J.length;m++)hm(J[m],D)}catch(fe){Ht(f,f.return,fe)}}c&&T&64&&A1(g),xc(g,g.return);break;case 27:D1(g);case 26:case 5:cs(m,g,c),c&&f===null&&T&4&&C1(g),xc(g,g.return);break;case 12:cs(m,g,c);break;case 13:cs(m,g,c),c&&T&4&&L1(m,g);break;case 22:g.memoizedState===null&&cs(m,g,c),xc(g,g.return);break;case 30:break;default:cs(m,g,c)}i=i.sibling}}function Yf(a,i){var c=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),a=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(a=i.memoizedState.cachePool.pool),a!==c&&(a!=null&&a.refCount++,c!=null&&Ql(c))}function qf(a,i){a=null,i.alternate!==null&&(a=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==a&&(i.refCount++,a!=null&&Ql(a))}function fn(a,i,c,f){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)B1(a,i,c,f),i=i.sibling}function B1(a,i,c,f){var m=i.flags;switch(i.tag){case 0:case 11:case 15:fn(a,i,c,f),m&2048&&hc(9,i);break;case 1:fn(a,i,c,f);break;case 3:fn(a,i,c,f),m&2048&&(a=null,i.alternate!==null&&(a=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==a&&(i.refCount++,a!=null&&Ql(a)));break;case 12:if(m&2048){fn(a,i,c,f),a=i.stateNode;try{var g=i.memoizedProps,T=g.id,D=g.onPostCommit;typeof D=="function"&&D(T,i.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(J){Ht(i,i.return,J)}}else fn(a,i,c,f);break;case 13:fn(a,i,c,f);break;case 23:break;case 22:g=i.stateNode,T=i.alternate,i.memoizedState!==null?g._visibility&2?fn(a,i,c,f):mc(a,i):g._visibility&2?fn(a,i,c,f):(g._visibility|=2,Xi(a,i,c,f,(i.subtreeFlags&10256)!==0)),m&2048&&Yf(T,i);break;case 24:fn(a,i,c,f),m&2048&&qf(i.alternate,i);break;default:fn(a,i,c,f)}}function Xi(a,i,c,f,m){for(m=m&&(i.subtreeFlags&10256)!==0,i=i.child;i!==null;){var g=a,T=i,D=c,J=f,fe=T.flags;switch(T.tag){case 0:case 11:case 15:Xi(g,T,D,J,m),hc(8,T);break;case 23:break;case 22:var we=T.stateNode;T.memoizedState!==null?we._visibility&2?Xi(g,T,D,J,m):mc(g,T):(we._visibility|=2,Xi(g,T,D,J,m)),m&&fe&2048&&Yf(T.alternate,T);break;case 24:Xi(g,T,D,J,m),m&&fe&2048&&qf(T.alternate,T);break;default:Xi(g,T,D,J,m)}i=i.sibling}}function mc(a,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var c=a,f=i,m=f.flags;switch(f.tag){case 22:mc(c,f),m&2048&&Yf(f.alternate,f);break;case 24:mc(c,f),m&2048&&qf(f.alternate,f);break;default:mc(c,f)}i=i.sibling}}var pc=8192;function Wi(a){if(a.subtreeFlags&pc)for(a=a.child;a!==null;)P1(a),a=a.sibling}function P1(a){switch(a.tag){case 26:Wi(a),a.flags&pc&&a.memoizedState!==null&&xE(Wa,a.memoizedState,a.memoizedProps);break;case 5:Wi(a);break;case 3:case 4:var i=Wa;Wa=k0(a.stateNode.containerInfo),Wi(a),Wa=i;break;case 22:a.memoizedState===null&&(i=a.alternate,i!==null&&i.memoizedState!==null?(i=pc,pc=16777216,Wi(a),pc=i):Wi(a));break;default:Wi(a)}}function H1(a){var i=a.alternate;if(i!==null&&(a=i.child,a!==null)){i.child=null;do i=a.sibling,a.sibling=null,a=i;while(a!==null)}}function gc(a){var i=a.deletions;if((a.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var f=i[c];kr=f,G1(f,a)}H1(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)z1(a),a=a.sibling}function z1(a){switch(a.tag){case 0:case 11:case 15:gc(a),a.flags&2048&&is(9,a,a.return);break;case 3:gc(a);break;case 12:gc(a);break;case 22:var i=a.stateNode;a.memoizedState!==null&&i._visibility&2&&(a.return===null||a.return.tag!==13)?(i._visibility&=-3,x0(a)):gc(a);break;default:gc(a)}}function x0(a){var i=a.deletions;if((a.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var f=i[c];kr=f,G1(f,a)}H1(a)}for(a=a.child;a!==null;){switch(i=a,i.tag){case 0:case 11:case 15:is(8,i,i.return),x0(i);break;case 22:c=i.stateNode,c._visibility&2&&(c._visibility&=-3,x0(i));break;default:x0(i)}a=a.sibling}}function G1(a,i){for(;kr!==null;){var c=kr;switch(c.tag){case 0:case 11:case 15:is(8,c,i);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var f=c.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Ql(c.memoizedState.cache)}if(f=c.child,f!==null)f.return=c,kr=f;else e:for(c=a;kr!==null;){f=kr;var m=f.sibling,g=f.return;if(I1(f),f===c){kr=null;break e}if(m!==null){m.return=g,kr=m;break e}kr=g}}}var Ob={getCacheForType:function(a){var i=Pr(_r),c=i.data.get(a);return c===void 0&&(c=a(),i.data.set(a,c)),c}},Db=typeof WeakMap=="function"?WeakMap:Map,It=0,zt=null,xt=null,wt=0,Mt=0,wa=null,os=!1,Zi=!1,Xf=!1,Mn=0,rr=0,us=0,ti=0,Wf=0,La=0,Ki=0,vc=null,ua=null,Zf=!1,Kf=0,m0=1/0,p0=null,fs=null,Ir=0,ds=null,Ji=null,Qi=0,Jf=0,Qf=null,V1=null,_c=0,ed=null;function ba(){if((It&2)!==0&&wt!==0)return wt&-wt;if(ae.T!==null){var a=Pi;return a!==0?a:ld()}return Wn()}function $1(){La===0&&(La=(wt&536870912)===0||jt?sn():536870912);var a=Ma.current;return a!==null&&(a.flags|=32),La}function Ea(a,i,c){(a===zt&&(Mt===2||Mt===9)||a.cancelPendingCommit!==null)&&(el(a,0),hs(a,wt,La,!1)),Ya(a,c),((It&2)===0||a!==zt)&&(a===zt&&((It&2)===0&&(ti|=c),rr===4&&hs(a,wt,La,!1)),dn(a))}function Y1(a,i,c){if((It&6)!==0)throw Error(n(327));var f=!c&&(i&124)===0&&(i&a.expiredLanes)===0||ma(a,i),m=f?Ib(a,i):ad(a,i,!0),g=f;do{if(m===0){Zi&&!f&&hs(a,i,0,!1);break}else{if(c=a.current.alternate,g&&!Rb(c)){m=ad(a,i,!1),g=!1;continue}if(m===2){if(g=i,a.errorRecoveryDisabledLanes&g)var T=0;else T=a.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){i=T;e:{var D=a;m=vc;var J=D.current.memoizedState.isDehydrated;if(J&&(el(D,T).flags|=256),T=ad(D,T,!1),T!==2){if(Xf&&!J){D.errorRecoveryDisabledLanes|=g,ti|=g,m=4;break e}g=ua,ua=m,g!==null&&(ua===null?ua=g:ua.push.apply(ua,g))}m=T}if(g=!1,m!==2)continue}}if(m===1){el(a,0),hs(a,i,0,!0);break}e:{switch(f=a,g=m,g){case 0:case 1:throw Error(n(345));case 4:if((i&4194048)!==i)break;case 6:hs(f,i,La,!os);break e;case 2:ua=null;break;case 3:case 5:break;default:throw Error(n(329))}if((i&62914560)===i&&(m=Kf+300-Oe(),10<m)){if(hs(f,i,La,!os),xa(f,0,!0)!==0)break e;f.timeoutHandle=wp(q1.bind(null,f,c,ua,p0,Zf,i,La,ti,Ki,os,g,2,-0,0),m);break e}q1(f,c,ua,p0,Zf,i,La,ti,Ki,os,g,0,-0,0)}}break}while(!0);dn(a)}function q1(a,i,c,f,m,g,T,D,J,fe,we,ke,xe,me){if(a.timeoutHandle=-1,ke=i.subtreeFlags,(ke&8192||(ke&16785408)===16785408)&&(kc={stylesheets:null,count:0,unsuspend:hE},P1(i),ke=mE(),ke!==null)){a.cancelPendingCommit=ke(ep.bind(null,a,i,g,c,f,m,T,D,J,we,1,xe,me)),hs(a,g,T,!fe);return}ep(a,i,g,c,f,m,T,D,J)}function Rb(a){for(var i=a;;){var c=i.tag;if((c===0||c===11||c===15)&&i.flags&16384&&(c=i.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var f=0;f<c.length;f++){var m=c[f],g=m.getSnapshot;m=m.value;try{if(!ga(g(),m))return!1}catch{return!1}}if(c=i.child,i.subtreeFlags&16384&&c!==null)c.return=i,i=c;else{if(i===a)break;for(;i.sibling===null;){if(i.return===null||i.return===a)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function hs(a,i,c,f){i&=~Wf,i&=~ti,a.suspendedLanes|=i,a.pingedLanes&=~i,f&&(a.warmLanes|=i),f=a.expirationTimes;for(var m=i;0<m;){var g=31-Qe(m),T=1<<g;f[g]=-1,m&=~T}c!==0&&qn(a,c,i)}function g0(){return(It&6)===0?(yc(0),!1):!0}function td(){if(xt!==null){if(Mt===0)var a=xt.return;else a=xt,An=Ws=null,vf(a),Yi=null,uc=0,a=xt;for(;a!==null;)k1(a.alternate,a),a=a.return;xt=null}}function el(a,i){var c=a.timeoutHandle;c!==-1&&(a.timeoutHandle=-1,Zb(c)),c=a.cancelPendingCommit,c!==null&&(a.cancelPendingCommit=null,c()),td(),zt=a,xt=c=Tn(a.current,null),wt=i,Mt=0,wa=null,os=!1,Zi=ma(a,i),Xf=!1,Ki=La=Wf=ti=us=rr=0,ua=vc=null,Zf=!1,(i&8)!==0&&(i|=i&32);var f=a.entangledLanes;if(f!==0)for(a=a.entanglements,f&=i;0<f;){var m=31-Qe(f),g=1<<m;i|=a[m],f&=~g}return Mn=i,Bo(),c}function X1(a,i){ct=null,ae.H=n0,i===tc||i===Xo?(i=fm(),Mt=3):i===cm?(i=fm(),Mt=4):Mt=i===d1?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,wa=i,xt===null&&(rr=1,o0(a,Da(i,a.current)))}function W1(){var a=ae.H;return ae.H=n0,a===null?n0:a}function Z1(){var a=ae.A;return ae.A=Ob,a}function rd(){rr=4,os||(wt&4194048)!==wt&&Ma.current!==null||(Zi=!0),(us&134217727)===0&&(ti&134217727)===0||zt===null||hs(zt,wt,La,!1)}function ad(a,i,c){var f=It;It|=2;var m=W1(),g=Z1();(zt!==a||wt!==i)&&(p0=null,el(a,i)),i=!1;var T=rr;e:do try{if(Mt!==0&&xt!==null){var D=xt,J=wa;switch(Mt){case 8:td(),T=6;break e;case 3:case 2:case 9:case 6:Ma.current===null&&(i=!0);var fe=Mt;if(Mt=0,wa=null,tl(a,D,J,fe),c&&Zi){T=0;break e}break;default:fe=Mt,Mt=0,wa=null,tl(a,D,J,fe)}}jb(),T=rr;break}catch(we){X1(a,we)}while(!0);return i&&a.shellSuspendCounter++,An=Ws=null,It=f,ae.H=m,ae.A=g,xt===null&&(zt=null,wt=0,Bo()),T}function jb(){for(;xt!==null;)K1(xt)}function Ib(a,i){var c=It;It|=2;var f=W1(),m=Z1();zt!==a||wt!==i?(p0=null,m0=Oe()+500,el(a,i)):Zi=ma(a,i);e:do try{if(Mt!==0&&xt!==null){i=xt;var g=wa;t:switch(Mt){case 1:Mt=0,wa=null,tl(a,i,g,1);break;case 2:case 9:if(om(g)){Mt=0,wa=null,J1(i);break}i=function(){Mt!==2&&Mt!==9||zt!==a||(Mt=7),dn(a)},g.then(i,i);break e;case 3:Mt=7;break e;case 4:Mt=5;break e;case 7:om(g)?(Mt=0,wa=null,J1(i)):(Mt=0,wa=null,tl(a,i,g,7));break;case 5:var T=null;switch(xt.tag){case 26:T=xt.memoizedState;case 5:case 27:var D=xt;if(!T||jp(T)){Mt=0,wa=null;var J=D.sibling;if(J!==null)xt=J;else{var fe=D.return;fe!==null?(xt=fe,v0(fe)):xt=null}break t}}Mt=0,wa=null,tl(a,i,g,5);break;case 6:Mt=0,wa=null,tl(a,i,g,6);break;case 8:td(),rr=6;break e;default:throw Error(n(462))}}Mb();break}catch(we){X1(a,we)}while(!0);return An=Ws=null,ae.H=f,ae.A=m,It=c,xt!==null?0:(zt=null,wt=0,Bo(),rr)}function Mb(){for(;xt!==null&&!gt();)K1(xt)}function K1(a){var i=T1(a.alternate,a,Mn);a.memoizedProps=a.pendingProps,i===null?v0(a):xt=i}function J1(a){var i=a,c=i.alternate;switch(i.tag){case 15:case 0:i=v1(c,i,i.pendingProps,i.type,void 0,wt);break;case 11:i=v1(c,i,i.pendingProps,i.type.render,i.ref,wt);break;case 5:vf(i);default:k1(c,i),i=xt=Qx(i,Mn),i=T1(c,i,Mn)}a.memoizedProps=a.pendingProps,i===null?v0(a):xt=i}function tl(a,i,c,f){An=Ws=null,vf(i),Yi=null,uc=0;var m=i.return;try{if(Tb(a,m,i,c,wt)){rr=1,o0(a,Da(c,a.current)),xt=null;return}}catch(g){if(m!==null)throw xt=m,g;rr=1,o0(a,Da(c,a.current)),xt=null;return}i.flags&32768?(jt||f===1?a=!0:Zi||(wt&536870912)!==0?a=!1:(os=a=!0,(f===2||f===9||f===3||f===6)&&(f=Ma.current,f!==null&&f.tag===13&&(f.flags|=16384))),Q1(i,a)):v0(i)}function v0(a){var i=a;do{if((i.flags&32768)!==0){Q1(i,os);return}a=i.return;var c=kb(i.alternate,i,Mn);if(c!==null){xt=c;return}if(i=i.sibling,i!==null){xt=i;return}xt=i=a}while(i!==null);rr===0&&(rr=5)}function Q1(a,i){do{var c=Ab(a.alternate,a);if(c!==null){c.flags&=32767,xt=c;return}if(c=a.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!i&&(a=a.sibling,a!==null)){xt=a;return}xt=a=c}while(a!==null);rr=6,xt=null}function ep(a,i,c,f,m,g,T,D,J){a.cancelPendingCommit=null;do _0();while(Ir!==0);if((It&6)!==0)throw Error(n(327));if(i!==null){if(i===a.current)throw Error(n(177));if(g=i.lanes|i.childLanes,g|=Yu,ln(a,c,g,T,D,J),a===zt&&(xt=zt=null,wt=0),Ji=i,ds=a,Qi=c,Jf=g,Qf=m,V1=f,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,Bb(Pe,function(){return sp(),null})):(a.callbackNode=null,a.callbackPriority=0),f=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||f){f=ae.T,ae.T=null,m=ue.p,ue.p=2,T=It,It|=4;try{Nb(a,i,c)}finally{It=T,ue.p=m,ae.T=f}}Ir=1,tp(),rp(),ap()}}function tp(){if(Ir===1){Ir=0;var a=ds,i=Ji,c=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||c){c=ae.T,ae.T=null;var f=ue.p;ue.p=2;var m=It;It|=4;try{F1(i,a);var g=md,T=Gx(a.containerInfo),D=g.focusedElem,J=g.selectionRange;if(T!==D&&D&&D.ownerDocument&&zx(D.ownerDocument.documentElement,D)){if(J!==null&&Hu(D)){var fe=J.start,we=J.end;if(we===void 0&&(we=fe),"selectionStart"in D)D.selectionStart=fe,D.selectionEnd=Math.min(we,D.value.length);else{var ke=D.ownerDocument||document,xe=ke&&ke.defaultView||window;if(xe.getSelection){var me=xe.getSelection(),Ze=D.textContent.length,qe=Math.min(J.start,Ze),Bt=J.end===void 0?qe:Math.min(J.end,Ze);!me.extend&&qe>Bt&&(T=Bt,Bt=qe,qe=T);var le=Hx(D,qe),ne=Hx(D,Bt);if(le&&ne&&(me.rangeCount!==1||me.anchorNode!==le.node||me.anchorOffset!==le.offset||me.focusNode!==ne.node||me.focusOffset!==ne.offset)){var oe=ke.createRange();oe.setStart(le.node,le.offset),me.removeAllRanges(),qe>Bt?(me.addRange(oe),me.extend(ne.node,ne.offset)):(oe.setEnd(ne.node,ne.offset),me.addRange(oe))}}}}for(ke=[],me=D;me=me.parentNode;)me.nodeType===1&&ke.push({element:me,left:me.scrollLeft,top:me.scrollTop});for(typeof D.focus=="function"&&D.focus(),D=0;D<ke.length;D++){var Ee=ke[D];Ee.element.scrollLeft=Ee.left,Ee.element.scrollTop=Ee.top}}D0=!!xd,md=xd=null}finally{It=m,ue.p=f,ae.T=c}}a.current=i,Ir=2}}function rp(){if(Ir===2){Ir=0;var a=ds,i=Ji,c=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||c){c=ae.T,ae.T=null;var f=ue.p;ue.p=2;var m=It;It|=4;try{j1(a,i.alternate,i)}finally{It=m,ue.p=f,ae.T=c}}Ir=3}}function ap(){if(Ir===4||Ir===3){Ir=0,Je();var a=ds,i=Ji,c=Qi,f=V1;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?Ir=5:(Ir=0,Ji=ds=null,np(a,a.pendingLanes));var m=a.pendingLanes;if(m===0&&(fs=null),bn(c),i=i.stateNode,Yt&&typeof Yt.onCommitFiberRoot=="function")try{Yt.onCommitFiberRoot(pr,i,void 0,(i.current.flags&128)===128)}catch{}if(f!==null){i=ae.T,m=ue.p,ue.p=2,ae.T=null;try{for(var g=a.onRecoverableError,T=0;T<f.length;T++){var D=f[T];g(D.value,{componentStack:D.stack})}}finally{ae.T=i,ue.p=m}}(Qi&3)!==0&&_0(),dn(a),m=a.pendingLanes,(c&4194090)!==0&&(m&42)!==0?a===ed?_c++:(_c=0,ed=a):_c=0,yc(0)}}function np(a,i){(a.pooledCacheLanes&=i)===0&&(i=a.pooledCache,i!=null&&(a.pooledCache=null,Ql(i)))}function _0(a){return tp(),rp(),ap(),sp()}function sp(){if(Ir!==5)return!1;var a=ds,i=Jf;Jf=0;var c=bn(Qi),f=ae.T,m=ue.p;try{ue.p=32>c?32:c,ae.T=null,c=Qf,Qf=null;var g=ds,T=Qi;if(Ir=0,Ji=ds=null,Qi=0,(It&6)!==0)throw Error(n(331));var D=It;if(It|=4,z1(g.current),B1(g,g.current,T,c),It=D,yc(0,!1),Yt&&typeof Yt.onPostCommitFiberRoot=="function")try{Yt.onPostCommitFiberRoot(pr,g)}catch{}return!0}finally{ue.p=m,ae.T=f,np(a,i)}}function ip(a,i,c){i=Da(c,i),i=Rf(a.stateNode,i,2),a=rs(a,i,2),a!==null&&(Ya(a,2),dn(a))}function Ht(a,i,c){if(a.tag===3)ip(a,a,c);else for(;i!==null;){if(i.tag===3){ip(i,a,c);break}else if(i.tag===1){var f=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(fs===null||!fs.has(f))){a=Da(c,a),c=u1(2),f=rs(i,c,2),f!==null&&(f1(c,f,i,a),Ya(f,2),dn(f));break}}i=i.return}}function nd(a,i,c){var f=a.pingCache;if(f===null){f=a.pingCache=new Db;var m=new Set;f.set(i,m)}else m=f.get(i),m===void 0&&(m=new Set,f.set(i,m));m.has(c)||(Xf=!0,m.add(c),a=Lb.bind(null,a,i,c),i.then(a,a))}function Lb(a,i,c){var f=a.pingCache;f!==null&&f.delete(i),a.pingedLanes|=a.suspendedLanes&c,a.warmLanes&=~c,zt===a&&(wt&c)===c&&(rr===4||rr===3&&(wt&62914560)===wt&&300>Oe()-Kf?(It&2)===0&&el(a,0):Wf|=c,Ki===wt&&(Ki=0)),dn(a)}function lp(a,i){i===0&&(i=Zr()),a=Li(a,i),a!==null&&(Ya(a,i),dn(a))}function Fb(a){var i=a.memoizedState,c=0;i!==null&&(c=i.retryLane),lp(a,c)}function Ub(a,i){var c=0;switch(a.tag){case 13:var f=a.stateNode,m=a.memoizedState;m!==null&&(c=m.retryLane);break;case 19:f=a.stateNode;break;case 22:f=a.stateNode._retryCache;break;default:throw Error(n(314))}f!==null&&f.delete(i),lp(a,c)}function Bb(a,i){return ot(a,i)}var y0=null,rl=null,sd=!1,w0=!1,id=!1,ri=0;function dn(a){a!==rl&&a.next===null&&(rl===null?y0=rl=a:rl=rl.next=a),w0=!0,sd||(sd=!0,Hb())}function yc(a,i){if(!id&&w0){id=!0;do for(var c=!1,f=y0;f!==null;){if(a!==0){var m=f.pendingLanes;if(m===0)var g=0;else{var T=f.suspendedLanes,D=f.pingedLanes;g=(1<<31-Qe(42|a)+1)-1,g&=m&~(T&~D),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(c=!0,fp(f,g))}else g=wt,g=xa(f,f===zt?g:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(g&3)===0||ma(f,g)||(c=!0,fp(f,g));f=f.next}while(c);id=!1}}function Pb(){cp()}function cp(){w0=sd=!1;var a=0;ri!==0&&(Wb()&&(a=ri),ri=0);for(var i=Oe(),c=null,f=y0;f!==null;){var m=f.next,g=op(f,i);g===0?(f.next=null,c===null?y0=m:c.next=m,m===null&&(rl=c)):(c=f,(a!==0||(g&3)!==0)&&(w0=!0)),f=m}yc(a)}function op(a,i){for(var c=a.suspendedLanes,f=a.pingedLanes,m=a.expirationTimes,g=a.pendingLanes&-62914561;0<g;){var T=31-Qe(g),D=1<<T,J=m[T];J===-1?((D&c)===0||(D&f)!==0)&&(m[T]=or(D,i)):J<=i&&(a.expiredLanes|=D),g&=~D}if(i=zt,c=wt,c=xa(a,a===i?c:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),f=a.callbackNode,c===0||a===i&&(Mt===2||Mt===9)||a.cancelPendingCommit!==null)return f!==null&&f!==null&&Xe(f),a.callbackNode=null,a.callbackPriority=0;if((c&3)===0||ma(a,c)){if(i=c&-c,i===a.callbackPriority)return i;switch(f!==null&&Xe(f),bn(c)){case 2:case 8:c=Le;break;case 32:c=Pe;break;case 268435456:c=$e;break;default:c=Pe}return f=up.bind(null,a),c=ot(c,f),a.callbackPriority=i,a.callbackNode=c,i}return f!==null&&f!==null&&Xe(f),a.callbackPriority=2,a.callbackNode=null,2}function up(a,i){if(Ir!==0&&Ir!==5)return a.callbackNode=null,a.callbackPriority=0,null;var c=a.callbackNode;if(_0()&&a.callbackNode!==c)return null;var f=wt;return f=xa(a,a===zt?f:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),f===0?null:(Y1(a,f,i),op(a,Oe()),a.callbackNode!=null&&a.callbackNode===c?up.bind(null,a):null)}function fp(a,i){if(_0())return null;Y1(a,i,!0)}function Hb(){Kb(function(){(It&6)!==0?ot($t,Pb):cp()})}function ld(){return ri===0&&(ri=sn()),ri}function dp(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:Ro(""+a)}function hp(a,i){var c=i.ownerDocument.createElement("input");return c.name=i.name,c.value=i.value,a.id&&c.setAttribute("form",a.id),i.parentNode.insertBefore(c,i),a=new FormData(a),c.parentNode.removeChild(c),a}function zb(a,i,c,f,m){if(i==="submit"&&c&&c.stateNode===m){var g=dp((m[Jt]||null).action),T=f.submitter;T&&(i=(i=T[Jt]||null)?dp(i.formAction):T.getAttribute("formAction"),i!==null&&(g=i,T=null));var D=new Lo("action","action",null,f,m);a.push({event:D,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(ri!==0){var J=T?hp(m,T):new FormData(m);Af(c,{pending:!0,data:J,method:m.method,action:g},null,J)}}else typeof g=="function"&&(D.preventDefault(),J=T?hp(m,T):new FormData(m),Af(c,{pending:!0,data:J,method:m.method,action:g},g,J))},currentTarget:m}]})}}for(var cd=0;cd<$u.length;cd++){var od=$u[cd],Gb=od.toLowerCase(),Vb=od[0].toUpperCase()+od.slice(1);Xa(Gb,"on"+Vb)}Xa(Yx,"onAnimationEnd"),Xa(qx,"onAnimationIteration"),Xa(Xx,"onAnimationStart"),Xa("dblclick","onDoubleClick"),Xa("focusin","onFocus"),Xa("focusout","onBlur"),Xa(lb,"onTransitionRun"),Xa(cb,"onTransitionStart"),Xa(ob,"onTransitionCancel"),Xa(Wx,"onTransitionEnd"),De("onMouseEnter",["mouseout","mouseover"]),De("onMouseLeave",["mouseout","mouseover"]),De("onPointerEnter",["pointerout","pointerover"]),De("onPointerLeave",["pointerout","pointerover"]),Ne("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ne("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ne("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ne("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ne("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ne("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$b=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(wc));function xp(a,i){i=(i&4)!==0;for(var c=0;c<a.length;c++){var f=a[c],m=f.event;f=f.listeners;e:{var g=void 0;if(i)for(var T=f.length-1;0<=T;T--){var D=f[T],J=D.instance,fe=D.currentTarget;if(D=D.listener,J!==g&&m.isPropagationStopped())break e;g=D,m.currentTarget=fe;try{g(m)}catch(we){c0(we)}m.currentTarget=null,g=J}else for(T=0;T<f.length;T++){if(D=f[T],J=D.instance,fe=D.currentTarget,D=D.listener,J!==g&&m.isPropagationStopped())break e;g=D,m.currentTarget=fe;try{g(m)}catch(we){c0(we)}m.currentTarget=null,g=J}}}}function mt(a,i){var c=i[Rt];c===void 0&&(c=i[Rt]=new Set);var f=a+"__bubble";c.has(f)||(mp(i,a,2,!1),c.add(f))}function ud(a,i,c){var f=0;i&&(f|=4),mp(c,a,f,i)}var b0="_reactListening"+Math.random().toString(36).slice(2);function fd(a){if(!a[b0]){a[b0]=!0,de.forEach(function(c){c!=="selectionchange"&&($b.has(c)||ud(c,!1,a),ud(c,!0,a))});var i=a.nodeType===9?a:a.ownerDocument;i===null||i[b0]||(i[b0]=!0,ud("selectionchange",!1,i))}}function mp(a,i,c,f){switch(Bp(i)){case 2:var m=vE;break;case 8:m=_E;break;default:m=Sd}c=m.bind(null,i,c,a),m=void 0,!Ru||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(m=!0),f?m!==void 0?a.addEventListener(i,c,{capture:!0,passive:m}):a.addEventListener(i,c,!0):m!==void 0?a.addEventListener(i,c,{passive:m}):a.addEventListener(i,c,!1)}function dd(a,i,c,f,m){var g=f;if((i&1)===0&&(i&2)===0&&f!==null)e:for(;;){if(f===null)return;var T=f.tag;if(T===3||T===4){var D=f.stateNode.containerInfo;if(D===m)break;if(T===4)for(T=f.return;T!==null;){var J=T.tag;if((J===3||J===4)&&T.stateNode.containerInfo===m)return;T=T.return}for(;D!==null;){if(T=M(D),T===null)return;if(J=T.tag,J===5||J===6||J===26||J===27){f=g=T;continue e}D=D.parentNode}}f=f.return}bx(function(){var fe=g,we=Ou(c),ke=[];e:{var xe=Zx.get(a);if(xe!==void 0){var me=Lo,Ze=a;switch(a){case"keypress":if(Io(c)===0)break e;case"keydown":case"keyup":me=Bw;break;case"focusin":Ze="focus",me=Lu;break;case"focusout":Ze="blur",me=Lu;break;case"beforeblur":case"afterblur":me=Lu;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":me=Sx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":me=Aw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":me=zw;break;case Yx:case qx:case Xx:me=Ow;break;case Wx:me=Vw;break;case"scroll":case"scrollend":me=Sw;break;case"wheel":me=Yw;break;case"copy":case"cut":case"paste":me=Rw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":me=Ax;break;case"toggle":case"beforetoggle":me=Xw}var qe=(i&4)!==0,Bt=!qe&&(a==="scroll"||a==="scrollend"),le=qe?xe!==null?xe+"Capture":null:xe;qe=[];for(var ne=fe,oe;ne!==null;){var Ee=ne;if(oe=Ee.stateNode,Ee=Ee.tag,Ee!==5&&Ee!==26&&Ee!==27||oe===null||le===null||(Ee=Pl(ne,le),Ee!=null&&qe.push(bc(ne,Ee,oe))),Bt)break;ne=ne.return}0<qe.length&&(xe=new me(xe,Ze,null,c,we),ke.push({event:xe,listeners:qe}))}}if((i&7)===0){e:{if(xe=a==="mouseover"||a==="pointerover",me=a==="mouseout"||a==="pointerout",xe&&c!==Cu&&(Ze=c.relatedTarget||c.fromElement)&&(M(Ze)||Ze[Ca]))break e;if((me||xe)&&(xe=we.window===we?we:(xe=we.ownerDocument)?xe.defaultView||xe.parentWindow:window,me?(Ze=c.relatedTarget||c.toElement,me=fe,Ze=Ze?M(Ze):null,Ze!==null&&(Bt=l(Ze),qe=Ze.tag,Ze!==Bt||qe!==5&&qe!==27&&qe!==6)&&(Ze=null)):(me=null,Ze=fe),me!==Ze)){if(qe=Sx,Ee="onMouseLeave",le="onMouseEnter",ne="mouse",(a==="pointerout"||a==="pointerover")&&(qe=Ax,Ee="onPointerLeave",le="onPointerEnter",ne="pointer"),Bt=me==null?xe:ce(me),oe=Ze==null?xe:ce(Ze),xe=new qe(Ee,ne+"leave",me,c,we),xe.target=Bt,xe.relatedTarget=oe,Ee=null,M(we)===fe&&(qe=new qe(le,ne+"enter",Ze,c,we),qe.target=oe,qe.relatedTarget=Bt,Ee=qe),Bt=Ee,me&&Ze)t:{for(qe=me,le=Ze,ne=0,oe=qe;oe;oe=al(oe))ne++;for(oe=0,Ee=le;Ee;Ee=al(Ee))oe++;for(;0<ne-oe;)qe=al(qe),ne--;for(;0<oe-ne;)le=al(le),oe--;for(;ne--;){if(qe===le||le!==null&&qe===le.alternate)break t;qe=al(qe),le=al(le)}qe=null}else qe=null;me!==null&&pp(ke,xe,me,qe,!1),Ze!==null&&Bt!==null&&pp(ke,Bt,Ze,qe,!0)}}e:{if(xe=fe?ce(fe):window,me=xe.nodeName&&xe.nodeName.toLowerCase(),me==="select"||me==="input"&&xe.type==="file")var Be=Mx;else if(jx(xe))if(Lx)Be=nb;else{Be=rb;var ut=tb}else me=xe.nodeName,!me||me.toLowerCase()!=="input"||xe.type!=="checkbox"&&xe.type!=="radio"?fe&&Nu(fe.elementType)&&(Be=Mx):Be=ab;if(Be&&(Be=Be(a,fe))){Ix(ke,Be,c,we);break e}ut&&ut(a,xe,fe),a==="focusout"&&fe&&xe.type==="number"&&fe.memoizedProps.value!=null&&qa(xe,"number",xe.value)}switch(ut=fe?ce(fe):window,a){case"focusin":(jx(ut)||ut.contentEditable==="true")&&(ji=ut,zu=fe,Xl=null);break;case"focusout":Xl=zu=ji=null;break;case"mousedown":Gu=!0;break;case"contextmenu":case"mouseup":case"dragend":Gu=!1,Vx(ke,c,we);break;case"selectionchange":if(ib)break;case"keydown":case"keyup":Vx(ke,c,we)}var Ge;if(Uu)e:{switch(a){case"compositionstart":var We="onCompositionStart";break e;case"compositionend":We="onCompositionEnd";break e;case"compositionupdate":We="onCompositionUpdate";break e}We=void 0}else Ri?Dx(a,c)&&(We="onCompositionEnd"):a==="keydown"&&c.keyCode===229&&(We="onCompositionStart");We&&(Nx&&c.locale!=="ko"&&(Ri||We!=="onCompositionStart"?We==="onCompositionEnd"&&Ri&&(Ge=Ex()):(Jn=we,ju="value"in Jn?Jn.value:Jn.textContent,Ri=!0)),ut=E0(fe,We),0<ut.length&&(We=new kx(We,a,null,c,we),ke.push({event:We,listeners:ut}),Ge?We.data=Ge:(Ge=Rx(c),Ge!==null&&(We.data=Ge)))),(Ge=Zw?Kw(a,c):Jw(a,c))&&(We=E0(fe,"onBeforeInput"),0<We.length&&(ut=new kx("onBeforeInput","beforeinput",null,c,we),ke.push({event:ut,listeners:We}),ut.data=Ge)),zb(ke,a,fe,c,we)}xp(ke,i)})}function bc(a,i,c){return{instance:a,listener:i,currentTarget:c}}function E0(a,i){for(var c=i+"Capture",f=[];a!==null;){var m=a,g=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||g===null||(m=Pl(a,c),m!=null&&f.unshift(bc(a,m,g)),m=Pl(a,i),m!=null&&f.push(bc(a,m,g))),a.tag===3)return f;a=a.return}return[]}function al(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function pp(a,i,c,f,m){for(var g=i._reactName,T=[];c!==null&&c!==f;){var D=c,J=D.alternate,fe=D.stateNode;if(D=D.tag,J!==null&&J===f)break;D!==5&&D!==26&&D!==27||fe===null||(J=fe,m?(fe=Pl(c,g),fe!=null&&T.unshift(bc(c,fe,J))):m||(fe=Pl(c,g),fe!=null&&T.push(bc(c,fe,J)))),c=c.return}T.length!==0&&a.push({event:i,listeners:T})}var Yb=/\r\n?/g,qb=/\u0000|\uFFFD/g;function gp(a){return(typeof a=="string"?a:""+a).replace(Yb,`
`).replace(qb,"")}function vp(a,i){return i=gp(i),gp(a)===i}function T0(){}function Ut(a,i,c,f,m,g){switch(c){case"children":typeof f=="string"?i==="body"||i==="textarea"&&f===""||Ci(a,f):(typeof f=="number"||typeof f=="bigint")&&i!=="body"&&Ci(a,""+f);break;case"className":Ie(a,"class",f);break;case"tabIndex":Ie(a,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":Ie(a,c,f);break;case"style":yx(a,f,g);break;case"data":if(i!=="object"){Ie(a,"data",f);break}case"src":case"href":if(f===""&&(i!=="a"||c!=="href")){a.removeAttribute(c);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){a.removeAttribute(c);break}f=Ro(""+f),a.setAttribute(c,f);break;case"action":case"formAction":if(typeof f=="function"){a.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(c==="formAction"?(i!=="input"&&Ut(a,i,"name",m.name,m,null),Ut(a,i,"formEncType",m.formEncType,m,null),Ut(a,i,"formMethod",m.formMethod,m,null),Ut(a,i,"formTarget",m.formTarget,m,null)):(Ut(a,i,"encType",m.encType,m,null),Ut(a,i,"method",m.method,m,null),Ut(a,i,"target",m.target,m,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){a.removeAttribute(c);break}f=Ro(""+f),a.setAttribute(c,f);break;case"onClick":f!=null&&(a.onclick=T0);break;case"onScroll":f!=null&&mt("scroll",a);break;case"onScrollEnd":f!=null&&mt("scrollend",a);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(c=f.__html,c!=null){if(m.children!=null)throw Error(n(60));a.innerHTML=c}}break;case"multiple":a.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":a.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){a.removeAttribute("xlink:href");break}c=Ro(""+f),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(c,""+f):a.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(c,""):a.removeAttribute(c);break;case"capture":case"download":f===!0?a.setAttribute(c,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(c,f):a.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?a.setAttribute(c,f):a.removeAttribute(c);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?a.removeAttribute(c):a.setAttribute(c,f);break;case"popover":mt("beforetoggle",a),mt("toggle",a),Te(a,"popover",f);break;case"xlinkActuate":Ue(a,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Ue(a,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Ue(a,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Ue(a,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Ue(a,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Ue(a,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Ue(a,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Ue(a,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Ue(a,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":Te(a,"is",f);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=Ew.get(c)||c,Te(a,c,f))}}function hd(a,i,c,f,m,g){switch(c){case"style":yx(a,f,g);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(c=f.__html,c!=null){if(m.children!=null)throw Error(n(60));a.innerHTML=c}}break;case"children":typeof f=="string"?Ci(a,f):(typeof f=="number"||typeof f=="bigint")&&Ci(a,""+f);break;case"onScroll":f!=null&&mt("scroll",a);break;case"onScrollEnd":f!=null&&mt("scrollend",a);break;case"onClick":f!=null&&(a.onclick=T0);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!he.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(m=c.endsWith("Capture"),i=c.slice(2,m?c.length-7:void 0),g=a[Jt]||null,g=g!=null?g[c]:null,typeof g=="function"&&a.removeEventListener(i,g,m),typeof f=="function")){typeof g!="function"&&g!==null&&(c in a?a[c]=null:a.hasAttribute(c)&&a.removeAttribute(c)),a.addEventListener(i,f,m);break e}c in a?a[c]=f:f===!0?a.setAttribute(c,""):Te(a,c,f)}}}function Mr(a,i,c){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":mt("error",a),mt("load",a);var f=!1,m=!1,g;for(g in c)if(c.hasOwnProperty(g)){var T=c[g];if(T!=null)switch(g){case"src":f=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,i));default:Ut(a,i,g,T,c,null)}}m&&Ut(a,i,"srcSet",c.srcSet,c,null),f&&Ut(a,i,"src",c.src,c,null);return;case"input":mt("invalid",a);var D=g=T=m=null,J=null,fe=null;for(f in c)if(c.hasOwnProperty(f)){var we=c[f];if(we!=null)switch(f){case"name":m=we;break;case"type":T=we;break;case"checked":J=we;break;case"defaultChecked":fe=we;break;case"value":g=we;break;case"defaultValue":D=we;break;case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(n(137,i));break;default:Ut(a,i,f,we,c,null)}}Ps(a,g,D,J,fe,T,m,!1),Kn(a);return;case"select":mt("invalid",a),f=T=g=null;for(m in c)if(c.hasOwnProperty(m)&&(D=c[m],D!=null))switch(m){case"value":g=D;break;case"defaultValue":T=D;break;case"multiple":f=D;default:Ut(a,i,m,D,c,null)}i=g,c=T,a.multiple=!!f,i!=null?pa(a,!!f,i,!1):c!=null&&pa(a,!!f,c,!0);return;case"textarea":mt("invalid",a),g=m=f=null;for(T in c)if(c.hasOwnProperty(T)&&(D=c[T],D!=null))switch(T){case"value":f=D;break;case"defaultValue":m=D;break;case"children":g=D;break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(n(91));break;default:Ut(a,i,T,D,c,null)}vx(a,f,m,g),Kn(a);return;case"option":for(J in c)if(c.hasOwnProperty(J)&&(f=c[J],f!=null))switch(J){case"selected":a.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:Ut(a,i,J,f,c,null)}return;case"dialog":mt("beforetoggle",a),mt("toggle",a),mt("cancel",a),mt("close",a);break;case"iframe":case"object":mt("load",a);break;case"video":case"audio":for(f=0;f<wc.length;f++)mt(wc[f],a);break;case"image":mt("error",a),mt("load",a);break;case"details":mt("toggle",a);break;case"embed":case"source":case"link":mt("error",a),mt("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(fe in c)if(c.hasOwnProperty(fe)&&(f=c[fe],f!=null))switch(fe){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,i));default:Ut(a,i,fe,f,c,null)}return;default:if(Nu(i)){for(we in c)c.hasOwnProperty(we)&&(f=c[we],f!==void 0&&hd(a,i,we,f,c,void 0));return}}for(D in c)c.hasOwnProperty(D)&&(f=c[D],f!=null&&Ut(a,i,D,f,c,null))}function Xb(a,i,c,f){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,g=null,T=null,D=null,J=null,fe=null,we=null;for(me in c){var ke=c[me];if(c.hasOwnProperty(me)&&ke!=null)switch(me){case"checked":break;case"value":break;case"defaultValue":J=ke;default:f.hasOwnProperty(me)||Ut(a,i,me,null,f,ke)}}for(var xe in f){var me=f[xe];if(ke=c[xe],f.hasOwnProperty(xe)&&(me!=null||ke!=null))switch(xe){case"type":g=me;break;case"name":m=me;break;case"checked":fe=me;break;case"defaultChecked":we=me;break;case"value":T=me;break;case"defaultValue":D=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(n(137,i));break;default:me!==ke&&Ut(a,i,xe,me,f,ke)}}vr(a,T,D,J,fe,we,g,m);return;case"select":me=T=D=xe=null;for(g in c)if(J=c[g],c.hasOwnProperty(g)&&J!=null)switch(g){case"value":break;case"multiple":me=J;default:f.hasOwnProperty(g)||Ut(a,i,g,null,f,J)}for(m in f)if(g=f[m],J=c[m],f.hasOwnProperty(m)&&(g!=null||J!=null))switch(m){case"value":xe=g;break;case"defaultValue":D=g;break;case"multiple":T=g;default:g!==J&&Ut(a,i,m,g,f,J)}i=D,c=T,f=me,xe!=null?pa(a,!!c,xe,!1):!!f!=!!c&&(i!=null?pa(a,!!c,i,!0):pa(a,!!c,c?[]:"",!1));return;case"textarea":me=xe=null;for(D in c)if(m=c[D],c.hasOwnProperty(D)&&m!=null&&!f.hasOwnProperty(D))switch(D){case"value":break;case"children":break;default:Ut(a,i,D,null,f,m)}for(T in f)if(m=f[T],g=c[T],f.hasOwnProperty(T)&&(m!=null||g!=null))switch(T){case"value":xe=m;break;case"defaultValue":me=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(n(91));break;default:m!==g&&Ut(a,i,T,m,f,g)}Do(a,xe,me);return;case"option":for(var Ze in c)if(xe=c[Ze],c.hasOwnProperty(Ze)&&xe!=null&&!f.hasOwnProperty(Ze))switch(Ze){case"selected":a.selected=!1;break;default:Ut(a,i,Ze,null,f,xe)}for(J in f)if(xe=f[J],me=c[J],f.hasOwnProperty(J)&&xe!==me&&(xe!=null||me!=null))switch(J){case"selected":a.selected=xe&&typeof xe!="function"&&typeof xe!="symbol";break;default:Ut(a,i,J,xe,f,me)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var qe in c)xe=c[qe],c.hasOwnProperty(qe)&&xe!=null&&!f.hasOwnProperty(qe)&&Ut(a,i,qe,null,f,xe);for(fe in f)if(xe=f[fe],me=c[fe],f.hasOwnProperty(fe)&&xe!==me&&(xe!=null||me!=null))switch(fe){case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(n(137,i));break;default:Ut(a,i,fe,xe,f,me)}return;default:if(Nu(i)){for(var Bt in c)xe=c[Bt],c.hasOwnProperty(Bt)&&xe!==void 0&&!f.hasOwnProperty(Bt)&&hd(a,i,Bt,void 0,f,xe);for(we in f)xe=f[we],me=c[we],!f.hasOwnProperty(we)||xe===me||xe===void 0&&me===void 0||hd(a,i,we,xe,f,me);return}}for(var le in c)xe=c[le],c.hasOwnProperty(le)&&xe!=null&&!f.hasOwnProperty(le)&&Ut(a,i,le,null,f,xe);for(ke in f)xe=f[ke],me=c[ke],!f.hasOwnProperty(ke)||xe===me||xe==null&&me==null||Ut(a,i,ke,xe,f,me)}var xd=null,md=null;function S0(a){return a.nodeType===9?a:a.ownerDocument}function _p(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function yp(a,i){if(a===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&i==="foreignObject"?0:a}function pd(a,i){return a==="textarea"||a==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var gd=null;function Wb(){var a=window.event;return a&&a.type==="popstate"?a===gd?!1:(gd=a,!0):(gd=null,!1)}var wp=typeof setTimeout=="function"?setTimeout:void 0,Zb=typeof clearTimeout=="function"?clearTimeout:void 0,bp=typeof Promise=="function"?Promise:void 0,Kb=typeof queueMicrotask=="function"?queueMicrotask:typeof bp<"u"?function(a){return bp.resolve(null).then(a).catch(Jb)}:wp;function Jb(a){setTimeout(function(){throw a})}function xs(a){return a==="head"}function Ep(a,i){var c=i,f=0,m=0;do{var g=c.nextSibling;if(a.removeChild(c),g&&g.nodeType===8)if(c=g.data,c==="/$"){if(0<f&&8>f){c=f;var T=a.ownerDocument;if(c&1&&Ec(T.documentElement),c&2&&Ec(T.body),c&4)for(c=T.head,Ec(c),T=c.firstChild;T;){var D=T.nextSibling,J=T.nodeName;T[k]||J==="SCRIPT"||J==="STYLE"||J==="LINK"&&T.rel.toLowerCase()==="stylesheet"||c.removeChild(T),T=D}}if(m===0){a.removeChild(g),Dc(i);return}m--}else c==="$"||c==="$?"||c==="$!"?m++:f=c.charCodeAt(0)-48;else f=0;c=g}while(c);Dc(i)}function vd(a){var i=a.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var c=i;switch(i=i.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":vd(c),R(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}a.removeChild(c)}}function Qb(a,i,c,f){for(;a.nodeType===1;){var m=c;if(a.nodeName.toLowerCase()!==i.toLowerCase()){if(!f&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(f){if(!a[k])switch(i){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(g=a.getAttribute("rel"),g==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(g!==m.rel||a.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||a.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||a.getAttribute("title")!==(m.title==null?null:m.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(g=a.getAttribute("src"),(g!==(m.src==null?null:m.src)||a.getAttribute("type")!==(m.type==null?null:m.type)||a.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&g&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(i==="input"&&a.type==="hidden"){var g=m.name==null?null:""+m.name;if(m.type==="hidden"&&a.getAttribute("name")===g)return a}else return a;if(a=Za(a.nextSibling),a===null)break}return null}function eE(a,i,c){if(i==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!c||(a=Za(a.nextSibling),a===null))return null;return a}function _d(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState==="complete"}function tE(a,i){var c=a.ownerDocument;if(a.data!=="$?"||c.readyState==="complete")i();else{var f=function(){i(),c.removeEventListener("DOMContentLoaded",f)};c.addEventListener("DOMContentLoaded",f),a._reactRetry=f}}function Za(a){for(;a!=null;a=a.nextSibling){var i=a.nodeType;if(i===1||i===3)break;if(i===8){if(i=a.data,i==="$"||i==="$!"||i==="$?"||i==="F!"||i==="F")break;if(i==="/$")return null}}return a}var yd=null;function Tp(a){a=a.previousSibling;for(var i=0;a;){if(a.nodeType===8){var c=a.data;if(c==="$"||c==="$!"||c==="$?"){if(i===0)return a;i--}else c==="/$"&&i++}a=a.previousSibling}return null}function Sp(a,i,c){switch(i=S0(c),a){case"html":if(a=i.documentElement,!a)throw Error(n(452));return a;case"head":if(a=i.head,!a)throw Error(n(453));return a;case"body":if(a=i.body,!a)throw Error(n(454));return a;default:throw Error(n(451))}}function Ec(a){for(var i=a.attributes;i.length;)a.removeAttributeNode(i[0]);R(a)}var Fa=new Map,kp=new Set;function k0(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var Ln=ue.d;ue.d={f:rE,r:aE,D:nE,C:sE,L:iE,m:lE,X:oE,S:cE,M:uE};function rE(){var a=Ln.f(),i=g0();return a||i}function aE(a){var i=F(a);i!==null&&i.tag===5&&i.type==="form"?Ym(i):Ln.r(a)}var nl=typeof document>"u"?null:document;function Ap(a,i,c){var f=nl;if(f&&typeof i=="string"&&i){var m=ht(i);m='link[rel="'+a+'"][href="'+m+'"]',typeof c=="string"&&(m+='[crossorigin="'+c+'"]'),kp.has(m)||(kp.add(m),a={rel:a,crossOrigin:c,href:i},f.querySelector(m)===null&&(i=f.createElement("link"),Mr(i,"link",a),ie(i),f.head.appendChild(i)))}}function nE(a){Ln.D(a),Ap("dns-prefetch",a,null)}function sE(a,i){Ln.C(a,i),Ap("preconnect",a,i)}function iE(a,i,c){Ln.L(a,i,c);var f=nl;if(f&&a&&i){var m='link[rel="preload"][as="'+ht(i)+'"]';i==="image"&&c&&c.imageSrcSet?(m+='[imagesrcset="'+ht(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(m+='[imagesizes="'+ht(c.imageSizes)+'"]')):m+='[href="'+ht(a)+'"]';var g=m;switch(i){case"style":g=sl(a);break;case"script":g=il(a)}Fa.has(g)||(a=p({rel:"preload",href:i==="image"&&c&&c.imageSrcSet?void 0:a,as:i},c),Fa.set(g,a),f.querySelector(m)!==null||i==="style"&&f.querySelector(Tc(g))||i==="script"&&f.querySelector(Sc(g))||(i=f.createElement("link"),Mr(i,"link",a),ie(i),f.head.appendChild(i)))}}function lE(a,i){Ln.m(a,i);var c=nl;if(c&&a){var f=i&&typeof i.as=="string"?i.as:"script",m='link[rel="modulepreload"][as="'+ht(f)+'"][href="'+ht(a)+'"]',g=m;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=il(a)}if(!Fa.has(g)&&(a=p({rel:"modulepreload",href:a},i),Fa.set(g,a),c.querySelector(m)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Sc(g)))return}f=c.createElement("link"),Mr(f,"link",a),ie(f),c.head.appendChild(f)}}}function cE(a,i,c){Ln.S(a,i,c);var f=nl;if(f&&a){var m=pe(f).hoistableStyles,g=sl(a);i=i||"default";var T=m.get(g);if(!T){var D={loading:0,preload:null};if(T=f.querySelector(Tc(g)))D.loading=5;else{a=p({rel:"stylesheet",href:a,"data-precedence":i},c),(c=Fa.get(g))&&wd(a,c);var J=T=f.createElement("link");ie(J),Mr(J,"link",a),J._p=new Promise(function(fe,we){J.onload=fe,J.onerror=we}),J.addEventListener("load",function(){D.loading|=1}),J.addEventListener("error",function(){D.loading|=2}),D.loading|=4,A0(T,i,f)}T={type:"stylesheet",instance:T,count:1,state:D},m.set(g,T)}}}function oE(a,i){Ln.X(a,i);var c=nl;if(c&&a){var f=pe(c).hoistableScripts,m=il(a),g=f.get(m);g||(g=c.querySelector(Sc(m)),g||(a=p({src:a,async:!0},i),(i=Fa.get(m))&&bd(a,i),g=c.createElement("script"),ie(g),Mr(g,"link",a),c.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},f.set(m,g))}}function uE(a,i){Ln.M(a,i);var c=nl;if(c&&a){var f=pe(c).hoistableScripts,m=il(a),g=f.get(m);g||(g=c.querySelector(Sc(m)),g||(a=p({src:a,async:!0,type:"module"},i),(i=Fa.get(m))&&bd(a,i),g=c.createElement("script"),ie(g),Mr(g,"link",a),c.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},f.set(m,g))}}function Np(a,i,c,f){var m=(m=se.current)?k0(m):null;if(!m)throw Error(n(446));switch(a){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(i=sl(c.href),c=pe(m).hoistableStyles,f=c.get(i),f||(f={type:"style",instance:null,count:0,state:null},c.set(i,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){a=sl(c.href);var g=pe(m).hoistableStyles,T=g.get(a);if(T||(m=m.ownerDocument||m,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(a,T),(g=m.querySelector(Tc(a)))&&!g._p&&(T.instance=g,T.state.loading=5),Fa.has(a)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Fa.set(a,c),g||fE(m,a,c,T.state))),i&&f===null)throw Error(n(528,""));return T}if(i&&f!==null)throw Error(n(529,""));return null;case"script":return i=c.async,c=c.src,typeof c=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=il(c),c=pe(m).hoistableScripts,f=c.get(i),f||(f={type:"script",instance:null,count:0,state:null},c.set(i,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,a))}}function sl(a){return'href="'+ht(a)+'"'}function Tc(a){return'link[rel="stylesheet"]['+a+"]"}function Cp(a){return p({},a,{"data-precedence":a.precedence,precedence:null})}function fE(a,i,c,f){a.querySelector('link[rel="preload"][as="style"]['+i+"]")?f.loading=1:(i=a.createElement("link"),f.preload=i,i.addEventListener("load",function(){return f.loading|=1}),i.addEventListener("error",function(){return f.loading|=2}),Mr(i,"link",c),ie(i),a.head.appendChild(i))}function il(a){return'[src="'+ht(a)+'"]'}function Sc(a){return"script[async]"+a}function Op(a,i,c){if(i.count++,i.instance===null)switch(i.type){case"style":var f=a.querySelector('style[data-href~="'+ht(c.href)+'"]');if(f)return i.instance=f,ie(f),f;var m=p({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return f=(a.ownerDocument||a).createElement("style"),ie(f),Mr(f,"style",m),A0(f,c.precedence,a),i.instance=f;case"stylesheet":m=sl(c.href);var g=a.querySelector(Tc(m));if(g)return i.state.loading|=4,i.instance=g,ie(g),g;f=Cp(c),(m=Fa.get(m))&&wd(f,m),g=(a.ownerDocument||a).createElement("link"),ie(g);var T=g;return T._p=new Promise(function(D,J){T.onload=D,T.onerror=J}),Mr(g,"link",f),i.state.loading|=4,A0(g,c.precedence,a),i.instance=g;case"script":return g=il(c.src),(m=a.querySelector(Sc(g)))?(i.instance=m,ie(m),m):(f=c,(m=Fa.get(g))&&(f=p({},c),bd(f,m)),a=a.ownerDocument||a,m=a.createElement("script"),ie(m),Mr(m,"link",f),a.head.appendChild(m),i.instance=m);case"void":return null;default:throw Error(n(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(f=i.instance,i.state.loading|=4,A0(f,c.precedence,a));return i.instance}function A0(a,i,c){for(var f=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=f.length?f[f.length-1]:null,g=m,T=0;T<f.length;T++){var D=f[T];if(D.dataset.precedence===i)g=D;else if(g!==m)break}g?g.parentNode.insertBefore(a,g.nextSibling):(i=c.nodeType===9?c.head:c,i.insertBefore(a,i.firstChild))}function wd(a,i){a.crossOrigin==null&&(a.crossOrigin=i.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=i.referrerPolicy),a.title==null&&(a.title=i.title)}function bd(a,i){a.crossOrigin==null&&(a.crossOrigin=i.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=i.referrerPolicy),a.integrity==null&&(a.integrity=i.integrity)}var N0=null;function Dp(a,i,c){if(N0===null){var f=new Map,m=N0=new Map;m.set(c,f)}else m=N0,f=m.get(c),f||(f=new Map,m.set(c,f));if(f.has(a))return f;for(f.set(a,null),c=c.getElementsByTagName(a),m=0;m<c.length;m++){var g=c[m];if(!(g[k]||g[Kt]||a==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var T=g.getAttribute(i)||"";T=a+T;var D=f.get(T);D?D.push(g):f.set(T,[g])}}return f}function Rp(a,i,c){a=a.ownerDocument||a,a.head.insertBefore(c,i==="title"?a.querySelector("head > title"):null)}function dE(a,i,c){if(c===1||i.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return a=i.disabled,typeof i.precedence=="string"&&a==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function jp(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}var kc=null;function hE(){}function xE(a,i,c){if(kc===null)throw Error(n(475));var f=kc;if(i.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var m=sl(c.href),g=a.querySelector(Tc(m));if(g){a=g._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(f.count++,f=C0.bind(f),a.then(f,f)),i.state.loading|=4,i.instance=g,ie(g);return}g=a.ownerDocument||a,c=Cp(c),(m=Fa.get(m))&&wd(c,m),g=g.createElement("link"),ie(g);var T=g;T._p=new Promise(function(D,J){T.onload=D,T.onerror=J}),Mr(g,"link",c),i.instance=g}f.stylesheets===null&&(f.stylesheets=new Map),f.stylesheets.set(i,a),(a=i.state.preload)&&(i.state.loading&3)===0&&(f.count++,i=C0.bind(f),a.addEventListener("load",i),a.addEventListener("error",i))}}function mE(){if(kc===null)throw Error(n(475));var a=kc;return a.stylesheets&&a.count===0&&Ed(a,a.stylesheets),0<a.count?function(i){var c=setTimeout(function(){if(a.stylesheets&&Ed(a,a.stylesheets),a.unsuspend){var f=a.unsuspend;a.unsuspend=null,f()}},6e4);return a.unsuspend=i,function(){a.unsuspend=null,clearTimeout(c)}}:null}function C0(){if(this.count--,this.count===0){if(this.stylesheets)Ed(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var O0=null;function Ed(a,i){a.stylesheets=null,a.unsuspend!==null&&(a.count++,O0=new Map,i.forEach(pE,a),O0=null,C0.call(a))}function pE(a,i){if(!(i.state.loading&4)){var c=O0.get(a);if(c)var f=c.get(null);else{c=new Map,O0.set(a,c);for(var m=a.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<m.length;g++){var T=m[g];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(c.set(T.dataset.precedence,T),f=T)}f&&c.set(null,f)}m=i.instance,T=m.getAttribute("data-precedence"),g=c.get(T)||f,g===f&&c.set(null,m),c.set(T,m),this.count++,f=C0.bind(this),m.addEventListener("load",f),m.addEventListener("error",f),g?g.parentNode.insertBefore(m,g.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(m,a.firstChild)),i.state.loading|=4}}var Ac={$$typeof:S,Provider:null,Consumer:null,_currentValue:Q,_currentValue2:Q,_threadCount:0};function gE(a,i,c,f,m,g,T,D){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=yn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yn(0),this.hiddenUpdates=yn(null),this.identifierPrefix=f,this.onUncaughtError=m,this.onCaughtError=g,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=D,this.incompleteTransitions=new Map}function Ip(a,i,c,f,m,g,T,D,J,fe,we,ke){return a=new gE(a,i,c,T,D,J,fe,ke),i=1,g===!0&&(i|=24),g=va(3,null,null,i),a.current=g,g.stateNode=a,i=af(),i.refCount++,a.pooledCache=i,i.refCount++,g.memoizedState={element:f,isDehydrated:c,cache:i},cf(g),a}function Mp(a){return a?(a=Fi,a):Fi}function Lp(a,i,c,f,m,g){m=Mp(m),f.context===null?f.context=m:f.pendingContext=m,f=ts(i),f.payload={element:c},g=g===void 0?null:g,g!==null&&(f.callback=g),c=rs(a,f,i),c!==null&&(Ea(c,a,i),ac(c,a,i))}function Fp(a,i){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var c=a.retryLane;a.retryLane=c!==0&&c<i?c:i}}function Td(a,i){Fp(a,i),(a=a.alternate)&&Fp(a,i)}function Up(a){if(a.tag===13){var i=Li(a,67108864);i!==null&&Ea(i,a,67108864),Td(a,67108864)}}var D0=!0;function vE(a,i,c,f){var m=ae.T;ae.T=null;var g=ue.p;try{ue.p=2,Sd(a,i,c,f)}finally{ue.p=g,ae.T=m}}function _E(a,i,c,f){var m=ae.T;ae.T=null;var g=ue.p;try{ue.p=8,Sd(a,i,c,f)}finally{ue.p=g,ae.T=m}}function Sd(a,i,c,f){if(D0){var m=kd(f);if(m===null)dd(a,i,f,R0,c),Pp(a,f);else if(wE(m,a,i,c,f))f.stopPropagation();else if(Pp(a,f),i&4&&-1<yE.indexOf(a)){for(;m!==null;){var g=F(m);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var T=sa(g.pendingLanes);if(T!==0){var D=g;for(D.pendingLanes|=2,D.entangledLanes|=2;T;){var J=1<<31-Qe(T);D.entanglements[1]|=J,T&=~J}dn(g),(It&6)===0&&(m0=Oe()+500,yc(0))}}break;case 13:D=Li(g,2),D!==null&&Ea(D,g,2),g0(),Td(g,2)}if(g=kd(f),g===null&&dd(a,i,f,R0,c),g===m)break;m=g}m!==null&&f.stopPropagation()}else dd(a,i,f,null,c)}}function kd(a){return a=Ou(a),Ad(a)}var R0=null;function Ad(a){if(R0=null,a=M(a),a!==null){var i=l(a);if(i===null)a=null;else{var c=i.tag;if(c===13){if(a=o(i),a!==null)return a;a=null}else if(c===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;a=null}else i!==a&&(a=null)}}return R0=a,null}function Bp(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ot()){case $t:return 2;case Le:return 8;case Pe:case Ve:return 32;case $e:return 268435456;default:return 32}default:return 32}}var Nd=!1,ms=null,ps=null,gs=null,Nc=new Map,Cc=new Map,vs=[],yE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Pp(a,i){switch(a){case"focusin":case"focusout":ms=null;break;case"dragenter":case"dragleave":ps=null;break;case"mouseover":case"mouseout":gs=null;break;case"pointerover":case"pointerout":Nc.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Cc.delete(i.pointerId)}}function Oc(a,i,c,f,m,g){return a===null||a.nativeEvent!==g?(a={blockedOn:i,domEventName:c,eventSystemFlags:f,nativeEvent:g,targetContainers:[m]},i!==null&&(i=F(i),i!==null&&Up(i)),a):(a.eventSystemFlags|=f,i=a.targetContainers,m!==null&&i.indexOf(m)===-1&&i.push(m),a)}function wE(a,i,c,f,m){switch(i){case"focusin":return ms=Oc(ms,a,i,c,f,m),!0;case"dragenter":return ps=Oc(ps,a,i,c,f,m),!0;case"mouseover":return gs=Oc(gs,a,i,c,f,m),!0;case"pointerover":var g=m.pointerId;return Nc.set(g,Oc(Nc.get(g)||null,a,i,c,f,m)),!0;case"gotpointercapture":return g=m.pointerId,Cc.set(g,Oc(Cc.get(g)||null,a,i,c,f,m)),!0}return!1}function Hp(a){var i=M(a.target);if(i!==null){var c=l(i);if(c!==null){if(i=c.tag,i===13){if(i=o(c),i!==null){a.blockedOn=i,Us(a.priority,function(){if(c.tag===13){var f=ba();f=wn(f);var m=Li(c,f);m!==null&&Ea(m,c,f),Td(c,f)}});return}}else if(i===3&&c.stateNode.current.memoizedState.isDehydrated){a.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}a.blockedOn=null}function j0(a){if(a.blockedOn!==null)return!1;for(var i=a.targetContainers;0<i.length;){var c=kd(a.nativeEvent);if(c===null){c=a.nativeEvent;var f=new c.constructor(c.type,c);Cu=f,c.target.dispatchEvent(f),Cu=null}else return i=F(c),i!==null&&Up(i),a.blockedOn=c,!1;i.shift()}return!0}function zp(a,i,c){j0(a)&&c.delete(i)}function bE(){Nd=!1,ms!==null&&j0(ms)&&(ms=null),ps!==null&&j0(ps)&&(ps=null),gs!==null&&j0(gs)&&(gs=null),Nc.forEach(zp),Cc.forEach(zp)}function I0(a,i){a.blockedOn===i&&(a.blockedOn=null,Nd||(Nd=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,bE)))}var M0=null;function Gp(a){M0!==a&&(M0=a,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){M0===a&&(M0=null);for(var i=0;i<a.length;i+=3){var c=a[i],f=a[i+1],m=a[i+2];if(typeof f!="function"){if(Ad(f||c)===null)continue;break}var g=F(c);g!==null&&(a.splice(i,3),i-=3,Af(g,{pending:!0,data:m,method:c.method,action:f},f,m))}}))}function Dc(a){function i(J){return I0(J,a)}ms!==null&&I0(ms,a),ps!==null&&I0(ps,a),gs!==null&&I0(gs,a),Nc.forEach(i),Cc.forEach(i);for(var c=0;c<vs.length;c++){var f=vs[c];f.blockedOn===a&&(f.blockedOn=null)}for(;0<vs.length&&(c=vs[0],c.blockedOn===null);)Hp(c),c.blockedOn===null&&vs.shift();if(c=(a.ownerDocument||a).$$reactFormReplay,c!=null)for(f=0;f<c.length;f+=3){var m=c[f],g=c[f+1],T=m[Jt]||null;if(typeof g=="function")T||Gp(c);else if(T){var D=null;if(g&&g.hasAttribute("formAction")){if(m=g,T=g[Jt]||null)D=T.formAction;else if(Ad(m)!==null)continue}else D=T.action;typeof D=="function"?c[f+1]=D:(c.splice(f,3),f-=3),Gp(c)}}}function Cd(a){this._internalRoot=a}L0.prototype.render=Cd.prototype.render=function(a){var i=this._internalRoot;if(i===null)throw Error(n(409));var c=i.current,f=ba();Lp(c,f,a,i,null,null)},L0.prototype.unmount=Cd.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var i=a.containerInfo;Lp(a.current,2,null,a,null,null),g0(),i[Ca]=null}};function L0(a){this._internalRoot=a}L0.prototype.unstable_scheduleHydration=function(a){if(a){var i=Wn();a={blockedOn:null,target:a,priority:i};for(var c=0;c<vs.length&&i!==0&&i<vs[c].priority;c++);vs.splice(c,0,a),c===0&&Hp(a)}};var Vp=t.version;if(Vp!=="19.1.0")throw Error(n(527,Vp,"19.1.0"));ue.findDOMNode=function(a){var i=a._reactInternals;if(i===void 0)throw typeof a.render=="function"?Error(n(188)):(a=Object.keys(a).join(","),Error(n(268,a)));return a=h(i),a=a!==null?x(a):null,a=a===null?null:a.stateNode,a};var EE={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:ae,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var F0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!F0.isDisabled&&F0.supportsFiber)try{pr=F0.inject(EE),Yt=F0}catch{}}return jc.createRoot=function(a,i){if(!s(a))throw Error(n(299));var c=!1,f="",m=i1,g=l1,T=c1,D=null;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(f=i.identifierPrefix),i.onUncaughtError!==void 0&&(m=i.onUncaughtError),i.onCaughtError!==void 0&&(g=i.onCaughtError),i.onRecoverableError!==void 0&&(T=i.onRecoverableError),i.unstable_transitionCallbacks!==void 0&&(D=i.unstable_transitionCallbacks)),i=Ip(a,1,!1,null,null,c,f,m,g,T,D,null),a[Ca]=i.current,fd(a),new Cd(i)},jc.hydrateRoot=function(a,i,c){if(!s(a))throw Error(n(299));var f=!1,m="",g=i1,T=l1,D=c1,J=null,fe=null;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(m=c.identifierPrefix),c.onUncaughtError!==void 0&&(g=c.onUncaughtError),c.onCaughtError!==void 0&&(T=c.onCaughtError),c.onRecoverableError!==void 0&&(D=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(J=c.unstable_transitionCallbacks),c.formState!==void 0&&(fe=c.formState)),i=Ip(a,1,!0,i,c??null,f,m,g,T,D,J,fe),i.context=Mp(null),c=i.current,f=ba(),f=wn(f),m=ts(f),m.callback=null,rs(c,m,f),c=f,i.current.lanes=c,Ya(i,c),dn(i),a[Ca]=i.current,fd(a),new L0(i)},jc.version="19.1.0",jc}var eg;function IE(){if(eg)return Rd.exports;eg=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Rd.exports=jE(),Rd.exports}var ME=IE();const LE=Ch(ME),FE="modulepreload",UE=function(e){return"/"+e},tg={},_o=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){let o=function(x){return Promise.all(x.map(p=>Promise.resolve(p).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),h=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));s=o(r.map(x=>{if(x=UE(x),x in tg)return;tg[x]=!0;const p=x.endsWith(".css"),v=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${x}"]${v}`))return;const _=document.createElement("link");if(_.rel=p?"stylesheet":FE,p||(_.as="script"),_.crossOrigin="",_.href=x,h&&_.setAttribute("nonce",h),document.head.appendChild(_),p)return new Promise((y,w)=>{_.addEventListener("load",y),_.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${x}`)))})}))}function l(o){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=o,window.dispatchEvent(u),!u.defaultPrevented)throw o}return s.then(o=>{for(const u of o||[])u.status==="rejected"&&l(u.reason);return t().catch(l)})},BE=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>_o(async()=>{const{default:n}=await Promise.resolve().then(()=>Ml);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class Dh extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class PE extends Dh{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class rg extends Dh{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class ag extends Dh{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var ah;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(ah||(ah={}));var HE=function(e,t,r,n){function s(l){return l instanceof r?l:new r(function(o){o(l)})}return new(r||(r=Promise))(function(l,o){function u(p){try{x(n.next(p))}catch(v){o(v)}}function h(p){try{x(n.throw(p))}catch(v){o(v)}}function x(p){p.done?l(p.value):s(p.value).then(u,h)}x((n=n.apply(e,t||[])).next())})};class zE{constructor(t,{headers:r={},customFetch:n,region:s=ah.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=BE(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return HE(this,void 0,void 0,function*(){try{const{headers:s,method:l,body:o}=r;let u={},{region:h}=r;h||(h=this.region);const x=new URL(`${this.url}/${t}`);h&&h!=="any"&&(u["x-region"]=h,x.searchParams.set("forceFunctionRegion",h));let p;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(u["Content-Type"]="application/octet-stream",p=o):typeof o=="string"?(u["Content-Type"]="text/plain",p=o):typeof FormData<"u"&&o instanceof FormData?p=o:(u["Content-Type"]="application/json",p=JSON.stringify(o)));const v=yield this.fetch(x.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},u),this.headers),s),body:p}).catch(b=>{throw new PE(b)}),_=v.headers.get("x-relay-error");if(_&&_==="true")throw new rg(v);if(!v.ok)throw new ag(v);let y=((n=v.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),w;return y==="application/json"?w=yield v.json():y==="application/octet-stream"?w=yield v.blob():y==="text/event-stream"?w=v:y==="multipart/form-data"?w=yield v.formData():w=yield v.text(),{data:w,error:null,response:v}}catch(s){return{data:null,error:s,response:s instanceof ag||s instanceof rg?s.context:void 0}}})}}var Nr={},ll={},cl={},ol={},ul={},fl={},GE=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Al=GE();const VE=Al.fetch,Q2=Al.fetch.bind(Al),e_=Al.Headers,$E=Al.Request,YE=Al.Response,Ml=Object.freeze(Object.defineProperty({__proto__:null,Headers:e_,Request:$E,Response:YE,default:Q2,fetch:VE},Symbol.toStringTag,{value:"Module"})),qE=SE(Ml);var U0={},ng;function t_(){if(ng)return U0;ng=1,Object.defineProperty(U0,"__esModule",{value:!0});class e extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return U0.default=e,U0}var sg;function r_(){if(sg)return fl;sg=1;var e=fl&&fl.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(fl,"__esModule",{value:!0});const t=e(qE),r=e(t_());class n{constructor(l){this.shouldThrowOnError=!1,this.method=l.method,this.url=l.url,this.headers=l.headers,this.schema=l.schema,this.body=l.body,this.shouldThrowOnError=l.shouldThrowOnError,this.signal=l.signal,this.isMaybeSingle=l.isMaybeSingle,l.fetch?this.fetch=l.fetch:typeof fetch>"u"?this.fetch=t.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(l,o){return this.headers=Object.assign({},this.headers),this.headers[l]=o,this}then(l,o){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const u=this.fetch;let h=u(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async x=>{var p,v,_;let y=null,w=null,b=null,E=x.status,j=x.statusText;if(x.ok){if(this.method!=="HEAD"){const Z=await x.text();Z===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?w=Z:w=JSON.parse(Z))}const S=(p=this.headers.Prefer)===null||p===void 0?void 0:p.match(/count=(exact|planned|estimated)/),L=(v=x.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");S&&L&&L.length>1&&(b=parseInt(L[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(w)&&(w.length>1?(y={code:"PGRST116",details:`Results contain ${w.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},w=null,b=null,E=406,j="Not Acceptable"):w.length===1?w=w[0]:w=null)}else{const S=await x.text();try{y=JSON.parse(S),Array.isArray(y)&&x.status===404&&(w=[],y=null,E=200,j="OK")}catch{x.status===404&&S===""?(E=204,j="No Content"):y={message:S}}if(y&&this.isMaybeSingle&&(!((_=y==null?void 0:y.details)===null||_===void 0)&&_.includes("0 rows"))&&(y=null,E=200,j="OK"),y&&this.shouldThrowOnError)throw new r.default(y)}return{error:y,data:w,count:b,status:E,statusText:j}});return this.shouldThrowOnError||(h=h.catch(x=>{var p,v,_;return{error:{message:`${(p=x==null?void 0:x.name)!==null&&p!==void 0?p:"FetchError"}: ${x==null?void 0:x.message}`,details:`${(v=x==null?void 0:x.stack)!==null&&v!==void 0?v:""}`,hint:"",code:`${(_=x==null?void 0:x.code)!==null&&_!==void 0?_:""}`},data:null,count:null,status:0,statusText:""}})),h.then(l,o)}returns(){return this}overrideTypes(){return this}}return fl.default=n,fl}var ig;function a_(){if(ig)return ul;ig=1;var e=ul&&ul.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ul,"__esModule",{value:!0});const t=e(r_());class r extends t.default{select(s){let l=!1;const o=(s??"*").split("").map(u=>/\s/.test(u)&&!l?"":(u==='"'&&(l=!l),u)).join("");return this.url.searchParams.set("select",o),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(s,{ascending:l=!0,nullsFirst:o,foreignTable:u,referencedTable:h=u}={}){const x=h?`${h}.order`:"order",p=this.url.searchParams.get(x);return this.url.searchParams.set(x,`${p?`${p},`:""}${s}.${l?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:l,referencedTable:o=l}={}){const u=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(u,`${s}`),this}range(s,l,{foreignTable:o,referencedTable:u=o}={}){const h=typeof u>"u"?"offset":`${u}.offset`,x=typeof u>"u"?"limit":`${u}.limit`;return this.url.searchParams.set(h,`${s}`),this.url.searchParams.set(x,`${l-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:s=!1,verbose:l=!1,settings:o=!1,buffers:u=!1,wal:h=!1,format:x="text"}={}){var p;const v=[s?"analyze":null,l?"verbose":null,o?"settings":null,u?"buffers":null,h?"wal":null].filter(Boolean).join("|"),_=(p=this.headers.Accept)!==null&&p!==void 0?p:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${x}; for="${_}"; options=${v};`,x==="json"?this:this}rollback(){var s;return((s=this.headers.Prefer)!==null&&s!==void 0?s:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return ul.default=r,ul}var lg;function Rh(){if(lg)return ol;lg=1;var e=ol&&ol.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ol,"__esModule",{value:!0});const t=e(a_());class r extends t.default{eq(s,l){return this.url.searchParams.append(s,`eq.${l}`),this}neq(s,l){return this.url.searchParams.append(s,`neq.${l}`),this}gt(s,l){return this.url.searchParams.append(s,`gt.${l}`),this}gte(s,l){return this.url.searchParams.append(s,`gte.${l}`),this}lt(s,l){return this.url.searchParams.append(s,`lt.${l}`),this}lte(s,l){return this.url.searchParams.append(s,`lte.${l}`),this}like(s,l){return this.url.searchParams.append(s,`like.${l}`),this}likeAllOf(s,l){return this.url.searchParams.append(s,`like(all).{${l.join(",")}}`),this}likeAnyOf(s,l){return this.url.searchParams.append(s,`like(any).{${l.join(",")}}`),this}ilike(s,l){return this.url.searchParams.append(s,`ilike.${l}`),this}ilikeAllOf(s,l){return this.url.searchParams.append(s,`ilike(all).{${l.join(",")}}`),this}ilikeAnyOf(s,l){return this.url.searchParams.append(s,`ilike(any).{${l.join(",")}}`),this}is(s,l){return this.url.searchParams.append(s,`is.${l}`),this}in(s,l){const o=Array.from(new Set(l)).map(u=>typeof u=="string"&&new RegExp("[,()]").test(u)?`"${u}"`:`${u}`).join(",");return this.url.searchParams.append(s,`in.(${o})`),this}contains(s,l){return typeof l=="string"?this.url.searchParams.append(s,`cs.${l}`):Array.isArray(l)?this.url.searchParams.append(s,`cs.{${l.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(l)}`),this}containedBy(s,l){return typeof l=="string"?this.url.searchParams.append(s,`cd.${l}`):Array.isArray(l)?this.url.searchParams.append(s,`cd.{${l.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(l)}`),this}rangeGt(s,l){return this.url.searchParams.append(s,`sr.${l}`),this}rangeGte(s,l){return this.url.searchParams.append(s,`nxl.${l}`),this}rangeLt(s,l){return this.url.searchParams.append(s,`sl.${l}`),this}rangeLte(s,l){return this.url.searchParams.append(s,`nxr.${l}`),this}rangeAdjacent(s,l){return this.url.searchParams.append(s,`adj.${l}`),this}overlaps(s,l){return typeof l=="string"?this.url.searchParams.append(s,`ov.${l}`):this.url.searchParams.append(s,`ov.{${l.join(",")}}`),this}textSearch(s,l,{config:o,type:u}={}){let h="";u==="plain"?h="pl":u==="phrase"?h="ph":u==="websearch"&&(h="w");const x=o===void 0?"":`(${o})`;return this.url.searchParams.append(s,`${h}fts${x}.${l}`),this}match(s){return Object.entries(s).forEach(([l,o])=>{this.url.searchParams.append(l,`eq.${o}`)}),this}not(s,l,o){return this.url.searchParams.append(s,`not.${l}.${o}`),this}or(s,{foreignTable:l,referencedTable:o=l}={}){const u=o?`${o}.or`:"or";return this.url.searchParams.append(u,`(${s})`),this}filter(s,l,o){return this.url.searchParams.append(s,`${l}.${o}`),this}}return ol.default=r,ol}var cg;function n_(){if(cg)return cl;cg=1;var e=cl&&cl.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(cl,"__esModule",{value:!0});const t=e(Rh());class r{constructor(s,{headers:l={},schema:o,fetch:u}){this.url=s,this.headers=l,this.schema=o,this.fetch=u}select(s,{head:l=!1,count:o}={}){const u=l?"HEAD":"GET";let h=!1;const x=(s??"*").split("").map(p=>/\s/.test(p)&&!h?"":(p==='"'&&(h=!h),p)).join("");return this.url.searchParams.set("select",x),o&&(this.headers.Prefer=`count=${o}`),new t.default({method:u,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(s,{count:l,defaultToNull:o=!0}={}){const u="POST",h=[];if(this.headers.Prefer&&h.push(this.headers.Prefer),l&&h.push(`count=${l}`),o||h.push("missing=default"),this.headers.Prefer=h.join(","),Array.isArray(s)){const x=s.reduce((p,v)=>p.concat(Object.keys(v)),[]);if(x.length>0){const p=[...new Set(x)].map(v=>`"${v}"`);this.url.searchParams.set("columns",p.join(","))}}return new t.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}upsert(s,{onConflict:l,ignoreDuplicates:o=!1,count:u,defaultToNull:h=!0}={}){const x="POST",p=[`resolution=${o?"ignore":"merge"}-duplicates`];if(l!==void 0&&this.url.searchParams.set("on_conflict",l),this.headers.Prefer&&p.push(this.headers.Prefer),u&&p.push(`count=${u}`),h||p.push("missing=default"),this.headers.Prefer=p.join(","),Array.isArray(s)){const v=s.reduce((_,y)=>_.concat(Object.keys(y)),[]);if(v.length>0){const _=[...new Set(v)].map(y=>`"${y}"`);this.url.searchParams.set("columns",_.join(","))}}return new t.default({method:x,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}update(s,{count:l}={}){const o="PATCH",u=[];return this.headers.Prefer&&u.push(this.headers.Prefer),l&&u.push(`count=${l}`),this.headers.Prefer=u.join(","),new t.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:this.fetch,allowEmpty:!1})}delete({count:s}={}){const l="DELETE",o=[];return s&&o.push(`count=${s}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),new t.default({method:l,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return cl.default=r,cl}var Ic={},Mc={},og;function XE(){return og||(og=1,Object.defineProperty(Mc,"__esModule",{value:!0}),Mc.version=void 0,Mc.version="0.0.0-automated"),Mc}var ug;function WE(){if(ug)return Ic;ug=1,Object.defineProperty(Ic,"__esModule",{value:!0}),Ic.DEFAULT_HEADERS=void 0;const e=XE();return Ic.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${e.version}`},Ic}var fg;function ZE(){if(fg)return ll;fg=1;var e=ll&&ll.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(ll,"__esModule",{value:!0});const t=e(n_()),r=e(Rh()),n=WE();class s{constructor(o,{headers:u={},schema:h,fetch:x}={}){this.url=o,this.headers=Object.assign(Object.assign({},n.DEFAULT_HEADERS),u),this.schemaName=h,this.fetch=x}from(o){const u=new URL(`${this.url}/${o}`);return new t.default(u,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(o){return new s(this.url,{headers:this.headers,schema:o,fetch:this.fetch})}rpc(o,u={},{head:h=!1,get:x=!1,count:p}={}){let v;const _=new URL(`${this.url}/rpc/${o}`);let y;h||x?(v=h?"HEAD":"GET",Object.entries(u).filter(([b,E])=>E!==void 0).map(([b,E])=>[b,Array.isArray(E)?`{${E.join(",")}}`:`${E}`]).forEach(([b,E])=>{_.searchParams.append(b,E)})):(v="POST",y=u);const w=Object.assign({},this.headers);return p&&(w.Prefer=`count=${p}`),new r.default({method:v,url:_,headers:w,schema:this.schemaName,body:y,fetch:this.fetch,allowEmpty:!1})}}return ll.default=s,ll}var dg;function KE(){if(dg)return Nr;dg=1;var e=Nr&&Nr.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(Nr,"__esModule",{value:!0}),Nr.PostgrestError=Nr.PostgrestBuilder=Nr.PostgrestTransformBuilder=Nr.PostgrestFilterBuilder=Nr.PostgrestQueryBuilder=Nr.PostgrestClient=void 0;const t=e(ZE());Nr.PostgrestClient=t.default;const r=e(n_());Nr.PostgrestQueryBuilder=r.default;const n=e(Rh());Nr.PostgrestFilterBuilder=n.default;const s=e(a_());Nr.PostgrestTransformBuilder=s.default;const l=e(r_());Nr.PostgrestBuilder=l.default;const o=e(t_());return Nr.PostgrestError=o.default,Nr.default={PostgrestClient:t.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:s.default,PostgrestBuilder:l.default,PostgrestError:o.default},Nr}var JE=KE();const QE=Ch(JE),{PostgrestClient:eT,PostgrestQueryBuilder:p8,PostgrestFilterBuilder:g8,PostgrestTransformBuilder:v8,PostgrestBuilder:_8,PostgrestError:y8}=QE;function tT(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const rT=tT(),aT="2.11.15",nT=`realtime-js/${aT}`,sT="1.0.0",s_=1e4,iT=1e3;var Gc;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Gc||(Gc={}));var Gr;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Gr||(Gr={}));var en;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(en||(en={}));var nh;(function(e){e.websocket="websocket"})(nh||(nh={}));var si;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(si||(si={}));class lT{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const s=r.getUint8(1),l=r.getUint8(2);let o=this.HEADER_LENGTH+2;const u=n.decode(t.slice(o,o+s));o=o+s;const h=n.decode(t.slice(o,o+l));o=o+l;const x=JSON.parse(n.decode(t.slice(o,t.byteLength)));return{ref:null,topic:u,event:h,payload:x}}}class i_{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Gt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Gt||(Gt={}));const hg=(e,t,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((l,o)=>(l[o]=cT(o,e,t,s),l),{})},cT=(e,t,r,n)=>{const s=t.find(u=>u.name===e),l=s==null?void 0:s.type,o=r[e];return l&&!n.includes(l)?l_(l,o):sh(o)},l_=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return dT(t,r)}switch(e){case Gt.bool:return oT(t);case Gt.float4:case Gt.float8:case Gt.int2:case Gt.int4:case Gt.int8:case Gt.numeric:case Gt.oid:return uT(t);case Gt.json:case Gt.jsonb:return fT(t);case Gt.timestamp:return hT(t);case Gt.abstime:case Gt.date:case Gt.daterange:case Gt.int4range:case Gt.int8range:case Gt.money:case Gt.reltime:case Gt.text:case Gt.time:case Gt.timestamptz:case Gt.timetz:case Gt.tsrange:case Gt.tstzrange:return sh(t);default:return sh(t)}},sh=e=>e,oT=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},uT=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},fT=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},dT=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let l;const o=e.slice(1,r);try{l=JSON.parse("["+o+"]")}catch{l=o?o.split(","):[]}return l.map(u=>l_(t,u))}return e},hT=e=>typeof e=="string"?e.replace(" ","T"):e,c_=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class Ld{constructor(t,r,n={},s=s_){this.channel=t,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var xg;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(xg||(xg={}));class Vc{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:l,onLeave:o,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Vc.syncState(this.state,s,l,o),this.pendingDiffs.forEach(h=>{this.state=Vc.syncDiff(this.state,h,l,o)}),this.pendingDiffs=[],u()}),this.channel._on(n.diff,{},s=>{const{onJoin:l,onLeave:o,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Vc.syncDiff(this.state,s,l,o),u())}),this.onJoin((s,l,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:l,newPresences:o})}),this.onLeave((s,l,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:l,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,s){const l=this.cloneDeep(t),o=this.transformState(r),u={},h={};return this.map(l,(x,p)=>{o[x]||(h[x]=p)}),this.map(o,(x,p)=>{const v=l[x];if(v){const _=p.map(E=>E.presence_ref),y=v.map(E=>E.presence_ref),w=p.filter(E=>y.indexOf(E.presence_ref)<0),b=v.filter(E=>_.indexOf(E.presence_ref)<0);w.length>0&&(u[x]=w),b.length>0&&(h[x]=b)}else u[x]=p}),this.syncDiff(l,{joins:u,leaves:h},n,s)}static syncDiff(t,r,n,s){const{joins:l,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(l,(u,h)=>{var x;const p=(x=t[u])!==null&&x!==void 0?x:[];if(t[u]=this.cloneDeep(h),p.length>0){const v=t[u].map(y=>y.presence_ref),_=p.filter(y=>v.indexOf(y.presence_ref)<0);t[u].unshift(..._)}n(u,p,h)}),this.map(o,(u,h)=>{let x=t[u];if(!x)return;const p=h.map(v=>v.presence_ref);x=x.filter(v=>p.indexOf(v.presence_ref)<0),t[u]=x,s(u,x,h),x.length===0&&delete t[u]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const s=t[n];return"metas"in s?r[n]=s.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):r[n]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var mg;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(mg||(mg={}));var pg;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(pg||(pg={}));var Un;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Un||(Un={}));class jh{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Gr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Ld(this,en.join,this.params,this.timeout),this.rejoinTimer=new i_(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Gr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Gr.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Gr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Gr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(en.reply,{},(s,l)=>{this._trigger(this._replyEventName(l),s)}),this.presence=new Vc(this),this.broadcastEndpointURL=c_(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,s;if(this.socket.isConnected()||this.socket.connect(),this.state==Gr.closed){const{config:{broadcast:l,presence:o,private:u}}=this.params;this._onError(p=>t==null?void 0:t(Un.CHANNEL_ERROR,p)),this._onClose(()=>t==null?void 0:t(Un.CLOSED));const h={},x={broadcast:l,presence:o,postgres_changes:(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(p=>p.filter))!==null&&s!==void 0?s:[],private:u};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:x},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:p})=>{var v;if(this.socket.setAuth(),p===void 0){t==null||t(Un.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,y=(v=_==null?void 0:_.length)!==null&&v!==void 0?v:0,w=[];for(let b=0;b<y;b++){const E=_[b],{filter:{event:j,schema:C,table:S,filter:L}}=E,Z=p&&p[b];if(Z&&Z.event===j&&Z.schema===C&&Z.table===S&&Z.filter===L)w.push(Object.assign(Object.assign({},E),{id:Z.id}));else{this.unsubscribe(),this.state=Gr.errored,t==null||t(Un.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,t&&t(Un.SUBSCRIBED);return}}).receive("error",p=>{this.state=Gr.errored,t==null||t(Un.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Un.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){const{event:l,payload:o}=t,h={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:o,private:this.private}]})};try{const x=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=x.body)===null||s===void 0?void 0:s.cancel()),x.ok?"ok":"error"}catch(x){return x.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var o,u,h;const x=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((h=(u=(o=this.params)===null||o===void 0?void 0:o.config)===null||u===void 0?void 0:u.broadcast)===null||h===void 0)&&h.ack)&&l("ok"),x.receive("ok",()=>l("ok")),x.receive("error",()=>l("error")),x.receive("timeout",()=>l("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Gr.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(en.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new Ld(this,en.leave,{},t),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(t,r,n){const s=new AbortController,l=setTimeout(()=>s.abort(),n),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(l),o}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Ld(this,t,r,n);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var s,l;const o=t.toLocaleLowerCase(),{close:u,error:h,leave:x,join:p}=en;if(n&&[u,h,x,p].indexOf(o)>=0&&n!==this._joinRef())return;let _=this._onMessage(o,r,n);if(r&&!_)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(y=>{var w,b,E;return((w=y.filter)===null||w===void 0?void 0:w.event)==="*"||((E=(b=y.filter)===null||b===void 0?void 0:b.event)===null||E===void 0?void 0:E.toLocaleLowerCase())===o}).map(y=>y.callback(_,n)):(l=this.bindings[o])===null||l===void 0||l.filter(y=>{var w,b,E,j,C,S;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in y){const L=y.id,Z=(w=y.filter)===null||w===void 0?void 0:w.event;return L&&((b=r.ids)===null||b===void 0?void 0:b.includes(L))&&(Z==="*"||(Z==null?void 0:Z.toLocaleLowerCase())===((E=r.data)===null||E===void 0?void 0:E.type.toLocaleLowerCase()))}else{const L=(C=(j=y==null?void 0:y.filter)===null||j===void 0?void 0:j.event)===null||C===void 0?void 0:C.toLocaleLowerCase();return L==="*"||L===((S=r==null?void 0:r.event)===null||S===void 0?void 0:S.toLocaleLowerCase())}else return y.type.toLocaleLowerCase()===o}).map(y=>{if(typeof _=="object"&&"ids"in _){const w=_.data,{schema:b,table:E,commit_timestamp:j,type:C,errors:S}=w;_=Object.assign(Object.assign({},{schema:b,table:E,commit_timestamp:j,eventType:C,new:{},old:{},errors:S}),this._getPayloadRecords(w))}y.callback(_,n)})}_isClosed(){return this.state===Gr.closed}_isJoined(){return this.state===Gr.joined}_isJoining(){return this.state===Gr.joining}_isLeaving(){return this.state===Gr.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const s=t.toLocaleLowerCase(),l={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(l):this.bindings[s]=[l],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(s=>{var l;return!(((l=s.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===n&&jh.isEqual(s.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(en.close,{},t)}_onError(t){this._on(en.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Gr.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=hg(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=hg(t.columns,t.old_record)),r}}const gg=()=>{},xT=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class mT{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=s_,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=gg,this.ref=0,this.logger=gg,this.conn=null,this.sendBuffer=[],this.serializer=new lT,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=l=>{let o;return l?o=l:typeof fetch>"u"?o=(...u)=>_o(async()=>{const{default:h}=await Promise.resolve().then(()=>Ml);return{default:h}},void 0).then(({default:h})=>h(...u)):o=fetch,(...u)=>o(...u)},this.endPoint=`${t}/${nh.websocket}`,this.httpEndpoint=c_(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),(r!=null&&r.logLevel||r!=null&&r.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const s=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:l=>[1e3,2e3,5e3,1e4][l-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(l,o)=>o(JSON.stringify(l)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new i_(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=rT),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:sT}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(n=>n.teardown()))}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Gc.connecting:return si.Connecting;case Gc.open:return si.Open;case Gc.closing:return si.Closing;default:return si.Closed}}isConnected(){return this.connectionState()===si.Open}channel(t,r={config:{}}){const n=`realtime:${t}`,s=this.getChannels().find(l=>l.topic===n);if(s)return s;{const l=new jh(`realtime:${t}`,r,this);return this.channels.push(l),l}}push(t){const{topic:r,event:n,payload:s,ref:l}=t,o=()=>{this.encode(t,u=>{var h;(h=this.conn)===null||h===void 0||h.send(u)})};this.log("push",`${r} ${n} (${l})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const s={access_token:r,version:nT};r&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(en.access_token,{access_token:r})}))}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(t=this.conn)===null||t===void 0||t.close(iT,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:s,payload:l,ref:o}=r;n==="phoenix"&&s==="phx_reply"&&this.heartbeatCallback(r.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${l.status||""} ${n} ${s} ${o&&"("+o+")"||""}`,l),Array.from(this.channels).filter(u=>u._isMember(n)).forEach(u=>u._trigger(s,l,o)),this.stateChangeCallbacks.message.forEach(u=>u(r))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(t=>t())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",`${t}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(en.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${n}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([xT],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class Ih extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Cr(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class pT extends Ih{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class ih extends Ih{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var gT=function(e,t,r,n){function s(l){return l instanceof r?l:new r(function(o){o(l)})}return new(r||(r=Promise))(function(l,o){function u(p){try{x(n.next(p))}catch(v){o(v)}}function h(p){try{x(n.throw(p))}catch(v){o(v)}}function x(p){p.done?l(p.value):s(p.value).then(u,h)}x((n=n.apply(e,t||[])).next())})};const o_=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>_o(async()=>{const{default:n}=await Promise.resolve().then(()=>Ml);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},vT=()=>gT(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield _o(()=>Promise.resolve().then(()=>Ml),void 0)).Response:Response}),lh=e=>{if(Array.isArray(e))return e.map(r=>lh(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));t[s]=lh(n)}),t};var _i=function(e,t,r,n){function s(l){return l instanceof r?l:new r(function(o){o(l)})}return new(r||(r=Promise))(function(l,o){function u(p){try{x(n.next(p))}catch(v){o(v)}}function h(p){try{x(n.throw(p))}catch(v){o(v)}}function x(p){p.done?l(p.value):s(p.value).then(u,h)}x((n=n.apply(e,t||[])).next())})};const Fd=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),_T=(e,t,r)=>_i(void 0,void 0,void 0,function*(){const n=yield vT();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(s=>{t(new pT(Fd(s),e.status||500))}).catch(s=>{t(new ih(Fd(s),s))}):t(new ih(Fd(e),e))}),yT=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(s.body=JSON.stringify(n)),Object.assign(Object.assign({},s),r))};function yo(e,t,r,n,s,l){return _i(this,void 0,void 0,function*(){return new Promise((o,u)=>{e(r,yT(t,n,s,l)).then(h=>{if(!h.ok)throw h;return n!=null&&n.noResolveJson?h:h.json()}).then(h=>o(h)).catch(h=>_T(h,u,n))})})}function eu(e,t,r,n){return _i(this,void 0,void 0,function*(){return yo(e,"GET",t,r,n)})}function bs(e,t,r,n,s){return _i(this,void 0,void 0,function*(){return yo(e,"POST",t,n,s,r)})}function wT(e,t,r,n,s){return _i(this,void 0,void 0,function*(){return yo(e,"PUT",t,n,s,r)})}function bT(e,t,r,n){return _i(this,void 0,void 0,function*(){return yo(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function u_(e,t,r,n,s){return _i(this,void 0,void 0,function*(){return yo(e,"DELETE",t,n,s,r)})}var fa=function(e,t,r,n){function s(l){return l instanceof r?l:new r(function(o){o(l)})}return new(r||(r=Promise))(function(l,o){function u(p){try{x(n.next(p))}catch(v){o(v)}}function h(p){try{x(n.throw(p))}catch(v){o(v)}}function x(p){p.done?l(p.value):s(p.value).then(u,h)}x((n=n.apply(e,t||[])).next())})};const ET={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},vg={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class TT{constructor(t,r={},n,s){this.url=t,this.headers=r,this.bucketId=n,this.fetch=o_(s)}uploadOrUpdate(t,r,n,s){return fa(this,void 0,void 0,function*(){try{let l;const o=Object.assign(Object.assign({},vg),s);let u=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const h=o.metadata;typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",o.cacheControl),h&&l.append("metadata",this.encodeMetadata(h)),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",o.cacheControl),h&&l.append("metadata",this.encodeMetadata(h))):(l=n,u["cache-control"]=`max-age=${o.cacheControl}`,u["content-type"]=o.contentType,h&&(u["x-metadata"]=this.toBase64(this.encodeMetadata(h)))),s!=null&&s.headers&&(u=Object.assign(Object.assign({},u),s.headers));const x=this._removeEmptyFolders(r),p=this._getFinalPath(x),v=yield this.fetch(`${this.url}/object/${p}`,Object.assign({method:t,body:l,headers:u},o!=null&&o.duplex?{duplex:o.duplex}:{})),_=yield v.json();return v.ok?{data:{path:x,id:_.Id,fullPath:_.Key},error:null}:{data:null,error:_}}catch(l){if(Cr(l))return{data:null,error:l};throw l}})}upload(t,r,n){return fa(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,s){return fa(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(t),o=this._getFinalPath(l),u=new URL(this.url+`/object/upload/sign/${o}`);u.searchParams.set("token",r);try{let h;const x=Object.assign({upsert:vg.upsert},s),p=Object.assign(Object.assign({},this.headers),{"x-upsert":String(x.upsert)});typeof Blob<"u"&&n instanceof Blob?(h=new FormData,h.append("cacheControl",x.cacheControl),h.append("",n)):typeof FormData<"u"&&n instanceof FormData?(h=n,h.append("cacheControl",x.cacheControl)):(h=n,p["cache-control"]=`max-age=${x.cacheControl}`,p["content-type"]=x.contentType);const v=yield this.fetch(u.toString(),{method:"PUT",body:h,headers:p}),_=yield v.json();return v.ok?{data:{path:l,fullPath:_.Key},error:null}:{data:null,error:_}}catch(h){if(Cr(h))return{data:null,error:h};throw h}})}createSignedUploadUrl(t,r){return fa(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const s=Object.assign({},this.headers);r!=null&&r.upsert&&(s["x-upsert"]="true");const l=yield bs(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),o=new URL(this.url+l.url),u=o.searchParams.get("token");if(!u)throw new Ih("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:u},error:null}}catch(n){if(Cr(n))return{data:null,error:n};throw n}})}update(t,r,n){return fa(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return fa(this,void 0,void 0,function*(){try{return{data:yield bs(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(Cr(s))return{data:null,error:s};throw s}})}copy(t,r,n){return fa(this,void 0,void 0,function*(){try{return{data:{path:(yield bs(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(Cr(s))return{data:null,error:s};throw s}})}createSignedUrl(t,r,n){return fa(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),l=yield bs(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${o}`)},{data:l,error:null}}catch(s){if(Cr(s))return{data:null,error:s};throw s}})}createSignedUrls(t,r,n){return fa(this,void 0,void 0,function*(){try{const s=yield bs(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),l=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${l}`):null})),error:null}}catch(s){if(Cr(s))return{data:null,error:s};throw s}})}download(t,r){return fa(this,void 0,void 0,function*(){const s=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),o=l?`?${l}`:"";try{const u=this._getFinalPath(t);return{data:yield(yield eu(this.fetch,`${this.url}/${s}/${u}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(u){if(Cr(u))return{data:null,error:u};throw u}})}info(t){return fa(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield eu(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:lh(n),error:null}}catch(n){if(Cr(n))return{data:null,error:n};throw n}})}exists(t){return fa(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield bT(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Cr(n)&&n instanceof ih){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),s=[],l=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";l!==""&&s.push(l);const u=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",h=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});h!==""&&s.push(h);let x=s.join("&");return x!==""&&(x=`?${x}`),{data:{publicUrl:encodeURI(`${this.url}/${u}/public/${n}${x}`)}}}remove(t){return fa(this,void 0,void 0,function*(){try{return{data:yield u_(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(Cr(r))return{data:null,error:r};throw r}})}list(t,r,n){return fa(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},ET),r),{prefix:t||""});return{data:yield bs(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(Cr(s))return{data:null,error:s};throw s}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const ST="2.7.1",kT={"X-Client-Info":`storage-js/${ST}`};var dl=function(e,t,r,n){function s(l){return l instanceof r?l:new r(function(o){o(l)})}return new(r||(r=Promise))(function(l,o){function u(p){try{x(n.next(p))}catch(v){o(v)}}function h(p){try{x(n.throw(p))}catch(v){o(v)}}function x(p){p.done?l(p.value):s(p.value).then(u,h)}x((n=n.apply(e,t||[])).next())})};class AT{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},kT),r),this.fetch=o_(n)}listBuckets(){return dl(this,void 0,void 0,function*(){try{return{data:yield eu(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Cr(t))return{data:null,error:t};throw t}})}getBucket(t){return dl(this,void 0,void 0,function*(){try{return{data:yield eu(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(Cr(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return dl(this,void 0,void 0,function*(){try{return{data:yield bs(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Cr(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return dl(this,void 0,void 0,function*(){try{return{data:yield wT(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Cr(n))return{data:null,error:n};throw n}})}emptyBucket(t){return dl(this,void 0,void 0,function*(){try{return{data:yield bs(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Cr(r))return{data:null,error:r};throw r}})}deleteBucket(t){return dl(this,void 0,void 0,function*(){try{return{data:yield u_(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(Cr(r))return{data:null,error:r};throw r}})}}class NT extends AT{constructor(t,r={},n){super(t,r,n)}from(t){return new TT(this.url,this.headers,t,this.fetch)}}const CT="2.50.3";let Lc="";typeof Deno<"u"?Lc="deno":typeof document<"u"?Lc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Lc="react-native":Lc="node";const OT={"X-Client-Info":`supabase-js-${Lc}/${CT}`},DT={headers:OT},RT={schema:"public"},jT={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},IT={};var MT=function(e,t,r,n){function s(l){return l instanceof r?l:new r(function(o){o(l)})}return new(r||(r=Promise))(function(l,o){function u(p){try{x(n.next(p))}catch(v){o(v)}}function h(p){try{x(n.throw(p))}catch(v){o(v)}}function x(p){p.done?l(p.value):s(p.value).then(u,h)}x((n=n.apply(e,t||[])).next())})};const LT=e=>{let t;return e?t=e:typeof fetch>"u"?t=Q2:t=fetch,(...r)=>t(...r)},FT=()=>typeof Headers>"u"?e_:Headers,UT=(e,t,r)=>{const n=LT(r),s=FT();return(l,o)=>MT(void 0,void 0,void 0,function*(){var u;const h=(u=yield t())!==null&&u!==void 0?u:e;let x=new s(o==null?void 0:o.headers);return x.has("apikey")||x.set("apikey",e),x.has("Authorization")||x.set("Authorization",`Bearer ${h}`),n(l,Object.assign(Object.assign({},o),{headers:x}))})};var BT=function(e,t,r,n){function s(l){return l instanceof r?l:new r(function(o){o(l)})}return new(r||(r=Promise))(function(l,o){function u(p){try{x(n.next(p))}catch(v){o(v)}}function h(p){try{x(n.throw(p))}catch(v){o(v)}}function x(p){p.done?l(p.value):s(p.value).then(u,h)}x((n=n.apply(e,t||[])).next())})};function PT(e){return e.endsWith("/")?e:e+"/"}function HT(e,t){var r,n;const{db:s,auth:l,realtime:o,global:u}=e,{db:h,auth:x,realtime:p,global:v}=t,_={db:Object.assign(Object.assign({},h),s),auth:Object.assign(Object.assign({},x),l),realtime:Object.assign(Object.assign({},p),o),global:Object.assign(Object.assign(Object.assign({},v),u),{headers:Object.assign(Object.assign({},(r=v==null?void 0:v.headers)!==null&&r!==void 0?r:{}),(n=u==null?void 0:u.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>BT(this,void 0,void 0,function*(){return""})};return e.accessToken?_.accessToken=e.accessToken:delete _.accessToken,_}const f_="2.70.0",_l=30*1e3,ch=3,Ud=ch*_l,zT="http://localhost:9999",GT="supabase.auth.token",VT={"X-Client-Info":`gotrue-js/${f_}`},oh="X-Supabase-Api-Version",d_={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},$T=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,YT=6e5;class Mh extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function st(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class qT extends Mh{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function XT(e){return st(e)&&e.name==="AuthApiError"}class h_ extends Mh{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Ls extends Mh{constructor(t,r,n,s){super(t,n,s),this.name=r,this.status=n}}class ws extends Ls{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function WT(e){return st(e)&&e.name==="AuthSessionMissingError"}class B0 extends Ls{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class P0 extends Ls{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class H0 extends Ls{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function ZT(e){return st(e)&&e.name==="AuthImplicitGrantRedirectError"}class _g extends Ls{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class uh extends Ls{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Bd(e){return st(e)&&e.name==="AuthRetryableFetchError"}class yg extends Ls{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class $c extends Ls{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const tu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),wg=` 	
\r=`.split(""),KT=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<wg.length;t+=1)e[wg[t].charCodeAt(0)]=-2;for(let t=0;t<tu.length;t+=1)e[tu[t].charCodeAt(0)]=t;return e})();function bg(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(tu[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(tu[n]),t.queuedBits-=6}}function x_(e,t,r){const n=KT[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Eg(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},l=o=>{eS(o,n,r)};for(let o=0;o<e.length;o+=1)x_(e.charCodeAt(o),s,l);return t.join("")}function JT(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function QT(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}JT(n,t)}}function eS(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if((e>>7-n&1)===0){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function tS(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)x_(e.charCodeAt(s),r,n);return new Uint8Array(t)}function rS(e){const t=[];return QT(e,r=>t.push(r)),new Uint8Array(t)}function aS(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};return e.forEach(s=>bg(s,r,n)),bg(null,r,n),t.join("")}function nS(e){return Math.round(Date.now()/1e3)+e}function sS(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Qa=()=>typeof window<"u"&&typeof document<"u",ai={tested:!1,writable:!1},Yc=()=>{if(!Qa())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ai.tested)return ai.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),ai.tested=!0,ai.writable=!0}catch{ai.tested=!0,ai.writable=!1}return ai.writable};function iS(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,l)=>{t[l]=s})}catch{}return r.searchParams.forEach((n,s)=>{t[s]=n}),t}const m_=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>_o(async()=>{const{default:n}=await Promise.resolve().then(()=>Ml);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},lS=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",p_=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},z0=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},G0=async(e,t)=>{await e.removeItem(t)};class yu{constructor(){this.promise=new yu.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}yu.promiseConstructor=Promise;function Pd(e){const t=e.split(".");if(t.length!==3)throw new $c("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!$T.test(t[n]))throw new $c("JWT not in base64url format");return{header:JSON.parse(Eg(t[0])),payload:JSON.parse(Eg(t[1])),signature:tS(t[2]),raw:{header:t[0],payload:t[1]}}}async function cS(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function oS(e,t){return new Promise((n,s)=>{(async()=>{for(let l=0;l<1/0;l++)try{const o=await e(l);if(!t(l,null,o)){n(o);return}}catch(o){if(!t(l,o)){s(o);return}}})()})}function uS(e){return("0"+e.toString(16)).substr(-2)}function fS(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let l=0;l<56;l++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,uS).join("")}async function dS(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(l=>String.fromCharCode(l)).join("")}async function hS(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await dS(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function hl(e,t,r=!1){const n=fS();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await p_(e,`${t}-code-verifier`,s);const l=await hS(n);return[l,n===l?"plain":"s256"]}const xS=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function mS(e){const t=e.headers.get(oh);if(!t||!t.match(xS))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function pS(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function gS(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const vS=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function xl(e){if(!vS.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var _S=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};const ni=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),yS=[502,503,504];async function Tg(e){var t;if(!lS(e))throw new uh(ni(e),0);if(yS.includes(e.status))throw new uh(ni(e),e.status);let r;try{r=await e.json()}catch(l){throw new h_(ni(l),l)}let n;const s=mS(e);if(s&&s.getTime()>=d_["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new yg(ni(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new ws}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((l,o)=>l&&typeof o=="string",!0))throw new yg(ni(r),e.status,r.weak_password.reasons);throw new qT(ni(r),e.status||500,n)}const wS=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function pt(e,t,r,n){var s;const l=Object.assign({},n==null?void 0:n.headers);l[oh]||(l[oh]=d_["2024-01-01"].name),n!=null&&n.jwt&&(l.Authorization=`Bearer ${n.jwt}`);const o=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const u=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",h=await bS(e,t,r+u,{headers:l,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(h):{data:Object.assign({},h),error:null}}async function bS(e,t,r,n,s,l){const o=wS(t,n,s,l);let u;try{u=await e(r,Object.assign({},o))}catch(h){throw console.error(h),new uh(ni(h),0)}if(u.ok||await Tg(u),n!=null&&n.noResolveJson)return u;try{return await u.json()}catch(h){await Tg(h)}}function Fn(e){var t;let r=null;kS(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=nS(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function Sg(e){const t=Fn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Ts(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function ES(e){return{data:e,error:null}}function TS(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:l}=e,o=_S(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:l},h=Object.assign({},o);return{data:{properties:u,user:h},error:null}}function SS(e){return e}function kS(e){return e.access_token&&e.refresh_token&&e.expires_in}const Hd=["global","local","others"];var AS=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};class NS{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=m_(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=Hd[0]){if(Hd.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Hd.join(", ")}`);try{return await pt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(st(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await pt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Ts})}catch(n){if(st(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=AS(t,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await pt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:TS,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(st(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await pt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Ts})}catch(r){if(st(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,s,l,o,u,h;try{const x={nextPage:null,lastPage:0,total:0},p=await pt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(l=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:""},xform:SS});if(p.error)throw p.error;const v=await p.json(),_=(o=p.headers.get("x-total-count"))!==null&&o!==void 0?o:0,y=(h=(u=p.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&h!==void 0?h:[];return y.length>0&&(y.forEach(w=>{const b=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),E=JSON.parse(w.split(";")[1].split("=")[1]);x[`${E}Page`]=b}),x.total=parseInt(_)),{data:Object.assign(Object.assign({},v),x),error:null}}catch(x){if(st(x))return{data:{users:[]},error:x};throw x}}async getUserById(t){xl(t);try{return await pt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Ts})}catch(r){if(st(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){xl(t);try{return await pt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Ts})}catch(n){if(st(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){xl(t);try{return await pt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Ts})}catch(n){if(st(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){xl(t.userId);try{const{data:r,error:n}=await pt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(st(r))return{data:null,error:r};throw r}}async _deleteFactor(t){xl(t.userId),xl(t.id);try{return{data:await pt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(st(r))return{data:null,error:r};throw r}}}const CS={getItem:e=>Yc()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{Yc()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{Yc()&&globalThis.localStorage.removeItem(e)}};function kg(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function OS(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const ml={debug:!!(globalThis&&Yc()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class g_ extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class DS extends g_{}async function RS(e,t,r){ml.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),ml.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){ml.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{ml.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw ml.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new DS(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(ml.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}OS();const jS={url:zT,storageKey:GT,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:VT,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Ag(e,t,r){return await r()}class ro{constructor(t){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ro.nextInstanceID,ro.nextInstanceID+=1,this.instanceID>0&&Qa()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},jS),t);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new NS({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=m_(s.fetch),this.lock=s.lock||Ag,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:Qa()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=RS:this.lock=Ag,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:Yc()?this.storage=CS:(this.memoryStorage={},this.storage=kg(this.memoryStorage)):(this.memoryStorage={},this.storage=kg(this.memoryStorage)),Qa()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${f_}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=iS(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Qa()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:l}=await this._getSessionFromURL(r,n);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),ZT(l)){const h=(t=l.details)===null||t===void 0?void 0:t.code;if(h==="identity_already_exists"||h==="identity_not_found"||h==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:o,redirectType:u}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",u),await this._saveSession(o),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return st(r)?{error:r}:{error:new h_("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,s;try{const l=await pt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:Fn}),{data:o,error:u}=l;if(u||!o)return{data:{user:null,session:null},error:u};const h=o.session,x=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",h)),{data:{user:x,session:h},error:null}}catch(l){if(st(l))return{data:{user:null,session:null},error:l};throw l}}async signUp(t){var r,n,s;try{let l;if("email"in t){const{email:p,password:v,options:_}=t;let y=null,w=null;this.flowType==="pkce"&&([y,w]=await hl(this.storage,this.storageKey)),l=await pt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:_==null?void 0:_.emailRedirectTo,body:{email:p,password:v,data:(r=_==null?void 0:_.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken},code_challenge:y,code_challenge_method:w},xform:Fn})}else if("phone"in t){const{phone:p,password:v,options:_}=t;l=await pt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:p,password:v,data:(n=_==null?void 0:_.data)!==null&&n!==void 0?n:{},channel:(s=_==null?void 0:_.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken}},xform:Fn})}else throw new P0("You must provide either an email or phone number and a password");const{data:o,error:u}=l;if(u||!o)return{data:{user:null,session:null},error:u};const h=o.session,x=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",h)),{data:{user:x,session:h},error:null}}catch(l){if(st(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithPassword(t){try{let r;if("email"in t){const{email:l,password:o,options:u}=t;r=await pt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:o,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken}},xform:Sg})}else if("phone"in t){const{phone:l,password:o,options:u}=t;r=await pt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:o,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken}},xform:Sg})}else throw new P0("You must provide either an email or phone number and a password");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new B0}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(st(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,s,l;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(l=t.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,s,l,o,u,h,x,p,v,_,y;let w,b;if("message"in t)w=t.message,b=t.signature;else{const{chain:E,wallet:j,statement:C,options:S}=t;let L;if(Qa())if(typeof j=="object")L=j;else{const W=window;if("solana"in W&&typeof W.solana=="object"&&("signIn"in W.solana&&typeof W.solana.signIn=="function"||"signMessage"in W.solana&&typeof W.solana.signMessage=="function"))L=W.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof j!="object"||!(S!=null&&S.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");L=j}const Z=new URL((r=S==null?void 0:S.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in L&&L.signIn){const W=await L.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},S==null?void 0:S.signInWithSolana),{version:"1",domain:Z.host,uri:Z.href}),C?{statement:C}:null));let I;if(Array.isArray(W)&&W[0]&&typeof W[0]=="object")I=W[0];else if(W&&typeof W=="object"&&"signedMessage"in W&&"signature"in W)I=W;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in I&&"signature"in I&&(typeof I.signedMessage=="string"||I.signedMessage instanceof Uint8Array)&&I.signature instanceof Uint8Array)w=typeof I.signedMessage=="string"?I.signedMessage:new TextDecoder().decode(I.signedMessage),b=I.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in L)||typeof L.signMessage!="function"||!("publicKey"in L)||typeof L!="object"||!L.publicKey||!("toBase58"in L.publicKey)||typeof L.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${Z.host} wants you to sign in with your Solana account:`,L.publicKey.toBase58(),...C?["",C,""]:[""],"Version: 1",`URI: ${Z.href}`,`Issued At: ${(s=(n=S==null?void 0:S.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((l=S==null?void 0:S.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${S.signInWithSolana.notBefore}`]:[],...!((o=S==null?void 0:S.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${S.signInWithSolana.expirationTime}`]:[],...!((u=S==null?void 0:S.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${S.signInWithSolana.chainId}`]:[],...!((h=S==null?void 0:S.signInWithSolana)===null||h===void 0)&&h.nonce?[`Nonce: ${S.signInWithSolana.nonce}`]:[],...!((x=S==null?void 0:S.signInWithSolana)===null||x===void 0)&&x.requestId?[`Request ID: ${S.signInWithSolana.requestId}`]:[],...!((v=(p=S==null?void 0:S.signInWithSolana)===null||p===void 0?void 0:p.resources)===null||v===void 0)&&v.length?["Resources",...S.signInWithSolana.resources.map(I=>`- ${I}`)]:[]].join(`
`);const W=await L.signMessage(new TextEncoder().encode(w),"utf8");if(!W||!(W instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");b=W}}try{const{data:E,error:j}=await pt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:aS(b)},!((_=t.options)===null||_===void 0)&&_.captchaToken?{gotrue_meta_security:{captcha_token:(y=t.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:Fn});if(j)throw j;return!E||!E.session||!E.user?{data:{user:null,session:null},error:new B0}:(E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("SIGNED_IN",E.session)),{data:Object.assign({},E),error:j})}catch(E){if(st(E))return{data:{user:null,session:null},error:E};throw E}}async _exchangeCodeForSession(t){const r=await z0(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:l,error:o}=await pt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Fn});if(await G0(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!l||!l.session||!l.user?{data:{user:null,session:null,redirectType:null},error:new B0}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign(Object.assign({},l),{redirectType:s??null}),error:o})}catch(l){if(st(l))return{data:{user:null,session:null,redirectType:null},error:l};throw l}}async signInWithIdToken(t){try{const{options:r,provider:n,token:s,access_token:l,nonce:o}=t,u=await pt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:l,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Fn}),{data:h,error:x}=u;return x?{data:{user:null,session:null},error:x}:!h||!h.session||!h.user?{data:{user:null,session:null},error:new B0}:(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),{data:h,error:x})}catch(r){if(st(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,s,l,o;try{if("email"in t){const{email:u,options:h}=t;let x=null,p=null;this.flowType==="pkce"&&([x,p]=await hl(this.storage,this.storageKey));const{error:v}=await pt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},create_user:(n=h==null?void 0:h.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:x,code_challenge_method:p},redirectTo:h==null?void 0:h.emailRedirectTo});return{data:{user:null,session:null},error:v}}if("phone"in t){const{phone:u,options:h}=t,{data:x,error:p}=await pt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(s=h==null?void 0:h.data)!==null&&s!==void 0?s:{},create_user:(l=h==null?void 0:h.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},channel:(o=h==null?void 0:h.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:x==null?void 0:x.message_id},error:p}}throw new P0("You must provide either an email or phone number.")}catch(u){if(st(u))return{data:{user:null,session:null},error:u};throw u}}async verifyOtp(t){var r,n;try{let s,l;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,l=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:u}=await pt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:l}}),redirectTo:s,xform:Fn});if(u)throw u;if(!o)throw new Error("An error occurred on token verification.");const h=o.session,x=o.user;return h!=null&&h.access_token&&(await this._saveSession(h),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",h)),{data:{user:x,session:h},error:null}}catch(s){if(st(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(t){var r,n,s;try{let l=null,o=null;return this.flowType==="pkce"&&([l,o]=await hl(this.storage,this.storageKey)),await pt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:o}),headers:this.headers,xform:ES})}catch(l){if(st(l))return{data:null,error:l};throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new ws;const{error:s}=await pt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(t){if(st(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:l}=t,{error:o}=await pt(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in t){const{phone:n,type:s,options:l}=t,{data:o,error:u}=await pt(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:u}}throw new P0("You must provide either an email or phone number and a type")}catch(r){if(st(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await z0(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Ud:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.storage.isServer){let o=this.suppressGetSessionWarning;t=new Proxy(t,{get:(h,x,p)=>(!o&&x==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(h,x,p))})}return{data:{session:t},error:null}}const{session:s,error:l}=await this._callRefreshToken(t.refresh_token);return l?{data:{session:null},error:l}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await pt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Ts}):await this._useSession(async r=>{var n,s,l;const{data:o,error:u}=r;if(u)throw u;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ws}:await pt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&l!==void 0?l:void 0,xform:Ts})})}catch(r){if(st(r))return WT(r)&&(await this._removeSession(),await G0(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:s,error:l}=n;if(l)throw l;if(!s.session)throw new ws;const o=s.session;let u=null,h=null;this.flowType==="pkce"&&t.email!=null&&([u,h]=await hl(this.storage,this.storageKey));const{data:x,error:p}=await pt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:u,code_challenge_method:h}),jwt:o.access_token,xform:Ts});if(p)throw p;return o.user=x.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(n){if(st(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new ws;const r=Date.now()/1e3;let n=r,s=!0,l=null;const{payload:o}=Pd(t.access_token);if(o.exp&&(n=o.exp,s=n<=r),s){const{session:u,error:h}=await this._callRefreshToken(t.refresh_token);if(h)return{data:{user:null,session:null},error:h};if(!u)return{data:{user:null,session:null},error:null};l=u}else{const{data:u,error:h}=await this._getUser(t.access_token);if(h)throw h;l={access_token:t.access_token,refresh_token:t.refresh_token,user:u.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return{data:{user:l.user,session:l},error:null}}catch(r){if(st(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:o,error:u}=r;if(u)throw u;t=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new ws;const{session:s,error:l}=await this._callRefreshToken(t.refresh_token);return l?{data:{user:null,session:null},error:l}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(st(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!Qa())throw new H0("No browser detected.");if(t.error||t.error_description||t.error_code)throw new H0(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new _g("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new H0("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new _g("No code detected.");const{data:C,error:S}=await this._exchangeCodeForSession(t.code);if(S)throw S;const L=new URL(window.location.href);return L.searchParams.delete("code"),window.history.replaceState(window.history.state,"",L.toString()),{data:{session:C.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:l,refresh_token:o,expires_in:u,expires_at:h,token_type:x}=t;if(!l||!u||!o||!x)throw new H0("No session defined in URL");const p=Math.round(Date.now()/1e3),v=parseInt(u);let _=p+v;h&&(_=parseInt(h));const y=_-p;y*1e3<=_l&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${y}s, should have been closer to ${v}s`);const w=_-v;p-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,_,p):p-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,_,p);const{data:b,error:E}=await this._getUser(l);if(E)throw E;const j={provider_token:n,provider_refresh_token:s,access_token:l,expires_in:v,expires_at:_,refresh_token:o,token_type:x,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:j,redirectType:t.type},error:null}}catch(n){if(st(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await z0(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:l}=r;if(l)return{error:l};const o=(n=s.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:u}=await this.admin.signOut(o,t);if(u&&!(XT(u)&&(u.status===404||u.status===401||u.status===403)))return{error:u}}return t!=="others"&&(await this._removeSession(),await G0(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=sS(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,s;try{const{data:{session:l},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",t,"session",l)}catch(l){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",l),console.error(l)}})}async resetPasswordForEmail(t,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await hl(this.storage,this.storageKey,!0));try{return await pt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(l){if(st(l))return{data:null,error:l};throw l}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(st(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:s}=await this._useSession(async l=>{var o,u,h,x,p;const{data:v,error:_}=l;if(_)throw _;const y=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(u=t.options)===null||u===void 0?void 0:u.scopes,queryParams:(h=t.options)===null||h===void 0?void 0:h.queryParams,skipBrowserRedirect:!0});return await pt(this.fetch,"GET",y,{headers:this.headers,jwt:(p=(x=v.session)===null||x===void 0?void 0:x.access_token)!==null&&p!==void 0?p:void 0})});if(s)throw s;return Qa()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(st(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,s;const{data:l,error:o}=r;if(o)throw o;return await pt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=l.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(st(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await oS(async s=>(s>0&&await cS(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await pt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Fn})),(s,l)=>{const o=200*Math.pow(2,s);return l&&Bd(l)&&Date.now()+o-n<_l})}catch(n){if(this._debug(r,"error",n),st(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),Qa()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await z0(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const s=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Ud;if(this._debug(r,`session has${s?"":" not"} expired with margin of ${Ud}s`),s){if(this.autoRefreshToken&&n.refresh_token){const{error:l}=await this._callRefreshToken(n.refresh_token);l&&(console.error(l),Bd(l)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new ws;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new yu;const{data:l,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!l.session)throw new ws;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const u={session:l.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(l){if(this._debug(s,"error",l),st(l)){const o={session:null,error:l};return Bd(l)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(l),l}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const l=[],o=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(t,r)}catch(h){l.push(h)}});if(await Promise.all(o),l.length>0){for(let u=0;u<l.length;u+=1)console.error(l[u]);throw l[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await p_(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await G0(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Qa()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),_l);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/_l);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${_l}ms, refresh threshold is ${ch} ticks`),s<=ch&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof g_)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Qa()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[l,o]=await hl(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(u.toString())}if(n!=null&&n.queryParams){const l=new URLSearchParams(n.queryParams);s.push(l.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:s,error:l}=r;return l?{data:null,error:l}:await pt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(st(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,s;const{data:l,error:o}=r;if(o)return{data:null,error:o};const u=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:h,error:x}=await pt(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(n=l==null?void 0:l.session)===null||n===void 0?void 0:n.access_token});return x?{data:null,error:x}:(t.factorType==="totp"&&(!((s=h==null?void 0:h.totp)===null||s===void 0)&&s.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),{data:h,error:null})})}catch(r){if(st(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:l}=r;if(l)return{data:null,error:l};const{data:o,error:u}=await pt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:u})})}catch(r){if(st(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:l}=r;return l?{data:null,error:l}:await pt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(st(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],s=n.filter(o=>o.factor_type==="totp"&&o.status==="verified"),l=n.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:n,totp:s,phone:l},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:s},error:l}=t;if(l)return{data:null,error:l};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Pd(s.access_token);let u=null;o.aal&&(u=o.aal);let h=u;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(v=>v.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(h="aal2");const p=o.amr||[];return{data:{currentLevel:u,nextLevel:h,currentAuthenticationMethods:p},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n||(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+YT>Date.now()))return n;const{data:s,error:l}=await pt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;if(!s.keys||s.keys.length===0)throw new $c("JWKS is empty");if(this.jwks=s,this.jwks_cached_at=Date.now(),n=s.keys.find(o=>o.kid===t),!n)throw new $c("No matching signing key found in JWKS");return n}async getClaims(t,r={keys:[]}){try{let n=t;if(!n){const{data:y,error:w}=await this.getSession();if(w||!y.session)return{data:null,error:w};n=y.session.access_token}const{header:s,payload:l,signature:o,raw:{header:u,payload:h}}=Pd(n);if(pS(l.exp),!s.kid||s.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:y}=await this.getUser(n);if(y)throw y;return{data:{claims:l,header:s,signature:o},error:null}}const x=gS(s.alg),p=await this.fetchJwk(s.kid,r),v=await crypto.subtle.importKey("jwk",p,x,!0,["verify"]);if(!await crypto.subtle.verify(x,v,o,rS(`${u}.${h}`)))throw new $c("Invalid JWT signature");return{data:{claims:l,header:s,signature:o},error:null}}catch(n){if(st(n))return{data:null,error:n};throw n}}}ro.nextInstanceID=0;const IS=ro;class MS extends IS{constructor(t){super(t)}}var LS=function(e,t,r,n){function s(l){return l instanceof r?l:new r(function(o){o(l)})}return new(r||(r=Promise))(function(l,o){function u(p){try{x(n.next(p))}catch(v){o(v)}}function h(p){try{x(n.throw(p))}catch(v){o(v)}}function x(p){p.done?l(p.value):s(p.value).then(u,h)}x((n=n.apply(e,t||[])).next())})};class FS{constructor(t,r,n){var s,l,o;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const u=PT(t),h=new URL(u);this.realtimeUrl=new URL("realtime/v1",h),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",h),this.storageUrl=new URL("storage/v1",h),this.functionsUrl=new URL("functions/v1",h);const x=`sb-${h.hostname.split(".")[0]}-auth-token`,p={db:RT,realtime:IT,auth:Object.assign(Object.assign({},jT),{storageKey:x}),global:DT},v=HT(n??{},p);this.storageKey=(s=v.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(l=v.global.headers)!==null&&l!==void 0?l:{},v.accessToken?(this.accessToken=v.accessToken,this.auth=new Proxy({},{get:(_,y)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(y)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=v.auth)!==null&&o!==void 0?o:{},this.headers,v.global.fetch),this.fetch=UT(r,this._getAccessToken.bind(this),v.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},v.realtime)),this.rest=new eT(new URL("rest/v1",h).href,{headers:this.headers,schema:v.db.schema,fetch:this.fetch}),v.accessToken||this._listenForAuthEvents()}get functions(){return new zE(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new NT(this.storageUrl.href,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return LS(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,storageKey:l,flowType:o,lock:u,debug:h},x,p){const v={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new MS({url:this.authUrl.href,headers:Object.assign(Object.assign({},v),x),storageKey:l,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,flowType:o,lock:u,debug:h,fetch:p,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new mT(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const US=(e,t,r)=>new FS(e,t,r),BS="https://jfjbgqrwkneyyfylttkh.supabase.co",PS="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpmamJncXJ3a25leXlmeWx0dGtoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE4NzYyMTAsImV4cCI6MjA2NzQ1MjIxMH0.N7Q28PiuDQHL05LorPJ_5aYxYC-VGgs6t-IA3tZK9XQ",ar=US(BS,PS);class Bn{static async getProjects(){const{data:t,error:r}=await ar.from("projects").select(`
        *,
        project_members!inner(role)
      `).order("updated_at",{ascending:!1});if(r)throw new Error(`: ${r.message}`);return t.map(n=>{var s;return{id:n.id,title:n.title,goal:n.goal,targetDate:n.target_date,tasks:n.tasks_data||[],ganttData:n.gantt_data,createdAt:n.created_at,updatedAt:n.updated_at,ownerId:n.owner_id,isPublic:n.is_public,lastModifiedBy:n.last_modified_by,userRole:(s=n.project_members[0])==null?void 0:s.role}})}static async createProject(t,r,n,s=[],l){const{data:{user:o}}=await ar.auth.getUser();if(!o)throw new Error("");const{data:u,error:h}=await ar.from("projects").insert({owner_id:o.id,user_id:o.id,title:t,goal:r,target_date:n,tasks_data:s,gantt_data:l}).select().single();if(h)throw new Error(`: ${h.message}`);return{id:u.id,title:u.title,goal:u.goal,targetDate:u.target_date,tasks:u.tasks_data||[],ganttData:u.gantt_data,createdAt:u.created_at,updatedAt:u.updated_at,ownerId:u.owner_id,isPublic:u.is_public,lastModifiedBy:u.last_modified_by,userRole:"owner"}}static async updateProject(t,r){var o;const n={};r.title!==void 0&&(n.title=r.title),r.goal!==void 0&&(n.goal=r.goal),r.targetDate!==void 0&&(n.target_date=r.targetDate),r.tasks!==void 0&&(n.tasks_data=r.tasks),r.ganttData!==void 0&&(n.gantt_data=r.ganttData),r.isPublic!==void 0&&(n.is_public=r.isPublic);const{data:s,error:l}=await ar.from("projects").update(n).eq("id",t).select(`
        *,
        project_members!inner(role)
      `).single();if(l)throw new Error(`: ${l.message}`);return{id:s.id,title:s.title,goal:s.goal,targetDate:s.target_date,tasks:s.tasks_data||[],ganttData:s.gantt_data,createdAt:s.created_at,updatedAt:s.updated_at,ownerId:s.owner_id,isPublic:s.is_public,lastModifiedBy:s.last_modified_by,userRole:(o=s.project_members[0])==null?void 0:o.role}}static async deleteProject(t){const{error:r}=await ar.from("projects").delete().eq("id",t);if(r)throw new Error(`: ${r.message}`)}static async getProject(t){var s;const{data:r,error:n}=await ar.from("projects").select(`
        *,
        project_members!inner(role)
      `).eq("id",t).single();if(n)throw new Error(`: ${n.message}`);return{id:r.id,title:r.title,goal:r.goal,targetDate:r.target_date,tasks:r.tasks_data||[],ganttData:r.gantt_data,createdAt:r.created_at,updatedAt:r.updated_at,ownerId:r.owner_id,isPublic:r.is_public,lastModifiedBy:r.last_modified_by,userRole:(s=r.project_members[0])==null?void 0:s.role}}static async toggleProjectVisibility(t){const n=!(await this.getProject(t)).isPublic;return await this.updateProject(t,{isPublic:n}),n}}class Ha{static async getProjectMembers(t){const{data:r,error:n}=await ar.from("project_members").select(`
        *,
        users:user_id (email)
      `).eq("project_id",t).order("created_at",{ascending:!0});if(n)throw new Error(`: ${n.message}`);return r.map(s=>{var l;return{id:s.id,projectId:s.project_id,userId:s.user_id,role:s.role,invitedBy:s.invited_by,joinedAt:s.joined_at,userEmail:(l=s.users)==null?void 0:l.email}})}static async inviteToProject(t,r,n){const{data:{user:s}}=await ar.auth.getUser();if(!s)throw new Error("");const{data:l,error:o}=await ar.from("project_invitations").insert({project_id:t,email:r,role:n,invited_by:s.id}).select().single();if(o)throw o.code==="23505"?new Error(""):new Error(`: ${o.message}`);return{id:l.id,projectId:l.project_id,email:l.email,role:l.role,invitedBy:l.invited_by,token:l.token,expiresAt:l.expires_at,acceptedAt:l.accepted_at,createdAt:l.created_at}}static async getProjectInvitations(t){const{data:r,error:n}=await ar.from("project_invitations").select("*").eq("project_id",t).order("created_at",{ascending:!1});if(n)throw new Error(`: ${n.message}`);return r.map(s=>({id:s.id,projectId:s.project_id,email:s.email,role:s.role,invitedBy:s.invited_by,token:s.token,expiresAt:s.expires_at,acceptedAt:s.accepted_at,createdAt:s.created_at}))}static async acceptInvitation(t){const{data:r,error:n}=await ar.rpc("accept_project_invitation",{invitation_token:t});if(n)throw new Error(`: ${n.message}`);return r}static async updateMemberRole(t,r,n){const{error:s}=await ar.from("project_members").update({role:n}).eq("project_id",t).eq("user_id",r);if(s)throw new Error(`: ${s.message}`)}static async removeMember(t,r){const{error:n}=await ar.from("project_members").delete().eq("project_id",t).eq("user_id",r);if(n)throw new Error(`: ${n.message}`)}static async cancelInvitation(t){const{error:r}=await ar.from("project_invitations").delete().eq("id",t);if(r)throw new Error(`: ${r.message}`)}static async getActivityLog(t,r=50){const{data:n,error:s}=await ar.from("project_activity_log").select(`
        *,
        users:user_id (email)
      `).eq("project_id",t).order("created_at",{ascending:!1}).limit(r);if(s)throw new Error(`: ${s.message}`);return n.map(l=>{var o;return{id:l.id,projectId:l.project_id,userId:l.user_id,action:l.action,details:l.details,createdAt:l.created_at,userEmail:(o=l.users)==null?void 0:o.email}})}static async getUserRole(t){const{data:{user:r}}=await ar.auth.getUser();if(!r)return null;const{data:n,error:s}=await ar.from("project_members").select("role").eq("project_id",t).eq("user_id",r.id).single();return s?null:n.role}static subscribeToProjectUpdates(t,r){return ar.channel(`project-${t}`).on("postgres_changes",{event:"*",schema:"public",table:"projects",filter:`id=eq.${t}`},r).on("postgres_changes",{event:"*",schema:"public",table:"project_members",filter:`project_id=eq.${t}`},r).subscribe()}}const Fr=({size:e="md",color:t="border-blue-500",text:r})=>{const n={sm:"w-6 h-6",md:"w-10 h-10",lg:"w-16 h-16"};return d.jsxs("div",{className:"flex flex-col items-center justify-center space-y-2",children:[d.jsx("div",{className:`animate-spin rounded-full border-4 ${t} border-t-transparent ${n[e]}`}),r&&d.jsx("p",{className:"text-slate-600 text-sm",children:r})]})},Lh=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-3.75h.008v.008H12v-.008ZM12 15h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5v-.008ZM9.75 18.75h.008v.008H9.75v-.008ZM7.5 18.75h.008v.008H7.5v-.008ZM14.25 15h.008v.008H14.25v-.008ZM16.5 15h.008v.008H16.5v-.008ZM14.25 18.75h.008v.008H14.25v-.008ZM16.5 18.75h.008v.008H16.5v-.008Z"})}),Fh=e=>d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9 9 0 1 0 0-18 9 9 0 0 0 0 18Z"}),d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m12 12 4.243 4.243"})]}),HS=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})}),zS=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"})}),na=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"})}),v_=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"})}),__=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"})}),Nl=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"})}),Uh=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),za=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12.56 0c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})}),wo=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),El=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})}),Bh=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.354a15.055 15.055 0 0 1-3 0M12.75 4.5v-.75a.75.75 0 0 0-.75-.75h-.75a.75.75 0 0 0-.75.75v.75m0 0A2.25 2.25 0 0 0 9.75 6.75h4.5A2.25 2.25 0 0 0 12.75 4.5M12 18.75h.008v.008H12v-.008Z"})}),di=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),GS=({title:e,...t})=>d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[e&&d.jsx("title",{children:e}),d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9.75V12m0 0H9.75M12 12h2.25m-2.25 0V9.75M12 12v2.25m0 0H9.75M12 14.25h2.25M12 6.75a5.25 5.25 0 1 1-10.5 0 5.25 5.25 0 0 1 10.5 0Zm0 0V3m0 3.75h.008v.008H12V6.75Zm-5.25 0H3.75m0 0V3m0 3.75h.008v.008H3.75V6.75Zm10.5 0h2.25m0 0V3m0 3.75h.008v.008H16.5V6.75Z"}),d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})]}),bo=e=>d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75h16.5v16.5H3.75V3.75Z"}),d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9 12.75 3 3 6-6"})]}),wu=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 0 1 7.5 5.25h9a2.25 2.25 0 0 1 2.25 2.25v9a2.25 2.25 0 0 1-2.25-2.25h-9a2.25 2.25 0 0 1-2.25-2.25v-9Z"})}),VS=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 6.75h7.5M8.25 12h7.5m-7.5 5.25h7.5M3.75 6.75h.007v.008H3.75V6.75Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})}),bu=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"})}),Ph=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),$S=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),YS=e=>d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}),d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113A.375.375 0 0 1 9.75 15.113V8.887c0-.286.307-.466.557-.332l5.603 3.118Z"})]}),qS=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),XS=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})}),WS=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 7.125A3.375 3.375 0 005.625 4.5h12.75c1.72 0 3.125 1.119 3.375 2.625M9.75 10.5h4.5m-4.5 3h4.5M11.25 3v1.5m0 15V21m0-16.5a1.5 1.5 0 00-3 0V21a1.5 1.5 0 003 0V3.062A3.375 3.375 0 0112 2.25c.465 0 .91.095 1.312.281M14.25 9a3 3 0 10-6 0 3 3 0 006 0z"})}),y_=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"})}),w_=e=>d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3v11.25A2.25 2.25 0 006 16.5h12A2.25 2.25 0 0020.25 14.25V3M3.75 21h16.5M16.5 3.75h.008v.008H16.5V3.75zm-3.75 0h.008v.008H12.75V3.75zm-3.75 0h.008v.008H9V3.75zm-3.75 0h.008v.008H5.25V3.75z"}),d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.5h18M9.75 16.5a.75.75 0 01.75-.75h3a.75.75 0 01.75.75v4.5a.75.75 0 01-.75.75h-3a.75.75 0 01-.75-.75v-4.5z"})]}),ZS=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"})}),b_=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 15 3 9m0 0 6-6M3 9h12a6 6 0 0 1 0 12h-3"})}),E_=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m15 15 6-6m0 0-6-6m6 6H3a6 6 0 0 0 0 12h3"})}),Ns=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m18.375 12.739-7.693 7.693a4.5 4.5 0 0 1-6.364-6.364l10.94-10.94A3 3 0 1 1 19.5 7.372L8.552 18.32m.009-.01-.01.01m5.699-9.941-7.81 7.81a1.5 1.5 0 0 0 2.122 2.122l7.81-7.81"})}),Eo=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 0 1-1.125-1.125v-1.5c0-.621.504-1.125 1.125-1.125h17.25c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h-1.5m1.5 0v-1.5m17.25 1.5v-1.5m0 0h1.5m-1.5 0h-17.25m0 0H3.375c-.621 0-1.125-.504-1.125-1.125v-12.75c0-.621.504-1.125 1.125-1.125h17.25c.621 0 1.125.504 1.125 1.125v12.75c0 .621-.504 1.125-1.125 1.125M12 4.5v15m0 0H9m3 0h3"})}),KS=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",...e,children:d.jsx("path",{fillRule:"evenodd",d:"M10 1a4.5 4.5 0 00-4.5 4.5V9H5a2 2 0 00-2 2v6a2 2 0 002 2h10a2 2 0 002-2v-6a2 2 0 00-2-2h-.5V5.5A4.5 4.5 0 0010 1zm3 8V5.5a3 3 0 10-6 0V9h6z",clipRule:"evenodd"})}),JS=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",...e,children:d.jsx("path",{d:"M10 2a5 5 0 00-5 5v2a2 2 0 00-2 2v6a2 2 0 002 2h10a2 2 0 002-2v-6a2 2 0 00-2-2h-1V7a5 5 0 00-5-5zm0 2.5a2.5 2.5 0 00-2.5 2.5V9h5V7a2.5 2.5 0 00-2.5-2.5z"})}),To=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.572L16.5 21.75l-.398-1.178a3.375 3.375 0 00-2.455-2.456L12.5 17.25l1.178-.398a3.375 3.375 0 002.455-2.456L16.5 13.5l.398 1.178a3.375 3.375 0 002.456 2.456L20.25 17.25l-1.178.398a3.375 3.375 0 00-2.456 2.456z"})}),T_=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75c0-.231-.035-.454-.1-.664M6.75 7.5H18v2.25H6.75V7.5zM3 12h3v6.75a2.25 2.25 0 002.25 2.25h9.75a2.25 2.25 0 002.25-2.25V12h3m-3.498 6.75H15"})}),zd=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75v4.5m0-4.5h-4.5m4.5 0L15 9m5.25 11.25v-4.5m0 4.5h-4.5m4.5 0L15 15"})}),Gd=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9V4.5M9 9H4.5M9 9 3.75 3.75M9 15v4.5M9 15H4.5M9 15l-5.25 5.25M15 9V4.5M15 9h4.5M15 9l5.25-5.25M15 15v4.5M15 15h4.5M15 15l5.25 5.25"})}),S_=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25H12"})}),hi=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"})}),ao=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 16 16",...e,children:d.jsx("path",{d:"M7.247 4.86l-4.796 5.481c-.566.647-.106 1.659.753 1.659h9.592a1 1 0 0 0 .753-1.659l-4.796-5.48a1 1 0 0 0-1.506 0z"})}),xi=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 16 16",...e,children:d.jsx("path",{d:"M7.247 11.14l-4.796-5.481c-.566-.647-.106-1.659.753-1.659h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"})}),no=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1 1 21.75 8.25z"})}),QS=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"})}),e4=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"})}),t4=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-3.07M12 6.375a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0Zm8.25 2.25a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z"})}),r4=e=>d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})]}),a4=e=>d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 1-4.243-4.243m4.242 4.242L9.88 9.88"})}),n4=({onSubmit:e,isLoading:t,onImportProject:r,onLoadTemplate:n,initialGoal:s="",initialDate:l="",onOpenProjectList:o,onLogout:u,user:h})=>{const[x,p]=re.useState(s),[v,_]=re.useState(l),y=re.useRef(null);Gn.useEffect(()=>{p(s)},[s]),Gn.useEffect(()=>{_(l)},[l]);const w=new Date().toISOString().split("T")[0],b=L=>{if(L.preventDefault(),!x.trim()||!v){alert("");return}e(x,v)},E=()=>{var L;(L=y.current)==null||L.click()},j=L=>{var W;const Z=(W=L.target.files)==null?void 0:W[0];Z&&(r(Z),L.target.value="")},C=L=>{if(!x.trim()||!v){alert("");return}n(L,x,v)},S=({template:L,title:Z,description:W,disabled:I})=>d.jsxs("button",{type:"button",onClick:()=>C(L),disabled:I,className:"text-left p-4 bg-purple-600 hover:bg-purple-700 disabled:bg-slate-400 text-white rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition duration-150 ease-in-out transform hover:scale-105",children:[d.jsx("div",{className:"font-semibold text-md",children:Z}),d.jsx("div",{className:"text-xs text-purple-200 mt-1",children:W})]});return d.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:[d.jsxs("div",{className:"w-full max-w-2xl mb-4 flex justify-between items-center",children:[d.jsxs("div",{className:"text-white text-sm",children:[": ",h==null?void 0:h.email]}),d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsxs("button",{onClick:o,className:"flex items-center gap-2 px-4 py-2 bg-slate-600 text-white rounded-md hover:bg-slate-500",children:[d.jsx(hi,{className:"w-5 h-5"}),""]}),d.jsxs("button",{onClick:u,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:[d.jsx(no,{className:"w-5 h-5"}),""]})]})]}),d.jsxs("div",{className:"w-full max-w-2xl bg-white shadow-2xl rounded-xl p-8 md:p-12",children:[d.jsxs("div",{className:"text-center mb-10",children:[d.jsx("h1",{className:"text-4xl font-bold text-slate-800 mb-3",children:"AI"}),d.jsx("p",{className:"text-slate-600 text-lg",children:"AI"})]}),d.jsxs("form",{onSubmit:b,className:"space-y-6",children:[d.jsxs("div",{children:[d.jsxs("label",{htmlFor:"projectGoal",className:"block text-sm font-semibold text-slate-700 mb-2 flex items-center",children:[d.jsx(Fh,{className:"w-5 h-5 mr-2 text-blue-600"})," ()"]}),d.jsx("textarea",{id:"projectGoal",value:x,onChange:L=>p(L.target.value),placeholder:": E1000",rows:3,className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out text-base text-slate-100 placeholder-slate-400"})]}),d.jsxs("div",{children:[d.jsxs("label",{htmlFor:"targetDate",className:"block text-sm font-semibold text-slate-700 mb-2 flex items-center",children:[d.jsx(Lh,{className:"w-5 h-5 mr-2 text-blue-600"}),""]}),d.jsx("input",{type:"date",id:"targetDate",value:v,onChange:L=>_(L.target.value),min:w,className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out text-base text-slate-100",style:{colorScheme:"dark"}})]}),d.jsx("p",{className:"text-sm text-slate-500 text-center",children:""}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[d.jsx("button",{type:"submit",disabled:t,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-150 ease-in-out transform hover:scale-105 flex items-center justify-center text-md",children:t?d.jsx(Fr,{size:"sm",color:"border-white"}):"AI"}),d.jsxs("button",{type:"button",onClick:E,disabled:t,className:"w-full bg-green-600 hover:bg-green-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition duration-150 ease-in-out transform hover:scale-105 flex items-center justify-center text-md",children:[d.jsx(__,{className:"w-5 h-5 mr-2"})," (.json)"]}),d.jsx("input",{type:"file",ref:y,onChange:j,accept:".json",className:"hidden","aria-hidden":"true"})]}),d.jsxs("div",{className:"sm:col-span-2 pt-4",children:[d.jsx("p",{className:"text-center text-sm font-semibold text-slate-600 mb-3",children:":"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:[d.jsx(S,{template:"process-design",disabled:t,title:" (APQP)",description:"APQP"}),d.jsx(S,{template:"process-change",disabled:t,title:" (ISO/IATF)",description:""}),d.jsx(S,{template:"new-product-eval",disabled:t,title:"",description:""}),d.jsx(S,{template:"improvement-project",disabled:t,title:"",description:"DMAIC"}),d.jsx(S,{template:"equipment-modification",disabled:t,title:"",description:""})]})]})]})]}),d.jsx("footer",{className:"mt-12 text-center",children:d.jsx("p",{className:"text-slate-400 text-sm",children:"Powered by Gemini API & Supabase"})})]})};var Jr=(e=>(e.NOT_STARTED="Not Started",e.IN_PROGRESS="In Progress",e.COMPLETED="Completed",e))(Jr||{}),fh=(e=>(e.PENDING="pending",e.ACHIEVED="achieved",e.MISSED="missed",e))(fh||{}),li=(e=>(e.NOT_STARTED="Not Started",e.IN_PROGRESS="In Progress",e.COMPLETED="Completed",e.BLOCKED="Blocked",e))(li||{});const V0=e=>{switch(e){case li.IN_PROGRESS:return{icon:d.jsx(YS,{className:"w-3.5 h-3.5"}),color:"text-blue-700",text:"",bgColor:"bg-blue-100"};case li.COMPLETED:return{icon:d.jsx(wo,{className:"w-3.5 h-3.5"}),color:"text-green-700",text:"",bgColor:"bg-green-100"};case li.BLOCKED:return{icon:d.jsx(qS,{className:"w-3.5 h-3.5"}),color:"text-red-700",text:"",bgColor:"bg-red-100"};case li.NOT_STARTED:default:return{icon:d.jsx($S,{className:"w-3.5 h-3.5"}),color:"text-slate-600",text:"",bgColor:"bg-slate-100"}}},s4=({task:e,onSelectTask:t,onRemoveTask:r,onUpdateStatus:n,onDragCardStart:s,index:l,cardRef:o,onStartConnection:u,onEndConnection:h})=>{var W,I,X,U;const[x,p]=re.useState(!1),v=re.useRef(null);re.useEffect(()=>{const ee=te=>{v.current&&!v.current.contains(te.target)&&p(!1)};return document.addEventListener("mousedown",ee),()=>{document.removeEventListener("mousedown",ee)}},[v]);const _=ee=>{n(e.id,ee),p(!1)},y=(W=e.extendedDetails)==null?void 0:W.numericalTarget;let w="text-slate-500";y&&(y.status===fh.ACHIEVED?w="text-green-600":y.status===fh.MISSED?w="text-red-600":w="text-yellow-600");const b=V0(e.status),E=(I=e.extendedDetails)==null?void 0:I.dueDate,j=E?new Date(E+"T00:00:00Z").toLocaleDateString("ja-JP",{month:"short",day:"numeric"}):null,C=e.status===li.IN_PROGRESS,S="task-card-in-flow bg-white rounded-xl shadow-lg hover:shadow-2xl transition-all duration-300 ease-in-out overflow-hidden flex-shrink-0 w-80 md:w-96 m-1 cursor-grab active:cursor-grabbing",L=C?"border-4 border-blue-500 ring-2 ring-blue-500 ring-offset-1":"border border-transparent",Z=ee=>{ee.stopPropagation(),u(e.id,ee)};return d.jsxs("div",{ref:o,id:`taskcard-${e.id}`,draggable:"true",onDragStart:ee=>s(ee,e.id),onMouseUp:()=>h(e.id),className:`${S} ${L}`,style:{position:"absolute",left:((X=e.position)==null?void 0:X.x)||0,top:((U=e.position)==null?void 0:U.y)||0,touchAction:"none"},children:[d.jsxs("div",{className:"p-5 relative",children:[d.jsx("div",{onMouseDown:Z,className:"absolute right-[-6px] top-1/2 -translate-y-1/2 w-4 h-4 bg-blue-500 border-2 border-white rounded-full cursor-crosshair hover:scale-125 transition-transform z-10",title:""}),d.jsxs("div",{className:"flex items-start justify-between mb-2",children:[d.jsxs("div",{className:"flex items-center flex-grow min-w-0 mr-2",children:[d.jsx("span",{className:"bg-blue-600 text-white rounded-full w-7 h-7 flex items-center justify-center font-bold text-xs mr-3 flex-shrink-0",children:l+1}),d.jsx("div",{className:"flex-grow min-w-0",children:d.jsx("div",{className:"text-lg font-bold text-slate-900 break-words","aria-label":`task title for ${e.title}`,children:e.title})})]}),d.jsxs("div",{className:"flex space-x-1 flex-shrink-0 items-center",children:[y&&d.jsx(GS,{className:`w-5 h-5 ${w}`,title:`: ${y.description} (${y.status})`}),d.jsx("button",{onClick:ee=>{ee.stopPropagation(),t(e)},className:"text-blue-600 hover:text-blue-800 transition-colors p-1 rounded-full hover:bg-blue-100",title:"","aria-label":`: ${e.title}`,children:d.jsx(zS,{className:"w-5 h-5"})}),d.jsx("button",{onClick:ee=>{ee.stopPropagation(),r(e.id)},className:"text-red-500 hover:text-red-700 transition-colors p-1 rounded-full hover:bg-red-100",title:"","aria-label":`: ${e.title}`,children:d.jsx(za,{className:"w-5 h-5"})})]})]}),d.jsx("div",{className:"h-20 mb-3",children:d.jsx("p",{className:"text-slate-800 text-sm leading-relaxed line-clamp-4 overflow-hidden h-full",children:e.description})}),d.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 mb-2",children:[d.jsxs("div",{className:"relative",ref:v,children:[d.jsxs("button",{onClick:()=>p(ee=>!ee),className:`inline-flex items-center px-2 py-0.5 rounded-full cursor-pointer ${b.bgColor} ${b.color} hover:ring-2 hover:ring-offset-1 hover:ring-blue-400 transition-all`,title:"",children:[Gn.cloneElement(b.icon,{className:`w-3 h-3 mr-1 ${b.color}`}),b.text]}),x&&d.jsx("div",{className:"absolute bottom-full mb-1 w-36 bg-white border border-slate-200 rounded-md shadow-lg z-20 py-1",children:Object.values(li).map(ee=>d.jsxs("button",{onClick:()=>_(ee),className:"w-full text-left px-3 py-1.5 text-sm text-slate-700 hover:bg-slate-100 flex items-center",children:[Gn.cloneElement(V0(ee).icon,{className:`w-3.5 h-3.5 mr-2 ${V0(ee).color}`}),V0(ee).text]},ee))})]}),j&&d.jsxs("div",{className:"flex items-center text-orange-600",children:[d.jsx(Ph,{className:"w-3.5 h-3.5 mr-1"}),": ",j]})]})]}),d.jsx("button",{onClick:ee=>{ee.stopPropagation(),t(e)},className:"block w-full text-left bg-slate-100 hover:bg-slate-200 text-blue-700 font-medium py-3 px-5 transition-colors text-xs border-t border-slate-200",children:" "})]})},i4=re.memo(s4),so=({from:e,to:t,id:r,onDelete:n})=>{const o=e.x,u=t.x,h=(o+u)/2,x=(e.y+t.y)/2,p=`M${o},${e.y} C${o+50},${e.y} ${u-50},${t.y} ${u},${t.y}`;return d.jsxs("svg",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",overflow:"visible"},"aria-hidden":"true",children:[d.jsx("defs",{children:d.jsx("marker",{id:`arrowhead-${r}`,markerWidth:8,markerHeight:8*.7,refX:8,refY:8*.35,orient:"auto",markerUnits:"strokeWidth",children:d.jsx("path",{d:`M0,0 L8,${8*.35} L0,${8*.7} Z`,fill:"#64748b"})})}),d.jsxs("g",{style:{pointerEvents:n?"auto":"none"},children:[d.jsx("path",{d:p,stroke:"#64748b",strokeWidth:2,markerEnd:`url(#arrowhead-${r})`,fill:"none"}),d.jsx("path",{d:p,stroke:"transparent",strokeWidth:"16",fill:"none",className:n?"cursor-pointer group":"",onClick:n}),n&&d.jsxs("g",{transform:`translate(${h}, ${x})`,className:"opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer",onClick:n,children:[d.jsx("circle",{cx:"0",cy:"0",r:"8",fill:"white",stroke:"#ef4444",strokeWidth:"1"}),d.jsx("path",{d:"M -3.5 -3.5 L 3.5 3.5 M -3.5 3.5 L 3.5 -3.5",stroke:"#ef4444",strokeWidth:"1.5",strokeLinecap:"round"})]})]})]})},l4=({tasks:e,onClose:t})=>{const[r,n]=re.useState("all"),[s,l]=re.useState(""),[o,u]=re.useState(null),h=re.useMemo(()=>{const w=[];return e.forEach(b=>{var E,j;(j=(E=b.extendedDetails)==null?void 0:E.subSteps)==null||j.forEach(C=>{var S;(S=C.actionItems)==null||S.forEach(L=>{w.push({actionItem:L,subStep:C,task:b})})})}),w},[e]),x=re.useMemo(()=>h.filter(w=>r==="completed"?w.actionItem.completed:r==="pending"?!w.actionItem.completed:!0).filter(w=>{const b=s.toLowerCase();return w.actionItem.text.toLowerCase().includes(b)||w.subStep.text.toLowerCase().includes(b)||(w.subStep.responsible||"").toLowerCase().includes(b)||w.task.title.toLowerCase().includes(b)}),[h,r,s]),p=re.useMemo(()=>{let w=[...x];return o!==null&&w.sort((b,E)=>{let j="",C="";switch(o.key){case"status":j=b.actionItem.completed,C=E.actionItem.completed;break;case"actionItem":j=b.actionItem.text.toLowerCase(),C=E.actionItem.text.toLowerCase();break;case"responsible":j=(b.subStep.responsible||"").toLowerCase(),C=(E.subStep.responsible||"").toLowerCase();break;case"subStep":j=b.subStep.text.toLowerCase(),C=E.subStep.text.toLowerCase();break;case"task":j=b.task.title.toLowerCase(),C=E.task.title.toLowerCase();break;case"dueDate":j=b.actionItem.dueDate||b.subStep.dueDate||"9999-12-31",C=E.actionItem.dueDate||E.subStep.dueDate||"9999-12-31";break}return j<C?o.direction==="ascending"?-1:1:j>C?o.direction==="ascending"?1:-1:0}),w},[x,o]),v=w=>{let b="ascending";o&&o.key===w&&o.direction==="ascending"&&(b="descending"),u({key:w,direction:b})},_=w=>!o||o.key!==w?d.jsx(ao,{className:"w-3 h-3 ml-1 opacity-20"}):o.direction==="ascending"?d.jsx(ao,{className:"w-3 h-3 ml-1 text-blue-600"}):d.jsx(xi,{className:"w-3 h-3 ml-1 text-blue-600"}),y=({sortKey:w,label:b,className:E})=>d.jsx("th",{scope:"col",className:`px-6 py-3 ${E||""}`,children:d.jsxs("button",{onClick:()=>v(w),className:"flex items-center gap-1 hover:text-blue-600 transition-colors",children:[b,_(w)]})});return d.jsxs("div",{className:"fixed inset-0 bg-slate-100 z-[60] flex flex-col",children:[d.jsx("header",{className:"flex-shrink-0 bg-white shadow-md",children:d.jsxs("div",{className:"flex items-center justify-between p-4 border-b w-full max-w-7xl mx-auto",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),d.jsxs("button",{onClick:t,className:"flex items-center gap-2 px-4 py-2 text-sm font-semibold text-slate-700 bg-slate-200 rounded-md hover:bg-slate-300",children:[d.jsx(v_,{className:"w-5 h-5"}),""]})]})}),d.jsxs("main",{className:"flex-grow flex flex-col overflow-hidden p-4 w-full max-w-7xl mx-auto",children:[d.jsx("div",{className:"p-4 flex-shrink-0 bg-white rounded-t-lg border-x border-t",children:d.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[d.jsx("input",{type:"text",placeholder:"...",value:s,onChange:w=>l(w.target.value),className:"px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm w-full sm:w-auto flex-grow"}),d.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-slate-100 p-1",children:[d.jsx("button",{onClick:()=>n("all"),className:`px-3 py-1 text-sm rounded-md ${r==="all"?"bg-white shadow":"hover:bg-slate-200"}`,children:""}),d.jsx("button",{onClick:()=>n("pending"),className:`px-3 py-1 text-sm rounded-md ${r==="pending"?"bg-white shadow":"hover:bg-slate-200"}`,children:""}),d.jsx("button",{onClick:()=>n("completed"),className:`px-3 py-1 text-sm rounded-md ${r==="completed"?"bg-white shadow":"hover:bg-slate-200"}`,children:""})]})]})}),d.jsx("div",{className:"flex-grow overflow-y-auto bg-white rounded-b-lg border",children:d.jsxs("table",{className:"w-full text-sm text-left text-slate-600",children:[d.jsx("thead",{className:"text-xs text-slate-700 uppercase bg-slate-100 sticky top-0 z-10",children:d.jsxs("tr",{children:[d.jsx(y,{sortKey:"status",label:"",className:"w-24"}),d.jsx(y,{sortKey:"actionItem",label:""}),d.jsx(y,{sortKey:"responsible",label:""}),d.jsx(y,{sortKey:"subStep",label:""}),d.jsx(y,{sortKey:"task",label:""}),d.jsx(y,{sortKey:"dueDate",label:""})]})}),d.jsxs("tbody",{className:"divide-y divide-slate-200",children:[p.map(({actionItem:w,subStep:b,task:E},j)=>d.jsxs("tr",{className:"hover:bg-slate-50",children:[d.jsx("td",{className:"px-6 py-3",children:w.completed?d.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[d.jsx(bo,{className:"w-4 h-4 mr-1"}),""]}):d.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800",children:[d.jsx(wu,{className:"w-4 h-4 mr-1"}),""]})}),d.jsx("td",{className:"px-6 py-3 font-medium text-slate-900",children:w.text}),d.jsx("td",{className:"px-6 py-3",children:b.responsible||""}),d.jsx("td",{className:"px-6 py-3",children:b.text}),d.jsx("td",{className:"px-6 py-3",children:E.title}),d.jsx("td",{className:"px-6 py-3",children:w.dueDate||b.dueDate?new Date((w.dueDate||b.dueDate)+"T00:00:00Z").toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"}):""})]},w.id+j)),p.length===0&&d.jsx("tr",{children:d.jsx("td",{colSpan:6,className:"text-center py-8 text-slate-500",children:""})})]})]})})]})]})},Ng={"On Track":{bgColor:"bg-green-100",textColor:"text-green-800",icon:d.jsx(wo,{className:"w-12 h-12 text-green-500"})},"At Risk":{bgColor:"bg-yellow-100",textColor:"text-yellow-800",icon:d.jsx(El,{className:"w-12 h-12 text-yellow-500"})},"Off Track":{bgColor:"bg-red-100",textColor:"text-red-800",icon:d.jsx(El,{className:"w-12 h-12 text-red-500"})},Unknown:{bgColor:"bg-slate-100",textColor:"text-slate-800",icon:d.jsx(El,{className:"w-12 h-12 text-slate-500"})}},c4=({report:e,onClose:t})=>{if(!e)return null;const r=Ng[e.overallStatus]||Ng.Unknown;return d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:d.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl h-[90vh] flex flex-col",children:[d.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200 flex-shrink-0",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"AI"}),d.jsx("button",{onClick:t,className:"p-1 rounded-full hover:bg-slate-100",children:d.jsx(na,{className:"w-6 h-6 text-slate-500"})})]}),d.jsxs("div",{className:"flex-grow p-6 overflow-y-auto space-y-6",children:[d.jsxs("section",{className:`p-6 rounded-lg flex items-center gap-6 ${r.bgColor}`,children:[d.jsx("div",{className:"flex-shrink-0",children:r.icon}),d.jsxs("div",{children:[d.jsx("h4",{className:`text-2xl font-bold ${r.textColor}`,children:e.overallStatus}),d.jsx("p",{className:`mt-1 text-base ${r.textColor}`,children:e.summary})]})]}),d.jsxs("section",{children:[d.jsxs("h5",{className:"text-lg font-semibold text-slate-700 mb-3 flex items-center",children:[d.jsx(wo,{className:"w-5 h-5 mr-2 text-green-500"}),""]}),d.jsx("ul",{className:"list-disc list-inside space-y-2 text-slate-600 pl-2",children:e.positivePoints.map((n,s)=>d.jsx("li",{children:n},s))})]}),d.jsxs("section",{children:[d.jsxs("h5",{className:"text-lg font-semibold text-slate-700 mb-3 flex items-center",children:[d.jsx(El,{className:"w-5 h-5 mr-2 text-yellow-500"}),""]}),d.jsx("div",{className:"space-y-3",children:e.areasOfConcern.map((n,s)=>d.jsxs("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-r-lg",children:[d.jsx("p",{className:"font-semibold text-yellow-800",children:n.description}),n.relatedTaskIds.length>0&&d.jsxs("p",{className:"text-xs text-yellow-700 mt-1",children:["ID: ",n.relatedTaskIds.join(", ")]})]},s))})]}),d.jsxs("section",{children:[d.jsxs("h5",{className:"text-lg font-semibold text-slate-700 mb-3 flex items-center",children:[d.jsx(Bh,{className:"w-5 h-5 mr-2 text-blue-500"}),"AI"]}),d.jsx("div",{className:"space-y-3",children:e.suggestions.map((n,s)=>d.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 rounded-r-lg",children:d.jsx("p",{className:"text-blue-800",children:n})},s))})]})]}),d.jsx("footer",{className:"p-4 bg-slate-50 border-t flex justify-end",children:d.jsx("button",{onClick:t,className:"px-5 py-2 text-sm font-medium text-white bg-slate-600 rounded-md hover:bg-slate-700",children:""})})]})})},yi=({message:e})=>e?d.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-md relative",role:"alert",children:[d.jsx("strong",{className:"font-bold",children:"Error: "}),d.jsx("span",{className:"block sm:inline",children:e})]}):null,o4=({isOpen:e,onClose:t,projectId:r,userRole:n})=>{const[s,l]=re.useState([]),[o,u]=re.useState([]),[h,x]=re.useState(!1),[p,v]=re.useState(null),[_,y]=re.useState(!1),[w,b]=re.useState(""),[E,j]=re.useState("editor"),[C,S]=re.useState(!1),L=n==="owner"||n==="admin";re.useEffect(()=>{e&&Z()},[e,r]);const Z=async()=>{x(!0),v(null);try{const[V,ge]=await Promise.all([Ha.getProjectMembers(r),L?Ha.getProjectInvitations(r):Promise.resolve([])]);l(V),u(ge)}catch(V){v(V instanceof Error?V.message:"")}finally{x(!1)}},W=async V=>{if(V.preventDefault(),!!w.trim()){S(!0);try{await Ha.inviteToProject(r,w,E),b(""),y(!1),await Z()}catch(ge){v(ge instanceof Error?ge.message:"")}finally{S(!1)}}},I=async(V,ge)=>{try{await Ha.updateMemberRole(r,V,ge),await Z()}catch(Re){v(Re instanceof Error?Re.message:"")}},X=async V=>{if(confirm(""))try{await Ha.removeMember(r,V),await Z()}catch(ge){v(ge instanceof Error?ge.message:"")}},U=async V=>{try{await Ha.cancelInvitation(V),await Z()}catch(ge){v(ge instanceof Error?ge.message:"")}},ee=V=>{switch(V){case"owner":return"";case"admin":return"";case"editor":return"";case"viewer":return"";default:return V}},te=V=>{switch(V){case"owner":return"bg-purple-100 text-purple-800";case"admin":return"bg-red-100 text-red-800";case"editor":return"bg-blue-100 text-blue-800";case"viewer":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}};return e?d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[100]",children:d.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[d.jsxs("header",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),d.jsxs("div",{className:"flex items-center gap-3",children:[L&&d.jsxs("button",{onClick:()=>y(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[d.jsx(di,{className:"w-5 h-5"}),""]}),d.jsx("button",{onClick:t,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",children:d.jsx(na,{className:"w-6 h-6"})})]})]}),d.jsxs("div",{className:"flex-grow p-6 overflow-y-auto",children:[p&&d.jsx(yi,{message:p}),h?d.jsx("div",{className:"flex items-center justify-center py-12",children:d.jsx(Fr,{size:"lg",text:"..."})}):d.jsxs("div",{className:"space-y-6",children:[_&&d.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[d.jsx("h4",{className:"font-semibold text-blue-800 mb-3",children:""}),d.jsxs("form",{onSubmit:W,className:"space-y-3",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:""}),d.jsx("input",{type:"email",value:w,onChange:V=>b(V.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md",placeholder:"example@email.com",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:""}),d.jsxs("select",{value:E,onChange:V=>j(V.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md",children:[d.jsx("option",{value:"viewer",children:" - "}),d.jsx("option",{value:"editor",children:" - "}),d.jsx("option",{value:"admin",children:" - "})]})]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{type:"submit",disabled:C,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-slate-400",children:C?d.jsx(Fr,{size:"sm",color:"border-white"}):""}),d.jsx("button",{type:"button",onClick:()=>y(!1),className:"px-4 py-2 bg-slate-200 text-slate-700 rounded-md hover:bg-slate-300",children:""})]})]})]}),d.jsxs("div",{children:[d.jsxs("h4",{className:"font-semibold text-slate-800 mb-3 flex items-center",children:[d.jsx(QS,{className:"w-5 h-5 mr-2"})," (",s.length,")"]}),d.jsx("div",{className:"space-y-2",children:s.map(V=>{var ge;return d.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center",children:d.jsx("span",{className:"text-white text-sm font-semibold",children:(ge=V.userEmail)==null?void 0:ge.charAt(0).toUpperCase()})}),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-slate-800",children:V.userEmail}),d.jsxs("p",{className:"text-sm text-slate-500",children:[": ",new Date(V.joinedAt).toLocaleDateString("ja-JP")]})]})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[L&&V.role!=="owner"?d.jsxs("select",{value:V.role,onChange:Re=>I(V.userId,Re.target.value),className:"px-2 py-1 text-sm border border-slate-300 rounded",children:[d.jsx("option",{value:"viewer",children:""}),d.jsx("option",{value:"editor",children:""}),d.jsx("option",{value:"admin",children:""})]}):d.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${te(V.role)}`,children:ee(V.role)}),L&&V.role!=="owner"&&d.jsx("button",{onClick:()=>X(V.userId),className:"p-1 text-red-500 hover:text-red-700 rounded",title:"",children:d.jsx(za,{className:"w-4 h-4"})})]})]},V.id)})})]}),L&&o.length>0&&d.jsxs("div",{children:[d.jsxs("h4",{className:"font-semibold text-slate-800 mb-3 flex items-center",children:[d.jsx(e4,{className:"w-5 h-5 mr-2"})," (",o.filter(V=>!V.acceptedAt).length,")"]}),d.jsx("div",{className:"space-y-2",children:o.filter(V=>!V.acceptedAt).map(V=>d.jsxs("div",{className:"flex items-center justify-between p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-slate-800",children:V.email}),d.jsxs("p",{className:"text-sm text-slate-500",children:[": ",ee(V.role)," | : ",new Date(V.expiresAt).toLocaleDateString("ja-JP")]})]}),d.jsx("button",{onClick:()=>U(V.id),className:"p-1 text-red-500 hover:text-red-700 rounded",title:"",children:d.jsx(za,{className:"w-4 h-4"})})]},V.id))})]})]})]})]})}):null};var Ct;(function(e){e.assertEqual=s=>{};function t(s){}e.assertIs=t;function r(s){throw new Error}e.assertNever=r,e.arrayToEnum=s=>{const l={};for(const o of s)l[o]=o;return l},e.getValidEnumValues=s=>{const l=e.objectKeys(s).filter(u=>typeof s[s[u]]!="number"),o={};for(const u of l)o[u]=s[u];return e.objectValues(o)},e.objectValues=s=>e.objectKeys(s).map(function(l){return s[l]}),e.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const l=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&l.push(o);return l},e.find=(s,l)=>{for(const o of s)if(l(o))return o},e.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function n(s,l=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(l)}e.joinValues=n,e.jsonStringifyReplacer=(s,l)=>typeof l=="bigint"?l.toString():l})(Ct||(Ct={}));var Cg;(function(e){e.mergeShapes=(t,r)=>({...t,...r})})(Cg||(Cg={}));const He=Ct.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Es=e=>{switch(typeof e){case"undefined":return He.undefined;case"string":return He.string;case"number":return Number.isNaN(e)?He.nan:He.number;case"boolean":return He.boolean;case"function":return He.function;case"bigint":return He.bigint;case"symbol":return He.symbol;case"object":return Array.isArray(e)?He.array:e===null?He.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?He.promise:typeof Map<"u"&&e instanceof Map?He.map:typeof Set<"u"&&e instanceof Set?He.set:typeof Date<"u"&&e instanceof Date?He.date:He.object;default:return He.unknown}},je=Ct.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Vn extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}format(t){const r=t||function(l){return l.message},n={_errors:[]},s=l=>{for(const o of l.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)n._errors.push(r(o));else{let u=n,h=0;for(;h<o.path.length;){const x=o.path[h];h===o.path.length-1?(u[x]=u[x]||{_errors:[]},u[x]._errors.push(r(o))):u[x]=u[x]||{_errors:[]},u=u[x],h++}}};return s(this),n}static assert(t){if(!(t instanceof Vn))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ct.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){const r={},n=[];for(const s of this.issues)if(s.path.length>0){const l=s.path[0];r[l]=r[l]||[],r[l].push(t(s))}else n.push(t(s));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}}Vn.create=e=>new Vn(e);const dh=(e,t)=>{let r;switch(e.code){case je.invalid_type:e.received===He.undefined?r="Required":r=`Expected ${e.expected}, received ${e.received}`;break;case je.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,Ct.jsonStringifyReplacer)}`;break;case je.unrecognized_keys:r=`Unrecognized key(s) in object: ${Ct.joinValues(e.keys,", ")}`;break;case je.invalid_union:r="Invalid input";break;case je.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Ct.joinValues(e.options)}`;break;case je.invalid_enum_value:r=`Invalid enum value. Expected ${Ct.joinValues(e.options)}, received '${e.received}'`;break;case je.invalid_arguments:r="Invalid function arguments";break;case je.invalid_return_type:r="Invalid function return type";break;case je.invalid_date:r="Invalid date";break;case je.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:Ct.assertNever(e.validation):e.validation!=="regex"?r=`Invalid ${e.validation}`:r="Invalid";break;case je.too_small:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="bigint"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:r="Invalid input";break;case je.too_big:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?r=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:r="Invalid input";break;case je.custom:r="Invalid input";break;case je.invalid_intersection_types:r="Intersection results could not be merged";break;case je.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case je.not_finite:r="Number must be finite";break;default:r=t.defaultError,Ct.assertNever(e)}return{message:r}};let u4=dh;function f4(){return u4}const d4=e=>{const{data:t,path:r,errorMaps:n,issueData:s}=e,l=[...r,...s.path||[]],o={...s,path:l};if(s.message!==void 0)return{...s,path:l,message:s.message};let u="";const h=n.filter(x=>!!x).slice().reverse();for(const x of h)u=x(o,{data:t,defaultError:u}).message;return{...s,path:l,message:u}};function Fe(e,t){const r=f4(),n=d4({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===dh?void 0:dh].filter(s=>!!s)});e.common.issues.push(n)}class Aa{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,r){const n=[];for(const s of r){if(s.status==="aborted")return at;s.status==="dirty"&&t.dirty(),n.push(s.value)}return{status:t.value,value:n}}static async mergeObjectAsync(t,r){const n=[];for(const s of r){const l=await s.key,o=await s.value;n.push({key:l,value:o})}return Aa.mergeObjectSync(t,n)}static mergeObjectSync(t,r){const n={};for(const s of r){const{key:l,value:o}=s;if(l.status==="aborted"||o.status==="aborted")return at;l.status==="dirty"&&t.dirty(),o.status==="dirty"&&t.dirty(),l.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(n[l.value]=o.value)}return{status:t.value,value:n}}}const at=Object.freeze({status:"aborted"}),Fc=e=>({status:"dirty",value:e}),Va=e=>({status:"valid",value:e}),Og=e=>e.status==="aborted",Dg=e=>e.status==="dirty",Cl=e=>e.status==="valid",ru=e=>typeof Promise<"u"&&e instanceof Promise;var ze;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(ze||(ze={}));class Rs{constructor(t,r,n,s){this._cachedPath=[],this.parent=t,this.data=r,this._path=n,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Rg=(e,t)=>{if(Cl(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new Vn(e.common.issues);return this._error=r,this._error}}};function ft(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:n,description:s}=e;if(t&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:s}:{errorMap:(o,u)=>{const{message:h}=e;return o.code==="invalid_enum_value"?{message:h??u.defaultError}:typeof u.data>"u"?{message:h??n??u.defaultError}:o.code!=="invalid_type"?{message:u.defaultError}:{message:h??r??u.defaultError}},description:s}}class St{get description(){return this._def.description}_getType(t){return Es(t.data)}_getOrReturnCtx(t,r){return r||{common:t.parent.common,data:t.data,parsedType:Es(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new Aa,ctx:{common:t.parent.common,data:t.data,parsedType:Es(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const r=this._parse(t);if(ru(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(t){const r=this._parse(t);return Promise.resolve(r)}parse(t,r){const n=this.safeParse(t,r);if(n.success)return n.data;throw n.error}safeParse(t,r){const n={common:{issues:[],async:(r==null?void 0:r.async)??!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Es(t)},s=this._parseSync({data:t,path:n.path,parent:n});return Rg(n,s)}"~validate"(t){var n,s;const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Es(t)};if(!this["~standard"].async)try{const l=this._parseSync({data:t,path:[],parent:r});return Cl(l)?{value:l.value}:{issues:r.common.issues}}catch(l){(s=(n=l==null?void 0:l.message)==null?void 0:n.toLowerCase())!=null&&s.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:r}).then(l=>Cl(l)?{value:l.value}:{issues:r.common.issues})}async parseAsync(t,r){const n=await this.safeParseAsync(t,r);if(n.success)return n.data;throw n.error}async safeParseAsync(t,r){const n={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Es(t)},s=this._parse({data:t,path:n.path,parent:n}),l=await(ru(s)?s:Promise.resolve(s));return Rg(n,l)}refine(t,r){const n=s=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(s):r;return this._refinement((s,l)=>{const o=t(s),u=()=>l.addIssue({code:je.custom,...n(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(h=>h?!0:(u(),!1)):o?!0:(u(),!1)})}refinement(t,r){return this._refinement((n,s)=>t(n)?!0:(s.addIssue(typeof r=="function"?r(n,s):r),!1))}_refinement(t){return new Dl({schema:this,typeName:nt.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Cs.create(this,this._def)}nullable(){return Rl.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return pn.create(this)}promise(){return iu.create(this,this._def)}or(t){return nu.create([this,t],this._def)}and(t){return su.create(this,t,this._def)}transform(t){return new Dl({...ft(this._def),schema:this,typeName:nt.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const r=typeof t=="function"?t:()=>t;return new xh({...ft(this._def),innerType:this,defaultValue:r,typeName:nt.ZodDefault})}brand(){return new M4({typeName:nt.ZodBranded,type:this,...ft(this._def)})}catch(t){const r=typeof t=="function"?t:()=>t;return new mh({...ft(this._def),innerType:this,catchValue:r,typeName:nt.ZodCatch})}describe(t){const r=this.constructor;return new r({...this._def,description:t})}pipe(t){return Hh.create(this,t)}readonly(){return ph.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const h4=/^c[^\s-]{8,}$/i,x4=/^[0-9a-z]+$/,m4=/^[0-9A-HJKMNP-TV-Z]{26}$/i,p4=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,g4=/^[a-z0-9_-]{21}$/i,v4=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,_4=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,y4=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,w4="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Vd;const b4=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,E4=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,T4=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,S4=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,k4=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,A4=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,k_="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",N4=new RegExp(`^${k_}$`);function A_(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const r=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${r}`}function C4(e){return new RegExp(`^${A_(e)}$`)}function O4(e){let t=`${k_}T${A_(e)}`;const r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function D4(e,t){return!!((t==="v4"||!t)&&b4.test(e)||(t==="v6"||!t)&&T4.test(e))}function R4(e,t){if(!v4.test(e))return!1;try{const[r]=e.split(".");if(!r)return!1;const n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),s=JSON.parse(atob(n));return!(typeof s!="object"||s===null||"typ"in s&&(s==null?void 0:s.typ)!=="JWT"||!s.alg||t&&s.alg!==t)}catch{return!1}}function j4(e,t){return!!((t==="v4"||!t)&&E4.test(e)||(t==="v6"||!t)&&S4.test(e))}class ci extends St{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==He.string){const l=this._getOrReturnCtx(t);return Fe(l,{code:je.invalid_type,expected:He.string,received:l.parsedType}),at}const n=new Aa;let s;for(const l of this._def.checks)if(l.kind==="min")t.data.length<l.value&&(s=this._getOrReturnCtx(t,s),Fe(s,{code:je.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),n.dirty());else if(l.kind==="max")t.data.length>l.value&&(s=this._getOrReturnCtx(t,s),Fe(s,{code:je.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),n.dirty());else if(l.kind==="length"){const o=t.data.length>l.value,u=t.data.length<l.value;(o||u)&&(s=this._getOrReturnCtx(t,s),o?Fe(s,{code:je.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}):u&&Fe(s,{code:je.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}),n.dirty())}else if(l.kind==="email")y4.test(t.data)||(s=this._getOrReturnCtx(t,s),Fe(s,{validation:"email",code:je.invalid_string,message:l.message}),n.dirty());else if(l.kind==="emoji")Vd||(Vd=new RegExp(w4,"u")),Vd.test(t.data)||(s=this._getOrReturnCtx(t,s),Fe(s,{validation:"emoji",code:je.invalid_string,message:l.message}),n.dirty());else if(l.kind==="uuid")p4.test(t.data)||(s=this._getOrReturnCtx(t,s),Fe(s,{validation:"uuid",code:je.invalid_string,message:l.message}),n.dirty());else if(l.kind==="nanoid")g4.test(t.data)||(s=this._getOrReturnCtx(t,s),Fe(s,{validation:"nanoid",code:je.invalid_string,message:l.message}),n.dirty());else if(l.kind==="cuid")h4.test(t.data)||(s=this._getOrReturnCtx(t,s),Fe(s,{validation:"cuid",code:je.invalid_string,message:l.message}),n.dirty());else if(l.kind==="cuid2")x4.test(t.data)||(s=this._getOrReturnCtx(t,s),Fe(s,{validation:"cuid2",code:je.invalid_string,message:l.message}),n.dirty());else if(l.kind==="ulid")m4.test(t.data)||(s=this._getOrReturnCtx(t,s),Fe(s,{validation:"ulid",code:je.invalid_string,message:l.message}),n.dirty());else if(l.kind==="url")try{new URL(t.data)}catch{s=this._getOrReturnCtx(t,s),Fe(s,{validation:"url",code:je.invalid_string,message:l.message}),n.dirty()}else l.kind==="regex"?(l.regex.lastIndex=0,l.regex.test(t.data)||(s=this._getOrReturnCtx(t,s),Fe(s,{validation:"regex",code:je.invalid_string,message:l.message}),n.dirty())):l.kind==="trim"?t.data=t.data.trim():l.kind==="includes"?t.data.includes(l.value,l.position)||(s=this._getOrReturnCtx(t,s),Fe(s,{code:je.invalid_string,validation:{includes:l.value,position:l.position},message:l.message}),n.dirty()):l.kind==="toLowerCase"?t.data=t.data.toLowerCase():l.kind==="toUpperCase"?t.data=t.data.toUpperCase():l.kind==="startsWith"?t.data.startsWith(l.value)||(s=this._getOrReturnCtx(t,s),Fe(s,{code:je.invalid_string,validation:{startsWith:l.value},message:l.message}),n.dirty()):l.kind==="endsWith"?t.data.endsWith(l.value)||(s=this._getOrReturnCtx(t,s),Fe(s,{code:je.invalid_string,validation:{endsWith:l.value},message:l.message}),n.dirty()):l.kind==="datetime"?O4(l).test(t.data)||(s=this._getOrReturnCtx(t,s),Fe(s,{code:je.invalid_string,validation:"datetime",message:l.message}),n.dirty()):l.kind==="date"?N4.test(t.data)||(s=this._getOrReturnCtx(t,s),Fe(s,{code:je.invalid_string,validation:"date",message:l.message}),n.dirty()):l.kind==="time"?C4(l).test(t.data)||(s=this._getOrReturnCtx(t,s),Fe(s,{code:je.invalid_string,validation:"time",message:l.message}),n.dirty()):l.kind==="duration"?_4.test(t.data)||(s=this._getOrReturnCtx(t,s),Fe(s,{validation:"duration",code:je.invalid_string,message:l.message}),n.dirty()):l.kind==="ip"?D4(t.data,l.version)||(s=this._getOrReturnCtx(t,s),Fe(s,{validation:"ip",code:je.invalid_string,message:l.message}),n.dirty()):l.kind==="jwt"?R4(t.data,l.alg)||(s=this._getOrReturnCtx(t,s),Fe(s,{validation:"jwt",code:je.invalid_string,message:l.message}),n.dirty()):l.kind==="cidr"?j4(t.data,l.version)||(s=this._getOrReturnCtx(t,s),Fe(s,{validation:"cidr",code:je.invalid_string,message:l.message}),n.dirty()):l.kind==="base64"?k4.test(t.data)||(s=this._getOrReturnCtx(t,s),Fe(s,{validation:"base64",code:je.invalid_string,message:l.message}),n.dirty()):l.kind==="base64url"?A4.test(t.data)||(s=this._getOrReturnCtx(t,s),Fe(s,{validation:"base64url",code:je.invalid_string,message:l.message}),n.dirty()):Ct.assertNever(l);return{status:n.value,value:t.data}}_regex(t,r,n){return this.refinement(s=>t.test(s),{validation:r,code:je.invalid_string,...ze.errToObj(n)})}_addCheck(t){return new ci({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...ze.errToObj(t)})}url(t){return this._addCheck({kind:"url",...ze.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...ze.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...ze.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...ze.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...ze.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...ze.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...ze.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...ze.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...ze.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...ze.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...ze.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...ze.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...ze.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...ze.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...ze.errToObj(t)})}regex(t,r){return this._addCheck({kind:"regex",regex:t,...ze.errToObj(r)})}includes(t,r){return this._addCheck({kind:"includes",value:t,position:r==null?void 0:r.position,...ze.errToObj(r==null?void 0:r.message)})}startsWith(t,r){return this._addCheck({kind:"startsWith",value:t,...ze.errToObj(r)})}endsWith(t,r){return this._addCheck({kind:"endsWith",value:t,...ze.errToObj(r)})}min(t,r){return this._addCheck({kind:"min",value:t,...ze.errToObj(r)})}max(t,r){return this._addCheck({kind:"max",value:t,...ze.errToObj(r)})}length(t,r){return this._addCheck({kind:"length",value:t,...ze.errToObj(r)})}nonempty(t){return this.min(1,ze.errToObj(t))}trim(){return new ci({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ci({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ci({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}ci.create=e=>new ci({checks:[],typeName:nt.ZodString,coerce:(e==null?void 0:e.coerce)??!1,...ft(e)});function I4(e,t){const r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,s=r>n?r:n,l=Number.parseInt(e.toFixed(s).replace(".","")),o=Number.parseInt(t.toFixed(s).replace(".",""));return l%o/10**s}class io extends St{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==He.number){const l=this._getOrReturnCtx(t);return Fe(l,{code:je.invalid_type,expected:He.number,received:l.parsedType}),at}let n;const s=new Aa;for(const l of this._def.checks)l.kind==="int"?Ct.isInteger(t.data)||(n=this._getOrReturnCtx(t,n),Fe(n,{code:je.invalid_type,expected:"integer",received:"float",message:l.message}),s.dirty()):l.kind==="min"?(l.inclusive?t.data<l.value:t.data<=l.value)&&(n=this._getOrReturnCtx(t,n),Fe(n,{code:je.too_small,minimum:l.value,type:"number",inclusive:l.inclusive,exact:!1,message:l.message}),s.dirty()):l.kind==="max"?(l.inclusive?t.data>l.value:t.data>=l.value)&&(n=this._getOrReturnCtx(t,n),Fe(n,{code:je.too_big,maximum:l.value,type:"number",inclusive:l.inclusive,exact:!1,message:l.message}),s.dirty()):l.kind==="multipleOf"?I4(t.data,l.value)!==0&&(n=this._getOrReturnCtx(t,n),Fe(n,{code:je.not_multiple_of,multipleOf:l.value,message:l.message}),s.dirty()):l.kind==="finite"?Number.isFinite(t.data)||(n=this._getOrReturnCtx(t,n),Fe(n,{code:je.not_finite,message:l.message}),s.dirty()):Ct.assertNever(l);return{status:s.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,ze.toString(r))}gt(t,r){return this.setLimit("min",t,!1,ze.toString(r))}lte(t,r){return this.setLimit("max",t,!0,ze.toString(r))}lt(t,r){return this.setLimit("max",t,!1,ze.toString(r))}setLimit(t,r,n,s){return new io({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:ze.toString(s)}]})}_addCheck(t){return new io({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:ze.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ze.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ze.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ze.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ze.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:ze.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:ze.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ze.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ze.toString(t)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Ct.isInteger(t.value))}get isFinite(){let t=null,r=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(t===null||n.value<t)&&(t=n.value)}return Number.isFinite(r)&&Number.isFinite(t)}}io.create=e=>new io({checks:[],typeName:nt.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...ft(e)});class lo extends St{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==He.bigint)return this._getInvalidInput(t);let n;const s=new Aa;for(const l of this._def.checks)l.kind==="min"?(l.inclusive?t.data<l.value:t.data<=l.value)&&(n=this._getOrReturnCtx(t,n),Fe(n,{code:je.too_small,type:"bigint",minimum:l.value,inclusive:l.inclusive,message:l.message}),s.dirty()):l.kind==="max"?(l.inclusive?t.data>l.value:t.data>=l.value)&&(n=this._getOrReturnCtx(t,n),Fe(n,{code:je.too_big,type:"bigint",maximum:l.value,inclusive:l.inclusive,message:l.message}),s.dirty()):l.kind==="multipleOf"?t.data%l.value!==BigInt(0)&&(n=this._getOrReturnCtx(t,n),Fe(n,{code:je.not_multiple_of,multipleOf:l.value,message:l.message}),s.dirty()):Ct.assertNever(l);return{status:s.value,value:t.data}}_getInvalidInput(t){const r=this._getOrReturnCtx(t);return Fe(r,{code:je.invalid_type,expected:He.bigint,received:r.parsedType}),at}gte(t,r){return this.setLimit("min",t,!0,ze.toString(r))}gt(t,r){return this.setLimit("min",t,!1,ze.toString(r))}lte(t,r){return this.setLimit("max",t,!0,ze.toString(r))}lt(t,r){return this.setLimit("max",t,!1,ze.toString(r))}setLimit(t,r,n,s){return new lo({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:ze.toString(s)}]})}_addCheck(t){return new lo({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ze.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ze.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ze.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ze.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:ze.toString(r)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}lo.create=e=>new lo({checks:[],typeName:nt.ZodBigInt,coerce:(e==null?void 0:e.coerce)??!1,...ft(e)});class jg extends St{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==He.boolean){const n=this._getOrReturnCtx(t);return Fe(n,{code:je.invalid_type,expected:He.boolean,received:n.parsedType}),at}return Va(t.data)}}jg.create=e=>new jg({typeName:nt.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...ft(e)});class au extends St{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==He.date){const l=this._getOrReturnCtx(t);return Fe(l,{code:je.invalid_type,expected:He.date,received:l.parsedType}),at}if(Number.isNaN(t.data.getTime())){const l=this._getOrReturnCtx(t);return Fe(l,{code:je.invalid_date}),at}const n=new Aa;let s;for(const l of this._def.checks)l.kind==="min"?t.data.getTime()<l.value&&(s=this._getOrReturnCtx(t,s),Fe(s,{code:je.too_small,message:l.message,inclusive:!0,exact:!1,minimum:l.value,type:"date"}),n.dirty()):l.kind==="max"?t.data.getTime()>l.value&&(s=this._getOrReturnCtx(t,s),Fe(s,{code:je.too_big,message:l.message,inclusive:!0,exact:!1,maximum:l.value,type:"date"}),n.dirty()):Ct.assertNever(l);return{status:n.value,value:new Date(t.data.getTime())}}_addCheck(t){return new au({...this._def,checks:[...this._def.checks,t]})}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:ze.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:ze.toString(r)})}get minDate(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}}au.create=e=>new au({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:nt.ZodDate,...ft(e)});class Ig extends St{_parse(t){if(this._getType(t)!==He.symbol){const n=this._getOrReturnCtx(t);return Fe(n,{code:je.invalid_type,expected:He.symbol,received:n.parsedType}),at}return Va(t.data)}}Ig.create=e=>new Ig({typeName:nt.ZodSymbol,...ft(e)});class Mg extends St{_parse(t){if(this._getType(t)!==He.undefined){const n=this._getOrReturnCtx(t);return Fe(n,{code:je.invalid_type,expected:He.undefined,received:n.parsedType}),at}return Va(t.data)}}Mg.create=e=>new Mg({typeName:nt.ZodUndefined,...ft(e)});class Lg extends St{_parse(t){if(this._getType(t)!==He.null){const n=this._getOrReturnCtx(t);return Fe(n,{code:je.invalid_type,expected:He.null,received:n.parsedType}),at}return Va(t.data)}}Lg.create=e=>new Lg({typeName:nt.ZodNull,...ft(e)});class Fg extends St{constructor(){super(...arguments),this._any=!0}_parse(t){return Va(t.data)}}Fg.create=e=>new Fg({typeName:nt.ZodAny,...ft(e)});class Ug extends St{constructor(){super(...arguments),this._unknown=!0}_parse(t){return Va(t.data)}}Ug.create=e=>new Ug({typeName:nt.ZodUnknown,...ft(e)});class js extends St{_parse(t){const r=this._getOrReturnCtx(t);return Fe(r,{code:je.invalid_type,expected:He.never,received:r.parsedType}),at}}js.create=e=>new js({typeName:nt.ZodNever,...ft(e)});class Bg extends St{_parse(t){if(this._getType(t)!==He.undefined){const n=this._getOrReturnCtx(t);return Fe(n,{code:je.invalid_type,expected:He.void,received:n.parsedType}),at}return Va(t.data)}}Bg.create=e=>new Bg({typeName:nt.ZodVoid,...ft(e)});class pn extends St{_parse(t){const{ctx:r,status:n}=this._processInputParams(t),s=this._def;if(r.parsedType!==He.array)return Fe(r,{code:je.invalid_type,expected:He.array,received:r.parsedType}),at;if(s.exactLength!==null){const o=r.data.length>s.exactLength.value,u=r.data.length<s.exactLength.value;(o||u)&&(Fe(r,{code:o?je.too_big:je.too_small,minimum:u?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),n.dirty())}if(s.minLength!==null&&r.data.length<s.minLength.value&&(Fe(r,{code:je.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),n.dirty()),s.maxLength!==null&&r.data.length>s.maxLength.value&&(Fe(r,{code:je.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((o,u)=>s.type._parseAsync(new Rs(r,o,r.path,u)))).then(o=>Aa.mergeArray(n,o));const l=[...r.data].map((o,u)=>s.type._parseSync(new Rs(r,o,r.path,u)));return Aa.mergeArray(n,l)}get element(){return this._def.type}min(t,r){return new pn({...this._def,minLength:{value:t,message:ze.toString(r)}})}max(t,r){return new pn({...this._def,maxLength:{value:t,message:ze.toString(r)}})}length(t,r){return new pn({...this._def,exactLength:{value:t,message:ze.toString(r)}})}nonempty(t){return this.min(1,t)}}pn.create=(e,t)=>new pn({type:e,minLength:null,maxLength:null,exactLength:null,typeName:nt.ZodArray,...ft(t)});function yl(e){if(e instanceof wr){const t={};for(const r in e.shape){const n=e.shape[r];t[r]=Cs.create(yl(n))}return new wr({...e._def,shape:()=>t})}else return e instanceof pn?new pn({...e._def,type:yl(e.element)}):e instanceof Cs?Cs.create(yl(e.unwrap())):e instanceof Rl?Rl.create(yl(e.unwrap())):e instanceof mi?mi.create(e.items.map(t=>yl(t))):e}class wr extends St{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),r=Ct.objectKeys(t);return this._cached={shape:t,keys:r},this._cached}_parse(t){if(this._getType(t)!==He.object){const x=this._getOrReturnCtx(t);return Fe(x,{code:je.invalid_type,expected:He.object,received:x.parsedType}),at}const{status:n,ctx:s}=this._processInputParams(t),{shape:l,keys:o}=this._getCached(),u=[];if(!(this._def.catchall instanceof js&&this._def.unknownKeys==="strip"))for(const x in s.data)o.includes(x)||u.push(x);const h=[];for(const x of o){const p=l[x],v=s.data[x];h.push({key:{status:"valid",value:x},value:p._parse(new Rs(s,v,s.path,x)),alwaysSet:x in s.data})}if(this._def.catchall instanceof js){const x=this._def.unknownKeys;if(x==="passthrough")for(const p of u)h.push({key:{status:"valid",value:p},value:{status:"valid",value:s.data[p]}});else if(x==="strict")u.length>0&&(Fe(s,{code:je.unrecognized_keys,keys:u}),n.dirty());else if(x!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const x=this._def.catchall;for(const p of u){const v=s.data[p];h.push({key:{status:"valid",value:p},value:x._parse(new Rs(s,v,s.path,p)),alwaysSet:p in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const x=[];for(const p of h){const v=await p.key,_=await p.value;x.push({key:v,value:_,alwaysSet:p.alwaysSet})}return x}).then(x=>Aa.mergeObjectSync(n,x)):Aa.mergeObjectSync(n,h)}get shape(){return this._def.shape()}strict(t){return ze.errToObj,new wr({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(r,n)=>{var l,o;const s=((o=(l=this._def).errorMap)==null?void 0:o.call(l,r,n).message)??n.defaultError;return r.code==="unrecognized_keys"?{message:ze.errToObj(t).message??s}:{message:s}}}:{}})}strip(){return new wr({...this._def,unknownKeys:"strip"})}passthrough(){return new wr({...this._def,unknownKeys:"passthrough"})}extend(t){return new wr({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new wr({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:nt.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new wr({...this._def,catchall:t})}pick(t){const r={};for(const n of Ct.objectKeys(t))t[n]&&this.shape[n]&&(r[n]=this.shape[n]);return new wr({...this._def,shape:()=>r})}omit(t){const r={};for(const n of Ct.objectKeys(this.shape))t[n]||(r[n]=this.shape[n]);return new wr({...this._def,shape:()=>r})}deepPartial(){return yl(this)}partial(t){const r={};for(const n of Ct.objectKeys(this.shape)){const s=this.shape[n];t&&!t[n]?r[n]=s:r[n]=s.optional()}return new wr({...this._def,shape:()=>r})}required(t){const r={};for(const n of Ct.objectKeys(this.shape))if(t&&!t[n])r[n]=this.shape[n];else{let l=this.shape[n];for(;l instanceof Cs;)l=l._def.innerType;r[n]=l}return new wr({...this._def,shape:()=>r})}keyof(){return N_(Ct.objectKeys(this.shape))}}wr.create=(e,t)=>new wr({shape:()=>e,unknownKeys:"strip",catchall:js.create(),typeName:nt.ZodObject,...ft(t)});wr.strictCreate=(e,t)=>new wr({shape:()=>e,unknownKeys:"strict",catchall:js.create(),typeName:nt.ZodObject,...ft(t)});wr.lazycreate=(e,t)=>new wr({shape:e,unknownKeys:"strip",catchall:js.create(),typeName:nt.ZodObject,...ft(t)});class nu extends St{_parse(t){const{ctx:r}=this._processInputParams(t),n=this._def.options;function s(l){for(const u of l)if(u.result.status==="valid")return u.result;for(const u of l)if(u.result.status==="dirty")return r.common.issues.push(...u.ctx.common.issues),u.result;const o=l.map(u=>new Vn(u.ctx.common.issues));return Fe(r,{code:je.invalid_union,unionErrors:o}),at}if(r.common.async)return Promise.all(n.map(async l=>{const o={...r,common:{...r.common,issues:[]},parent:null};return{result:await l._parseAsync({data:r.data,path:r.path,parent:o}),ctx:o}})).then(s);{let l;const o=[];for(const h of n){const x={...r,common:{...r.common,issues:[]},parent:null},p=h._parseSync({data:r.data,path:r.path,parent:x});if(p.status==="valid")return p;p.status==="dirty"&&!l&&(l={result:p,ctx:x}),x.common.issues.length&&o.push(x.common.issues)}if(l)return r.common.issues.push(...l.ctx.common.issues),l.result;const u=o.map(h=>new Vn(h));return Fe(r,{code:je.invalid_union,unionErrors:u}),at}}get options(){return this._def.options}}nu.create=(e,t)=>new nu({options:e,typeName:nt.ZodUnion,...ft(t)});function hh(e,t){const r=Es(e),n=Es(t);if(e===t)return{valid:!0,data:e};if(r===He.object&&n===He.object){const s=Ct.objectKeys(t),l=Ct.objectKeys(e).filter(u=>s.indexOf(u)!==-1),o={...e,...t};for(const u of l){const h=hh(e[u],t[u]);if(!h.valid)return{valid:!1};o[u]=h.data}return{valid:!0,data:o}}else if(r===He.array&&n===He.array){if(e.length!==t.length)return{valid:!1};const s=[];for(let l=0;l<e.length;l++){const o=e[l],u=t[l],h=hh(o,u);if(!h.valid)return{valid:!1};s.push(h.data)}return{valid:!0,data:s}}else return r===He.date&&n===He.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class su extends St{_parse(t){const{status:r,ctx:n}=this._processInputParams(t),s=(l,o)=>{if(Og(l)||Og(o))return at;const u=hh(l.value,o.value);return u.valid?((Dg(l)||Dg(o))&&r.dirty(),{status:r.value,value:u.data}):(Fe(n,{code:je.invalid_intersection_types}),at)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([l,o])=>s(l,o)):s(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}su.create=(e,t,r)=>new su({left:e,right:t,typeName:nt.ZodIntersection,...ft(r)});class mi extends St{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==He.array)return Fe(n,{code:je.invalid_type,expected:He.array,received:n.parsedType}),at;if(n.data.length<this._def.items.length)return Fe(n,{code:je.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),at;!this._def.rest&&n.data.length>this._def.items.length&&(Fe(n,{code:je.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const l=[...n.data].map((o,u)=>{const h=this._def.items[u]||this._def.rest;return h?h._parse(new Rs(n,o,n.path,u)):null}).filter(o=>!!o);return n.common.async?Promise.all(l).then(o=>Aa.mergeArray(r,o)):Aa.mergeArray(r,l)}get items(){return this._def.items}rest(t){return new mi({...this._def,rest:t})}}mi.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new mi({items:e,typeName:nt.ZodTuple,rest:null,...ft(t)})};class Pg extends St{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==He.map)return Fe(n,{code:je.invalid_type,expected:He.map,received:n.parsedType}),at;const s=this._def.keyType,l=this._def.valueType,o=[...n.data.entries()].map(([u,h],x)=>({key:s._parse(new Rs(n,u,n.path,[x,"key"])),value:l._parse(new Rs(n,h,n.path,[x,"value"]))}));if(n.common.async){const u=new Map;return Promise.resolve().then(async()=>{for(const h of o){const x=await h.key,p=await h.value;if(x.status==="aborted"||p.status==="aborted")return at;(x.status==="dirty"||p.status==="dirty")&&r.dirty(),u.set(x.value,p.value)}return{status:r.value,value:u}})}else{const u=new Map;for(const h of o){const x=h.key,p=h.value;if(x.status==="aborted"||p.status==="aborted")return at;(x.status==="dirty"||p.status==="dirty")&&r.dirty(),u.set(x.value,p.value)}return{status:r.value,value:u}}}}Pg.create=(e,t,r)=>new Pg({valueType:t,keyType:e,typeName:nt.ZodMap,...ft(r)});class co extends St{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==He.set)return Fe(n,{code:je.invalid_type,expected:He.set,received:n.parsedType}),at;const s=this._def;s.minSize!==null&&n.data.size<s.minSize.value&&(Fe(n,{code:je.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),r.dirty()),s.maxSize!==null&&n.data.size>s.maxSize.value&&(Fe(n,{code:je.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),r.dirty());const l=this._def.valueType;function o(h){const x=new Set;for(const p of h){if(p.status==="aborted")return at;p.status==="dirty"&&r.dirty(),x.add(p.value)}return{status:r.value,value:x}}const u=[...n.data.values()].map((h,x)=>l._parse(new Rs(n,h,n.path,x)));return n.common.async?Promise.all(u).then(h=>o(h)):o(u)}min(t,r){return new co({...this._def,minSize:{value:t,message:ze.toString(r)}})}max(t,r){return new co({...this._def,maxSize:{value:t,message:ze.toString(r)}})}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}}co.create=(e,t)=>new co({valueType:e,minSize:null,maxSize:null,typeName:nt.ZodSet,...ft(t)});class Hg extends St{get schema(){return this._def.getter()}_parse(t){const{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}Hg.create=(e,t)=>new Hg({getter:e,typeName:nt.ZodLazy,...ft(t)});class zg extends St{_parse(t){if(t.data!==this._def.value){const r=this._getOrReturnCtx(t);return Fe(r,{received:r.data,code:je.invalid_literal,expected:this._def.value}),at}return{status:"valid",value:t.data}}get value(){return this._def.value}}zg.create=(e,t)=>new zg({value:e,typeName:nt.ZodLiteral,...ft(t)});function N_(e,t){return new Ol({values:e,typeName:nt.ZodEnum,...ft(t)})}class Ol extends St{_parse(t){if(typeof t.data!="string"){const r=this._getOrReturnCtx(t),n=this._def.values;return Fe(r,{expected:Ct.joinValues(n),received:r.parsedType,code:je.invalid_type}),at}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const r=this._getOrReturnCtx(t),n=this._def.values;return Fe(r,{received:r.data,code:je.invalid_enum_value,options:n}),at}return Va(t.data)}get options(){return this._def.values}get enum(){const t={};for(const r of this._def.values)t[r]=r;return t}get Values(){const t={};for(const r of this._def.values)t[r]=r;return t}get Enum(){const t={};for(const r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return Ol.create(t,{...this._def,...r})}exclude(t,r=this._def){return Ol.create(this.options.filter(n=>!t.includes(n)),{...this._def,...r})}}Ol.create=N_;class Gg extends St{_parse(t){const r=Ct.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(t);if(n.parsedType!==He.string&&n.parsedType!==He.number){const s=Ct.objectValues(r);return Fe(n,{expected:Ct.joinValues(s),received:n.parsedType,code:je.invalid_type}),at}if(this._cache||(this._cache=new Set(Ct.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const s=Ct.objectValues(r);return Fe(n,{received:n.data,code:je.invalid_enum_value,options:s}),at}return Va(t.data)}get enum(){return this._def.values}}Gg.create=(e,t)=>new Gg({values:e,typeName:nt.ZodNativeEnum,...ft(t)});class iu extends St{unwrap(){return this._def.type}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==He.promise&&r.common.async===!1)return Fe(r,{code:je.invalid_type,expected:He.promise,received:r.parsedType}),at;const n=r.parsedType===He.promise?r.data:Promise.resolve(r.data);return Va(n.then(s=>this._def.type.parseAsync(s,{path:r.path,errorMap:r.common.contextualErrorMap})))}}iu.create=(e,t)=>new iu({type:e,typeName:nt.ZodPromise,...ft(t)});class Dl extends St{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===nt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:r,ctx:n}=this._processInputParams(t),s=this._def.effect||null,l={addIssue:o=>{Fe(n,o),o.fatal?r.abort():r.dirty()},get path(){return n.path}};if(l.addIssue=l.addIssue.bind(l),s.type==="preprocess"){const o=s.transform(n.data,l);if(n.common.async)return Promise.resolve(o).then(async u=>{if(r.value==="aborted")return at;const h=await this._def.schema._parseAsync({data:u,path:n.path,parent:n});return h.status==="aborted"?at:h.status==="dirty"||r.value==="dirty"?Fc(h.value):h});{if(r.value==="aborted")return at;const u=this._def.schema._parseSync({data:o,path:n.path,parent:n});return u.status==="aborted"?at:u.status==="dirty"||r.value==="dirty"?Fc(u.value):u}}if(s.type==="refinement"){const o=u=>{const h=s.refinement(u,l);if(n.common.async)return Promise.resolve(h);if(h instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return u};if(n.common.async===!1){const u=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return u.status==="aborted"?at:(u.status==="dirty"&&r.dirty(),o(u.value),{status:r.value,value:u.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(u=>u.status==="aborted"?at:(u.status==="dirty"&&r.dirty(),o(u.value).then(()=>({status:r.value,value:u.value}))))}if(s.type==="transform")if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Cl(o))return at;const u=s.transform(o.value,l);if(u instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:u}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>Cl(o)?Promise.resolve(s.transform(o.value,l)).then(u=>({status:r.value,value:u})):at);Ct.assertNever(s)}}Dl.create=(e,t,r)=>new Dl({schema:e,typeName:nt.ZodEffects,effect:t,...ft(r)});Dl.createWithPreprocess=(e,t,r)=>new Dl({schema:t,effect:{type:"preprocess",transform:e},typeName:nt.ZodEffects,...ft(r)});class Cs extends St{_parse(t){return this._getType(t)===He.undefined?Va(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Cs.create=(e,t)=>new Cs({innerType:e,typeName:nt.ZodOptional,...ft(t)});class Rl extends St{_parse(t){return this._getType(t)===He.null?Va(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Rl.create=(e,t)=>new Rl({innerType:e,typeName:nt.ZodNullable,...ft(t)});class xh extends St{_parse(t){const{ctx:r}=this._processInputParams(t);let n=r.data;return r.parsedType===He.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}xh.create=(e,t)=>new xh({innerType:e,typeName:nt.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...ft(t)});class mh extends St{_parse(t){const{ctx:r}=this._processInputParams(t),n={...r,common:{...r.common,issues:[]}},s=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return ru(s)?s.then(l=>({status:"valid",value:l.status==="valid"?l.value:this._def.catchValue({get error(){return new Vn(n.common.issues)},input:n.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Vn(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}mh.create=(e,t)=>new mh({innerType:e,typeName:nt.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...ft(t)});class Vg extends St{_parse(t){if(this._getType(t)!==He.nan){const n=this._getOrReturnCtx(t);return Fe(n,{code:je.invalid_type,expected:He.nan,received:n.parsedType}),at}return{status:"valid",value:t.data}}}Vg.create=e=>new Vg({typeName:nt.ZodNaN,...ft(e)});class M4 extends St{_parse(t){const{ctx:r}=this._processInputParams(t),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}}class Hh extends St{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.common.async)return(async()=>{const l=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return l.status==="aborted"?at:l.status==="dirty"?(r.dirty(),Fc(l.value)):this._def.out._parseAsync({data:l.value,path:n.path,parent:n})})();{const s=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?at:s.status==="dirty"?(r.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:n.path,parent:n})}}static create(t,r){return new Hh({in:t,out:r,typeName:nt.ZodPipeline})}}class ph extends St{_parse(t){const r=this._def.innerType._parse(t),n=s=>(Cl(s)&&(s.value=Object.freeze(s.value)),s);return ru(r)?r.then(s=>n(s)):n(r)}unwrap(){return this._def.innerType}}ph.create=(e,t)=>new ph({innerType:e,typeName:nt.ZodReadonly,...ft(t)});var nt;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(nt||(nt={}));js.create;const L4=pn.create,F4=nu.create;su.create;mi.create;const U4=Ol.create;iu.create;Cs.create;Rl.create;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var $g;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})($g||($g={}));var Yg;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(Yg||(Yg={}));var qg;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT",e.NULL="NULL"})(qg||(qg={}));var Xg;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",e.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",e.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",e.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",e.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(Xg||(Xg={}));var Wg;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(Wg||(Wg={}));var Zg;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(Zg||(Zg={}));var Kg;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(Kg||(Kg={}));var Jg;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(Jg||(Jg={}));var Qg;(function(e){e.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",e.SIMPLE_SEARCH="SIMPLE_SEARCH",e.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Qg||(Qg={}));var ev;(function(e){e.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",e.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(ev||(ev={}));var tv;(function(e){e.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",e.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",e.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(tv||(tv={}));var rv;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY",e.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(rv||(rv={}));var av;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(av||(av={}));var nv;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(nv||(nv={}));var sv;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.IMAGE_SAFETY="IMAGE_SAFETY"})(sv||(sv={}));var iv;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(iv||(iv={}));var lv;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(lv||(lv={}));var cv;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(cv||(cv={}));var ov;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(ov||(ov={}));var uv;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(uv||(uv={}));var fv;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(fv||(fv={}));var dv;(function(e){e.UNSPECIFIED="UNSPECIFIED",e.BLOCKING="BLOCKING",e.NON_BLOCKING="NON_BLOCKING"})(dv||(dv={}));var hv;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(hv||(hv={}));var xv;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(xv||(xv={}));var mv;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(mv||(mv={}));var pv;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(pv||(pv={}));var gv;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi"})(gv||(gv={}));var vv;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(vv||(vv={}));var _v;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(_v||(_v={}));var yv;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(yv||(yv={}));var wv;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(wv||(wv={}));var bv;(function(e){e.OPTIMIZED="OPTIMIZED",e.LOSSLESS="LOSSLESS"})(bv||(bv={}));var Ev;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(Ev||(Ev={}));var Tv;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"})(Tv||(Tv={}));var Sv;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(Sv||(Sv={}));var kv;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(kv||(kv={}));var Av;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Av||(Av={}));var Nv;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(Nv||(Nv={}));var Cv;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Cv||(Cv={}));var Ov;(function(e){e.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",e.SILENT="SILENT",e.WHEN_IDLE="WHEN_IDLE",e.INTERRUPT="INTERRUPT"})(Ov||(Ov={}));var Dv;(function(e){e.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",e.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",e.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",e.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",e.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",e.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",e.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",e.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",e.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",e.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",e.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",e.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",e.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Dv||(Dv={}));var Rv;(function(e){e.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",e.PLAY="PLAY",e.PAUSE="PAUSE",e.STOP="STOP",e.RESET_CONTEXT="RESET_CONTEXT"})(Rv||(Rv={}));const jv=U4(["string","number","integer","object","array","boolean","null"]);F4([jv,L4(jv)]);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Iv;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Iv||(Iv={}));const B4=async e=>{throw new Error("AI Service not initialized. Please set an API Key.")},P4=async(e,t)=>{throw new Error("AI Service not initialized. Please set an API Key.")},H4=async(e,t,r)=>{throw new Error("AI Service not initialized. Please set an API Key.")},z4=async e=>{throw new Error("AI Service not initialized. Please set an API Key.")},G4=async(e,t,r)=>{throw new Error("AI Service not initialized. Please set an API Key.")},V4=async(e,t,r)=>{throw new Error("AI Service not initialized. Please set an API Key.")},$4=async(e,t,r,n)=>{throw new Error("AI Service not initialized. Please set an API Key.")},C_=async(e,t)=>{throw new Error("AI Service not initialized. Please set an API Key.")},Y4=async(e,t)=>{throw new Error("AI Service not initialized. Please set an API Key.")},Mv=async(e,t,r)=>{throw new Error("AI Service not initialized. Please set an API Key.")},Lv=e=>{const t=Math.cos(2*Math.PI*e),r=Math.sin(2*Math.PI*e);return[t,r]},q4=({data:e,title:t})=>{const r=e.reduce((o,u)=>o+u.value,0);if(r===0)return d.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"No data to display"});let n=0;const s=["#4a90e2","#50e3c2","#f5a623","#f8e71c","#7ed321","#9013fe"],l=e.map((o,u)=>{const h=o.value/r,[x,p]=Lv(n);n+=h;const[v,_]=Lv(n),y=h>.5?1:0;return{path:[`M ${x} ${p}`,`A 1 1 0 ${y} 1 ${v} ${_}`,"L 0 0"].join(" "),color:s[u%s.length],label:o.label}});return d.jsxs("div",{className:"w-full h-full flex flex-col bg-white p-2",children:[d.jsx("text",{x:"50%",y:"10",textAnchor:"middle",fontSize:"10",fontWeight:"bold",fill:"#333",className:"block text-center",children:t}),d.jsxs("div",{className:"flex-grow flex items-center",children:[d.jsx("svg",{viewBox:"-1 -1 2 2",className:"w-2/3 h-full",children:l.map((o,u)=>d.jsx("path",{d:o.path,fill:o.color},u))}),d.jsx("div",{className:"w-1/3 text-[8px] space-y-1",children:l.map((o,u)=>d.jsxs("div",{className:"flex items-center",children:[d.jsx("span",{className:"w-2 h-2 rounded-full mr-1",style:{backgroundColor:o.color}}),d.jsx("span",{className:"truncate",children:o.label})]},u))})]})]})},X4=({data:e,title:t})=>{const r=Math.max(...e.map(x=>x.value),0),n=300,s=150,l={top:20,right:10,bottom:30,left:30},o=n-l.left-l.right,u=s-l.top-l.bottom,h=e.map((x,p)=>{const v=p/(e.length-1)*o,_=u-x.value/r*u;return`${v},${_}`}).join(" ");return d.jsxs("svg",{viewBox:`0 0 ${n} ${s}`,className:"w-full h-full bg-white",children:[d.jsx("text",{x:n/2,y:l.top/2+5,textAnchor:"middle",fontSize:"10",fontWeight:"bold",fill:"#333",children:t}),d.jsxs("g",{transform:`translate(${l.left}, ${l.top})`,children:[d.jsx("line",{x1:"0",y1:"0",x2:"0",y2:u,stroke:"#ddd",strokeWidth:"0.5"}),d.jsx("line",{x1:"0",y1:u,x2:o,y2:u,stroke:"#ddd",strokeWidth:"0.5"}),d.jsx("polyline",{fill:"none",stroke:"#4a90e2",strokeWidth:"1.5",points:h}),e.map((x,p)=>{const v=p/(e.length-1)*o,_=u-x.value/r*u;return d.jsx("circle",{cx:v,cy:_,r:"2",fill:"#4a90e2"},p)})]})]})},W4=({data:e,title:t})=>{const r=Math.max(...e.map(x=>x.value),0),n=300,s=150,l={top:20,right:10,bottom:30,left:30},o=n-l.left-l.right,u=s-l.top-l.bottom,h=e.length>0?o/e.length*.8:0;return d.jsxs("svg",{viewBox:`0 0 ${n} ${s}`,className:"w-full h-full bg-white",children:[d.jsx("text",{x:n/2,y:l.top/2+5,textAnchor:"middle",fontSize:"10",fontWeight:"bold",fill:"#333",children:t}),d.jsxs("g",{transform:`translate(${l.left}, ${l.top})`,children:[d.jsx("line",{x1:"0",y1:"0",x2:"0",y2:u,stroke:"#999",strokeWidth:"0.5"}),[0,r/2,r].map(x=>d.jsxs("g",{transform:`translate(0, ${u-x/r*u})`,children:[d.jsx("line",{x1:"-3",y1:"0",x2:"0",y2:"0",stroke:"#999",strokeWidth:"0.5"}),d.jsx("text",{x:"-5",y:"3",textAnchor:"end",fontSize:"6",fill:"#666",children:x.toFixed(0)})]},x)),e.map((x,p)=>d.jsxs("g",{transform:`translate(${p*o/e.length+o/e.length*.1}, 0)`,children:[d.jsx("rect",{x:"0",y:u-x.value/r*u,width:h,height:x.value/r*u,fill:"#4a90e2"}),d.jsx("text",{x:h/2,y:u+8,textAnchor:"middle",fontSize:"6",fill:"#666",transform:`rotate(-45, ${h/2}, ${u+8})`,children:x.label})]},x.label))]})]})},Z4=({subStep:e,statusColor:t})=>{var r,n;return d.jsx("div",{style:{position:"absolute",left:((r=e.position)==null?void 0:r.x)||0,top:((n=e.position)==null?void 0:n.y)||0,width:192,minHeight:76,padding:"8px",borderRadius:"8px",backgroundColor:"white",borderLeft:`4px solid ${t}`,boxShadow:"0 2px 4px rgba(0,0,0,0.1)",fontSize:"12px",fontFamily:"sans-serif",color:"#333",display:"flex",flexDirection:"column",justifyContent:"center"},children:d.jsx("p",{className:`font-bold break-words ${e.status===Jr.COMPLETED?"line-through text-slate-500":""}`,children:e.text})})},K4=({subSteps:e})=>{if(!e||e.length===0)return d.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-100 text-slate-500 text-sm",children:"No sub-steps to display."});const t=o=>{switch(o){case Jr.COMPLETED:return"#22c55e";case Jr.IN_PROGRESS:return"#3b82f6";default:return"#94a3b8"}},r=192,n=76,s=re.useMemo(()=>{const o=[];return(e||[]).forEach(u=>{var h;if((h=u==null?void 0:u.nextSubStepIds)!=null&&h.length&&u.position){const x={x:u.position.x+r,y:u.position.y+n/2};u.nextSubStepIds.forEach(p=>{const v=e.find(_=>_.id===p);if(v&&v.position){const _={x:v.position.x,y:v.position.y+n/2};o.push({id:`fc-render-${u.id}-${p}`,from:x,to:_,sourceId:u.id,targetId:p})}})}}),o},[e,r,n]),l=re.useMemo(()=>{if(!e||e.length===0)return{minX:0,minY:0,width:400,height:300};let o=0,u=0;return e.forEach(h=>{h.position&&(o=Math.max(o,h.position.x+r),u=Math.max(u,h.position.y+n))}),{minX:0,minY:0,width:o+20,height:u+20}},[e,r,n]);return d.jsx("div",{className:"w-full h-full bg-slate-50 overflow-hidden",style:{fontFamily:"Inter, sans-serif"},children:d.jsxs("svg",{width:"100%",height:"100%",viewBox:`${l.minX} ${l.minY} ${l.width} ${l.height}`,children:[d.jsx("style",{children:`
                    .flowchart-card-container {
                        position: relative;
                        width: 100%;
                        height: 100%;
                        font-family: Inter, sans-serif;
                    }
                    `}),d.jsx("foreignObject",{x:"0",y:"0",width:l.width,height:l.height,children:d.jsx("div",{className:"flowchart-card-container",children:(e||[]).map(o=>d.jsx(Z4,{subStep:o,statusColor:t(o.status)},o.id))})}),s.map(o=>d.jsx(so,{from:o.from,to:o.to,id:o.id},o.id))]})})},J4=({el:e,onUpdate:t,children:r,isSelected:n,onClick:s})=>d.jsx("div",{onClick:l=>{l.stopPropagation(),s()},style:{position:"absolute",left:`${e.position.x}%`,top:`${e.position.y}%`,width:`${e.position.width}%`,height:`${e.position.height}%`,outline:n?"2px solid #3b82f6":"1px dashed transparent",cursor:"move"},className:"transition-all duration-150 hover:outline-dashed hover:outline-slate-400",children:r}),zh=({tasks:e,initialDeck:t,onSave:r,onClose:n,generateUniqueId:s,projectGoal:l,targetDate:o,reportScope:u})=>{const[h,x]=re.useState(t),[p,v]=re.useState(0),[_,y]=re.useState(null),[w,b]=re.useState(!1),[E,j]=re.useState(null),[C,S]=re.useState(!1),L=re.useRef(null),Z=(Q,G)=>{x(A=>({...A,slides:A.slides.map(K=>K.id===Q?{...K,...typeof G=="function"?G(K):K}:K)}))},W=Q=>{const G=h.slides[Q];Z(G.id,{isLocked:!G.isLocked})},I=(Q,G,A)=>{Z(Q,K=>({elements:K.elements.map(N=>N.id===G?{...N,...A}:N)}))},X=async()=>{b(!0),j(null);try{const Q={...h,slides:h.slides.map(K=>K.isLocked?K:{...K,isLocked:void 0})},G=await z4(Q),A={...G,slides:G.slides.map((K,N)=>({...K,isLocked:h.slides[N].isLocked}))};x(A)}catch(Q){j(Q instanceof Error?Q.message:"")}finally{b(!1)}},U=async()=>{b(!0),j(null);try{let Q;u==="project"?Q=await $4(h,e,l,o):Q=await H4(h,e[0],l),x(Q)}catch(Q){j(Q instanceof Error?Q.message:"")}finally{b(!1)}},ee=(Q,G)=>{var A,K,N;for(const P of e){const z=(K=(A=P.extendedDetails)==null?void 0:A.subSteps)==null?void 0:K.find(H=>H.id===Q);if(z){const H=(N=z==null?void 0:z.actionItems)==null?void 0:N.find(se=>se.id===G);if(H)return H}}},te=Q=>{var G,A,K,N,P;switch(Q.type){case"textbox":const z=Q;return d.jsx("textarea",{value:z.content,onChange:H=>I(h.slides[p].id,Q.id,{content:H.target.value}),className:"w-full h-full bg-transparent resize-none border-none outline-none p-2",style:{fontSize:z.fontSize,fontWeight:z.fontWeight,textAlign:z.textAlign,color:"#333"}});case"image":{const H=Q,se=ee(H.subStepId,H.actionItemId),ve=(A=(G=se==null?void 0:se.report)==null?void 0:G.attachments)==null?void 0:A.find(be=>be.id===H.attachmentId);return ve?d.jsx("img",{src:ve.dataUrl,className:"w-full h-full object-contain",alt:ve.name}):d.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:""})}case"table":{const H=Q,se=ee(H.subStepId,H.actionItemId),ve=(K=se==null?void 0:se.report)==null?void 0:K.matrixData;return ve?d.jsx("div",{className:"p-2 overflow-auto h-full",children:d.jsxs("table",{className:"w-full text-[8px] border-collapse bg-white",children:[d.jsx("thead",{children:d.jsx("tr",{className:"bg-slate-200",children:ve.headers.map((be,Ae)=>d.jsx("th",{className:"border border-slate-300 p-1 font-semibold",children:be},Ae))})}),d.jsx("tbody",{children:ve.rows.map((be,Ae)=>d.jsx("tr",{children:be.map((ye,Ye)=>d.jsx("td",{className:"border border-slate-300 p-1",children:ye},`${Ae}-${Ye}`))},Ae))})]})}):d.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:""})}case"chart":{const H=Q,se=ee(H.subStepId,H.actionItemId),ve=(((P=(N=se==null?void 0:se.report)==null?void 0:N.matrixData)==null?void 0:P.rows)||[]).map(be=>({label:be[0],value:parseFloat(be[1])||0})).filter(be=>be.label&&!isNaN(be.value));if(ve.length===0)return d.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:""});switch(H.chartType){case"line":return d.jsx(X4,{data:ve,title:H.title});case"pie":return d.jsx(q4,{data:ve,title:H.title});case"bar":default:return d.jsx(W4,{data:ve,title:H.title})}}case"flowchart":{const H=Q;return H.data&&H.data.subSteps?d.jsx(K4,{subSteps:H.data.subSteps}):d.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:""})}default:return null}},V=()=>window.print(),ge=(Q,G)=>{const A=JSON.stringify(Q,null,2),K=new Blob([A],{type:"application/json"}),N=URL.createObjectURL(K),P=document.createElement("a");P.href=N,P.download=G,document.body.appendChild(P),P.click(),document.body.removeChild(P),URL.revokeObjectURL(N)},Re=Q=>{Q==="pdf"?V():ge(h,"report-deck.json"),S(!1)},Se=()=>{r(h),n()},ae=h.slides[p],ue=u==="project"?`: ${l}`:`: ${e[0].title}`;return d.jsxs(d.Fragment,{children:[d.jsx("style",{children:"@media print { body { -webkit-print-color-adjust: exact; print-color-adjust: exact; } .no-print { display: none !important; } .slide-print-page { page-break-after: always; width: 100vw; height: 56.25vw; /* 16:9 aspect ratio */ box-shadow: none !important; border: none; } }"}),d.jsxs("div",{className:"fixed inset-0 bg-slate-900 bg-opacity-80 z-[100] flex flex-col p-4 no-print",onClick:()=>y(null),children:[d.jsxs("header",{className:"flex items-center justify-between pb-4 flex-shrink-0",children:[d.jsx("h2",{className:"text-xl font-bold text-white truncate pr-4",children:ue}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsxs("button",{onClick:U,disabled:w,className:"flex items-center gap-2 px-3 py-1.5 text-xs font-semibold text-white bg-green-600 rounded-md hover:bg-green-700 disabled:bg-slate-400",children:[d.jsx(bu,{className:"w-4 h-4"})," ",w?"...":""]}),d.jsxs("button",{onClick:X,disabled:w,className:"flex items-center gap-2 px-3 py-1.5 text-xs font-semibold text-white bg-purple-600 rounded-md hover:bg-purple-700 disabled:bg-slate-400",children:[d.jsx(Bh,{className:"w-4 h-4"})," ",w?"...":"AI"]}),d.jsxs("div",{className:"relative",ref:L,children:[d.jsx("button",{onClick:()=>S(Q=>!Q),className:"p-2 bg-slate-600 text-white rounded-md hover:bg-slate-500",title:"",children:d.jsx(Nl,{className:"w-5 h-5"})}),C&&d.jsxs("div",{className:"absolute right-0 mt-2 w-32 bg-white rounded-md shadow-lg z-10",children:[d.jsx("button",{onClick:()=>Re("pdf"),className:"block w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-100",children:"PDF"}),d.jsx("button",{onClick:()=>Re("json"),className:"block w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-100",children:"JSON"})]})]}),d.jsxs("button",{onClick:n,className:"p-2 bg-slate-600 text-white rounded-md hover:bg-slate-500",title:"",children:[" ",d.jsx(na,{className:"w-5 h-5"})]}),d.jsx("button",{onClick:Se,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-semibold text-sm",children:""})]})]}),E&&d.jsx("div",{className:"text-red-400 text-sm mb-2 bg-red-100 border border-red-400 p-2 rounded-md",children:E}),d.jsxs("div",{className:"flex-grow flex gap-4 min-h-0",children:[d.jsx("aside",{className:"w-40 bg-slate-800 rounded-lg p-2 flex flex-col gap-2 overflow-y-auto",children:h.slides.map((Q,G)=>d.jsxs("div",{onClick:()=>v(G),className:`relative group aspect-video bg-white rounded cursor-pointer transition-all p-1 ${p===G?"ring-4 ring-blue-500":"hover:ring-2 ring-blue-400"}`,children:[d.jsx("div",{className:"absolute top-1 right-1 z-10 opacity-50 group-hover:opacity-100 transition-opacity",children:d.jsx("button",{onClick:A=>{A.stopPropagation(),W(G)},title:Q.isLocked?"":"",className:`p-1 rounded-full ${Q.isLocked?"bg-blue-600 text-white":"bg-slate-500 text-white"}`,children:Q.isLocked?d.jsx(KS,{className:"w-3 h-3"}):d.jsx(JS,{className:"w-3 h-3"})})}),d.jsx("div",{className:"w-full h-full transform scale-[0.1] origin-top-left overflow-hidden relative",children:Q.elements.map(A=>d.jsx("div",{style:{position:"absolute",left:`${A.position.x}%`,top:`${A.position.y}%`,width:`${A.position.width}%`,height:`${A.position.height}%`,backgroundColor:"#ccc"}},A.id))}),d.jsx("span",{className:"text-white text-xs block text-center -mt-2",children:G+1})]},Q.id))}),d.jsx("main",{className:"flex-grow flex items-center justify-center",children:ae&&d.jsx("div",{className:"aspect-video w-full max-w-[100vh] bg-white shadow-2xl rounded-lg relative overflow-hidden",children:ae.elements.map(Q=>d.jsx(J4,{el:Q,onUpdate:()=>{},isSelected:_===Q.id,onClick:()=>y(Q.id),children:te(Q)},Q.id))})}),d.jsxs("aside",{className:"w-64 bg-slate-800 rounded-lg p-3 text-white overflow-y-auto",children:[d.jsx("h3",{className:"font-bold border-b border-slate-600 pb-2 mb-3",children:""}),d.jsx("p",{className:"text-xs text-slate-400",children:""})]})]})]}),d.jsx("div",{className:"hidden print:block",children:h.slides.map((Q,G)=>d.jsx("div",{className:"slide-print-page bg-white relative",children:d.jsx("div",{className:"w-full h-full relative",children:Q.elements.map(A=>d.jsx("div",{style:{position:"absolute",left:`${A.position.x}%`,top:`${A.position.y}%`,width:`${A.position.width}%`,height:`${A.position.height}%`},children:te(A)},A.id))})},Q.id))})]})},O_=({onClose:e,onDownloadAndStartNew:t,onStartNewWithoutSaving:r})=>d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:d.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md",children:[d.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200",children:[d.jsxs("h3",{className:"text-lg font-bold text-slate-800 flex items-center",children:[d.jsx(El,{className:"w-6 h-6 mr-2 text-yellow-500"}),""]}),d.jsx("button",{onClick:e,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",title:"","aria-label":"",children:d.jsx(na,{className:"w-5 h-5"})})]}),d.jsxs("div",{className:"p-6",children:[d.jsx("p",{className:"text-slate-700",children:""}),d.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"JSON"})]}),d.jsxs("footer",{className:"p-4 bg-slate-50 border-t border-slate-200 flex flex-col sm:flex-row justify-end gap-3 rounded-b-xl",children:[d.jsx("button",{type:"button",onClick:e,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:""}),d.jsx("button",{type:"button",onClick:r,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-red-700 bg-red-100 border border-transparent rounded-md shadow-sm hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:""}),d.jsxs("button",{type:"submit",onClick:t,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 flex items-center justify-center gap-2",children:[d.jsx(Nl,{className:"w-4 h-4"}),""]})]})]})});function Q4(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;const r=document.implementation.createHTMLDocument(),n=r.createElement("base"),s=r.createElement("a");return r.head.appendChild(n),r.body.appendChild(s),t&&(n.href=t),s.href=e,s.href}const ek=(()=>{let e=0;const t=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${t()}${e}`)})();function Os(e){const t=[];for(let r=0,n=e.length;r<n;r++)t.push(e[r]);return t}let pl=null;function D_(e={}){return pl||(e.includeStyleProperties?(pl=e.includeStyleProperties,pl):(pl=Os(window.getComputedStyle(document.documentElement)),pl))}function lu(e,t){const n=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(t);return n?parseFloat(n.replace("px","")):0}function tk(e){const t=lu(e,"border-left-width"),r=lu(e,"border-right-width");return e.clientWidth+t+r}function rk(e){const t=lu(e,"border-top-width"),r=lu(e,"border-bottom-width");return e.clientHeight+t+r}function R_(e,t={}){const r=t.width||tk(e),n=t.height||rk(e);return{width:r,height:n}}function ak(){let e,t;try{t=process}catch{}const r=t&&t.env?t.env.devicePixelRatio:null;return r&&(e=parseInt(r,10),Number.isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}const Ta=16384;function nk(e){(e.width>Ta||e.height>Ta)&&(e.width>Ta&&e.height>Ta?e.width>e.height?(e.height*=Ta/e.width,e.width=Ta):(e.width*=Ta/e.height,e.height=Ta):e.width>Ta?(e.height*=Ta/e.width,e.width=Ta):(e.width*=Ta/e.height,e.height=Ta))}function cu(e){return new Promise((t,r)=>{const n=new Image;n.onload=()=>{n.decode().then(()=>{requestAnimationFrame(()=>t(n))})},n.onerror=r,n.crossOrigin="anonymous",n.decoding="async",n.src=e})}async function sk(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(t=>`data:image/svg+xml;charset=utf-8,${t}`)}async function ik(e,t,r){const n="http://www.w3.org/2000/svg",s=document.createElementNS(n,"svg"),l=document.createElementNS(n,"foreignObject");return s.setAttribute("width",`${t}`),s.setAttribute("height",`${r}`),s.setAttribute("viewBox",`0 0 ${t} ${r}`),l.setAttribute("width","100%"),l.setAttribute("height","100%"),l.setAttribute("x","0"),l.setAttribute("y","0"),l.setAttribute("externalResourcesRequired","true"),s.appendChild(l),l.appendChild(e),sk(s)}const ha=(e,t)=>{if(e instanceof t)return!0;const r=Object.getPrototypeOf(e);return r===null?!1:r.constructor.name===t.name||ha(r,t)};function lk(e){const t=e.getPropertyValue("content");return`${e.cssText} content: '${t.replace(/'|"/g,"")}';`}function ck(e,t){return D_(t).map(r=>{const n=e.getPropertyValue(r),s=e.getPropertyPriority(r);return`${r}: ${n}${s?" !important":""};`}).join(" ")}function ok(e,t,r,n){const s=`.${e}:${t}`,l=r.cssText?lk(r):ck(r,n);return document.createTextNode(`${s}{${l}}`)}function Fv(e,t,r,n){const s=window.getComputedStyle(e,r),l=s.getPropertyValue("content");if(l===""||l==="none")return;const o=ek();try{t.className=`${t.className} ${o}`}catch{return}const u=document.createElement("style");u.appendChild(ok(o,r,s,n)),t.appendChild(u)}function uk(e,t,r){Fv(e,t,":before",r),Fv(e,t,":after",r)}const Uv="application/font-woff",Bv="image/jpeg",fk={woff:Uv,woff2:Uv,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:Bv,jpeg:Bv,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function dk(e){const t=/\.([^./]*?)$/g.exec(e);return t?t[1]:""}function Gh(e){const t=dk(e).toLowerCase();return fk[t]||""}function hk(e){return e.split(/,/)[1]}function gh(e){return e.search(/^(data:)/)!==-1}function xk(e,t){return`data:${t};base64,${e}`}async function j_(e,t,r){const n=await fetch(e,t);if(n.status===404)throw new Error(`Resource "${n.url}" not found`);const s=await n.blob();return new Promise((l,o)=>{const u=new FileReader;u.onerror=o,u.onloadend=()=>{try{l(r({res:n,result:u.result}))}catch(h){o(h)}},u.readAsDataURL(s)})}const $d={};function mk(e,t,r){let n=e.replace(/\?.*/,"");return r&&(n=e),/ttf|otf|eot|woff2?/i.test(n)&&(n=n.replace(/.*\//,"")),t?`[${t}]${n}`:n}async function Vh(e,t,r){const n=mk(e,t,r.includeQueryParams);if($d[n]!=null)return $d[n];r.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());let s;try{const l=await j_(e,r.fetchRequestInit,({res:o,result:u})=>(t||(t=o.headers.get("Content-Type")||""),hk(u)));s=xk(l,t)}catch(l){s=r.imagePlaceholder||"";let o=`Failed to fetch resource: ${e}`;l&&(o=typeof l=="string"?l:l.message),o&&console.warn(o)}return $d[n]=s,s}async function pk(e){const t=e.toDataURL();return t==="data:,"?e.cloneNode(!1):cu(t)}async function gk(e,t){if(e.currentSrc){const l=document.createElement("canvas"),o=l.getContext("2d");l.width=e.clientWidth,l.height=e.clientHeight,o==null||o.drawImage(e,0,0,l.width,l.height);const u=l.toDataURL();return cu(u)}const r=e.poster,n=Gh(r),s=await Vh(r,n,t);return cu(s)}async function vk(e,t){var r;try{if(!((r=e==null?void 0:e.contentDocument)===null||r===void 0)&&r.body)return await Eu(e.contentDocument.body,t,!0)}catch{}return e.cloneNode(!1)}async function _k(e,t){return ha(e,HTMLCanvasElement)?pk(e):ha(e,HTMLVideoElement)?gk(e,t):ha(e,HTMLIFrameElement)?vk(e,t):e.cloneNode(I_(e))}const yk=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SLOT",I_=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SVG";async function wk(e,t,r){var n,s;if(I_(t))return t;let l=[];return yk(e)&&e.assignedNodes?l=Os(e.assignedNodes()):ha(e,HTMLIFrameElement)&&(!((n=e.contentDocument)===null||n===void 0)&&n.body)?l=Os(e.contentDocument.body.childNodes):l=Os(((s=e.shadowRoot)!==null&&s!==void 0?s:e).childNodes),l.length===0||ha(e,HTMLVideoElement)||await l.reduce((o,u)=>o.then(()=>Eu(u,r)).then(h=>{h&&t.appendChild(h)}),Promise.resolve()),t}function bk(e,t,r){const n=t.style;if(!n)return;const s=window.getComputedStyle(e);s.cssText?(n.cssText=s.cssText,n.transformOrigin=s.transformOrigin):D_(r).forEach(l=>{let o=s.getPropertyValue(l);l==="font-size"&&o.endsWith("px")&&(o=`${Math.floor(parseFloat(o.substring(0,o.length-2)))-.1}px`),ha(e,HTMLIFrameElement)&&l==="display"&&o==="inline"&&(o="block"),l==="d"&&t.getAttribute("d")&&(o=`path(${t.getAttribute("d")})`),n.setProperty(l,o,s.getPropertyPriority(l))})}function Ek(e,t){ha(e,HTMLTextAreaElement)&&(t.innerHTML=e.value),ha(e,HTMLInputElement)&&t.setAttribute("value",e.value)}function Tk(e,t){if(ha(e,HTMLSelectElement)){const r=t,n=Array.from(r.children).find(s=>e.value===s.getAttribute("value"));n&&n.setAttribute("selected","")}}function Sk(e,t,r){return ha(t,Element)&&(bk(e,t,r),uk(e,t,r),Ek(e,t),Tk(e,t)),t}async function kk(e,t){const r=e.querySelectorAll?e.querySelectorAll("use"):[];if(r.length===0)return e;const n={};for(let l=0;l<r.length;l++){const u=r[l].getAttribute("xlink:href");if(u){const h=e.querySelector(u),x=document.querySelector(u);!h&&x&&!n[u]&&(n[u]=await Eu(x,t,!0))}}const s=Object.values(n);if(s.length){const l="http://www.w3.org/1999/xhtml",o=document.createElementNS(l,"svg");o.setAttribute("xmlns",l),o.style.position="absolute",o.style.width="0",o.style.height="0",o.style.overflow="hidden",o.style.display="none";const u=document.createElementNS(l,"defs");o.appendChild(u);for(let h=0;h<s.length;h++)u.appendChild(s[h]);e.appendChild(o)}return e}async function Eu(e,t,r){return!r&&t.filter&&!t.filter(e)?null:Promise.resolve(e).then(n=>_k(n,t)).then(n=>wk(e,n,t)).then(n=>Sk(e,n,t)).then(n=>kk(n,t))}const M_=/url\((['"]?)([^'"]+?)\1\)/g,Ak=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,Nk=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function Ck(e){const t=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${t})(['"]?\\))`,"g")}function Ok(e){const t=[];return e.replace(M_,(r,n,s)=>(t.push(s),r)),t.filter(r=>!gh(r))}async function Dk(e,t,r,n,s){try{const l=r?Q4(t,r):t,o=Gh(t);let u;return s||(u=await Vh(l,o,n)),e.replace(Ck(t),`$1${u}$3`)}catch{}return e}function Rk(e,{preferredFontFormat:t}){return t?e.replace(Nk,r=>{for(;;){const[n,,s]=Ak.exec(r)||[];if(!s)return"";if(s===t)return`src: ${n};`}}):e}function L_(e){return e.search(M_)!==-1}async function F_(e,t,r){if(!L_(e))return e;const n=Rk(e,r);return Ok(n).reduce((l,o)=>l.then(u=>Dk(u,o,t,r)),Promise.resolve(n))}async function gl(e,t,r){var n;const s=(n=t.style)===null||n===void 0?void 0:n.getPropertyValue(e);if(s){const l=await F_(s,null,r);return t.style.setProperty(e,l,t.style.getPropertyPriority(e)),!0}return!1}async function jk(e,t){await gl("background",e,t)||await gl("background-image",e,t),await gl("mask",e,t)||await gl("-webkit-mask",e,t)||await gl("mask-image",e,t)||await gl("-webkit-mask-image",e,t)}async function Ik(e,t){const r=ha(e,HTMLImageElement);if(!(r&&!gh(e.src))&&!(ha(e,SVGImageElement)&&!gh(e.href.baseVal)))return;const n=r?e.src:e.href.baseVal,s=await Vh(n,Gh(n),t);await new Promise((l,o)=>{e.onload=l,e.onerror=t.onImageErrorHandler?(...h)=>{try{l(t.onImageErrorHandler(...h))}catch(x){o(x)}}:o;const u=e;u.decode&&(u.decode=l),u.loading==="lazy"&&(u.loading="eager"),r?(e.srcset="",e.src=s):e.href.baseVal=s})}async function Mk(e,t){const n=Os(e.childNodes).map(s=>U_(s,t));await Promise.all(n).then(()=>e)}async function U_(e,t){ha(e,Element)&&(await jk(e,t),await Ik(e,t),await Mk(e,t))}function Lk(e,t){const{style:r}=e;t.backgroundColor&&(r.backgroundColor=t.backgroundColor),t.width&&(r.width=`${t.width}px`),t.height&&(r.height=`${t.height}px`);const n=t.style;return n!=null&&Object.keys(n).forEach(s=>{r[s]=n[s]}),e}const Pv={};async function Hv(e){let t=Pv[e];if(t!=null)return t;const n=await(await fetch(e)).text();return t={url:e,cssText:n},Pv[e]=t,t}async function zv(e,t){let r=e.cssText;const n=/url\(["']?([^"')]+)["']?\)/g,l=(r.match(/url\([^)]+\)/g)||[]).map(async o=>{let u=o.replace(n,"$1");return u.startsWith("https://")||(u=new URL(u,e.url).href),j_(u,t.fetchRequestInit,({result:h})=>(r=r.replace(o,`url(${h})`),[o,h]))});return Promise.all(l).then(()=>r)}function Gv(e){if(e==null)return[];const t=[],r=/(\/\*[\s\S]*?\*\/)/gi;let n=e.replace(r,"");const s=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const h=s.exec(n);if(h===null)break;t.push(h[0])}n=n.replace(s,"");const l=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,o="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",u=new RegExp(o,"gi");for(;;){let h=l.exec(n);if(h===null){if(h=u.exec(n),h===null)break;l.lastIndex=u.lastIndex}else u.lastIndex=l.lastIndex;t.push(h[0])}return t}async function Fk(e,t){const r=[],n=[];return e.forEach(s=>{if("cssRules"in s)try{Os(s.cssRules||[]).forEach((l,o)=>{if(l.type===CSSRule.IMPORT_RULE){let u=o+1;const h=l.href,x=Hv(h).then(p=>zv(p,t)).then(p=>Gv(p).forEach(v=>{try{s.insertRule(v,v.startsWith("@import")?u+=1:s.cssRules.length)}catch(_){console.error("Error inserting rule from remote css",{rule:v,error:_})}})).catch(p=>{console.error("Error loading remote css",p.toString())});n.push(x)}})}catch(l){const o=e.find(u=>u.href==null)||document.styleSheets[0];s.href!=null&&n.push(Hv(s.href).then(u=>zv(u,t)).then(u=>Gv(u).forEach(h=>{o.insertRule(h,o.cssRules.length)})).catch(u=>{console.error("Error loading remote stylesheet",u)})),console.error("Error inlining remote css file",l)}}),Promise.all(n).then(()=>(e.forEach(s=>{if("cssRules"in s)try{Os(s.cssRules||[]).forEach(l=>{r.push(l)})}catch(l){console.error(`Error while reading CSS rules from ${s.href}`,l)}}),r))}function Uk(e){return e.filter(t=>t.type===CSSRule.FONT_FACE_RULE).filter(t=>L_(t.style.getPropertyValue("src")))}async function Bk(e,t){if(e.ownerDocument==null)throw new Error("Provided element is not within a Document");const r=Os(e.ownerDocument.styleSheets),n=await Fk(r,t);return Uk(n)}function B_(e){return e.trim().replace(/["']/g,"")}function Pk(e){const t=new Set;function r(n){(n.style.fontFamily||getComputedStyle(n).fontFamily).split(",").forEach(l=>{t.add(B_(l))}),Array.from(n.children).forEach(l=>{l instanceof HTMLElement&&r(l)})}return r(e),t}async function Hk(e,t){const r=await Bk(e,t),n=Pk(e);return(await Promise.all(r.filter(l=>n.has(B_(l.style.fontFamily))).map(l=>{const o=l.parentStyleSheet?l.parentStyleSheet.href:null;return F_(l.cssText,o,t)}))).join(`
`)}async function zk(e,t){const r=t.fontEmbedCSS!=null?t.fontEmbedCSS:t.skipFonts?null:await Hk(e,t);if(r){const n=document.createElement("style"),s=document.createTextNode(r);n.appendChild(s),e.firstChild?e.insertBefore(n,e.firstChild):e.appendChild(n)}}async function Gk(e,t={}){const{width:r,height:n}=R_(e,t),s=await Eu(e,t,!0);return await zk(s,t),await U_(s,t),Lk(s,t),await ik(s,r,n)}async function Vk(e,t={}){const{width:r,height:n}=R_(e,t),s=await Gk(e,t),l=await cu(s),o=document.createElement("canvas"),u=o.getContext("2d"),h=t.pixelRatio||ak(),x=t.canvasWidth||r,p=t.canvasHeight||n;return o.width=x*h,o.height=p*h,t.skipAutoScale||nk(o),o.style.width=`${x}`,o.style.height=`${p}`,t.backgroundColor&&(u.fillStyle=t.backgroundColor,u.fillRect(0,0,o.width,o.height)),u.drawImage(l,0,0,o.width,o.height),o}async function $k(e,t={}){return(await Vk(e,t)).toDataURL()}const Uc=40,Vv=64,$v=320,Yv=["#3B82F6","#F59E0B","#10B981","#EF4444","#6B7280","#6366F1","#EC4899","#8B5CF6"],Yk=({data:e,onClose:t,onItemClick:r,onRegenerate:n,isRegenerating:s})=>{const[l,o]=re.useState(!0),[u,h]=re.useState(new Set),[x,p]=re.useState("all"),v=re.useRef(null),[_,y]=re.useState(!1),[w,b]=re.useState("day"),[E,j]=re.useState({start:"",end:""}),S={day:40,week:15,month:5}[w],L=re.useMemo(()=>{const Q=new Map;return e.filter(G=>G.type==="task").forEach((G,A)=>{Q.set(G.id,Yv[A%Yv.length])}),Q},[e]),Z=re.useCallback((Q,G)=>{if(Q.type==="task")return Q.id;let A=Q;for(;A.parentId;){const K=G.get(A.parentId);if(!K)return null;if(K.type==="task")return K.id;A=K}return null},[]),W=re.useMemo(()=>new Map(e.map(Q=>[Q.id,Q])),[e]),I=re.useCallback(Q=>{const G=Z(Q,W);return G&&L.get(G)||"#9CA3AF"},[W,L,Z]);re.useEffect(()=>{const Q=new Set(e.filter(G=>G.type==="task").map(G=>G.id));h(Q)},[e]);const X=Q=>{h(G=>{const A=new Set(G);return A.has(Q)?A.delete(Q):A.add(Q),A})},U=re.useMemo(()=>{const Q=[];return e.filter(A=>A.type==="task").forEach(A=>{Q.push(A),u.has(A.id)&&e.filter(N=>N.type==="substep"&&N.parentId===A.id).forEach(N=>{if(Q.push(N),u.has(N.id)){const P=e.filter(z=>{if(z.type!=="actionitem"||z.parentId!==N.id)return!1;if(x==="all")return!0;const H=z.progress===100;return x==="completed"?H:x==="pending"?!H:!0});Q.push(...P)}})}),Q},[e,u,x]),{timelineStart:ee,totalDays:te}=re.useMemo(()=>{if(e.length===0)return{timelineStart:new Date,totalDays:30};const Q=e.map(H=>new Date(H.start)).filter(H=>!isNaN(H.getTime())),G=e.map(H=>new Date(H.end)).filter(H=>!isNaN(H.getTime()));let A,K;Q.length===0||G.length===0?(A=new Date,K=new Date,K.setMonth(K.getMonth()+1)):(A=new Date(Math.min(...Q.map(H=>H.getTime()))),K=new Date(Math.max(...G.map(H=>H.getTime()))));let N=E.start?new Date(E.start):A,P=E.end?new Date(E.end):K;isNaN(N.getTime())&&(N=A),isNaN(P.getTime())&&(P=K),P<N&&(P=N),N.setDate(N.getDate()-2),P.setDate(P.getDate()+5);const z=(P.getTime()-N.getTime())/(1e3*3600*24);return{timelineStart:N,totalDays:Math.ceil(z)}},[e,E]),V=re.useMemo(()=>{const Q=K=>{K=new Date(Date.UTC(K.getFullYear(),K.getMonth(),K.getDate())),K.setUTCDate(K.getUTCDate()+4-(K.getUTCDay()||7));const N=new Date(Date.UTC(K.getUTCFullYear(),0,1));return Math.ceil(((K.getTime()-N.getTime())/864e5+1)/7)},G=[];let A=new Date(ee);if(w==="day")for(let K=0;K<te;K++)G.push({secondaryLabel:A.toLocaleDateString("ja-JP",{weekday:"short"}),label:String(A.getDate()),width:S}),A.setDate(A.getDate()+1);else if(w==="week")for(let K=0;K<te;K++)(A.getDay()===1||G.length===0)&&G.push({label:`W${Q(A)}`,secondaryLabel:A.toLocaleDateString("ja-JP",{month:"short"}),width:0}),G[G.length-1].width+=S,A.setDate(A.getDate()+1);else if(w==="month"){let K=-1;for(let N=0;N<te;N++){const P=A.getMonth();P!==K&&(K=P,G.push({label:A.toLocaleDateString("ja-JP",{month:"long",year:"numeric"}),width:0})),G[G.length-1].width+=S,A.setDate(A.getDate()+1)}}return G},[ee,te,w,S]),ge=Q=>{const G=new Date(Q);return isNaN(G.getTime())?-1:(G.getTime()-ee.getTime())/(1e3*3600*24)},Re=Q=>{switch(Q){case"substep":return"pl-5";case"actionitem":return"pl-9";default:return"pl-1"}},Se=Q=>e.some(G=>G.parentId===Q),ae=re.useCallback(()=>{if(v.current===null){alert("");return}y(!0),$k(v.current,{cacheBust:!0,backgroundColor:"#ffffff",width:v.current.scrollWidth,height:v.current.scrollHeight}).then(Q=>{const G=document.createElement("a");G.download="gantt-chart.png",G.href=Q,G.click()}).catch(Q=>{console.error("",Q),alert("")}).finally(()=>{y(!1)})},[]),ue=re.useMemo(()=>V.reduce((Q,G)=>Q+G.width,0),[V]);return d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex flex-col p-4 z-[80]",children:d.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full h-full flex flex-col",children:[d.jsxs("header",{className:"flex-shrink-0 flex flex-wrap items-center justify-between p-4 border-b gap-4",children:[d.jsx("h2",{className:"text-xl font-bold text-slate-800",children:""}),d.jsxs("div",{className:"flex items-center flex-wrap gap-x-6 gap-y-2",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-sm font-medium text-slate-600",children:":"}),d.jsx("div",{className:"flex items-center rounded-md bg-slate-100 p-1",children:["day","week","month"].map(Q=>d.jsx("button",{onClick:()=>b(Q),className:`px-3 py-1 text-xs capitalize rounded-md ${w===Q?"bg-white shadow-sm font-semibold text-blue-600":""}`,children:Q},Q))})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-sm font-medium text-slate-600",children:":"}),d.jsx("input",{type:"date",value:E.start,onChange:Q=>j(G=>({...G,start:Q.target.value})),className:"p-1 border rounded-md text-sm"}),d.jsx("span",{children:"-"}),d.jsx("input",{type:"date",value:E.end,onChange:Q=>j(G=>({...G,end:Q.target.value})),className:"p-1 border rounded-md text-sm"}),d.jsx("button",{onClick:()=>j({start:"",end:""}),className:"text-xs px-2 py-1 bg-slate-200 rounded-md hover:bg-slate-300",children:""})]}),d.jsxs("button",{onClick:ae,disabled:_,className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-green-600 rounded-md hover:bg-green-700 disabled:bg-slate-400",children:[_?d.jsx(Fr,{size:"sm",color:"border-white"}):d.jsx(Nl,{className:"w-4 h-4"}),"PNG"]}),d.jsxs("button",{onClick:t,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-semibold text-slate-700 bg-slate-100 rounded-md hover:bg-slate-200",children:[d.jsx(na,{className:"w-5 h-5"}),""]})]})]}),d.jsxs("div",{className:"flex-shrink-0 p-4 border-b flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-1 rounded-full bg-slate-100 p-1",children:[d.jsx("button",{onClick:()=>p("all"),className:`px-3 py-1 text-xs rounded-full ${x==="all"?"bg-white shadow-sm":""}`,children:""}),d.jsx("button",{onClick:()=>p("pending"),className:`px-3 py-1 text-xs rounded-full ${x==="pending"?"bg-white shadow-sm":""}`,children:""}),d.jsx("button",{onClick:()=>p("completed"),className:`px-3 py-1 text-xs rounded-full ${x==="completed"?"bg-white shadow-sm":""}`,children:""})]}),d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsxs("button",{onClick:n,disabled:s,className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:bg-slate-400",children:[s?d.jsx(Fr,{size:"sm",color:"border-white"}):d.jsx(bu,{className:"w-4 h-4"}),"AI"]}),d.jsxs("label",{className:"flex items-center text-sm text-slate-600 cursor-pointer",children:[d.jsx("input",{type:"checkbox",checked:l,onChange:()=>o(Q=>!Q),className:"w-4 h-4 mr-2 accent-blue-600"}),""]})]})]}),d.jsx("div",{className:"flex-grow overflow-auto relative",children:d.jsxs("div",{ref:v,className:"grid",style:{gridTemplateColumns:`${$v}px 1fr`,width:`${$v+ue}px`},children:[d.jsx("div",{className:"sticky top-0 left-0 z-30 flex items-center p-2 font-semibold text-sm border-b border-r bg-slate-100 text-slate-800",style:{gridColumn:1,gridRow:1,height:Vv},children:" / "}),d.jsx("div",{className:"sticky top-0 z-20 border-b bg-slate-50",style:{gridColumn:2,gridRow:1,height:Vv},children:d.jsx("div",{className:"flex h-full",children:V.map((Q,G)=>d.jsxs("div",{className:"border-r text-center text-[10px] flex flex-col items-center justify-center",style:{width:Q.width},children:[Q.secondaryLabel&&d.jsx("span",{className:"font-semibold text-slate-600",children:Q.secondaryLabel}),d.jsx("div",{className:`font-bold text-slate-800 ${w==="day"?"text-lg":"text-sm"}`,children:Q.label})]},G))})}),d.jsx("div",{className:"pointer-events-none flex",style:{gridColumn:2,gridRow:`2 / span ${U.length}`},children:V.map((Q,G)=>d.jsx("div",{className:"h-full border-r border-slate-200",style:{width:Q.width}},G))}),U.map((Q,G)=>{const A=I(Q),K=(()=>{const ve=U[G+1];return ve?Z(Q,W)!==Z(ve,W):!0})(),N=ge(Q.start),P=Math.max(.2,ge(Q.end)-N+1),z=N*S,H=P*S,se={task:{height:"24px"},substep:{height:"20px"},actionitem:{height:"8px"}};return d.jsxs(Gn.Fragment,{children:[d.jsxs("div",{className:"sticky left-0 z-10 flex items-center border-r bg-slate-50",style:{gridColumn:1,gridRow:G+2,height:Uc,borderBottom:K?`2px solid ${A}`:"1px solid #e5e7eb"},children:[d.jsx("div",{className:"w-1 h-full flex-shrink-0",style:{backgroundColor:A}}),d.jsxs("div",{className:`flex items-center w-full ${Re(Q.type)}`,children:[(Q.type==="task"||Q.type==="substep")&&(Se(Q.id)?d.jsx(ZS,{onClick:()=>X(Q.id),className:`w-4 h-4 mr-1 text-slate-500 cursor-pointer transition-transform ${u.has(Q.id)?"rotate-0":"-rotate-90"}`}):d.jsx("div",{className:"w-4 h-4 mr-1"})),Q.type==="actionitem"&&(Q.progress===100?d.jsx(bo,{className:"w-3.5 h-3.5 text-green-600 mr-2 flex-shrink-0"}):d.jsx(wu,{className:"w-3.5 h-3.5 text-slate-400 mr-2 flex-shrink-0"})),d.jsx("span",{onClick:()=>r==null?void 0:r(Q),className:`truncate text-xs ${Q.type==="task"?"font-semibold text-slate-800":"text-slate-600"} ${r?"cursor-pointer hover:text-blue-600":""}`,title:Q.name,children:Q.name})]})]}),d.jsx("div",{className:"relative",style:{gridColumn:2,gridRow:G+2,borderBottom:K?`2px solid ${A}`:"1px solid #e5e7eb"},children:N>=0&&d.jsx("div",{title:`${Q.name} (${Q.progress}%)`,onClick:()=>r==null?void 0:r(Q),className:"absolute h-full flex items-center group",style:{left:z,width:H,cursor:r?"pointer":"default"},children:d.jsx("div",{className:"w-full rounded",style:{...se[Q.type],backgroundColor:A},children:d.jsx("div",{className:"bg-black bg-opacity-30 h-full rounded",style:{width:`${Q.progress}%`}})})})})]},Q.id)}),d.jsx("div",{style:{gridColumn:2,gridRow:`2 / span ${U.length}`,position:"relative",pointerEvents:"none"},children:l&&d.jsx(qk,{items:U,getDaysFromStart:ge,dayWidth:S})})]})})]})})},qk=({items:e,getDaysFromStart:t,dayWidth:r})=>{const n=re.useMemo(()=>{const s=[],l=new Map(e.map((o,u)=>[o.id,u]));return e.forEach((o,u)=>{(o.dependencies||[]).forEach(h=>{const x=l.get(h),p=x!==void 0?e[x]:void 0;if(p&&x!==void 0){const v=t(p.end),_=t(o.start);if(v<0||_<0)return;const y=(v+1)*r,w=x*Uc+Uc/2,b=_*r,E=u*Uc+Uc/2,j=y+20,C=b-20,S=`M ${y} ${w} C ${j} ${w}, ${C} ${E}, ${b} ${E}`;s.push({key:`${h}-${o.id}`,d:S})}})}),s},[e,t,r]);return d.jsxs("svg",{className:"absolute top-0 left-0 w-full h-full pointer-events-none",overflow:"visible",children:[d.jsx("defs",{children:d.jsx("marker",{id:"gantt_arrowhead",markerWidth:"5",markerHeight:"4",refX:"5",refY:"2",orient:"auto",children:d.jsx("polygon",{points:"0 0, 5 2, 0 4",fill:"#4b5563"})})}),n.map(s=>d.jsx("path",{d:s.d,stroke:"#4b5563",strokeWidth:"1",fill:"none",markerEnd:"url(#gantt_arrowhead)"},s.key))]})},Xk=({tasks:e,projectGoal:t,targetDate:r,ganttData:n,projectReportDeck:s,onClose:l,onReportGenerated:o,generateUniqueId:u})=>{const[h,x]=re.useState("list"),[p,v]=re.useState(new Set),[_,y]=re.useState(""),[w,b]=re.useState(!1),[E,j]=re.useState(null),[C,S]=re.useState({key:"taskName",direction:"ascending"}),[L,Z]=re.useState("slides"),[W,I]=re.useState(null),X=re.useMemo(()=>{const A=[];return n&&A.push({id:"gantt-chart-main",name:" ",type:"Gantt Chart",taskName:"",subStepName:"",actionItemName:"",source:{name:" ",type:"json",content:n}}),s&&A.push({id:"project-report-main",name:"",type:"Project Report",taskName:"",subStepName:"",actionItemName:"",source:{name:"",type:"json",content:s}}),e.forEach(K=>{var N,P,z,H,se;(N=K.extendedDetails)!=null&&N.reportDeck&&A.push({id:`task-report-${K.id}`,name:`: ${K.title}`,type:"Task Report",taskName:K.title,subStepName:"",actionItemName:"",source:{name:`: ${K.title}`,type:"json",content:K.extendedDetails.reportDeck}}),(z=(P=K.extendedDetails)==null?void 0:P.attachments)==null||z.forEach(ve=>{A.push({id:ve.id,name:ve.name,type:"Attachment",taskName:K.title,subStepName:"",actionItemName:"",source:{name:ve.name,type:ve.type.startsWith("image/")?"image":"text",content:ve.dataUrl,dataUrl:ve.dataUrl}})}),(se=(H=K.extendedDetails)==null?void 0:H.subSteps)==null||se.forEach(ve=>{var be,Ae;(be=ve.attachments)==null||be.forEach(ye=>{A.push({id:ye.id,name:ye.name,type:"Attachment",taskName:K.title,subStepName:ve.text,actionItemName:"",source:{name:ye.name,type:ye.type.startsWith("image/")?"image":"text",content:ye.dataUrl,dataUrl:ye.dataUrl}})}),(Ae=ve.actionItems)==null||Ae.forEach(ye=>{var Ye,Y,ot;(Y=(Ye=ye.report)==null?void 0:Ye.attachments)==null||Y.forEach(Xe=>{A.push({id:Xe.id,name:Xe.name,type:"Attachment",taskName:K.title,subStepName:ve.text,actionItemName:ye.text,source:{name:Xe.name,type:Xe.type.startsWith("image/")?"image":"text",content:Xe.dataUrl,dataUrl:Xe.dataUrl}})}),(ot=ye.report)!=null&&ot.matrixData&&A.push({id:`matrix-${ye.id}`,name:`: ${ye.text}`,type:"Data Matrix",taskName:K.title,subStepName:ve.text,actionItemName:ye.text,source:{name:`: ${ye.text}`,type:"json",content:ye.report.matrixData}})})})}),A},[e,n,s]),U=re.useMemo(()=>{let A=[...X];return C!==null&&A.sort((K,N)=>{const P=(K[C.key]||"").toLowerCase(),z=(N[C.key]||"").toLowerCase();return P<z?C.direction==="ascending"?-1:1:P>z?C.direction==="ascending"?1:-1:0}),A},[X,C]),ee=A=>{let K="ascending";C&&C.key===A&&C.direction==="ascending"&&(K="descending"),S({key:A,direction:K})},te=A=>!C||C.key!==A?d.jsx(xi,{className:"w-3 h-3 ml-1 opacity-30 group-hover:opacity-100"}):C.direction==="ascending"?d.jsx(ao,{className:"w-3 h-3 ml-1 text-blue-600"}):d.jsx(xi,{className:"w-3 h-3 ml-1 text-blue-600"}),V=A=>{v(K=>{const N=new Set(K);return N.has(A)?N.delete(A):N.add(A),N})},ge=()=>{p.size===X.length?v(new Set):v(new Set(X.map(A=>A.id)))},Re=async()=>{if(p.size===0){j("1");return}if(!_.trim()){j("");return}b(!0),j(null),I(null);const A=X.filter(K=>p.has(K.id)).map(K=>K.source);try{if(L==="slides"){const K=await C_(A,_);o(K)}else{const K=await Y4(A,_);I(K)}}catch(K){j(K instanceof Error?K.message:"")}finally{b(!1)}},Se=A=>{switch(A){case"Gantt Chart":return d.jsx(S_,{className:"w-5 h-5 text-amber-600"});case"Project Report":case"Task Report":return d.jsx(w_,{className:"w-5 h-5 text-teal-600"});case"Attachment":return d.jsx(Ns,{className:"w-5 h-5 text-slate-600"});case"Data Matrix":return d.jsx(Eo,{className:"w-5 h-5 text-purple-600"});default:return d.jsx(hi,{className:"w-5 h-5 text-slate-500"})}},ae=A=>{if(A.dataUrl)return A.dataUrl;if(A.type==="json")try{const K=JSON.stringify(A.content,null,2),N=new Blob([K],{type:"application/json"});return URL.createObjectURL(N)}catch{return}},ue=re.useMemo(()=>X.filter(A=>p.has(A.id)),[p,X]),Q=()=>d.jsxs(d.Fragment,{children:[d.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:d.jsxs("table",{className:"w-full min-w-[1000px] border-collapse text-sm",children:[d.jsx("thead",{className:"sticky top-0 bg-slate-200 z-10",children:d.jsxs("tr",{children:[d.jsx("th",{className:"p-2 border border-slate-300 w-10 text-center",children:d.jsx("input",{type:"checkbox",checked:p.size===X.length&&X.length>0,onChange:ge,className:"w-4 h-4 accent-blue-600"})}),d.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:d.jsxs("button",{onClick:()=>ee("name"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[d.jsx("span",{children:""}),te("name")]})}),d.jsx("th",{className:"p-0 border border-slate-300 w-40",children:d.jsxs("button",{onClick:()=>ee("type"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[d.jsx("span",{children:""}),te("type")]})}),d.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:d.jsxs("button",{onClick:()=>ee("taskName"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[d.jsx("span",{children:""}),te("taskName")]})}),d.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:d.jsxs("button",{onClick:()=>ee("subStepName"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[d.jsx("span",{children:""}),te("subStepName")]})}),d.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:d.jsxs("button",{onClick:()=>ee("actionItemName"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[d.jsx("span",{children:""}),te("actionItemName")]})})]})}),d.jsx("tbody",{children:U.map(A=>{const K=ae(A.source);return d.jsxs("tr",{className:"bg-white hover:bg-slate-50 transition-colors",children:[d.jsx("td",{className:"border border-slate-300 align-middle text-center p-2",children:d.jsx("input",{type:"checkbox",checked:p.has(A.id),onChange:()=>V(A.id),className:"w-4 h-4 accent-blue-600"})}),d.jsx("td",{className:"border border-slate-300 p-2 font-medium text-slate-800",children:K?d.jsx("a",{href:K,target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:A.name}):d.jsx("span",{children:A.name})}),d.jsx("td",{className:"border border-slate-300 p-2 text-slate-600",children:d.jsxs("div",{className:"flex items-center gap-2",children:[Se(A.type),d.jsx("span",{children:A.type})]})}),d.jsx("td",{className:"border border-slate-300 p-2 text-slate-600 truncate",children:A.taskName}),d.jsx("td",{className:"border border-slate-300 p-2 text-slate-600 truncate",children:A.subStepName}),d.jsx("td",{className:"border border-slate-300 p-2 text-slate-600 truncate",children:A.actionItemName})]},A.id)})})]})}),d.jsxs("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-between items-center rounded-b-xl",children:[d.jsxs("span",{className:"text-sm text-slate-600",children:[p.size," / ",X.length," "]}),d.jsx("button",{onClick:()=>x("generate"),disabled:p.size===0,className:"px-6 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700 disabled:bg-slate-400 disabled:cursor-not-allowed",children:""})]})]}),G=()=>d.jsxs(d.Fragment,{children:[d.jsxs("main",{className:"flex-grow p-6 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsxs("h4",{className:"font-semibold text-lg text-slate-800 mb-2",children:[" (",ue.length,")"]}),d.jsx("div",{className:"bg-slate-50 border rounded-lg p-3 max-h-96 overflow-y-auto space-y-2",children:ue.map(A=>d.jsxs("div",{className:"text-sm text-slate-700 flex items-center gap-2",children:[Se(A.type),d.jsx("span",{className:"truncate",title:A.name,children:A.name})]},A.id))}),d.jsx("h4",{className:"font-semibold text-lg text-slate-800 mt-6 mb-2",children:""}),d.jsxs("div",{className:"flex gap-4",children:[d.jsxs("label",{className:"flex items-center gap-2 p-3 border rounded-lg cursor-pointer flex-1 hover:bg-slate-50",children:[d.jsx("input",{type:"radio",name:"reportFormat",value:"slides",checked:L==="slides",onChange:()=>Z("slides"),className:"w-4 h-4 accent-blue-600"}),""]}),d.jsxs("label",{className:"flex items-center gap-2 p-3 border rounded-lg cursor-pointer flex-1 hover:bg-slate-50",children:[d.jsx("input",{type:"radio",name:"reportFormat",value:"text",checked:L==="text",onChange:()=>Z("text"),className:"w-4 h-4 accent-blue-600"}),""]})]})]}),d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-lg text-slate-800 mb-2",children:""}),d.jsx("textarea",{value:_,onChange:A=>y(A.target.value),placeholder:"",rows:6,className:"w-full p-3 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition text-sm"}),E&&d.jsx("div",{className:"mt-2",children:d.jsx(yi,{message:E})}),W&&d.jsxs("div",{className:"mt-4 p-4 border rounded-lg bg-slate-50",children:[d.jsx("h5",{className:"font-semibold text-md text-slate-800 mb-2",children:""}),d.jsx("pre",{className:"text-sm text-slate-700 bg-white p-3 rounded whitespace-pre-wrap max-h-60 overflow-y-auto",children:W}),d.jsx("button",{onClick:()=>navigator.clipboard.writeText(W),className:"text-xs mt-2 px-2 py-1 bg-slate-200 rounded",children:""})]})]})]}),d.jsxs("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-between items-center rounded-b-xl",children:[d.jsxs("button",{onClick:()=>{x("list"),I(null)},className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md shadow-sm hover:bg-slate-200",children:[d.jsx(v_,{className:"w-4 h-4"}),""]}),d.jsxs("button",{onClick:Re,disabled:w,className:"flex items-center gap-2 px-6 py-2 text-sm font-medium text-white bg-green-600 rounded-md shadow-sm hover:bg-green-700 disabled:bg-slate-400",children:[w?d.jsx(Fr,{size:"sm",color:"border-white"}):d.jsx(To,{className:"w-5 h-5"}),d.jsx("span",{children:w?"...":""})]})]})]});return d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex flex-col p-4 sm:p-6 md:p-8 z-[70]",children:d.jsxs("div",{className:"bg-slate-100 rounded-xl shadow-2xl w-full h-full flex flex-col",children:[d.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-slate-200 bg-white rounded-t-xl",children:[d.jsxs("h3",{className:"text-xl font-bold text-slate-800 flex items-center gap-3",children:[d.jsx(hi,{className:"w-7 h-7 text-blue-600"}),d.jsx("span",{children:""})]}),d.jsx("button",{onClick:l,className:"p-1.5 rounded-full hover:bg-slate-100",children:d.jsx(na,{className:"w-6 h-6 text-slate-500"})})]}),h==="list"?Q():G()]})})},Wk=({tasks:e,projectGoal:t,targetDate:r,onSelectTask:n,onUpdateTaskExtendedDetails:s,onUpdateTaskPosition:l,onUpdateTaskStatus:o,onStartNewProject:u,onExportProject:h,onAddTask:x,onRemoveTask:p,onImportSingleTask:v,onAutoLayout:_,onUndo:y,canUndo:w,onRedo:b,canRedo:E,generateUniqueId:j,onUpdateTaskConnections:C,ganttData:S,setGanttData:L,onCustomReportGenerated:Z,onClearApiKey:W,onOpenProjectList:I,onLogout:X,currentProjectId:U,onSaveProject:ee})=>{re.useRef(null);const te=re.useRef(null),[V,ge]=re.useState(new Map),[Re,Se]=re.useState([]),ae=re.useRef(null),ue=re.useRef({x:0,y:0}),[Q,G]=re.useState(!1),[A,K]=re.useState(!1),[N,P]=re.useState(null),[z,H]=re.useState(!1),[se,ve]=re.useState(null),[be,Ae]=re.useState(!1),[ye,Ye]=re.useState(null),[Y,ot]=re.useState(!1),[Xe,gt]=re.useState(null),[Je,Oe]=re.useState(!1),[Ot,$t]=re.useState(!1),[Le,Pe]=re.useState(null),[Ve,$e]=re.useState(!1),[mr,Rr]=re.useState(!1),[pr,Yt]=re.useState(!1),[yt,Qe]=re.useState(null),[et,Pt]=re.useState({x:0,y:0}),[gr,Dt]=re.useState(!1),[qt,sa]=re.useState("viewer"),[xa,ma]=re.useState(!1);re.useEffect(()=>{(async()=>{if(U)try{const R=await Ha.getUserRole(U);sa(R||"viewer");const M=await Bn.getProject(U);ma(M.isPublic)}catch(R){console.error(":",R)}})()},[U]),re.useEffect(()=>{if(!U)return;const k=Ha.subscribeToProjectUpdates(U,R=>{R.table==="projects"&&R.eventType==="UPDATE"&&window.location.reload()});return()=>{k.unsubscribe()}},[U]);const or=qt==="owner"||qt==="admin"||qt==="editor",sn=qt==="owner"||qt==="admin";re.useEffect(()=>{const k=new Map;e.forEach(R=>{k.set(R.id,V.get(R.id)||re.createRef())}),ge(k)},[e]);const Zr=re.useCallback(()=>{if(!te.current||V.size===0){Se([]);return}const k=[];e.forEach(R=>{var M,F;if(R.nextTaskIds&&R.nextTaskIds.length>0){const ce=V.get(R.id),pe=ce==null?void 0:ce.current;if(!pe)return;const ie=((M=R.position)==null?void 0:M.x)||0,de=((F=R.position)==null?void 0:F.y)||0,he=pe.getBoundingClientRect(),Ne={x:ie+he.width,y:de+he.height/2};R.nextTaskIds.forEach(De=>{var tt,vt;const Me=e.find(dt=>dt.id===De);if(!Me)return;const Ce=V.get(De),q=Ce==null?void 0:Ce.current;if(!q)return;const _e=((tt=Me.position)==null?void 0:tt.x)||0,Te=((vt=Me.position)==null?void 0:vt.y)||0,Ie=q.getBoundingClientRect(),Ue={x:_e,y:Te+Ie.height/2};k.push({id:`conn-${R.id}-${De}`,from:Ne,to:Ue,sourceId:R.id,targetId:De})})}}),Se(k)},[e,V]);re.useEffect(()=>{const k=setTimeout(Zr,50);return()=>clearTimeout(k)},[Zr,e]),re.useEffect(()=>{window.addEventListener("resize",Zr);const k=new MutationObserver(Zr);return te.current&&k.observe(te.current,{childList:!0,subtree:!0,attributes:!0,characterData:!0}),()=>{window.removeEventListener("resize",Zr),k.disconnect()}},[Zr]);const yn=(k,R)=>{var F,ce;if(!or)return;ae.current=R;const M=e.find(pe=>pe.id===R);if(te.current){const pe=te.current.getBoundingClientRect();ue.current.x=k.clientX-pe.left-(((F=M==null?void 0:M.position)==null?void 0:F.x)||0),ue.current.y=k.clientY-pe.top-(((ce=M==null?void 0:M.position)==null?void 0:ce.y)||0)}k.dataTransfer.effectAllowed="move"},Ya=k=>{or&&(k.preventDefault(),k.dataTransfer.dropEffect="move")},ln=k=>{var Ne;if(!or||(k.preventDefault(),!ae.current||!te.current))return;const R=te.current.getBoundingClientRect(),M=(Ne=V.get(ae.current))==null?void 0:Ne.current,F=(M==null?void 0:M.offsetWidth)||380,ce=(M==null?void 0:M.offsetHeight)||280;let pe=k.clientX-R.left-ue.current.x,ie=k.clientY-R.top-ue.current.y;const de=te.current.scrollWidth,he=te.current.scrollHeight;pe=Math.max(0,Math.min(pe,de-F)),ie=Math.max(0,Math.min(ie,he-ce)),l(ae.current,{x:pe,y:ie}),ae.current=null,setTimeout(Zr,0)},qn=async()=>{H(!0),ve(null);try{const k=await G4(e,t,r);P(k),K(!0)}catch(k){ve(k instanceof Error?k.message:"")}finally{H(!1)}},Xn=async()=>{if(ye){Ae(!0);return}ot(!0),gt(null);try{const k=await V4(e,t,r);Ye(k),Ae(!0)}catch(k){gt(k instanceof Error?k.message:"")}finally{ot(!1)}},wn=async()=>{if(S){Oe(!0);return}$t(!0),Pe(null);try{const k=await Mv(e,t,r);L(k),Oe(!0)}catch(k){Pe(k instanceof Error?k.message:"")}finally{$t(!1)}},bn=async()=>{$t(!0),Pe(null);try{const k=await Mv(e,t,r);L(k)}catch(k){Pe(k instanceof Error?k.message:"")}finally{$t(!1)}},Wn=async()=>{if(!or){alert("");return}if(U){Dt(!0);try{await ee(),alert("")}catch(k){alert(": "+(k instanceof Error?k.message:""))}finally{Dt(!1)}}else{const k=prompt(":",`${t.substring(0,50)}...`);if(!k)return;Dt(!0);try{const R=await Bn.createProject(k,t,r,e,S);alert("")}catch(R){alert(": "+(R instanceof Error?R.message:""))}finally{Dt(!1)}}},Us=async()=>{if(!(!sn||!U))try{const k=await Bn.toggleProjectVisibility(U);ma(k),alert(k?"":"")}catch(k){alert(": "+(k instanceof Error?k.message:""))}},ia=(k,R)=>{if(!or||!te.current)return;const M=te.current.getBoundingClientRect(),F={x:R.clientX-M.left+te.current.scrollLeft,y:R.clientY-M.top+te.current.scrollTop};Qe({fromId:k,fromPos:F})},Kt=k=>{if(!or)return;if(!yt||yt.fromId===k){Qe(null);return}const R=e.find(M=>M.id===yt.fromId);if(R){const M=Array.from(new Set([...R.nextTaskIds||[],k]));C(R.id,M)}Qe(null)},Jt=(k,R)=>{if(!or)return;const M=e.find(F=>F.id===k);if(M){const F=(M.nextTaskIds||[]).filter(ce=>ce!==R);C(M.id,F)}},Ca=k=>{if(!yt||!te.current)return;const R=te.current.getBoundingClientRect();Pt({x:k.clientX-R.left+te.current.scrollLeft,y:k.clientY-R.top+te.current.scrollTop})},Rt=()=>{yt&&Qe(null)},Zn=k=>{const R=k.type==="task"?k.id:k.parentId;if(!R)return;const M=e.find(F=>F.id===R);M&&(Oe(!1),n(M))},O=k=>{Z(k),Rr(!1)},B=r?new Date(r+"T00:00:00Z").toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"}):"";return be&&ye?d.jsx(zh,{tasks:e,initialDeck:ye,onSave:k=>Ye(k),onClose:()=>Ae(!1),projectGoal:t,targetDate:r,reportScope:"project",generateUniqueId:j}):d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"min-h-screen bg-slate-100 p-4 md:p-6 flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"max-w-full mx-auto w-full",children:[d.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-6",children:[d.jsxs("button",{onClick:()=>$e(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-slate-600 hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-500 transition-transform hover:scale-105",children:[d.jsx(di,{className:"w-5 h-5 mr-2"}),""]}),d.jsxs("div",{className:"flex flex-wrap gap-2",children:[d.jsx("button",{onClick:I,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400",title:"",children:d.jsx(hi,{className:"w-5 h-5"})}),or&&d.jsxs(d.Fragment,{children:[d.jsx("button",{onClick:Wn,disabled:gr,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 disabled:bg-slate-400",title:"",children:gr?d.jsx(Fr,{size:"sm",color:"border-white"}):d.jsx(Nl,{className:"w-5 h-5"})}),d.jsx("button",{onClick:y,disabled:!w,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400 disabled:bg-slate-300 disabled:cursor-not-allowed",title:"",children:d.jsx(b_,{className:"w-5 h-5"})}),d.jsx("button",{onClick:b,disabled:!E,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400 disabled:bg-slate-300 disabled:cursor-not-allowed",title:"",children:d.jsx(E_,{className:"w-5 h-5"})})]}),sn&&U&&d.jsxs(d.Fragment,{children:[d.jsx("button",{onClick:()=>Yt(!0),className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400",title:"",children:d.jsx(t4,{className:"w-5 h-5"})}),d.jsx("button",{onClick:Us,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400",title:xa?"":"",children:xa?d.jsx(r4,{className:"w-5 h-5"}):d.jsx(a4,{className:"w-5 h-5"})})]}),d.jsx("button",{onClick:W,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400",title:"API",children:d.jsx(no,{className:"w-5 h-5 text-yellow-600"})}),d.jsx("button",{onClick:X,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700",title:"",children:d.jsx(no,{className:"w-5 h-5"})}),or&&d.jsxs(d.Fragment,{children:[d.jsxs("button",{onClick:x,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700",children:[d.jsx(Uh,{className:"w-5 h-5 mr-2"}),""]}),d.jsxs("button",{onClick:h,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700",children:[d.jsx(Nl,{className:"w-5 h-5 mr-2"}),"JSON"]}),d.jsxs("button",{onClick:_,className:"inline-flex items-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-md shadow-sm text-slate-700 bg-white hover:bg-slate-50",title:"",children:[d.jsx(bu,{className:"w-5 h-5 mr-2"}),""]})]})]})]}),d.jsxs("header",{className:"mb-6 p-6 bg-white rounded-xl shadow-lg",children:[d.jsxs("div",{className:"flex flex-wrap justify-between items-start gap-4",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-bold text-slate-800 mb-3",children:""}),d.jsxs("div",{className:"space-y-2 text-slate-700",children:[d.jsxs("p",{className:"flex items-start",children:[d.jsx(Fh,{className:"w-5 h-5 mr-2 text-blue-600 flex-shrink-0 mt-1"}),d.jsx("strong",{children:":"}),"",d.jsx("span",{className:"break-all",children:t})]}),d.jsxs("p",{className:"flex items-center",children:[d.jsx(Lh,{className:"w-5 h-5 mr-2 text-blue-600 flex-shrink-0"}),d.jsx("strong",{children:":"}),"",B]}),d.jsxs("div",{className:"flex items-center gap-4",children:[U&&d.jsx("p",{className:"text-sm text-green-600",children:" Supabase"}),xa&&d.jsx("p",{className:"text-sm text-blue-600",children:" "}),d.jsxs("p",{className:"text-sm text-slate-500",children:[": ",qt==="owner"?"":qt==="admin"?"":qt==="editor"?"":""]})]})]})]}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 flex-shrink-0",children:[d.jsxs("button",{onClick:()=>G(!0),className:"inline-flex items-center justify-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-md shadow-sm text-slate-700 bg-white hover:bg-slate-50",children:[d.jsx(T_,{className:"w-5 h-5 mr-2"}),""]}),d.jsxs("button",{onClick:()=>Rr(!0),className:"inline-flex items-center justify-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-md shadow-sm text-slate-700 bg-white hover:bg-slate-50",children:[d.jsx(hi,{className:"w-5 h-5 mr-2"}),""]}),d.jsxs("button",{onClick:wn,disabled:Ot,className:"inline-flex items-center justify-center px-4 py-2 border border-amber-300 text-sm font-medium rounded-md shadow-sm text-amber-800 bg-amber-100 hover:bg-amber-200 disabled:bg-slate-400",children:[Ot?d.jsx(Fr,{size:"sm"}):d.jsx(S_,{className:"w-5 h-5 mr-2"}),""]}),d.jsxs("button",{onClick:qn,disabled:z,className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-purple-600 hover:bg-purple-700 disabled:bg-slate-400",children:[z?d.jsx(Fr,{size:"sm"}):d.jsx(To,{className:"w-5 h-5 mr-2"}),"AI"]}),d.jsxs("button",{onClick:Xn,disabled:Y,className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-teal-600 hover:bg-teal-700 disabled:bg-slate-400",children:[Y?d.jsx(Fr,{size:"sm"}):d.jsx(w_,{className:"w-5 h-5 mr-2"}),""]})]})]}),se&&d.jsx("div",{className:"mt-4",children:d.jsx("p",{className:"text-red-600 text-sm",children:se})}),Xe&&d.jsx("div",{className:"mt-4",children:d.jsx("p",{className:"text-red-600 text-sm",children:Xe})}),Le&&d.jsx("div",{className:"mt-4",children:d.jsx("p",{className:"text-red-600 text-sm",children:Le})})]})]}),d.jsxs("div",{ref:te,className:"flex-grow overflow-auto pb-8 relative min-h-[600px] border border-slate-300 rounded-lg bg-slate-50 p-4 shadow-inner",onDragOver:Ya,onDrop:ln,onMouseMove:Ca,onMouseUp:Rt,children:[d.jsxs("div",{className:"relative w-full h-full min-w-[1200px] min-h-[800px]",children:[e.map((k,R)=>d.jsx(i4,{cardRef:V.get(k.id),task:k,onSelectTask:n,onRemoveTask:or?p:()=>{},onUpdateStatus:or?o:()=>{},onDragCardStart:yn,onStartConnection:ia,onEndConnection:Kt,index:R},k.id)),Re.map(k=>d.jsx(so,{from:k.from,to:k.to,id:k.id,onDelete:or?()=>Jt(k.sourceId,k.targetId):void 0},k.id)),yt&&d.jsx(so,{from:yt.fromPos,to:et,id:"preview-connector"})]}),e.length===0&&d.jsx("div",{className:"text-center py-10 flex-grow flex items-center justify-center",children:d.jsx("p",{className:"text-slate-500 text-lg",children:or?"":""})})]})]}),Je&&S&&d.jsx(Yk,{data:S,onClose:()=>Oe(!1),onItemClick:Zn,onRegenerate:bn,isRegenerating:Ot}),mr&&d.jsx(Xk,{tasks:e,projectGoal:t,targetDate:r,ganttData:S,projectReportDeck:ye,onClose:()=>Rr(!1),onReportGenerated:O,generateUniqueId:j}),Q&&d.jsx(l4,{tasks:e,onClose:()=>G(!1)}),A&&d.jsx(c4,{report:N,onClose:()=>K(!1)}),pr&&U&&d.jsx(o4,{isOpen:pr,onClose:()=>Yt(!1),projectId:U,userRole:qt}),Ve&&d.jsx(O_,{onClose:()=>$e(!1),onDownloadAndStartNew:()=>{h(),u()},onStartNewWithoutSaving:u})]})},Zk=({proposals:e,existingSubSteps:t,onConfirm:r,onClose:n})=>{const[s,l]=re.useState(()=>{const h={};return e.forEach((x,p)=>{h[p]={decision:"NEW",targetSubStepId:void 0}}),h}),o=(h,x,p)=>{l(v=>({...v,[h]:{...v[h],[x]:p}}))},u=()=>{const h=[],x=[];Object.entries(s).forEach(([p,v])=>{const _=parseInt(p,10),y=e[_];v.decision==="NEW"?h.push(y):v.decision==="ADD"&&v.targetSubStepId&&x.push({targetSubStepId:v.targetSubStepId,title:y.title})}),r({newSubSteps:h,newActionItems:x})};return d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:d.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl max-h-[90vh] flex flex-col",children:[d.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"AI"}),d.jsx("button",{onClick:n,className:"p-1 rounded-full hover:bg-slate-100",children:d.jsx(na,{className:"w-6 h-6 text-slate-500"})})]}),d.jsxs("div",{className:"flex-grow p-5 overflow-y-auto space-y-4",children:[d.jsx("p",{className:"text-sm text-slate-600",children:"AI"}),d.jsx("div",{className:"space-y-3",children:e.map((h,x)=>d.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-200",children:[d.jsx("p",{className:"font-semibold text-slate-800",children:h.title}),d.jsx("p",{className:"text-sm text-slate-600 mb-3",children:h.description}),d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsxs("select",{value:s[x].decision,onChange:p=>o(x,"decision",p.target.value),className:"p-2 border border-slate-300 rounded-md text-sm",children:[d.jsx("option",{value:"NEW",children:""}),t.length>0&&d.jsx("option",{value:"ADD",children:""}),d.jsx("option",{value:"IGNORE",children:""})]}),s[x].decision==="ADD"&&d.jsxs("select",{value:s[x].targetSubStepId||"",onChange:p=>o(x,"targetSubStepId",p.target.value),className:"flex-grow p-2 border border-slate-300 rounded-md text-sm",children:[d.jsx("option",{value:"",disabled:!0,children:"..."}),t.map(p=>d.jsx("option",{value:p.id,children:p.text},p.id))]})]})]},x))})]}),d.jsxs("footer",{className:"p-5 bg-slate-100 border-t flex justify-end gap-3",children:[d.jsx("button",{onClick:n,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50",children:""}),d.jsx("button",{onClick:u,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:""})]})]})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var P_=1252,Kk=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],$h={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Yh=function(e){Kk.indexOf(e)!=-1&&(P_=$h[0]=e)};function Jk(){Yh(1252)}var rn=function(e){Yh(e)};function H_(){rn(1200),Jk()}function qv(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function Qk(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function z_(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Bc=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Qk(e.slice(2)):t==254&&r==255?z_(e.slice(2)):t==65279?e.slice(1):e},$0=function(t){return String.fromCharCode(t)},Xv=function(t){return String.fromCharCode(t)},oo,ks="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Wv(e){for(var t="",r=0,n=0,s=0,l=0,o=0,u=0,h=0,x=0;x<e.length;)r=e.charCodeAt(x++),l=r>>2,n=e.charCodeAt(x++),o=(r&3)<<4|n>>4,s=e.charCodeAt(x++),u=(n&15)<<2|s>>6,h=s&63,isNaN(n)?u=h=64:isNaN(s)&&(h=64),t+=ks.charAt(l)+ks.charAt(o)+ks.charAt(u)+ks.charAt(h);return t}function Na(e){var t="",r=0,n=0,s=0,l=0,o=0,u=0,h=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var x=0;x<e.length;)l=ks.indexOf(e.charAt(x++)),o=ks.indexOf(e.charAt(x++)),r=l<<2|o>>4,t+=String.fromCharCode(r),u=ks.indexOf(e.charAt(x++)),n=(o&15)<<4|u>>2,u!==64&&(t+=String.fromCharCode(n)),h=ks.indexOf(e.charAt(x++)),s=(u&3)<<6|h,h!==64&&(t+=String.fromCharCode(s));return t}var _t=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),wi=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Is(e){return _t?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Zv(e){return _t?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var tn=function(t){return _t?wi(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function bi(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function qh(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return qh(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Ss=_t?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:wi(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function eA(e){for(var t=[],r=0,n=e.length+250,s=Is(e.length+255),l=0;l<e.length;++l){var o=e.charCodeAt(l);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var u=e.charCodeAt(++l)&1023;s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|u>>6&15|(o&3)<<4,s[r++]=128|u&63}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|o&63;r>n&&(t.push(s.slice(0,r)),r=0,s=Is(65535),n=65530)}return t.push(s.slice(0,r)),Ss(t)}var ra=/\u0000/g,Pc=/[\u0001-\u0006]/g;function Tl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function an(e,t){var r=""+e;return r.length>=t?r:nr("0",t-r.length)+r}function Xh(e,t){var r=""+e;return r.length>=t?r:nr(" ",t-r.length)+r}function ou(e,t){var r=""+e;return r.length>=t?r:r+nr(" ",t-r.length)}function tA(e,t){var r=""+Math.round(e);return r.length>=t?r:nr("0",t-r.length)+r}function rA(e,t){var r=""+e;return r.length>=t?r:nr("0",t-r.length)+r}var Kv=Math.pow(2,32);function vl(e,t){if(e>Kv||e<-Kv)return tA(e,t);var r=Math.round(e);return rA(r,t)}function uu(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Jv=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Yd=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function aA(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var it={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Qv={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},nA={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function fu(e,t,r){for(var n=e<0?-1:1,s=e*n,l=0,o=1,u=0,h=1,x=0,p=0,v=Math.floor(s);x<t&&(v=Math.floor(s),u=v*o+l,p=v*x+h,!(s-v<5e-8));)s=1/(s-v),l=o,o=u,h=x,x=p;if(p>t&&(x>t?(p=h,u=l):(p=x,u=o)),!r)return[0,n*u,p];var _=Math.floor(n*u/p);return[_,n*u-_*p,p]}function oi(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),l=0,o=[],u={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),t&&t.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++s==86400&&(u.T=s=0,++n,++u.D)),n===60)o=r?[1317,10,29]:[1900,2,29],l=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],l=6;else{n>60&&--n;var h=new Date(1900,0,1);h.setDate(h.getDate()+n-1),o=[h.getFullYear(),h.getMonth()+1,h.getDate()],l=h.getDay(),n<60&&(l=(l+6)%7),r&&(l=uA(h,o))}return u.y=o[0],u.m=o[1],u.d=o[2],u.S=s%60,s=Math.floor(s/60),u.M=s%60,s=Math.floor(s/60),u.H=s,u.q=l,u}var G_=new Date(1899,11,31,0,0,0),sA=G_.getTime(),iA=new Date(1900,2,1,0,0,0);function V_(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=iA&&(r+=24*60*60*1e3),(r-(sA+(e.getTimezoneOffset()-G_.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Wh(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function lA(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function cA(e){var t=e<0?12:11,r=Wh(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function oA(e){var t=Wh(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function uo(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=cA(e):t===10?r=e.toFixed(10).substr(0,12):r=oA(e),Wh(lA(r.toUpperCase()))}function pi(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):uo(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ga(14,V_(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function uA(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function fA(e,t,r,n){var s="",l=0,o=0,u=r.y,h,x=0;switch(e){case 98:u=r.y+543;case 121:switch(t.length){case 1:case 2:h=u%100,x=2;break;default:h=u%1e4,x=4;break}break;case 109:switch(t.length){case 1:case 2:h=r.m,x=t.length;break;case 3:return Yd[r.m-1][1];case 5:return Yd[r.m-1][0];default:return Yd[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:h=r.d,x=t.length;break;case 3:return Jv[r.q][0];default:return Jv[r.q][1]}break;case 104:switch(t.length){case 1:case 2:h=1+(r.H+11)%12,x=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:h=r.H,x=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:h=r.M,x=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?an(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,l=Math.round(o*(r.S+r.u)),l>=60*o&&(l=0),t==="s"?l===0?"0":""+l/o:(s=an(l,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":h=r.D*24+r.H;break;case"[m]":case"[mm]":h=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":h=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}x=t.length===3?1:2;break;case 101:h=u,x=1;break}var p=x>0?an(h,x):"";return p}function As(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var $_=/%/g;function dA(e,t,r){var n=t.replace($_,""),s=t.length-n.length;return Hn(e,n,r*Math.pow(10,2*s))+nr("%",s)}function hA(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Hn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Y_(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Y_(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%s;if(l<0&&(l+=s),r=(t/Math.pow(10,l)).toPrecision(n+1+(s+l)%s),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+l):r+="E+"+(o-l);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,x,p){return h+x+p.substr(0,(s+l)%s)+"."+p.substr(l)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var q_=/# (\?+)( ?)\/( ?)(\d+)/;function xA(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),l=Math.floor(s/n),o=s-l*n,u=n;return r+(l===0?"":""+l)+" "+(o===0?nr(" ",e[1].length+1+e[4].length):Xh(o,e[1].length)+e[2]+"/"+e[3]+an(u,e[4].length))}function mA(e,t,r){return r+(t===0?"":""+t)+nr(" ",e[1].length+2+e[4].length)}var X_=/^#*0*\.([0#]+)/,W_=/\).*[0#]/,Z_=/\(###\) ###\\?-####/;function Qr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function e2(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function t2(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function pA(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function gA(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ba(e,t,r){if(e.charCodeAt(0)===40&&!t.match(W_)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ba("n",n,r):"("+Ba("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return hA(e,t,r);if(t.indexOf("%")!==-1)return dA(e,t,r);if(t.indexOf("E")!==-1)return Y_(t,r);if(t.charCodeAt(0)===36)return"$"+Ba(e,t.substr(t.charAt(1)==" "?2:1),r);var s,l,o,u,h=Math.abs(r),x=r<0?"-":"";if(t.match(/^00+$/))return x+vl(h,t.length);if(t.match(/^[#?]+$/))return s=vl(r,0),s==="0"&&(s=""),s.length>t.length?s:Qr(t.substr(0,t.length-s.length))+s;if(l=t.match(q_))return xA(l,h,x);if(t.match(/^#+0+$/))return x+vl(h,t.length-t.indexOf("0"));if(l=t.match(X_))return s=e2(r,l[1].length).replace(/^([^\.]+)$/,"$1."+Qr(l[1])).replace(/\.$/,"."+Qr(l[1])).replace(/\.(\d*)$/,function(w,b){return"."+b+nr("0",Qr(l[1]).length-b.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return x+e2(h,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return x+As(vl(h,0));if(l=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ba(e,t,-r):As(""+(Math.floor(r)+pA(r,l[1].length)))+"."+an(t2(r,l[1].length),l[1].length);if(l=t.match(/^#,#*,#0/))return Ba(e,t.replace(/^#,#*,/,""),r);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Tl(Ba(e,t.replace(/[\\-]/g,""),r)),o=0,Tl(Tl(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return o<s.length?s.charAt(o++):w==="0"?"0":""}));if(t.match(Z_))return s=Ba(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var p="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),u=fu(h,Math.pow(10,o)-1,!1),s=""+x,p=Hn("n",l[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),s+=p+l[2]+"/"+l[3],p=ou(u[2],o),p.length<l[4].length&&(p=Qr(l[4].substr(l[4].length-p.length))+p),s+=p,s;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),u=fu(h,Math.pow(10,o)-1,!0),x+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Xh(u[1],o)+l[2]+"/"+l[3]+ou(u[2],o):nr(" ",2*o+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return s=vl(r,0),t.length<=s.length?s:Qr(t.substr(0,t.length-s.length))+s;if(l=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var v=t.indexOf(".")-o,_=t.length-s.length-v;return Qr(t.substr(0,v)+s+t.substr(t.length-_))}if(l=t.match(/^00,000\.([#0]*0)$/))return o=t2(r,l[1].length),r<0?"-"+Ba(e,t,-r):As(gA(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?an(0,3-w.length):"")+w})+"."+an(o,l[1].length);switch(t){case"###,##0.00":return Ba(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var y=As(vl(h,0));return y!=="0"?x+y:"";case"###,###.00":return Ba(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ba(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function vA(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Hn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function _A(e,t,r){var n=t.replace($_,""),s=t.length-n.length;return Hn(e,n,r*Math.pow(10,2*s))+nr("%",s)}function K_(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+K_(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%s;if(l<0&&(l+=s),r=(t/Math.pow(10,l)).toPrecision(n+1+(s+l)%s),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+l):r+="E+"+(o-l),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,x,p){return h+x+p.substr(0,(s+l)%s)+"."+p.substr(l)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function mn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(W_)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?mn("n",n,r):"("+mn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return vA(e,t,r);if(t.indexOf("%")!==-1)return _A(e,t,r);if(t.indexOf("E")!==-1)return K_(t,r);if(t.charCodeAt(0)===36)return"$"+mn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,l,o,u,h=Math.abs(r),x=r<0?"-":"";if(t.match(/^00+$/))return x+an(h,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:Qr(t.substr(0,t.length-s.length))+s;if(l=t.match(q_))return mA(l,h,x);if(t.match(/^#+0+$/))return x+an(h,t.length-t.indexOf("0"));if(l=t.match(X_))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Qr(l[1])).replace(/\.$/,"."+Qr(l[1])),s=s.replace(/\.(\d*)$/,function(w,b){return"."+b+nr("0",Qr(l[1]).length-b.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return x+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return x+As(""+h);if(l=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+mn(e,t,-r):As(""+r)+"."+nr("0",l[1].length);if(l=t.match(/^#,#*,#0/))return mn(e,t.replace(/^#,#*,/,""),r);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Tl(mn(e,t.replace(/[\\-]/g,""),r)),o=0,Tl(Tl(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return o<s.length?s.charAt(o++):w==="0"?"0":""}));if(t.match(Z_))return s=mn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var p="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(l[4].length,7),u=fu(h,Math.pow(10,o)-1,!1),s=""+x,p=Hn("n",l[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),s+=p+l[2]+"/"+l[3],p=ou(u[2],o),p.length<l[4].length&&(p=Qr(l[4].substr(l[4].length-p.length))+p),s+=p,s;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(l[1].length,l[4].length),7),u=fu(h,Math.pow(10,o)-1,!0),x+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Xh(u[1],o)+l[2]+"/"+l[3]+ou(u[2],o):nr(" ",2*o+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:Qr(t.substr(0,t.length-s.length))+s;if(l=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var v=t.indexOf(".")-o,_=t.length-s.length-v;return Qr(t.substr(0,v)+s+t.substr(t.length-_))}if(l=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+mn(e,t,-r):As(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?an(0,3-w.length):"")+w})+"."+an(0,l[1].length);switch(t){case"###,###":case"##,###":case"#,###":var y=As(""+h);return y!=="0"?x+y:"";default:if(t.match(/\.[0#?]*$/))return mn(e,t.slice(0,t.lastIndexOf(".")),r)+Qr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Hn(e,t,r){return(r|0)===r?mn(e,t,r):Ba(e,t,r)}function yA(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var J_=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ll(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":uu(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(J_))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function wA(e,t,r,n){for(var s=[],l="",o=0,u="",h="t",x,p,v,_="H";o<e.length;)switch(u=e.charAt(o)){case"G":if(!uu(e,o))throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(l="";(v=e.charCodeAt(++o))!==34&&o<e.length;)l+=String.fromCharCode(v);s[s.length]={t:"t",v:l},++o;break;case"\\":var y=e.charAt(++o),w=y==="("||y===")"?y:"t";s[s.length]={t:w,v:y},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(x==null&&(x=oi(t,r,e.charAt(o+1)==="2"),x==null))return"";s[s.length]={t:"X",v:e.substr(o,2)},h=u,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||x==null&&(x=oi(t,r),x==null))return"";for(l=u;++o<e.length&&e.charAt(o).toLowerCase()===u;)l+=u;u==="m"&&h.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=_),s[s.length]={t:u,v:l},h=u;break;case"A":case"a":case"":var b={t:u,v:u};if(x==null&&(x=oi(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(x!=null&&(b.v=x.H>=12?"P":"A"),b.t="T",_="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(x!=null&&(b.v=x.H>=12?"PM":"AM"),b.t="T",o+=5,_="h"):e.substr(o,5).toUpperCase()==="/"?(x!=null&&(b.v=x.H>=12?"":""),b.t="T",o+=5,_="h"):(b.t="t",++o),x==null&&b.t==="T")return"";s[s.length]=b,h=u;break;case"[":for(l=u;e.charAt(o++)!=="]"&&o<e.length;)l+=e.charAt(o);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(J_)){if(x==null&&(x=oi(t,r),x==null))return"";s[s.length]={t:"Z",v:l.toLowerCase()},h=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ll(e)||(s[s.length]={t:"t",v:l}));break;case".":if(x!=null){for(l=u;++o<e.length&&(u=e.charAt(o))==="0";)l+=u;s[s.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++o<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(o))>-1;)l+=u;s[s.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++o)===u;)l+=u;s[s.length]={t:u,v:l},h=u;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:n===1?"t":u,v:u},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)l+=e.charAt(o);s[s.length]={t:"D",v:l};break;case" ":s[s.length]={t:u,v:u},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"t",v:u},++o;break}var E=0,j=0,C;for(o=s.length-1,h="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=_,h="h",E<1&&(E=1);break;case"s":(C=s[o].v.match(/\.0+$/))&&(j=Math.max(j,C[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":h=s[o].t;break;case"m":h==="s"&&(s[o].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&s[o].v.match(/[Hh]/)&&(E=1),E<2&&s[o].v.match(/[Mm]/)&&(E=2),E<3&&s[o].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:x.u>=.5&&(x.u=0,++x.S),x.S>=60&&(x.S=0,++x.M),x.M>=60&&(x.M=0,++x.H);break;case 2:x.u>=.5&&(x.u=0,++x.S),x.S>=60&&(x.S=0,++x.M);break}var S="",L;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=fA(s[o].t.charCodeAt(0),s[o].v,x,j),s[o].t="t";break;case"n":case"?":for(L=o+1;s[L]!=null&&((u=s[L].t)==="?"||u==="D"||(u===" "||u==="t")&&s[L+1]!=null&&(s[L+1].t==="?"||s[L+1].t==="t"&&s[L+1].v==="/")||s[o].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(s[L].v==="/"||s[L].v===" "&&s[L+1]!=null&&s[L+1].t=="?"));)s[o].v+=s[L].v,s[L]={v:"",t:";"},++L;S+=s[o].v,o=L-1;break;case"G":s[o].t="t",s[o].v=pi(t,r);break}var Z="",W,I;if(S.length>0){S.charCodeAt(0)==40?(W=t<0&&S.charCodeAt(0)===45?-t:t,I=Hn("n",S,W)):(W=t<0&&n>1?-t:t,I=Hn("n",S,W),W<0&&s[0]&&s[0].t=="t"&&(I=I.substr(1),s[0].v="-"+s[0].v)),L=I.length-1;var X=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){X=o;break}var U=s.length;if(X===s.length&&I.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(L>=s[o].v.length-1?(L-=s[o].v.length,s[o].v=I.substr(L+1,s[o].v.length)):L<0?s[o].v="":(s[o].v=I.substr(0,L+1),L=-1),s[o].t="t",U=o);L>=0&&U<s.length&&(s[U].v=I.substr(0,L+1)+s[U].v)}else if(X!==s.length&&I.indexOf("E")===-1){for(L=I.indexOf(".")-1,o=X;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(p=s[o].v.indexOf(".")>-1&&o===X?s[o].v.indexOf(".")-1:s[o].v.length-1,Z=s[o].v.substr(p+1);p>=0;--p)L>=0&&(s[o].v.charAt(p)==="0"||s[o].v.charAt(p)==="#")&&(Z=I.charAt(L--)+Z);s[o].v=Z,s[o].t="t",U=o}for(L>=0&&U<s.length&&(s[U].v=I.substr(0,L+1)+s[U].v),L=I.indexOf(".")+1,o=X;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==X)){for(p=s[o].v.indexOf(".")>-1&&o===X?s[o].v.indexOf(".")+1:0,Z=s[o].v.substr(0,p);p<s[o].v.length;++p)L<I.length&&(Z+=I.charAt(L++));s[o].v=Z,s[o].t="t",U=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(W=n>1&&t<0&&o>0&&s[o-1].v==="-"?-t:t,s[o].v=Hn(s[o].t,s[o].v,W),s[o].t="t");var ee="";for(o=0;o!==s.length;++o)s[o]!=null&&(ee+=s[o].v);return ee}var r2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function a2(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function bA(e,t){var r=yA(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var l=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,l];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(r2),u=r[1].match(r2);return a2(t,o)?[n,r[0]]:a2(t,u)?[n,r[1]]:[n,r[o!=null&&u!=null?2:1]]}return[n,l]}function Ga(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:it)[e],n==null&&(n=r.table&&r.table[Qv[e]]||it[Qv[e]]),n==null&&(n=nA[e]||"General");break}if(uu(n,0))return pi(t,r);t instanceof Date&&(t=V_(t,r.date1904));var s=bA(n,t);if(uu(s[1]))return pi(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return wA(s[1],t,r,s[0])}function ui(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(it[r]==null){t<0&&(t=r);continue}if(it[r]==e){t=r;break}}t<0&&(t=391)}return it[t]=e,t}function Q_(){it=aA()}var EA={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},ey=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function TA(e){var t=typeof e=="number"?it[e]:e;return t=t.replace(ey,"(\\d+)"),new RegExp("^"+t+"$")}function SA(e,t,r){var n=-1,s=-1,l=-1,o=-1,u=-1,h=-1;(t.match(ey)||[]).forEach(function(v,_){var y=parseInt(r[_+1],10);switch(v.toLowerCase().charAt(0)){case"y":n=y;break;case"d":l=y;break;case"h":o=y;break;case"s":h=y;break;case"m":o>=0?u=y:s=y;break}}),h>=0&&u==-1&&s>=0&&(u=s,s=-1);var x=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);x.length==7&&(x="0"+x),x.length==8&&(x="20"+x);var p=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return o==-1&&u==-1&&h==-1?x:n==-1&&s==-1&&l==-1?p:x+"T"+p}var kA=function(){var e={};e.version="1.2.0";function t(){for(var I=0,X=new Array(256),U=0;U!=256;++U)I=U,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,X[U]=I;return typeof Int32Array<"u"?new Int32Array(X):X}var r=t();function n(I){var X=0,U=0,ee=0,te=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ee=0;ee!=256;++ee)te[ee]=I[ee];for(ee=0;ee!=256;++ee)for(U=I[ee],X=256+ee;X<4096;X+=256)U=te[X]=U>>>8^I[U&255];var V=[];for(ee=1;ee!=16;++ee)V[ee-1]=typeof Int32Array<"u"?te.subarray(ee*256,ee*256+256):te.slice(ee*256,ee*256+256);return V}var s=n(r),l=s[0],o=s[1],u=s[2],h=s[3],x=s[4],p=s[5],v=s[6],_=s[7],y=s[8],w=s[9],b=s[10],E=s[11],j=s[12],C=s[13],S=s[14];function L(I,X){for(var U=X^-1,ee=0,te=I.length;ee<te;)U=U>>>8^r[(U^I.charCodeAt(ee++))&255];return~U}function Z(I,X){for(var U=X^-1,ee=I.length-15,te=0;te<ee;)U=S[I[te++]^U&255]^C[I[te++]^U>>8&255]^j[I[te++]^U>>16&255]^E[I[te++]^U>>>24]^b[I[te++]]^w[I[te++]]^y[I[te++]]^_[I[te++]]^v[I[te++]]^p[I[te++]]^x[I[te++]]^h[I[te++]]^u[I[te++]]^o[I[te++]]^l[I[te++]]^r[I[te++]];for(ee+=15;te<ee;)U=U>>>8^r[(U^I[te++])&255];return~U}function W(I,X){for(var U=X^-1,ee=0,te=I.length,V=0,ge=0;ee<te;)V=I.charCodeAt(ee++),V<128?U=U>>>8^r[(U^V)&255]:V<2048?(U=U>>>8^r[(U^(192|V>>6&31))&255],U=U>>>8^r[(U^(128|V&63))&255]):V>=55296&&V<57344?(V=(V&1023)+64,ge=I.charCodeAt(ee++)&1023,U=U>>>8^r[(U^(240|V>>8&7))&255],U=U>>>8^r[(U^(128|V>>2&63))&255],U=U>>>8^r[(U^(128|ge>>6&15|(V&3)<<4))&255],U=U>>>8^r[(U^(128|ge&63))&255]):(U=U>>>8^r[(U^(224|V>>12&15))&255],U=U>>>8^r[(U^(128|V>>6&63))&255],U=U>>>8^r[(U^(128|V&63))&255]);return~U}return e.table=r,e.bstr=L,e.buf=Z,e.str=W,e}(),bt=function(){var t={};t.version="1.2.1";function r(O,B){for(var k=O.split("/"),R=B.split("/"),M=0,F=0,ce=Math.min(k.length,R.length);M<ce;++M){if(F=k[M].length-R[M].length)return F;if(k[M]!=R[M])return k[M]<R[M]?-1:1}return k.length-R.length}function n(O){if(O.charAt(O.length-1)=="/")return O.slice(0,-1).indexOf("/")===-1?O:n(O.slice(0,-1));var B=O.lastIndexOf("/");return B===-1?O:O.slice(0,B+1)}function s(O){if(O.charAt(O.length-1)=="/")return s(O.slice(0,-1));var B=O.lastIndexOf("/");return B===-1?O:O.slice(B+1)}function l(O,B){typeof B=="string"&&(B=new Date(B));var k=B.getHours();k=k<<6|B.getMinutes(),k=k<<5|B.getSeconds()>>>1,O.write_shift(2,k);var R=B.getFullYear()-1980;R=R<<4|B.getMonth()+1,R=R<<5|B.getDate(),O.write_shift(2,R)}function o(O){var B=O.read_shift(2)&65535,k=O.read_shift(2)&65535,R=new Date,M=k&31;k>>>=5;var F=k&15;k>>>=4,R.setMilliseconds(0),R.setFullYear(k+1980),R.setMonth(F-1),R.setDate(M);var ce=B&31;B>>>=5;var pe=B&63;return B>>>=6,R.setHours(B),R.setMinutes(pe),R.setSeconds(ce<<1),R}function u(O){Lr(O,0);for(var B={},k=0;O.l<=O.length-4;){var R=O.read_shift(2),M=O.read_shift(2),F=O.l+M,ce={};switch(R){case 21589:k=O.read_shift(1),k&1&&(ce.mtime=O.read_shift(4)),M>5&&(k&2&&(ce.atime=O.read_shift(4)),k&4&&(ce.ctime=O.read_shift(4))),ce.mtime&&(ce.mt=new Date(ce.mtime*1e3));break}O.l=F,B[R]=ce}return B}var h;function x(){return h||(h={})}function p(O,B){if(O[0]==80&&O[1]==75)return Zr(O,B);if((O[0]|32)==109&&(O[1]|32)==105)return Us(O,B);if(O.length<512)throw new Error("CFB file size "+O.length+" < 512");var k=3,R=512,M=0,F=0,ce=0,pe=0,ie=0,de=[],he=O.slice(0,512);Lr(he,0);var Ne=v(he);switch(k=Ne[0],k){case 3:R=512;break;case 4:R=4096;break;case 0:if(Ne[1]==0)return Zr(O,B);default:throw new Error("Major Version: Expected 3 or 4 saw "+k)}R!==512&&(he=O.slice(0,R),Lr(he,28));var De=O.slice(0,R);_(he,k);var Me=he.read_shift(4,"i");if(k===3&&Me!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Me);he.l+=4,ce=he.read_shift(4,"i"),he.l+=4,he.chk("00100000","Mini Stream Cutoff Size: "),pe=he.read_shift(4,"i"),M=he.read_shift(4,"i"),ie=he.read_shift(4,"i"),F=he.read_shift(4,"i");for(var Ce=-1,q=0;q<109&&(Ce=he.read_shift(4,"i"),!(Ce<0));++q)de[q]=Ce;var _e=y(O,R);E(ie,F,_e,R,de);var Te=C(_e,ce,de,R);Te[ce].name="!Directory",M>0&&pe!==ge&&(Te[pe].name="!MiniFAT"),Te[de[0]].name="!FAT",Te.fat_addrs=de,Te.ssz=R;var Ie={},Ue=[],tt=[],vt=[];S(ce,Te,_e,Ue,M,Ie,tt,pe),w(tt,vt,Ue),Ue.shift();var dt={FileIndex:tt,FullPaths:vt};return B&&B.raw&&(dt.raw={header:De,sectors:_e}),dt}function v(O){if(O[O.l]==80&&O[O.l+1]==75)return[0,0];O.chk(Re,"Header Signature: "),O.l+=16;var B=O.read_shift(2,"u");return[O.read_shift(2,"u"),B]}function _(O,B){var k=9;switch(O.l+=2,k=O.read_shift(2)){case 9:if(B!=3)throw new Error("Sector Shift: Expected 9 saw "+k);break;case 12:if(B!=4)throw new Error("Sector Shift: Expected 12 saw "+k);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+k)}O.chk("0600","Mini Sector Shift: "),O.chk("000000000000","Reserved: ")}function y(O,B){for(var k=Math.ceil(O.length/B)-1,R=[],M=1;M<k;++M)R[M-1]=O.slice(M*B,(M+1)*B);return R[k-1]=O.slice(k*B),R}function w(O,B,k){for(var R=0,M=0,F=0,ce=0,pe=0,ie=k.length,de=[],he=[];R<ie;++R)de[R]=he[R]=R,B[R]=k[R];for(;pe<he.length;++pe)R=he[pe],M=O[R].L,F=O[R].R,ce=O[R].C,de[R]===R&&(M!==-1&&de[M]!==M&&(de[R]=de[M]),F!==-1&&de[F]!==F&&(de[R]=de[F])),ce!==-1&&(de[ce]=R),M!==-1&&R!=de[R]&&(de[M]=de[R],he.lastIndexOf(M)<pe&&he.push(M)),F!==-1&&R!=de[R]&&(de[F]=de[R],he.lastIndexOf(F)<pe&&he.push(F));for(R=1;R<ie;++R)de[R]===R&&(F!==-1&&de[F]!==F?de[R]=de[F]:M!==-1&&de[M]!==M&&(de[R]=de[M]));for(R=1;R<ie;++R)if(O[R].type!==0){if(pe=R,pe!=de[pe])do pe=de[pe],B[R]=B[pe]+"/"+B[R];while(pe!==0&&de[pe]!==-1&&pe!=de[pe]);de[R]=-1}for(B[0]+="/",R=1;R<ie;++R)O[R].type!==2&&(B[R]+="/")}function b(O,B,k){for(var R=O.start,M=O.size,F=[],ce=R;k&&M>0&&ce>=0;)F.push(B.slice(ce*V,ce*V+V)),M-=V,ce=ii(k,ce*4);return F.length===0?br(0):Ss(F).slice(0,O.size)}function E(O,B,k,R,M){var F=ge;if(O===ge){if(B!==0)throw new Error("DIFAT chain shorter than expected")}else if(O!==-1){var ce=k[O],pe=(R>>>2)-1;if(!ce)return;for(var ie=0;ie<pe&&(F=ii(ce,ie*4))!==ge;++ie)M.push(F);E(ii(ce,R-4),B-1,k,R,M)}}function j(O,B,k,R,M){var F=[],ce=[];M||(M=[]);var pe=R-1,ie=0,de=0;for(ie=B;ie>=0;){M[ie]=!0,F[F.length]=ie,ce.push(O[ie]);var he=k[Math.floor(ie*4/R)];if(de=ie*4&pe,R<4+de)throw new Error("FAT boundary crossed: "+ie+" 4 "+R);if(!O[he])break;ie=ii(O[he],de)}return{nodes:F,data:h2([ce])}}function C(O,B,k,R){var M=O.length,F=[],ce=[],pe=[],ie=[],de=R-1,he=0,Ne=0,De=0,Me=0;for(he=0;he<M;++he)if(pe=[],De=he+B,De>=M&&(De-=M),!ce[De]){ie=[];var Ce=[];for(Ne=De;Ne>=0;){Ce[Ne]=!0,ce[Ne]=!0,pe[pe.length]=Ne,ie.push(O[Ne]);var q=k[Math.floor(Ne*4/R)];if(Me=Ne*4&de,R<4+Me)throw new Error("FAT boundary crossed: "+Ne+" 4 "+R);if(!O[q]||(Ne=ii(O[q],Me),Ce[Ne]))break}F[De]={nodes:pe,data:h2([ie])}}return F}function S(O,B,k,R,M,F,ce,pe){for(var ie=0,de=R.length?2:0,he=B[O].data,Ne=0,De=0,Me;Ne<he.length;Ne+=128){var Ce=he.slice(Ne,Ne+128);Lr(Ce,64),De=Ce.read_shift(2),Me=ex(Ce,0,De-de),R.push(Me);var q={name:Me,type:Ce.read_shift(1),color:Ce.read_shift(1),L:Ce.read_shift(4,"i"),R:Ce.read_shift(4,"i"),C:Ce.read_shift(4,"i"),clsid:Ce.read_shift(16),state:Ce.read_shift(4,"i"),start:0,size:0},_e=Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2);_e!==0&&(q.ct=L(Ce,Ce.l-8));var Te=Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2);Te!==0&&(q.mt=L(Ce,Ce.l-8)),q.start=Ce.read_shift(4,"i"),q.size=Ce.read_shift(4,"i"),q.size<0&&q.start<0&&(q.size=q.type=0,q.start=ge,q.name=""),q.type===5?(ie=q.start,M>0&&ie!==ge&&(B[ie].name="!StreamData")):q.size>=4096?(q.storage="fat",B[q.start]===void 0&&(B[q.start]=j(k,q.start,B.fat_addrs,B.ssz)),B[q.start].name=q.name,q.content=B[q.start].data.slice(0,q.size)):(q.storage="minifat",q.size<0?q.size=0:ie!==ge&&q.start!==ge&&B[ie]&&(q.content=b(q,B[ie].data,(B[pe]||{}).data))),q.content&&Lr(q.content,0),F[Me]=q,ce.push(q)}}function L(O,B){return new Date((Sa(O,B+4)/1e7*Math.pow(2,32)+Sa(O,B)/1e7-11644473600)*1e3)}function Z(O,B){return x(),p(h.readFileSync(O),B)}function W(O,B){var k=B&&B.type;switch(k||_t&&Buffer.isBuffer(O)&&(k="buffer"),k||"base64"){case"file":return Z(O,B);case"base64":return p(tn(Na(O)),B);case"binary":return p(tn(O),B)}return p(O,B)}function I(O,B){var k=B||{},R=k.root||"Root Entry";if(O.FullPaths||(O.FullPaths=[]),O.FileIndex||(O.FileIndex=[]),O.FullPaths.length!==O.FileIndex.length)throw new Error("inconsistent CFB structure");O.FullPaths.length===0&&(O.FullPaths[0]=R+"/",O.FileIndex[0]={name:R,type:5}),k.CLSID&&(O.FileIndex[0].clsid=k.CLSID),X(O)}function X(O){var B="Sh33tJ5";if(!bt.find(O,"/"+B)){var k=br(4);k[0]=55,k[1]=k[3]=50,k[2]=54,O.FileIndex.push({name:B,type:2,content:k,size:4,L:69,R:69,C:69}),O.FullPaths.push(O.FullPaths[0]+B),U(O)}}function U(O,B){I(O);for(var k=!1,R=!1,M=O.FullPaths.length-1;M>=0;--M){var F=O.FileIndex[M];switch(F.type){case 0:R?k=!0:(O.FileIndex.pop(),O.FullPaths.pop());break;case 1:case 2:case 5:R=!0,isNaN(F.R*F.L*F.C)&&(k=!0),F.R>-1&&F.L>-1&&F.R==F.L&&(k=!0);break;default:k=!0;break}}if(!(!k&&!B)){var ce=new Date(1987,1,19),pe=0,ie=Object.create?Object.create(null):{},de=[];for(M=0;M<O.FullPaths.length;++M)ie[O.FullPaths[M]]=!0,O.FileIndex[M].type!==0&&de.push([O.FullPaths[M],O.FileIndex[M]]);for(M=0;M<de.length;++M){var he=n(de[M][0]);R=ie[he],R||(de.push([he,{name:s(he).replace("/",""),type:1,clsid:ae,ct:ce,mt:ce,content:null}]),ie[he]=!0)}for(de.sort(function(Me,Ce){return r(Me[0],Ce[0])}),O.FullPaths=[],O.FileIndex=[],M=0;M<de.length;++M)O.FullPaths[M]=de[M][0],O.FileIndex[M]=de[M][1];for(M=0;M<de.length;++M){var Ne=O.FileIndex[M],De=O.FullPaths[M];if(Ne.name=s(De).replace("/",""),Ne.L=Ne.R=Ne.C=-(Ne.color=1),Ne.size=Ne.content?Ne.content.length:0,Ne.start=0,Ne.clsid=Ne.clsid||ae,M===0)Ne.C=de.length>1?1:-1,Ne.size=0,Ne.type=5;else if(De.slice(-1)=="/"){for(pe=M+1;pe<de.length&&n(O.FullPaths[pe])!=De;++pe);for(Ne.C=pe>=de.length?-1:pe,pe=M+1;pe<de.length&&n(O.FullPaths[pe])!=n(De);++pe);Ne.R=pe>=de.length?-1:pe,Ne.type=1}else n(O.FullPaths[M+1]||"")==n(De)&&(Ne.R=M+1),Ne.type=2}}}function ee(O,B){var k=B||{};if(k.fileType=="mad")return ia(O,k);switch(U(O),k.fileType){case"zip":return Ya(O,k)}var R=function(Me){for(var Ce=0,q=0,_e=0;_e<Me.FileIndex.length;++_e){var Te=Me.FileIndex[_e];if(Te.content){var Ie=Te.content.length;Ie>0&&(Ie<4096?Ce+=Ie+63>>6:q+=Ie+511>>9)}}for(var Ue=Me.FullPaths.length+3>>2,tt=Ce+7>>3,vt=Ce+127>>7,dt=tt+q+Ue+vt,kt=dt+127>>7,Qt=kt<=109?0:Math.ceil((kt-109)/127);dt+kt+Qt+127>>7>kt;)Qt=++kt<=109?0:Math.ceil((kt-109)/127);var At=[1,Qt,kt,vt,Ue,q,Ce,0];return Me.FileIndex[0].size=Ce<<6,At[7]=(Me.FileIndex[0].start=At[0]+At[1]+At[2]+At[3]+At[4]+At[5])+(At[6]+7>>3),At}(O),M=br(R[7]<<9),F=0,ce=0;{for(F=0;F<8;++F)M.write_shift(1,Se[F]);for(F=0;F<8;++F)M.write_shift(2,0);for(M.write_shift(2,62),M.write_shift(2,3),M.write_shift(2,65534),M.write_shift(2,9),M.write_shift(2,6),F=0;F<3;++F)M.write_shift(2,0);for(M.write_shift(4,0),M.write_shift(4,R[2]),M.write_shift(4,R[0]+R[1]+R[2]+R[3]-1),M.write_shift(4,0),M.write_shift(4,4096),M.write_shift(4,R[3]?R[0]+R[1]+R[2]-1:ge),M.write_shift(4,R[3]),M.write_shift(-4,R[1]?R[0]-1:ge),M.write_shift(4,R[1]),F=0;F<109;++F)M.write_shift(-4,F<R[2]?R[1]+F:-1)}if(R[1])for(ce=0;ce<R[1];++ce){for(;F<236+ce*127;++F)M.write_shift(-4,F<R[2]?R[1]+F:-1);M.write_shift(-4,ce===R[1]-1?ge:ce+1)}var pe=function(Me){for(ce+=Me;F<ce-1;++F)M.write_shift(-4,F+1);Me&&(++F,M.write_shift(-4,ge))};for(ce=F=0,ce+=R[1];F<ce;++F)M.write_shift(-4,ue.DIFSECT);for(ce+=R[2];F<ce;++F)M.write_shift(-4,ue.FATSECT);pe(R[3]),pe(R[4]);for(var ie=0,de=0,he=O.FileIndex[0];ie<O.FileIndex.length;++ie)he=O.FileIndex[ie],he.content&&(de=he.content.length,!(de<4096)&&(he.start=ce,pe(de+511>>9)));for(pe(R[6]+7>>3);M.l&511;)M.write_shift(-4,ue.ENDOFCHAIN);for(ce=F=0,ie=0;ie<O.FileIndex.length;++ie)he=O.FileIndex[ie],he.content&&(de=he.content.length,!(!de||de>=4096)&&(he.start=ce,pe(de+63>>6)));for(;M.l&511;)M.write_shift(-4,ue.ENDOFCHAIN);for(F=0;F<R[4]<<2;++F){var Ne=O.FullPaths[F];if(!Ne||Ne.length===0){for(ie=0;ie<17;++ie)M.write_shift(4,0);for(ie=0;ie<3;++ie)M.write_shift(4,-1);for(ie=0;ie<12;++ie)M.write_shift(4,0);continue}he=O.FileIndex[F],F===0&&(he.start=he.size?he.start-1:ge);var De=F===0&&k.root||he.name;if(de=2*(De.length+1),M.write_shift(64,De,"utf16le"),M.write_shift(2,de),M.write_shift(1,he.type),M.write_shift(1,he.color),M.write_shift(-4,he.L),M.write_shift(-4,he.R),M.write_shift(-4,he.C),he.clsid)M.write_shift(16,he.clsid,"hex");else for(ie=0;ie<4;++ie)M.write_shift(4,0);M.write_shift(4,he.state||0),M.write_shift(4,0),M.write_shift(4,0),M.write_shift(4,0),M.write_shift(4,0),M.write_shift(4,he.start),M.write_shift(4,he.size),M.write_shift(4,0)}for(F=1;F<O.FileIndex.length;++F)if(he=O.FileIndex[F],he.size>=4096)if(M.l=he.start+1<<9,_t&&Buffer.isBuffer(he.content))he.content.copy(M,M.l,0,he.size),M.l+=he.size+511&-512;else{for(ie=0;ie<he.size;++ie)M.write_shift(1,he.content[ie]);for(;ie&511;++ie)M.write_shift(1,0)}for(F=1;F<O.FileIndex.length;++F)if(he=O.FileIndex[F],he.size>0&&he.size<4096)if(_t&&Buffer.isBuffer(he.content))he.content.copy(M,M.l,0,he.size),M.l+=he.size+63&-64;else{for(ie=0;ie<he.size;++ie)M.write_shift(1,he.content[ie]);for(;ie&63;++ie)M.write_shift(1,0)}if(_t)M.l=M.length;else for(;M.l<M.length;)M.write_shift(1,0);return M}function te(O,B){var k=O.FullPaths.map(function(ie){return ie.toUpperCase()}),R=k.map(function(ie){var de=ie.split("/");return de[de.length-(ie.slice(-1)=="/"?2:1)]}),M=!1;B.charCodeAt(0)===47?(M=!0,B=k[0].slice(0,-1)+B):M=B.indexOf("/")!==-1;var F=B.toUpperCase(),ce=M===!0?k.indexOf(F):R.indexOf(F);if(ce!==-1)return O.FileIndex[ce];var pe=!F.match(Pc);for(F=F.replace(ra,""),pe&&(F=F.replace(Pc,"!")),ce=0;ce<k.length;++ce)if((pe?k[ce].replace(Pc,"!"):k[ce]).replace(ra,"")==F||(pe?R[ce].replace(Pc,"!"):R[ce]).replace(ra,"")==F)return O.FileIndex[ce];return null}var V=64,ge=-2,Re="d0cf11e0a1b11ae1",Se=[208,207,17,224,161,177,26,225],ae="00000000000000000000000000000000",ue={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ge,FREESECT:-1,HEADER_SIGNATURE:Re,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Q(O,B,k){x();var R=ee(O,k);h.writeFileSync(B,R)}function G(O){for(var B=new Array(O.length),k=0;k<O.length;++k)B[k]=String.fromCharCode(O[k]);return B.join("")}function A(O,B){var k=ee(O,B);switch(B&&B.type||"buffer"){case"file":return x(),h.writeFileSync(B.filename,k),k;case"binary":return typeof k=="string"?k:G(k);case"base64":return Wv(typeof k=="string"?k:G(k));case"buffer":if(_t)return Buffer.isBuffer(k)?k:wi(k);case"array":return typeof k=="string"?tn(k):k}return k}var K;function N(O){try{var B=O.InflateRaw,k=new B;if(k._processChunk(new Uint8Array([3,0]),k._finishFlushFlag),k.bytesRead)K=O;else throw new Error("zlib does not expose bytesRead")}catch(R){console.error("cannot use native zlib: "+(R.message||R))}}function P(O,B){if(!K)return or(O,B);var k=K.InflateRaw,R=new k,M=R._processChunk(O.slice(O.l),R._finishFlushFlag);return O.l+=R.bytesRead,M}function z(O){return K?K.deflateRawSync(O):et(O)}var H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],se=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ve=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function be(O){var B=(O<<1|O<<11)&139536|(O<<5|O<<15)&558144;return(B>>16|B>>8|B)&255}for(var Ae=typeof Uint8Array<"u",ye=Ae?new Uint8Array(256):[],Ye=0;Ye<256;++Ye)ye[Ye]=be(Ye);function Y(O,B){var k=ye[O&255];return B<=8?k>>>8-B:(k=k<<8|ye[O>>8&255],B<=16?k>>>16-B:(k=k<<8|ye[O>>16&255],k>>>24-B))}function ot(O,B){var k=B&7,R=B>>>3;return(O[R]|(k<=6?0:O[R+1]<<8))>>>k&3}function Xe(O,B){var k=B&7,R=B>>>3;return(O[R]|(k<=5?0:O[R+1]<<8))>>>k&7}function gt(O,B){var k=B&7,R=B>>>3;return(O[R]|(k<=4?0:O[R+1]<<8))>>>k&15}function Je(O,B){var k=B&7,R=B>>>3;return(O[R]|(k<=3?0:O[R+1]<<8))>>>k&31}function Oe(O,B){var k=B&7,R=B>>>3;return(O[R]|(k<=1?0:O[R+1]<<8))>>>k&127}function Ot(O,B,k){var R=B&7,M=B>>>3,F=(1<<k)-1,ce=O[M]>>>R;return k<8-R||(ce|=O[M+1]<<8-R,k<16-R)||(ce|=O[M+2]<<16-R,k<24-R)||(ce|=O[M+3]<<24-R),ce&F}function $t(O,B,k){var R=B&7,M=B>>>3;return R<=5?O[M]|=(k&7)<<R:(O[M]|=k<<R&255,O[M+1]=(k&7)>>8-R),B+3}function Le(O,B,k){var R=B&7,M=B>>>3;return k=(k&1)<<R,O[M]|=k,B+1}function Pe(O,B,k){var R=B&7,M=B>>>3;return k<<=R,O[M]|=k&255,k>>>=8,O[M+1]=k,B+8}function Ve(O,B,k){var R=B&7,M=B>>>3;return k<<=R,O[M]|=k&255,k>>>=8,O[M+1]=k&255,O[M+2]=k>>>8,B+16}function $e(O,B){var k=O.length,R=2*k>B?2*k:B+5,M=0;if(k>=B)return O;if(_t){var F=Zv(R);if(O.copy)O.copy(F);else for(;M<O.length;++M)F[M]=O[M];return F}else if(Ae){var ce=new Uint8Array(R);if(ce.set)ce.set(O);else for(;M<k;++M)ce[M]=O[M];return ce}return O.length=R,O}function mr(O){for(var B=new Array(O),k=0;k<O;++k)B[k]=0;return B}function Rr(O,B,k){var R=1,M=0,F=0,ce=0,pe=0,ie=O.length,de=Ae?new Uint16Array(32):mr(32);for(F=0;F<32;++F)de[F]=0;for(F=ie;F<k;++F)O[F]=0;ie=O.length;var he=Ae?new Uint16Array(ie):mr(ie);for(F=0;F<ie;++F)de[M=O[F]]++,R<M&&(R=M),he[F]=0;for(de[0]=0,F=1;F<=R;++F)de[F+16]=pe=pe+de[F-1]<<1;for(F=0;F<ie;++F)pe=O[F],pe!=0&&(he[F]=de[pe+16]++);var Ne=0;for(F=0;F<ie;++F)if(Ne=O[F],Ne!=0)for(pe=Y(he[F],R)>>R-Ne,ce=(1<<R+4-Ne)-1;ce>=0;--ce)B[pe|ce<<Ne]=Ne&15|F<<4;return R}var pr=Ae?new Uint16Array(512):mr(512),Yt=Ae?new Uint16Array(32):mr(32);if(!Ae){for(var yt=0;yt<512;++yt)pr[yt]=0;for(yt=0;yt<32;++yt)Yt[yt]=0}(function(){for(var O=[],B=0;B<32;B++)O.push(5);Rr(O,Yt,32);var k=[];for(B=0;B<=143;B++)k.push(8);for(;B<=255;B++)k.push(9);for(;B<=279;B++)k.push(7);for(;B<=287;B++)k.push(8);Rr(k,pr,288)})();var Qe=function(){for(var B=Ae?new Uint8Array(32768):[],k=0,R=0;k<ve.length-1;++k)for(;R<ve[k+1];++R)B[R]=k;for(;R<32768;++R)B[R]=29;var M=Ae?new Uint8Array(259):[];for(k=0,R=0;k<se.length-1;++k)for(;R<se[k+1];++R)M[R]=k;function F(pe,ie){for(var de=0;de<pe.length;){var he=Math.min(65535,pe.length-de),Ne=de+he==pe.length;for(ie.write_shift(1,+Ne),ie.write_shift(2,he),ie.write_shift(2,~he&65535);he-- >0;)ie[ie.l++]=pe[de++]}return ie.l}function ce(pe,ie){for(var de=0,he=0,Ne=Ae?new Uint16Array(32768):[];he<pe.length;){var De=Math.min(65535,pe.length-he);if(De<10){for(de=$t(ie,de,+(he+De==pe.length)),de&7&&(de+=8-(de&7)),ie.l=de/8|0,ie.write_shift(2,De),ie.write_shift(2,~De&65535);De-- >0;)ie[ie.l++]=pe[he++];de=ie.l*8;continue}de=$t(ie,de,+(he+De==pe.length)+2);for(var Me=0;De-- >0;){var Ce=pe[he];Me=(Me<<5^Ce)&32767;var q=-1,_e=0;if((q=Ne[Me])&&(q|=he&-32768,q>he&&(q-=32768),q<he))for(;pe[q+_e]==pe[he+_e]&&_e<250;)++_e;if(_e>2){Ce=M[_e],Ce<=22?de=Pe(ie,de,ye[Ce+1]>>1)-1:(Pe(ie,de,3),de+=5,Pe(ie,de,ye[Ce-23]>>5),de+=3);var Te=Ce<8?0:Ce-4>>2;Te>0&&(Ve(ie,de,_e-se[Ce]),de+=Te),Ce=B[he-q],de=Pe(ie,de,ye[Ce]>>3),de-=3;var Ie=Ce<4?0:Ce-2>>1;Ie>0&&(Ve(ie,de,he-q-ve[Ce]),de+=Ie);for(var Ue=0;Ue<_e;++Ue)Ne[Me]=he&32767,Me=(Me<<5^pe[he])&32767,++he;De-=_e-1}else Ce<=143?Ce=Ce+48:de=Le(ie,de,1),de=Pe(ie,de,ye[Ce]),Ne[Me]=he&32767,++he}de=Pe(ie,de,0)-1}return ie.l=(de+7)/8|0,ie.l}return function(ie,de){return ie.length<8?F(ie,de):ce(ie,de)}}();function et(O){var B=br(50+Math.floor(O.length*1.1)),k=Qe(O,B);return B.slice(0,k)}var Pt=Ae?new Uint16Array(32768):mr(32768),gr=Ae?new Uint16Array(32768):mr(32768),Dt=Ae?new Uint16Array(128):mr(128),qt=1,sa=1;function xa(O,B){var k=Je(O,B)+257;B+=5;var R=Je(O,B)+1;B+=5;var M=gt(O,B)+4;B+=4;for(var F=0,ce=Ae?new Uint8Array(19):mr(19),pe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ie=1,de=Ae?new Uint8Array(8):mr(8),he=Ae?new Uint8Array(8):mr(8),Ne=ce.length,De=0;De<M;++De)ce[H[De]]=F=Xe(O,B),ie<F&&(ie=F),de[F]++,B+=3;var Me=0;for(de[0]=0,De=1;De<=ie;++De)he[De]=Me=Me+de[De-1]<<1;for(De=0;De<Ne;++De)(Me=ce[De])!=0&&(pe[De]=he[Me]++);var Ce=0;for(De=0;De<Ne;++De)if(Ce=ce[De],Ce!=0){Me=ye[pe[De]]>>8-Ce;for(var q=(1<<7-Ce)-1;q>=0;--q)Dt[Me|q<<Ce]=Ce&7|De<<3}var _e=[];for(ie=1;_e.length<k+R;)switch(Me=Dt[Oe(O,B)],B+=Me&7,Me>>>=3){case 16:for(F=3+ot(O,B),B+=2,Me=_e[_e.length-1];F-- >0;)_e.push(Me);break;case 17:for(F=3+Xe(O,B),B+=3;F-- >0;)_e.push(0);break;case 18:for(F=11+Oe(O,B),B+=7;F-- >0;)_e.push(0);break;default:_e.push(Me),ie<Me&&(ie=Me);break}var Te=_e.slice(0,k),Ie=_e.slice(k);for(De=k;De<286;++De)Te[De]=0;for(De=R;De<30;++De)Ie[De]=0;return qt=Rr(Te,Pt,286),sa=Rr(Ie,gr,30),B}function ma(O,B){if(O[0]==3&&!(O[1]&3))return[Is(B),2];for(var k=0,R=0,M=Zv(B||1<<18),F=0,ce=M.length>>>0,pe=0,ie=0;(R&1)==0;){if(R=Xe(O,k),k+=3,R>>>1)R>>1==1?(pe=9,ie=5):(k=xa(O,k),pe=qt,ie=sa);else{k&7&&(k+=8-(k&7));var de=O[k>>>3]|O[(k>>>3)+1]<<8;if(k+=32,de>0)for(!B&&ce<F+de&&(M=$e(M,F+de),ce=M.length);de-- >0;)M[F++]=O[k>>>3],k+=8;continue}for(;;){!B&&ce<F+32767&&(M=$e(M,F+32767),ce=M.length);var he=Ot(O,k,pe),Ne=R>>>1==1?pr[he]:Pt[he];if(k+=Ne&15,Ne>>>=4,(Ne>>>8&255)===0)M[F++]=Ne;else{if(Ne==256)break;Ne-=257;var De=Ne<8?0:Ne-4>>2;De>5&&(De=0);var Me=F+se[Ne];De>0&&(Me+=Ot(O,k,De),k+=De),he=Ot(O,k,ie),Ne=R>>>1==1?Yt[he]:gr[he],k+=Ne&15,Ne>>>=4;var Ce=Ne<4?0:Ne-2>>1,q=ve[Ne];for(Ce>0&&(q+=Ot(O,k,Ce),k+=Ce),!B&&ce<Me&&(M=$e(M,Me+100),ce=M.length);F<Me;)M[F]=M[F-q],++F}}}return B?[M,k+7>>>3]:[M.slice(0,F),k+7>>>3]}function or(O,B){var k=O.slice(O.l||0),R=ma(k,B);return O.l+=R[1],R[0]}function sn(O,B){if(O)typeof console<"u"&&console.error(B);else throw new Error(B)}function Zr(O,B){var k=O;Lr(k,0);var R=[],M=[],F={FileIndex:R,FullPaths:M};I(F,{root:B.root});for(var ce=k.length-4;(k[ce]!=80||k[ce+1]!=75||k[ce+2]!=5||k[ce+3]!=6)&&ce>=0;)--ce;k.l=ce+4,k.l+=4;var pe=k.read_shift(2);k.l+=6;var ie=k.read_shift(4);for(k.l=ie,ce=0;ce<pe;++ce){k.l+=20;var de=k.read_shift(4),he=k.read_shift(4),Ne=k.read_shift(2),De=k.read_shift(2),Me=k.read_shift(2);k.l+=8;var Ce=k.read_shift(4),q=u(k.slice(k.l+Ne,k.l+Ne+De));k.l+=Ne+De+Me;var _e=k.l;k.l=Ce+4,yn(k,de,he,F,q),k.l=_e}return F}function yn(O,B,k,R,M){O.l+=2;var F=O.read_shift(2),ce=O.read_shift(2),pe=o(O);if(F&8257)throw new Error("Unsupported ZIP encryption");for(var ie=O.read_shift(4),de=O.read_shift(4),he=O.read_shift(4),Ne=O.read_shift(2),De=O.read_shift(2),Me="",Ce=0;Ce<Ne;++Ce)Me+=String.fromCharCode(O[O.l++]);if(De){var q=u(O.slice(O.l,O.l+De));(q[21589]||{}).mt&&(pe=q[21589].mt),((M||{})[21589]||{}).mt&&(pe=M[21589].mt)}O.l+=De;var _e=O.slice(O.l,O.l+de);switch(ce){case 8:_e=P(O,he);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ce)}var Te=!1;F&8&&(ie=O.read_shift(4),ie==134695760&&(ie=O.read_shift(4),Te=!0),de=O.read_shift(4),he=O.read_shift(4)),de!=B&&sn(Te,"Bad compressed size: "+B+" != "+de),he!=k&&sn(Te,"Bad uncompressed size: "+k+" != "+he),Jt(R,Me,_e,{unsafe:!0,mt:pe})}function Ya(O,B){var k=B||{},R=[],M=[],F=br(1),ce=k.compression?8:0,pe=0,ie=0,de=0,he=0,Ne=0,De=O.FullPaths[0],Me=De,Ce=O.FileIndex[0],q=[],_e=0;for(ie=1;ie<O.FullPaths.length;++ie)if(Me=O.FullPaths[ie].slice(De.length),Ce=O.FileIndex[ie],!(!Ce.size||!Ce.content||Me=="Sh33tJ5")){var Te=he,Ie=br(Me.length);for(de=0;de<Me.length;++de)Ie.write_shift(1,Me.charCodeAt(de)&127);Ie=Ie.slice(0,Ie.l),q[Ne]=kA.buf(Ce.content,0);var Ue=Ce.content;ce==8&&(Ue=z(Ue)),F=br(30),F.write_shift(4,67324752),F.write_shift(2,20),F.write_shift(2,pe),F.write_shift(2,ce),Ce.mt?l(F,Ce.mt):F.write_shift(4,0),F.write_shift(-4,q[Ne]),F.write_shift(4,Ue.length),F.write_shift(4,Ce.content.length),F.write_shift(2,Ie.length),F.write_shift(2,0),he+=F.length,R.push(F),he+=Ie.length,R.push(Ie),he+=Ue.length,R.push(Ue),F=br(46),F.write_shift(4,33639248),F.write_shift(2,0),F.write_shift(2,20),F.write_shift(2,pe),F.write_shift(2,ce),F.write_shift(4,0),F.write_shift(-4,q[Ne]),F.write_shift(4,Ue.length),F.write_shift(4,Ce.content.length),F.write_shift(2,Ie.length),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(4,0),F.write_shift(4,Te),_e+=F.l,M.push(F),_e+=Ie.length,M.push(Ie),++Ne}return F=br(22),F.write_shift(4,101010256),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,Ne),F.write_shift(2,Ne),F.write_shift(4,_e),F.write_shift(4,he),F.write_shift(2,0),Ss([Ss(R),Ss(M),F])}var ln={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function qn(O,B){if(O.ctype)return O.ctype;var k=O.name||"",R=k.match(/\.([^\.]+)$/);return R&&ln[R[1]]||B&&(R=(k=B).match(/[\.\\]([^\.\\])+$/),R&&ln[R[1]])?ln[R[1]]:"application/octet-stream"}function Xn(O){for(var B=Wv(O),k=[],R=0;R<B.length;R+=76)k.push(B.slice(R,R+76));return k.join(`\r
`)+`\r
`}function wn(O){var B=O.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(de){var he=de.charCodeAt(0).toString(16).toUpperCase();return"="+(he.length==1?"0"+he:he)});B=B.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),B.charAt(0)==`
`&&(B="=0D"+B.slice(1)),B=B.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var k=[],R=B.split(`\r
`),M=0;M<R.length;++M){var F=R[M];if(F.length==0){k.push("");continue}for(var ce=0;ce<F.length;){var pe=76,ie=F.slice(ce,ce+pe);ie.charAt(pe-1)=="="?pe--:ie.charAt(pe-2)=="="?pe-=2:ie.charAt(pe-3)=="="&&(pe-=3),ie=F.slice(ce,ce+pe),ce+=pe,ce<F.length&&(ie+="="),k.push(ie)}}return k.join(`\r
`)}function bn(O){for(var B=[],k=0;k<O.length;++k){for(var R=O[k];k<=O.length&&R.charAt(R.length-1)=="=";)R=R.slice(0,R.length-1)+O[++k];B.push(R)}for(var M=0;M<B.length;++M)B[M]=B[M].replace(/[=][0-9A-Fa-f]{2}/g,function(F){return String.fromCharCode(parseInt(F.slice(1),16))});return tn(B.join(`\r
`))}function Wn(O,B,k){for(var R="",M="",F="",ce,pe=0;pe<10;++pe){var ie=B[pe];if(!ie||ie.match(/^\s*$/))break;var de=ie.match(/^(.*?):\s*([^\s].*)$/);if(de)switch(de[1].toLowerCase()){case"content-location":R=de[2].trim();break;case"content-type":F=de[2].trim();break;case"content-transfer-encoding":M=de[2].trim();break}}switch(++pe,M.toLowerCase()){case"base64":ce=tn(Na(B.slice(pe).join("")));break;case"quoted-printable":ce=bn(B.slice(pe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+M)}var he=Jt(O,R.slice(k.length),ce,{unsafe:!0});F&&(he.ctype=F)}function Us(O,B){if(G(O.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var k=B&&B.root||"",R=(_t&&Buffer.isBuffer(O)?O.toString("binary"):G(O)).split(`\r
`),M=0,F="";for(M=0;M<R.length;++M)if(F=R[M],!!/^Content-Location:/i.test(F)&&(F=F.slice(F.indexOf("file")),k||(k=F.slice(0,F.lastIndexOf("/")+1)),F.slice(0,k.length)!=k))for(;k.length>0&&(k=k.slice(0,k.length-1),k=k.slice(0,k.lastIndexOf("/")+1),F.slice(0,k.length)!=k););var ce=(R[1]||"").match(/boundary="(.*?)"/);if(!ce)throw new Error("MAD cannot find boundary");var pe="--"+(ce[1]||""),ie=[],de=[],he={FileIndex:ie,FullPaths:de};I(he);var Ne,De=0;for(M=0;M<R.length;++M){var Me=R[M];Me!==pe&&Me!==pe+"--"||(De++&&Wn(he,R.slice(Ne,M),k),Ne=M)}return he}function ia(O,B){var k=B||{},R=k.boundary||"SheetJS";R="------="+R;for(var M=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+R.slice(2)+'"',"","",""],F=O.FullPaths[0],ce=F,pe=O.FileIndex[0],ie=1;ie<O.FullPaths.length;++ie)if(ce=O.FullPaths[ie].slice(F.length),pe=O.FileIndex[ie],!(!pe.size||!pe.content||ce=="Sh33tJ5")){ce=ce.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(_e){return"_x"+_e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(_e){return"_u"+_e.charCodeAt(0).toString(16)+"_"});for(var de=pe.content,he=_t&&Buffer.isBuffer(de)?de.toString("binary"):G(de),Ne=0,De=Math.min(1024,he.length),Me=0,Ce=0;Ce<=De;++Ce)(Me=he.charCodeAt(Ce))>=32&&Me<128&&++Ne;var q=Ne>=De*4/5;M.push(R),M.push("Content-Location: "+(k.root||"file:///C:/SheetJS/")+ce),M.push("Content-Transfer-Encoding: "+(q?"quoted-printable":"base64")),M.push("Content-Type: "+qn(pe,ce)),M.push(""),M.push(q?wn(he):Xn(he))}return M.push(R+`--\r
`),M.join(`\r
`)}function Kt(O){var B={};return I(B,O),B}function Jt(O,B,k,R){var M=R&&R.unsafe;M||I(O);var F=!M&&bt.find(O,B);if(!F){var ce=O.FullPaths[0];B.slice(0,ce.length)==ce?ce=B:(ce.slice(-1)!="/"&&(ce+="/"),ce=(ce+B).replace("//","/")),F={name:s(B),type:2},O.FileIndex.push(F),O.FullPaths.push(ce),M||bt.utils.cfb_gc(O)}return F.content=k,F.size=k?k.length:0,R&&(R.CLSID&&(F.clsid=R.CLSID),R.mt&&(F.mt=R.mt),R.ct&&(F.ct=R.ct)),F}function Ca(O,B){I(O);var k=bt.find(O,B);if(k){for(var R=0;R<O.FileIndex.length;++R)if(O.FileIndex[R]==k)return O.FileIndex.splice(R,1),O.FullPaths.splice(R,1),!0}return!1}function Rt(O,B,k){I(O);var R=bt.find(O,B);if(R){for(var M=0;M<O.FileIndex.length;++M)if(O.FileIndex[M]==R)return O.FileIndex[M].name=s(k),O.FullPaths[M]=k,!0}return!1}function Zn(O){U(O,!0)}return t.find=te,t.read=W,t.parse=p,t.write=A,t.writeFile=Q,t.utils={cfb_new:Kt,cfb_add:Jt,cfb_del:Ca,cfb_mov:Rt,cfb_gc:Zn,ReadShift:qc,CheckField:by,prep_blob:Lr,bconcat:Ss,use_zlib:N,_deflateRaw:et,_inflateRaw:or,consts:ue},t}();function AA(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function gn(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Zh(e){for(var t=[],r=gn(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var du=new Date(1899,11,30,0,0,0);function aa(e,t){var r=e.getTime(),n=du.getTime()+(e.getTimezoneOffset()-du.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var ty=new Date,NA=du.getTime()+(ty.getTimezoneOffset()-du.getTimezoneOffset())*6e4,n2=ty.getTimezoneOffset();function Tu(e){var t=new Date;return t.setTime(e*24*60*60*1e3+NA),t.getTimezoneOffset()!==n2&&t.setTime(t.getTime()+(t.getTimezoneOffset()-n2)*6e4),t}function CA(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var l=1;l!=s.length;++l)if(s[l]){switch(r=1,l>3&&(n=!0),s[l].slice(s[l].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[l].slice(s[l].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[l],10)}return t}var s2=new Date("2017-02-19T19:06:09.000Z"),ry=isNaN(s2.getFullYear())?new Date("2/19/17"):s2,OA=ry.getFullYear()==2017;function Dr(e,t){var r=new Date(e);if(OA)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(ry.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function gi(e,t){if(_t&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return zc(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return zc(z_(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return zc(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return zc(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(l){return r[l]||l})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function Ur(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Ur(e[r]));return t}function nr(e,t){for(var r="";r.length<t;)r+=e;return r}function nn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,l){return r=-r,l}),!isNaN(t=Number(n)))?t/r:t}var DA=["january","february","march","april","may","june","july","august","september","october","november","december"];function jl(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),l=t.getDate();if(isNaN(l))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&DA.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||l>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var RA=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var l=r.split(n),o=[l[0]],u=1;u<l.length;++u)o.push(s),o.push(l[u]);return o}}();function ay(e){return e?e.content&&e.type?gi(e.content,!0):e.data?Bc(e.data):e.asNodeBuffer&&_t?Bc(e.asNodeBuffer().toString("binary")):e.asBinary?Bc(e.asBinary()):e._data&&e._data.getContent?Bc(gi(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function ny(e){if(!e)return null;if(e.data)return qv(e.data);if(e.asNodeBuffer&&_t)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?qv(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function jA(e){return e&&e.name.slice(-4)===".bin"?ny(e):ay(e)}function Pa(e,t){for(var r=e.FullPaths||gn(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),l=0;l<r.length;++l){var o=r[l].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||s==o)return e.files?e.files[r[l]]:e.FileIndex[l]}return null}function Kh(e,t){var r=Pa(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function hr(e,t,r){if(!r)return jA(Kh(e,t));if(!t)return null;try{return hr(e,t)}catch{return null}}function ka(e,t,r){if(!r)return ay(Kh(e,t));if(!t)return null;try{return ka(e,t)}catch{return null}}function IA(e,t,r){return ny(Kh(e,t))}function i2(e){for(var t=e.FullPaths||gn(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function MA(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return _t?n=wi(r):n=eA(r),bt.utils.cfb_add(e,t,n)}bt.utils.cfb_add(e,t,r)}else e.file(t,r)}function sy(e,t){switch(t.type){case"base64":return bt.read(e,{type:"base64"});case"binary":return bt.read(e,{type:"binary"});case"buffer":case"array":return bt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Hc(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var iy=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,LA=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,l2=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,FA=/<[^>]*>/g,Wr=iy.match(l2)?l2:FA,UA=/<\w*:/,BA=/<(\/?)\w+:/;function Ke(e,t,r){for(var n={},s=0,l=0;s!==e.length&&!((l=e.charCodeAt(s))===32||l===10||l===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var o=e.match(LA),u=0,h="",x=0,p="",v="",_=1;if(o)for(x=0;x!=o.length;++x){for(v=o[x],l=0;l!=v.length&&v.charCodeAt(l)!==61;++l);for(p=v.slice(0,l).trim();v.charCodeAt(l+1)==32;)++l;for(_=(s=v.charCodeAt(l+1))==34||s==39?1:0,h=v.slice(l+1+_,v.length-_),u=0;u!=p.length&&p.charCodeAt(u)!==58;++u);if(u===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),n[p]=h,n[p.toLowerCase()]=h;else{var y=(u===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(u+1);if(n[y]&&p.slice(u-3,u)=="ext")continue;n[y]=h,n[y.toLowerCase()]=h}}return n}function vn(e){return e.replace(BA,"<$1")}var ly={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},PA=Zh(ly),Tt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",l=s.indexOf("<![CDATA[");if(l==-1)return s.replace(e,function(u,h){return ly[u]||String.fromCharCode(parseInt(h,u.indexOf("x")>-1?16:10))||u}).replace(t,function(u,h){return String.fromCharCode(parseInt(h,16))});var o=s.indexOf("]]>");return r(s.slice(0,l))+s.slice(l+9,o)+r(s.slice(o+3))}}(),HA=/[&<>'"]/g,zA=/[\u0000-\u001f]/g;function Jh(e){var t=e+"";return t.replace(HA,function(r){return PA[r]}).replace(/\n/g,"<br/>").replace(zA,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var c2=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function Wt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function qd(e){for(var t="",r=0,n=0,s=0,l=0,o=0,u=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=s&63,t+=String.fromCharCode(o);continue}if(l=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|l&63);continue}o=e.charCodeAt(r++),u=((n&7)<<18|(s&63)<<12|(l&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(u>>>10&1023)),t+=String.fromCharCode(56320+(u&1023))}return t}function o2(e){var t=Is(2*e.length),r,n,s=1,l=0,o=0,u;for(n=0;n<e.length;n+=s)s=1,(u=e.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(e.charCodeAt(n+1)&63),s=2):u<240?(r=(u&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(u&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[l++]=o&255,t[l++]=o>>>8,o=0),t[l++]=r%256,t[l++]=r>>>8;return t.slice(0,l).toString("ucs2")}function u2(e){return wi(e,"binary").toString("utf8")}var Y0="foo bar baz",Vt=_t&&(u2(Y0)==qd(Y0)&&u2||o2(Y0)==qd(Y0)&&o2)||qd,zc=_t?function(e){return wi(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},fo=function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),cy=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),GA=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),VA=/<\/?(?:vt:)?variant>/g,$A=/<(?:vt:)([^>]*)>([\s\S]*)</;function f2(e,t){var r=Ke(e),n=e.match(GA(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(l){var o=l.replace(VA,"").match($A);o&&s.push({v:Vt(o[2]),t:o[1]})}),s}var YA=/(^\s|\s$|\n)/;function qA(e){return gn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function XA(e,t,r){return"<"+e+(r!=null?qA(r):"")+(t!=null?(t.match(YA)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Qh(e){if(_t&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Vt(bi(qh(e)));throw new Error("Bad input format: expected Buffer or string")}var ho=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,WA={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},ZA=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function KA(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,l=5;l>=0;--l)s=s*256+e[t+l];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function JA(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,l=0,o=n?-t:t;isFinite(o)?o==0?s=l=0:(s=Math.floor(Math.log(o)/Math.LN2),l=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?s=-1022:(l-=Math.pow(2,52),s+=1023)):(s=2047,l=isNaN(t)?26985:0);for(var u=0;u<=5;++u,l/=256)e[r+u]=l&255;e[r+6]=(s&15)<<4|l&15,e[r+7]=s>>4|n}var d2=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,l=e[0][n].length;s<l;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},h2=_t?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:wi(t)})):d2(e)}:d2,x2=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(Pn(e,s)));return n.join("").replace(ra,"")},ex=_t?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(ra,""):x2(e,t,r)}:x2,m2=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},oy=_t?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):m2(e,t,r)}:m2,p2=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(wl(e,s)));return n.join("")},So=_t?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):p2(t,r,n)}:p2,uy=function(e,t){var r=Sa(e,t);return r>0?So(e,t+4,t+4+r-1):""},fy=uy,dy=function(e,t){var r=Sa(e,t);return r>0?So(e,t+4,t+4+r-1):""},hy=dy,xy=function(e,t){var r=2*Sa(e,t);return r>0?So(e,t+4,t+4+r-1):""},my=xy,py=function(t,r){var n=Sa(t,r);return n>0?ex(t,r+4,r+4+n):""},gy=py,vy=function(e,t){var r=Sa(e,t);return r>0?So(e,t+4,t+4+r):""},_y=vy,yy=function(e,t){return KA(e,t)},hu=yy,wy=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};_t&&(fy=function(t,r){if(!Buffer.isBuffer(t))return uy(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},hy=function(t,r){if(!Buffer.isBuffer(t))return dy(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},my=function(t,r){if(!Buffer.isBuffer(t))return xy(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},gy=function(t,r){if(!Buffer.isBuffer(t))return py(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},_y=function(t,r){if(!Buffer.isBuffer(t))return vy(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},hu=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):yy(t,r)},wy=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var wl=function(e,t){return e[t]},Pn=function(e,t){return e[t+1]*256+e[t]},QA=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Sa=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ii=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},e3=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function qc(e,t){var r="",n,s,l=[],o,u,h,x;switch(t){case"dbcs":if(x=this.l,_t&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(h=0;h<e;++h)r+=String.fromCharCode(Pn(this,x)),x+=2;e*=2;break;case"utf8":r=So(this,this.l,this.l+e);break;case"utf16le":e*=2,r=ex(this,this.l,this.l+e);break;case"wstr":return qc.call(this,e,"dbcs");case"lpstr-ansi":r=fy(this,this.l),e=4+Sa(this,this.l);break;case"lpstr-cp":r=hy(this,this.l),e=4+Sa(this,this.l);break;case"lpwstr":r=my(this,this.l),e=4+2*Sa(this,this.l);break;case"lpp4":e=4+Sa(this,this.l),r=gy(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Sa(this,this.l),r=_y(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=wl(this,this.l+e++))!==0;)l.push($0(o));r=l.join("");break;case"_wstr":for(e=0,r="";(o=Pn(this,this.l+e))!==0;)l.push($0(o)),e+=2;e+=2,r=l.join("");break;case"dbcs-cont":for(r="",x=this.l,h=0;h<e;++h){if(this.lens&&this.lens.indexOf(x)!==-1)return o=wl(this,x),this.l=x+1,u=qc.call(this,e-h,o?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push($0(Pn(this,x))),x+=2}r=l.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",x=this.l,h=0;h!=e;++h){if(this.lens&&this.lens.indexOf(x)!==-1)return o=wl(this,x),this.l=x+1,u=qc.call(this,e-h,o?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push($0(wl(this,x))),x+=1}r=l.join("");break;default:switch(e){case 1:return n=wl(this,this.l),this.l++,n;case 2:return n=(t==="i"?QA:Pn)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?ii:e3)(this,this.l),this.l+=4,n):(s=Sa(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=hu(this,this.l):s=hu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=oy(this,this.l,e);break}}return this.l+=e,r}var t3=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},r3=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},a3=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function n3(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)a3(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var l=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var o=t.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,t3(this,t,this.l);break;case 8:if(n=8,r==="f"){JA(this,t,this.l);break}case 16:break;case-4:n=4,r3(this,t,this.l);break}return this.l+=n,this}function by(e,t){var r=oy(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Lr(e,t){e.l=t,e.read_shift=qc,e.chk=by,e.write_shift=n3}function Xr(e,t){e.l+=t}function br(e){var t=Is(e);return Lr(t,0),t}function Yn(e,t,r){if(e){var n,s,l;Lr(e,e.l||0);for(var o=e.length,u=0,h=0;e.l<o;){u=e.read_shift(1),u&128&&(u=(u&127)+((e.read_shift(1)&127)<<7));var x=_u[u]||_u[65535];for(n=e.read_shift(1),l=n&127,s=1;s<4&&n&128;++s)l+=((n=e.read_shift(1))&127)<<7*s;h=e.l+l;var p=x.f&&x.f(e,l,r);if(e.l=h,t(p,x,u))return}}}function vh(){var e=[],t=_t?256:2048,r=function(x){var p=br(x);return Lr(p,0),p},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},l=function(x){return n&&x<n.length-n.l?n:(s(),n=r(Math.max(x+1,t)))},o=function(){return s(),Ss(e)},u=function(x){s(),n=x,n.l==null&&(n.l=n.length),l(t)};return{next:l,push:u,end:o,_bufs:e}}function Xc(e,t,r){var n=Ur(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function g2(e,t,r){var n=Ur(e);return n.s=Xc(n.s,t.s,r),n.e=Xc(n.e,t.s,r),n}function Wc(e,t){if(e.cRel&&e.c<0)for(e=Ur(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Ur(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=rt(e);return!e.cRel&&e.cRel!=null&&(r=l3(r)),!e.rRel&&e.rRel!=null&&(r=s3(r)),r}function Xd(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Er(e.s.c)+":"+(e.e.cRel?"":"$")+Er(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Br(e.s.r)+":"+(e.e.rRel?"":"$")+Br(e.e.r):Wc(e.s,t.biff)+":"+Wc(e.e,t.biff)}function tx(e){return parseInt(i3(e),10)-1}function Br(e){return""+(e+1)}function s3(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function i3(e){return e.replace(/\$(\d+)$/,"$1")}function rx(e){for(var t=c3(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Er(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function l3(e){return e.replace(/^([A-Z])/,"$$$1")}function c3(e){return e.replace(/^\$([A-Z])/,"$1")}function o3(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ta(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function rt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Fl(e){var t=e.indexOf(":");return t==-1?{s:ta(e),e:ta(e)}:{s:ta(e.slice(0,t)),e:ta(e.slice(t+1))}}function Et(e,t){return typeof t>"u"||typeof t=="number"?Et(e.s,e.e):(typeof e!="string"&&(e=rt(e)),typeof t!="string"&&(t=rt(t)),e==t?e:e+":"+t)}function sr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,l=e.length;for(r=0;n<l&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<l&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===l||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=l&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=l&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function v2(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Ga(e.z,r?aa(t):t)}catch{}try{return e.w=Ga((e.XF||{}).numFmtId||(r?14:0),r?aa(t):t)}catch{return""+t}}function $n(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Si[e.v]||e.v:t==null?v2(e,e.v):v2(e,t))}function Fs(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Ey(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,l=e||(s?[]:{}),o=0,u=0;if(l&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var h=typeof n.origin=="string"?ta(n.origin):n.origin;o=h.r,u=h.c}l["!ref"]||(l["!ref"]="A1:A1")}var x={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var p=sr(l["!ref"]);x.s.c=p.s.c,x.s.r=p.s.r,x.e.c=Math.max(x.e.c,p.e.c),x.e.r=Math.max(x.e.r,p.e.r),o==-1&&(x.e.r=o=p.e.r+1)}for(var v=0;v!=t.length;++v)if(t[v]){if(!Array.isArray(t[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=t[v].length;++_)if(!(typeof t[v][_]>"u")){var y={v:t[v][_]},w=o+v,b=u+_;if(x.s.r>w&&(x.s.r=w),x.s.c>b&&(x.s.c=b),x.e.r<w&&(x.e.r=w),x.e.c<b&&(x.e.c=b),t[v][_]&&typeof t[v][_]=="object"&&!Array.isArray(t[v][_])&&!(t[v][_]instanceof Date))y=t[v][_];else if(Array.isArray(y.v)&&(y.f=t[v][_][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(n.nullError)y.t="e",y.v=0;else if(n.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=n.dateNF||it[14],n.cellDates?(y.t="d",y.w=Ga(y.z,aa(y.v))):(y.t="n",y.v=aa(y.v),y.w=Ga(y.z,y.v))):y.t="s";if(s)l[w]||(l[w]=[]),l[w][b]&&l[w][b].z&&(y.z=l[w][b].z),l[w][b]=y;else{var E=rt({c:b,r:w});l[E]&&l[E].z&&(y.z=l[E].z),l[E]=y}}}return x.s.c<1e7&&(l["!ref"]=Et(x)),l}function Ul(e,t){return Ey(null,e,t)}function u3(e){return e.read_shift(4,"i")}function qr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function f3(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function ax(e,t){var r=e.l,n=e.read_shift(1),s=qr(e),l=[],o={t:s,h:s};if((n&1)!==0){for(var u=e.read_shift(4),h=0;h!=u;++h)l.push(f3(e));o.r=l}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}var d3=ax;function $a(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ei(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var h3=qr;function nx(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var x3=qr,_h=nx;function sx(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?hu([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ii(t,0)>>2;return r?s/100:s}function Ty(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Ti=Ty;function $r(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function m3(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),l=e.read_shift(2,"i"),o=e.read_shift(1),u=e.read_shift(1),h=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var x=fi[s];x&&(t.rgb=mo(x));break;case 2:t.rgb=mo([o,u,h]);break;case 3:t.theme=s;break}return l!=0&&(t.tint=l>0?l/32767:l/32768),t}function p3(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Sy(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function g3(e){return Sy(e,1)}function v3(e){return Sy(e,2)}var ix=2,da=3,q0=11,_2=12,xu=19,X0=64,_3=65,y3=71,w3=4108,b3=4126,Or=80,ky=81,E3=[Or,ky],T3={1:{n:"CodePage",t:ix},2:{n:"Category",t:Or},3:{n:"PresentationFormat",t:Or},4:{n:"ByteCount",t:da},5:{n:"LineCount",t:da},6:{n:"ParagraphCount",t:da},7:{n:"SlideCount",t:da},8:{n:"NoteCount",t:da},9:{n:"HiddenCount",t:da},10:{n:"MultimediaClipCount",t:da},11:{n:"ScaleCrop",t:q0},12:{n:"HeadingPairs",t:w3},13:{n:"TitlesOfParts",t:b3},14:{n:"Manager",t:Or},15:{n:"Company",t:Or},16:{n:"LinksUpToDate",t:q0},17:{n:"CharacterCount",t:da},19:{n:"SharedDoc",t:q0},22:{n:"HyperlinksChanged",t:q0},23:{n:"AppVersion",t:da,p:"version"},24:{n:"DigSig",t:_3},26:{n:"ContentType",t:Or},27:{n:"ContentStatus",t:Or},28:{n:"Language",t:Or},29:{n:"Version",t:Or},255:{},2147483648:{n:"Locale",t:xu},2147483651:{n:"Behavior",t:xu},1919054434:{}},S3={1:{n:"CodePage",t:ix},2:{n:"Title",t:Or},3:{n:"Subject",t:Or},4:{n:"Author",t:Or},5:{n:"Keywords",t:Or},6:{n:"Comments",t:Or},7:{n:"Template",t:Or},8:{n:"LastAuthor",t:Or},9:{n:"RevNumber",t:Or},10:{n:"EditTime",t:X0},11:{n:"LastPrinted",t:X0},12:{n:"CreatedDate",t:X0},13:{n:"ModifiedDate",t:X0},14:{n:"PageCount",t:da},15:{n:"WordCount",t:da},16:{n:"CharCount",t:da},17:{n:"Thumbnail",t:y3},18:{n:"Application",t:Or},19:{n:"DocSecurity",t:da},255:{},2147483648:{n:"Locale",t:xu},2147483651:{n:"Behavior",t:xu},1919054434:{}},y2={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},k3=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function A3(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var N3=A3([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),fi=Ur(N3),Si={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Ay={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},w2={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function C3(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function O3(e){var t=C3();if(!e||!e.match)return t;var r={};if((e.match(Wr)||[]).forEach(function(n){var s=Ke(n);switch(s[0].replace(UA,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[w2[s.ContentType]]!==void 0&&t[w2[s.ContentType]].push(s.PartName);break}}),t.xmlns!==WA.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var bl={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function yh(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Zc(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Wr)||[]).forEach(function(s){var l=Ke(s);if(l[0]==="<Relationship"){var o={};o.Type=l.Type,o.Target=l.Target,o.Id=l.Id,l.TargetMode&&(o.TargetMode=l.TargetMode);var u=l.TargetMode==="External"?l.Target:Hc(l.Target,t);r[u]=o,n[l.Id]=o}}),r["!id"]=n,r}var D3="application/vnd.oasis.opendocument.spreadsheet";function R3(e,t){for(var r=Qh(e),n,s;n=ho.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Ke(n[0],!1),s.path=="/"&&s.type!==D3)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var Kc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],j3=function(){for(var e=new Array(Kc.length),t=0;t<Kc.length;++t){var r=Kc[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function Ny(e){var t={};e=Vt(e);for(var r=0;r<Kc.length;++r){var n=Kc[r],s=e.match(j3[r]);s!=null&&s.length>0&&(t[n[1]]=Tt(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Dr(t[n[1]]))}return t}var I3=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Cy(e,t,r,n){var s=[];if(typeof e=="string")s=f2(e,n);else for(var l=0;l<e.length;++l)s=s.concat(e[l].map(function(p){return{v:p}}));var o=typeof t=="string"?f2(t,n).map(function(p){return p.v}):t,u=0,h=0;if(o.length>0)for(var x=0;x!==s.length;x+=2){switch(h=+s[x+1].v,s[x].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=h,r.SheetNames=o.slice(u,u+h);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=h,r.DefinedNames=o.slice(u,u+h);break;case"Charts":case"Diagramme":r.Chartsheets=h,r.ChartNames=o.slice(u,u+h);break}u+=h}}function M3(e,t,r){var n={};return t||(t={}),e=Vt(e),I3.forEach(function(s){var l=(e.match(fo(s[0]))||[])[1];switch(s[2]){case"string":l&&(t[s[1]]=Tt(l));break;case"bool":t[s[1]]=l==="true";break;case"raw":var o=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(n[s[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Cy(n.HeadingPairs,n.TitlesOfParts,t,r),t}var L3=/<[^>]+>[^<]*/g;function F3(e,t){var r={},n="",s=e.match(L3);if(s)for(var l=0;l!=s.length;++l){var o=s[l],u=Ke(o);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Tt(u.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var h=o.split(">"),x=h[0].slice(4),p=h[1];switch(x){case"lpstr":case"bstr":case"lpwstr":r[n]=Tt(p);break;case"bool":r[n]=Wt(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(p,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(p);break;case"filetime":case"date":r[n]=Dr(p);break;case"cy":case"error":r[n]=Tt(p);break;default:if(x.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,x,h)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}var U3={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Wd;function B3(e,t,r){Wd||(Wd=Zh(U3)),t=Wd[t]||t,e[t]=r}function lx(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Oy(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function Dy(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function Ry(e,t,r){return t===31?Dy(e):Oy(e,t,r)}function wh(e,t,r){return Ry(e,t,r===!1?0:4)}function P3(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Ry(e,t,0)}function H3(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(ra,""),e.l-s&2&&(e.l+=2)}return r}function z3(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(ra,"");return r}function G3(e){var t=e.l,r=mu(e,ky);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=mu(e,da);return[r,n]}function V3(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(G3(e));return r}function b2(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var l=e.read_shift(4),o=e.read_shift(4);n[l]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(ra,"").replace(Pc,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function jy(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function $3(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function mu(e,t,r){var n=e.read_shift(2),s,l=r||{};if(e.l+=2,t!==_2&&n!==t&&E3.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===_2?n:t){case 2:return s=e.read_shift(2,"i"),l.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return Oy(e,n,4).replace(ra,"");case 31:return Dy(e);case 64:return lx(e);case 65:return jy(e);case 71:return $3(e);case 80:return wh(e,n,!l.raw).replace(ra,"");case 81:return P3(e,n).replace(ra,"");case 4108:return V3(e);case 4126:case 4127:return n==4127?H3(e):z3(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function E2(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),l=[],o=0,u=0,h=-1,x={};for(o=0;o!=s;++o){var p=e.read_shift(4),v=e.read_shift(4);l[o]=[p,v+r]}l.sort(function(C,S){return C[1]-S[1]});var _={};for(o=0;o!=s;++o){if(e.l!==l[o][1]){var y=!0;if(o>0&&t)switch(t[l[o-1][0]].t){case 2:e.l+2===l[o][1]&&(e.l+=2,y=!1);break;case 80:e.l<=l[o][1]&&(e.l=l[o][1],y=!1);break;case 4108:e.l<=l[o][1]&&(e.l=l[o][1],y=!1);break}if((!t||o==0)&&e.l<=l[o][1]&&(y=!1,e.l=l[o][1]),y)throw new Error("Read Error: Expected address "+l[o][1]+" at "+e.l+" :"+o)}if(t){var w=t[l[o][0]];if(_[w.n]=mu(e,w.t,{raw:!0}),w.p==="version"&&(_[w.n]=String(_[w.n]>>16)+"."+("0000"+String(_[w.n]&65535)).slice(-4)),w.n=="CodePage")switch(_[w.n]){case 0:_[w.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:rn(u=_[w.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[w.n])}}else if(l[o][0]===1){if(u=_.CodePage=mu(e,ix),rn(u),h!==-1){var b=e.l;e.l=l[h][1],x=b2(e,u),e.l=b}}else if(l[o][0]===0){if(u===0){h=o,e.l=l[o+1][1];continue}x=b2(e,u)}else{var E=x[l[o][0]],j;switch(e[e.l]){case 65:e.l+=4,j=jy(e);break;case 30:e.l+=4,j=wh(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,j=wh(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,j=e.read_shift(4,"i");break;case 19:e.l+=4,j=e.read_shift(4);break;case 5:e.l+=4,j=e.read_shift(8,"f");break;case 11:e.l+=4,j=cr(e,4);break;case 64:e.l+=4,j=Dr(lx(e));break;default:throw new Error("unparsed value: "+e[e.l])}_[E]=j}}return e.l=r+n,_}function T2(e,t,r){var n=e.content;if(!n)return{};Lr(n,0);var s,l,o,u,h=0;n.chk("feff","Byte Order: "),n.read_shift(2);var x=n.read_shift(4),p=n.read_shift(16);if(p!==bt.utils.consts.HEADER_CLSID&&p!==r)throw new Error("Bad PropertySet CLSID "+p);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(l=n.read_shift(16),u=n.read_shift(4),s===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);s===2&&(o=n.read_shift(16),h=n.read_shift(4));var v=E2(n,t),_={SystemIdentifier:x};for(var y in v)_[y]=v[y];if(_.FMTID=l,s===1)return _;if(h-n.l==2&&(n.l+=2),n.l!==h)throw new Error("Length mismatch 2: "+n.l+" !== "+h);var w;try{w=E2(n,null)}catch{}for(y in w)_[y]=w[y];return _.FMTID=[l,o],_}function ys(e,t){return e.read_shift(t),null}function Y3(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function cr(e,t){return e.read_shift(t)===1}function xr(e){return e.read_shift(2,"u")}function Iy(e,t){return Y3(e,t,xr)}function q3(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function ko(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var l=e.read_shift(1);l&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var o=n?e.read_shift(n,s):"";return o}function X3(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,l=1+(r&1),o=0,u,h={};s&&(o=e.read_shift(2)),n&&(u=e.read_shift(4));var x=l==2?"dbcs-cont":"sbcs-cont",p=t===0?"":e.read_shift(t,x);return s&&(e.l+=4*o),n&&(e.l+=u),h.t=p,s||(h.raw="<t>"+h.t+"</t>",h.r=h.t),h}function vi(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Ao(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):vi(e,n,r)}function ki(e,t,r){if(r.biff>5)return Ao(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function W3(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function Z3(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(ra,"");return n&&(e.l+=24),s}function K3(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var l=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(l>>1,"utf16le").replace(ra,"");return r+o}function J3(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return Z3(e);case"0303000000000000c000000000000046":return K3(e);default:throw new Error("Unsupported Moniker "+r)}}function W0(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(ra,""):"";return r}function Q3(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var l,o,u,h,x="",p,v;s&16&&(l=W0(e,r-e.l)),s&128&&(o=W0(e,r-e.l)),(s&257)===257&&(u=W0(e,r-e.l)),(s&257)===1&&(h=J3(e,r-e.l)),s&8&&(x=W0(e,r-e.l)),s&32&&(p=e.read_shift(16)),s&64&&(v=lx(e)),e.l=r;var _=o||u||h||"";_&&x&&(_+="#"+x),_||(_="#"+x),s&2&&_.charAt(0)=="/"&&_.charAt(1)!="/"&&(_="file://"+_);var y={Target:_};return p&&(y.guid=p),v&&(y.time=v),l&&(y.Tooltip=l),y}function My(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function Ly(e,t){var r=My(e);return r[3]=0,r}function _n(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function e5(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function t5(e,t,r){return t===0?"":ki(e,t,r)}function r5(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),l=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[s,l,o]}function Fy(e){var t=e.read_shift(2),r=sx(e);return[t,r]}function a5(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=ko(e,t,r),l=e.read_shift(2);if(n-=e.l,l!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+l);return e.l+=l,s}function Su(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function Uy(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var n5=Uy;function By(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function s5(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function i5(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function zr(e){e.l+=2,e.l+=e.read_shift(2)}var l5={0:zr,4:zr,5:zr,6:zr,7:i5,8:zr,9:zr,10:zr,11:zr,12:zr,13:s5,14:zr,15:zr,16:zr,17:zr,18:zr,19:zr,20:zr,21:By};function c5(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(l5[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Z0(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function o5(e,t){return t===0||e.read_shift(2),1200}function u5(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=ki(e,0,r);return e.read_shift(t+n-e.l),s}function f5(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function d5(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,l=e.read_shift(1);switch(l){case 0:l="Worksheet";break;case 1:l="Macrosheet";break;case 2:l="Chartsheet";break;case 6:l="VBAModule";break}var o=ko(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:s,dt:l,name:o}}function h5(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),l=[],o=0;o!=s&&e.l<r;++o)l.push(X3(e));return l.Count=n,l.Unique=s,l}function x5(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function m5(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function p5(e){var t=e5(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function g5(e){return e.read_shift(2),e.read_shift(4)}function S2(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var l={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[l,s]}function v5(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),u=e.read_shift(2),h=e.read_shift(2),x=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:l,CurTab:o,FirstTab:u,Selected:h,TabRatio:x}}function _5(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function y5(){}function w5(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=ko(e,0,r),n}function b5(e){var t=_n(e);return t.isst=e.read_shift(4),t}function E5(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=_n(e);r.biff==2&&e.l++;var l=Ao(e,n-e.l,r);return s.val=l,s}function T5(e,t,r){var n=e.read_shift(2),s=ki(e,0,r);return[n,s]}var S5=ki;function k2(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,l=e.read_shift(s),o=e.read_shift(s),u=e.read_shift(2),h=e.read_shift(2);return e.l=n,{s:{r:l,c:u},e:{r:o,c:h}}}function k5(e){var t=e.read_shift(2),r=e.read_shift(2),n=Fy(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function A5(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),l=[];e.l<r;)l.push(Fy(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(l.length!=o-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:o,rkrec:l}}function N5(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),l=[];e.l<r;)l.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(l.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:o,ixfe:l}}function C5(e,t,r,n){var s={},l=e.read_shift(4),o=e.read_shift(4),u=e.read_shift(4),h=e.read_shift(2);return s.patternType=k3[u>>26],n.cellStyles&&(s.alc=l&7,s.fWrap=l>>3&1,s.alcV=l>>4&7,s.fJustLast=l>>7&1,s.trot=l>>8&255,s.cIndent=l>>16&15,s.fShrinkToFit=l>>20&1,s.iReadOrder=l>>22&2,s.fAtrNum=l>>26&1,s.fAtrFnt=l>>27&1,s.fAtrAlc=l>>28&1,s.fAtrBdr=l>>29&1,s.fAtrPat=l>>30&1,s.fAtrProt=l>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=u&127,s.icvBottom=u>>7&127,s.icvDiag=u>>14&127,s.dgDiag=u>>21&15,s.icvFore=h&127,s.icvBack=h>>7&127,s.fsxButton=h>>14&1),s}function O5(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=C5(e,t,n.fStyle,r),n}function D5(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function A2(e,t,r){var n=_n(e);(r.biff==2||t==9)&&++e.l;var s=q3(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function R5(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=_n(e),s=$r(e);return n.val=s,n}var N2=t5;function j5(e,t,r){var n=e.l+t,s=e.read_shift(2),l=e.read_shift(2);if(r.sbcch=l,l==1025||l==14849)return[l,s];if(l<1||l>255)throw new Error("Unexpected SupBook type: "+l);for(var o=vi(e,l),u=[];n>e.l;)u.push(Ao(e));return[l,s,o,u]}function C2(e,t,r){var n=e.read_shift(2),s,l={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=a5(e,t-2,r)),l.body=s||e.read_shift(t-2),typeof s=="string"&&(l.Name=s),l}var I5=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function O2(e,t,r){var n=e.l+t,s=e.read_shift(2),l=e.read_shift(1),o=e.read_shift(1),u=e.read_shift(r&&r.biff==2?1:2),h=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),h=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var x=vi(e,o,r);s&32&&(x=I5[x.charCodeAt(0)]);var p=n-e.l;r&&r.biff==2&&--p;var v=n==e.l||u===0||!(p>0)?[]:m6(e,p,r,u);return{chKey:l,Name:x,itab:h,rgce:v}}function Py(e,t,r){if(r.biff<8)return M5(e,t,r);for(var n=[],s=e.l+t,l=e.read_shift(r.biff>8?4:2);l--!==0;)n.push(r5(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function M5(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=ko(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function L5(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),l=vi(e,n,r),o=vi(e,s,r);return[l,o]}function F5(e,t,r){var n=Uy(e);e.l++;var s=e.read_shift(1);return t-=8,[p6(e,t,r),s,n]}function D2(e,t,r){var n=n5(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,h6(e,t,r)]}function U5(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function B5(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),u=ki(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},u,o,l]}}function P5(e,t,r){return B5(e,t,r)}function H5(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Su(e));return r}function z5(e,t,r){if(r&&r.biff<8)return V5(e,t,r);var n=By(e),s=c5(e,t-22,n[1]);return{cmo:n,ft:s}}var G5={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function V5(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((G5[n]||Xr)(e,t,r)),{cmo:[s,n,l],ft:o}}function $5(e,t,r){var n=e.l,s="";try{e.l+=4;var l=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(l)==-1?e.l+=6:o=W3(e,6,r);var u=e.read_shift(2);e.read_shift(2),xr(e,2);var h=e.read_shift(2);e.l+=h;for(var x=1;x<e.lens.length-1;++x){if(e.l-n!=e.lens[x])throw new Error("TxO: bad continue record");var p=e[e.l],v=vi(e,e.lens[x+1]-e.lens[x]-1);if(s+=v,s.length>=(p?u:2*u))break}if(s.length!==u&&s.length!==u*2)throw new Error("cchText: "+u+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function Y5(e,t){var r=Su(e);e.l+=16;var n=Q3(e,t-24);return[r,n]}function q5(e,t){e.read_shift(2);var r=Su(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(ra,""),[r,n]}function X5(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=y2[r]||r,r=e.read_shift(2),t[1]=y2[r]||r,t}function W5(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Ly(e));return r}function Z5(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Ly(e));return r}function K5(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Hy(e,t,r){if(!r.cellStyles)return Xr(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),l=e.read_shift(n),o=e.read_shift(n),u=e.read_shift(n),h=e.read_shift(2);n==2&&(e.l+=2);var x={s,e:l,w:o,ixfe:u,flags:h};return(r.biff>=5||!r.biff)&&(x.level=h>>8&7),x}function J5(e,t){var r={};return t<32||(e.l+=16,r.header=$r(e),r.footer=$r(e),e.l+=2),r}function Q5(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}var eN=_n,tN=Iy,rN=Ao;function aN(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function nN(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=_n(e);++e.l;var s=ki(e,t-7,r);return n.t="str",n.val=s,n}function sN(e){var t=_n(e);++e.l;var r=$r(e);return t.t="n",t.val=r,t}function iN(e){var t=_n(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function lN(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function cN(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function oN(e,t,r){var n=e.l+t,s=_n(e),l=e.read_shift(2),o=vi(e,l,r);return e.l=n,s.t="str",s.val=o,s}var uN=[2,3,48,49,131,139,140,245],R2=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Zh({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,h){var x=[],p=Is(1);switch(h.type){case"base64":p=tn(Na(u));break;case"binary":p=tn(u);break;case"buffer":case"array":p=u;break}Lr(p,0);var v=p.read_shift(1),_=!!(v&136),y=!1,w=!1;switch(v){case 2:break;case 3:break;case 48:y=!0,_=!0;break;case 49:y=!0,_=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var b=0,E=521;v==2&&(b=p.read_shift(2)),p.l+=3,v!=2&&(b=p.read_shift(4)),b>1048576&&(b=1e6),v!=2&&(E=p.read_shift(2));var j=p.read_shift(2),C=h.codepage||1252;v!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(C=e[p[p.l]]),p.l+=1,p.l+=2),w&&(p.l+=36);for(var S=[],L={},Z=Math.min(p.length,v==2?521:E-10-(y?264:0)),W=w?32:11;p.l<Z&&p[p.l]!=13;)switch(L={},L.name=oo.utils.decode(C,p.slice(p.l,p.l+W)).replace(/[\u0000\r\n].*$/g,""),p.l+=W,L.type=String.fromCharCode(p.read_shift(1)),v!=2&&!w&&(L.offset=p.read_shift(4)),L.len=p.read_shift(1),v==2&&(L.offset=p.read_shift(2)),L.dec=p.read_shift(1),L.name.length&&S.push(L),v!=2&&(p.l+=w?13:14),L.type){case"B":(!y||L.len!=8)&&h.WTF&&console.log("Skipping "+L.name+":"+L.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+L.name+":"+L.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+L.type)}if(p[p.l]!==13&&(p.l=E-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=E;var I=0,X=0;for(x[0]=[],X=0;X!=S.length;++X)x[0][X]=S[X].name;for(;b-- >0;){if(p[p.l]===42){p.l+=j;continue}for(++p.l,x[++I]=[],X=0,X=0;X!=S.length;++X){var U=p.slice(p.l,p.l+S[X].len);p.l+=S[X].len,Lr(U,0);var ee=oo.utils.decode(C,U);switch(S[X].type){case"C":ee.trim().length&&(x[I][X]=ee.replace(/\s+$/,""));break;case"D":ee.length===8?x[I][X]=new Date(+ee.slice(0,4),+ee.slice(4,6)-1,+ee.slice(6,8)):x[I][X]=ee;break;case"F":x[I][X]=parseFloat(ee.trim());break;case"+":case"I":x[I][X]=w?U.read_shift(-4,"i")^2147483648:U.read_shift(4,"i");break;case"L":switch(ee.trim().toUpperCase()){case"Y":case"T":x[I][X]=!0;break;case"N":case"F":x[I][X]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ee+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));x[I][X]="##MEMO##"+(w?parseInt(ee.trim(),10):U.read_shift(4));break;case"N":ee=ee.replace(/\u0000/g,"").trim(),ee&&ee!="."&&(x[I][X]=+ee||0);break;case"@":x[I][X]=new Date(U.read_shift(-8,"f")-621356832e5);break;case"T":x[I][X]=new Date((U.read_shift(4)-2440588)*864e5+U.read_shift(4));break;case"Y":x[I][X]=U.read_shift(4,"i")/1e4+U.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":x[I][X]=-U.read_shift(-8,"f");break;case"B":if(y&&S[X].len==8){x[I][X]=U.read_shift(8,"f");break}case"G":case"P":U.l+=S[X].len;break;case"0":if(S[X].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[X].type)}}}if(v!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return h&&h.sheetRows&&(x=x.slice(0,h.sheetRows)),h.DBF=S,x}function n(u,h){var x=h||{};x.dateNF||(x.dateNF="yyyymmdd");var p=Ul(r(u,x),x);return p["!cols"]=x.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete x.DBF,p}function s(u,h){try{return Fs(n(u,h),h)}catch(x){if(h&&h.WTF)throw x}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function o(u,h){var x=h||{};if(+x.codepage>=0&&rn(+x.codepage),x.type=="string")throw new Error("Cannot write DBF to JS string");var p=vh(),v=Nh(u,{header:1,raw:!0,cellDates:!0}),_=v[0],y=v.slice(1),w=u["!cols"]||[],b=0,E=0,j=0,C=1;for(b=0;b<_.length;++b){if(((w[b]||{}).DBF||{}).name){_[b]=w[b].DBF.name,++j;continue}if(_[b]!=null){if(++j,typeof _[b]=="number"&&(_[b]=_[b].toString(10)),typeof _[b]!="string")throw new Error("DBF Invalid column name "+_[b]+" |"+typeof _[b]+"|");if(_.indexOf(_[b])!==b){for(E=0;E<1024;++E)if(_.indexOf(_[b]+"_"+E)==-1){_[b]+="_"+E;break}}}}var S=sr(u["!ref"]),L=[],Z=[],W=[];for(b=0;b<=S.e.c-S.s.c;++b){var I="",X="",U=0,ee=[];for(E=0;E<y.length;++E)y[E][b]!=null&&ee.push(y[E][b]);if(ee.length==0||_[b]==null){L[b]="?";continue}for(E=0;E<ee.length;++E){switch(typeof ee[E]){case"number":X="B";break;case"string":X="C";break;case"boolean":X="L";break;case"object":X=ee[E]instanceof Date?"D":"C";break;default:X="C"}U=Math.max(U,String(ee[E]).length),I=I&&I!=X?"C":X}U>250&&(U=250),X=((w[b]||{}).DBF||{}).type,X=="C"&&w[b].DBF.len>U&&(U=w[b].DBF.len),I=="B"&&X=="N"&&(I="N",W[b]=w[b].DBF.dec,U=w[b].DBF.len),Z[b]=I=="C"||X=="N"?U:l[I]||0,C+=Z[b],L[b]=I}var te=p.next(32);for(te.write_shift(4,318902576),te.write_shift(4,y.length),te.write_shift(2,296+32*j),te.write_shift(2,C),b=0;b<4;++b)te.write_shift(4,0);for(te.write_shift(4,0|(+t[P_]||3)<<8),b=0,E=0;b<_.length;++b)if(_[b]!=null){var V=p.next(32),ge=(_[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);V.write_shift(1,ge,"sbcs"),V.write_shift(1,L[b]=="?"?"C":L[b],"sbcs"),V.write_shift(4,E),V.write_shift(1,Z[b]||l[L[b]]||0),V.write_shift(1,W[b]||0),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(1,0),V.write_shift(4,0),V.write_shift(4,0),E+=Z[b]||l[L[b]]||0}var Re=p.next(264);for(Re.write_shift(4,13),b=0;b<65;++b)Re.write_shift(4,0);for(b=0;b<y.length;++b){var Se=p.next(C);for(Se.write_shift(1,0),E=0;E<_.length;++E)if(_[E]!=null)switch(L[E]){case"L":Se.write_shift(1,y[b][E]==null?63:y[b][E]?84:70);break;case"B":Se.write_shift(8,y[b][E]||0,"f");break;case"N":var ae="0";for(typeof y[b][E]=="number"&&(ae=y[b][E].toFixed(W[E]||0)),j=0;j<Z[E]-ae.length;++j)Se.write_shift(1,32);Se.write_shift(1,ae,"sbcs");break;case"D":y[b][E]?(Se.write_shift(4,("0000"+y[b][E].getFullYear()).slice(-4),"sbcs"),Se.write_shift(2,("00"+(y[b][E].getMonth()+1)).slice(-2),"sbcs"),Se.write_shift(2,("00"+y[b][E].getDate()).slice(-2),"sbcs")):Se.write_shift(8,"00000000","sbcs");break;case"C":var ue=String(y[b][E]!=null?y[b][E]:"").slice(0,Z[E]);for(Se.write_shift(1,ue,"sbcs"),j=0;j<Z[E]-ue.length;++j)Se.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:s,to_sheet:n,from_sheet:o}}(),fN=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+gn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(_,y){var w=e[y];return typeof w=="number"?Xv(w):w},n=function(_,y,w){var b=y.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return b==59?_:Xv(b)};e["|"]=254;function s(_,y){switch(y.type){case"base64":return l(Na(_),y);case"binary":return l(_,y);case"buffer":return l(_t&&Buffer.isBuffer(_)?_.toString("binary"):bi(_),y);case"array":return l(gi(_),y)}throw new Error("Unrecognized type "+y.type)}function l(_,y){var w=_.split(/[\n\r]+/),b=-1,E=-1,j=0,C=0,S=[],L=[],Z=null,W={},I=[],X=[],U=[],ee=0,te;for(+y.codepage>=0&&rn(+y.codepage);j!==w.length;++j){ee=0;var V=w[j].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),ge=V.replace(/;;/g,"\0").split(";").map(function(H){return H.replace(/\u0000/g,";")}),Re=ge[0],Se;if(V.length>0)switch(Re){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ge[1].charAt(0)=="P"&&L.push(V.slice(3).replace(/;;/g,";"));break;case"C":var ae=!1,ue=!1,Q=!1,G=!1,A=-1,K=-1;for(C=1;C<ge.length;++C)switch(ge[C].charAt(0)){case"A":break;case"X":E=parseInt(ge[C].slice(1))-1,ue=!0;break;case"Y":for(b=parseInt(ge[C].slice(1))-1,ue||(E=0),te=S.length;te<=b;++te)S[te]=[];break;case"K":Se=ge[C].slice(1),Se.charAt(0)==='"'?Se=Se.slice(1,Se.length-1):Se==="TRUE"?Se=!0:Se==="FALSE"?Se=!1:isNaN(nn(Se))?isNaN(jl(Se).getDate())||(Se=Dr(Se)):(Se=nn(Se),Z!==null&&Ll(Z)&&(Se=Tu(Se))),ae=!0;break;case"E":G=!0;var N=Sl(ge[C].slice(1),{r:b,c:E});S[b][E]=[S[b][E],N];break;case"S":Q=!0,S[b][E]=[S[b][E],"S5S"];break;case"G":break;case"R":A=parseInt(ge[C].slice(1))-1;break;case"C":K=parseInt(ge[C].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+V)}if(ae&&(S[b][E]&&S[b][E].length==2?S[b][E][0]=Se:S[b][E]=Se,Z=null),Q){if(G)throw new Error("SYLK shared formula cannot have own formula");var P=A>-1&&S[A][K];if(!P||!P[1])throw new Error("SYLK shared formula cannot find base");S[b][E][1]=Ky(P[1],{r:b-A,c:E-K})}break;case"F":var z=0;for(C=1;C<ge.length;++C)switch(ge[C].charAt(0)){case"X":E=parseInt(ge[C].slice(1))-1,++z;break;case"Y":for(b=parseInt(ge[C].slice(1))-1,te=S.length;te<=b;++te)S[te]=[];break;case"M":ee=parseInt(ge[C].slice(1))/20;break;case"F":break;case"G":break;case"P":Z=L[parseInt(ge[C].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(U=ge[C].slice(1).split(" "),te=parseInt(U[0],10);te<=parseInt(U[1],10);++te)ee=parseInt(U[2],10),X[te-1]=ee===0?{hidden:!0}:{wch:ee},Il(X[te-1]);break;case"C":E=parseInt(ge[C].slice(1))-1,X[E]||(X[E]={});break;case"R":b=parseInt(ge[C].slice(1))-1,I[b]||(I[b]={}),ee>0?(I[b].hpt=ee,I[b].hpx=po(ee)):ee===0&&(I[b].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+V)}z<1&&(Z=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+V)}}return I.length>0&&(W["!rows"]=I),X.length>0&&(W["!cols"]=X),y&&y.sheetRows&&(S=S.slice(0,y.sheetRows)),[S,W]}function o(_,y){var w=s(_,y),b=w[0],E=w[1],j=Ul(b,y);return gn(E).forEach(function(C){j[C]=E[C]}),j}function u(_,y){return Fs(o(_,y),y)}function h(_,y,w,b){var E="C;Y"+(w+1)+";X"+(b+1)+";K";switch(_.t){case"n":E+=_.v||0,_.f&&!_.F&&(E+=";E"+KC(_.f,{r:w,c:b}));break;case"b":E+=_.v?"TRUE":"FALSE";break;case"e":E+=_.w||_.v;break;case"d":E+='"'+(_.w||_.v)+'"';break;case"s":E+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function x(_,y){y.forEach(function(w,b){var E="F;W"+(b+1)+" "+(b+1)+" ";w.hidden?E+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=gu(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=vu(w.wpx)),typeof w.wch=="number"&&(E+=Math.round(w.wch))),E.charAt(E.length-1)!=" "&&_.push(E)})}function p(_,y){y.forEach(function(w,b){var E="F;";w.hidden?E+="M0;":w.hpt?E+="M"+20*w.hpt+";":w.hpx&&(E+="M"+20*Xy(w.hpx)+";"),E.length>2&&_.push(E+"R"+(b+1))})}function v(_,y){var w=["ID;PWXL;N;E"],b=[],E=sr(_["!ref"]),j,C=Array.isArray(_),S=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),_["!cols"]&&x(w,_["!cols"]),_["!rows"]&&p(w,_["!rows"]),w.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var L=E.s.r;L<=E.e.r;++L)for(var Z=E.s.c;Z<=E.e.c;++Z){var W=rt({r:L,c:Z});j=C?(_[L]||[])[Z]:_[W],!(!j||j.v==null&&(!j.f||j.F))&&b.push(h(j,_,L,Z))}return w.join(S)+S+b.join(S)+S+"E"+S}return{to_workbook:u,to_sheet:o,from_sheet:v}}(),dN=function(){function e(l,o){switch(o.type){case"base64":return t(Na(l),o);case"binary":return t(l,o);case"buffer":return t(_t&&Buffer.isBuffer(l)?l.toString("binary"):bi(l),o);case"array":return t(gi(l),o)}throw new Error("Unrecognized type "+o.type)}function t(l,o){for(var u=l.split(`
`),h=-1,x=-1,p=0,v=[];p!==u.length;++p){if(u[p].trim()==="BOT"){v[++h]=[],x=0;continue}if(!(h<0)){var _=u[p].trim().split(","),y=_[0],w=_[1];++p;for(var b=u[p]||"";(b.match(/["]/g)||[]).length&1&&p<u.length-1;)b+=`
`+u[++p];switch(b=b.trim(),+y){case-1:if(b==="BOT"){v[++h]=[],x=0;continue}else if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?v[h][x]=!0:b==="FALSE"?v[h][x]=!1:isNaN(nn(w))?isNaN(jl(w).getDate())?v[h][x]=w:v[h][x]=Dr(w):v[h][x]=nn(w),++x;break;case 1:b=b.slice(1,b.length-1),b=b.replace(/""/g,'"'),b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),v[h][x++]=b!==""?b:null;break}if(b==="EOD")break}}return o&&o.sheetRows&&(v=v.slice(0,o.sheetRows)),v}function r(l,o){return Ul(e(l,o),o)}function n(l,o){return Fs(r(l,o),o)}var s=function(){var l=function(h,x,p,v,_){h.push(x),h.push(p+","+v),h.push('"'+_.replace(/"/g,'""')+'"')},o=function(h,x,p,v){h.push(x+","+p),h.push(x==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(h){var x=[],p=sr(h["!ref"]),v,_=Array.isArray(h);l(x,"TABLE",0,1,"sheetjs"),l(x,"VECTORS",0,p.e.r-p.s.r+1,""),l(x,"TUPLES",0,p.e.c-p.s.c+1,""),l(x,"DATA",0,0,"");for(var y=p.s.r;y<=p.e.r;++y){o(x,-1,0,"BOT");for(var w=p.s.c;w<=p.e.c;++w){var b=rt({r:y,c:w});if(v=_?(h[y]||[])[w]:h[b],!v){o(x,1,0,"");continue}switch(v.t){case"n":var E=v.w;!E&&v.v!=null&&(E=v.v),E==null?v.f&&!v.F?o(x,1,0,"="+v.f):o(x,1,0,""):o(x,0,E,"V");break;case"b":o(x,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":o(x,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=Ga(v.z||it[14],aa(Dr(v.v)))),o(x,0,v.w,"V");break;default:o(x,1,0,"")}}}o(x,-1,0,"EOD");var j=`\r
`,C=x.join(j);return C}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),hN=function(){function e(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(v,_){for(var y=v.split(`
`),w=-1,b=-1,E=0,j=[];E!==y.length;++E){var C=y[E].trim().split(":");if(C[0]==="cell"){var S=ta(C[1]);if(j.length<=S.r)for(w=j.length;w<=S.r;++w)j[w]||(j[w]=[]);switch(w=S.r,b=S.c,C[2]){case"t":j[w][b]=e(C[3]);break;case"v":j[w][b]=+C[3];break;case"vtf":var L=C[C.length-1];case"vtc":switch(C[3]){case"nl":j[w][b]=!!+C[4];break;default:j[w][b]=+C[4];break}C[2]=="vtf"&&(j[w][b]=[j[w][b],L])}}}return _&&_.sheetRows&&(j=j.slice(0,_.sheetRows)),j}function n(v,_){return Ul(r(v,_),_)}function s(v,_){return Fs(n(v,_),_)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function x(v){if(!v||!v["!ref"])return"";for(var _=[],y=[],w,b="",E=Fl(v["!ref"]),j=Array.isArray(v),C=E.s.r;C<=E.e.r;++C)for(var S=E.s.c;S<=E.e.c;++S)if(b=rt({r:C,c:S}),w=j?(v[C]||[])[S]:v[b],!(!w||w.v==null||w.t==="z")){switch(y=["cell",b,"t"],w.t){case"s":case"str":y.push(t(w.v));break;case"n":w.f?(y[2]="vtf",y[3]="n",y[4]=w.v,y[5]=t(w.f)):(y[2]="v",y[3]=w.v);break;case"b":y[2]="vt"+(w.f?"f":"c"),y[3]="nl",y[4]=w.v?"1":"0",y[5]=t(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var L=aa(Dr(w.v));y[2]="vtc",y[3]="nd",y[4]=""+L,y[5]=w.w||Ga(w.z||it[14],L);break;case"e":continue}_.push(y.join(":"))}return _.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function p(v){return[l,o,u,o,x(v),h].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:p}}(),xo=function(){function e(p,v,_,y,w){w.raw?v[_][y]=p:p===""||(p==="TRUE"?v[_][y]=!0:p==="FALSE"?v[_][y]=!1:isNaN(nn(p))?isNaN(jl(p).getDate())?v[_][y]=p:v[_][y]=Dr(p):v[_][y]=nn(p))}function t(p,v){var _=v||{},y=[];if(!p||p.length===0)return y;for(var w=p.split(/[\r\n]/),b=w.length-1;b>=0&&w[b].length===0;)--b;for(var E=10,j=0,C=0;C<=b;++C)j=w[C].indexOf(" "),j==-1?j=w[C].length:j++,E=Math.max(E,j);for(C=0;C<=b;++C){y[C]=[];var S=0;for(e(w[C].slice(0,E).trim(),y,C,S,_),S=1;S<=(w[C].length-E)/10+1;++S)e(w[C].slice(E+(S-1)*10,E+S*10).trim(),y,C,S,_)}return _.sheetRows&&(y=y.slice(0,_.sheetRows)),y}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(p){for(var v={},_=!1,y=0,w=0;y<p.length;++y)(w=p.charCodeAt(y))==34?_=!_:!_&&w in r&&(v[w]=(v[w]||0)+1);w=[];for(y in v)Object.prototype.hasOwnProperty.call(v,y)&&w.push([v[y],y]);if(!w.length){v=n;for(y in v)Object.prototype.hasOwnProperty.call(v,y)&&w.push([v[y],y])}return w.sort(function(b,E){return b[0]-E[0]||n[b[1]]-n[E[1]]}),r[w.pop()[1]]||44}function l(p,v){var _=v||{},y="",w=_.dense?[]:{},b={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(y=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(y=p.charAt(4),p=p.slice(6)):y=s(p.slice(0,1024)):_&&_.FS?y=_.FS:y=s(p.slice(0,1024));var E=0,j=0,C=0,S=0,L=0,Z=y.charCodeAt(0),W=!1,I=0,X=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var U=_.dateNF!=null?TA(_.dateNF):null;function ee(){var te=p.slice(S,L),V={};if(te.charAt(0)=='"'&&te.charAt(te.length-1)=='"'&&(te=te.slice(1,-1).replace(/""/g,'"')),te.length===0)V.t="z";else if(_.raw)V.t="s",V.v=te;else if(te.trim().length===0)V.t="s",V.v=te;else if(te.charCodeAt(0)==61)te.charCodeAt(1)==34&&te.charCodeAt(te.length-1)==34?(V.t="s",V.v=te.slice(2,-1).replace(/""/g,'"')):QC(te)?(V.t="n",V.f=te.slice(1)):(V.t="s",V.v=te);else if(te=="TRUE")V.t="b",V.v=!0;else if(te=="FALSE")V.t="b",V.v=!1;else if(!isNaN(C=nn(te)))V.t="n",_.cellText!==!1&&(V.w=te),V.v=C;else if(!isNaN(jl(te).getDate())||U&&te.match(U)){V.z=_.dateNF||it[14];var ge=0;U&&te.match(U)&&(te=SA(te,_.dateNF,te.match(U)||[]),ge=1),_.cellDates?(V.t="d",V.v=Dr(te,ge)):(V.t="n",V.v=aa(Dr(te,ge))),_.cellText!==!1&&(V.w=Ga(V.z,V.v instanceof Date?aa(V.v):V.v)),_.cellNF||delete V.z}else V.t="s",V.v=te;if(V.t=="z"||(_.dense?(w[E]||(w[E]=[]),w[E][j]=V):w[rt({c:j,r:E})]=V),S=L+1,X=p.charCodeAt(S),b.e.c<j&&(b.e.c=j),b.e.r<E&&(b.e.r=E),I==Z)++j;else if(j=0,++E,_.sheetRows&&_.sheetRows<=E)return!0}e:for(;L<p.length;++L)switch(I=p.charCodeAt(L)){case 34:X===34&&(W=!W);break;case Z:case 10:case 13:if(!W&&ee())break e;break}return L-S>0&&ee(),w["!ref"]=Et(b),w}function o(p,v){return!(v&&v.PRN)||v.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?l(p,v):Ul(t(p,v),v)}function u(p,v){var _="",y=v.type=="string"?[0,0,0,0]:mx(p,v);switch(v.type){case"base64":_=Na(p);break;case"binary":_=p;break;case"buffer":v.codepage==65001?_=p.toString("utf8"):v.codepage&&typeof oo<"u"||(_=_t&&Buffer.isBuffer(p)?p.toString("binary"):bi(p));break;case"array":_=gi(p);break;case"string":_=p;break;default:throw new Error("Unrecognized type "+v.type)}return y[0]==239&&y[1]==187&&y[2]==191?_=Vt(_.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?_=Vt(_):v.type=="binary"&&typeof oo<"u",_.slice(0,19)=="socialcalc:version:"?hN.to_sheet(v.type=="string"?_:Vt(_),v):o(_,v)}function h(p,v){return Fs(u(p,v),v)}function x(p){for(var v=[],_=sr(p["!ref"]),y,w=Array.isArray(p),b=_.s.r;b<=_.e.r;++b){for(var E=[],j=_.s.c;j<=_.e.c;++j){var C=rt({r:b,c:j});if(y=w?(p[b]||[])[j]:p[C],!y||y.v==null){E.push("          ");continue}for(var S=(y.w||($n(y),y.w)||"").slice(0,10);S.length<10;)S+=" ";E.push(S+(j===0?" ":""))}v.push(E.join(""))}return v.join(`
`)}return{to_workbook:h,to_sheet:u,from_sheet:x}}();function xN(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=fN.to_workbook(e,r);return r.WTF=n,s}catch(l){if(r.WTF=n,!l.message.match(/SYLK bad record ID/)&&n)throw l;return xo.to_workbook(e,t)}}var Jc=function(){function e(N,P,z){if(N){Lr(N,N.l||0);for(var H=z.Enum||A;N.l<N.length;){var se=N.read_shift(2),ve=H[se]||H[65535],be=N.read_shift(2),Ae=N.l+be,ye=ve.f&&ve.f(N,be,z);if(N.l=Ae,P(ye,ve,se))return}}}function t(N,P){switch(P.type){case"base64":return r(tn(Na(N)),P);case"binary":return r(tn(N),P);case"buffer":case"array":return r(N,P)}throw"Unsupported type "+P.type}function r(N,P){if(!N)return N;var z=P||{},H=z.dense?[]:{},se="Sheet1",ve="",be=0,Ae={},ye=[],Ye=[],Y={s:{r:0,c:0},e:{r:0,c:0}},ot=z.sheetRows||0;if(N[2]==0&&(N[3]==8||N[3]==9)&&N.length>=16&&N[14]==5&&N[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(N[2]==2)z.Enum=A,e(N,function(Oe,Ot,$t){switch($t){case 0:z.vers=Oe,Oe>=4096&&(z.qpro=!0);break;case 6:Y=Oe;break;case 204:Oe&&(ve=Oe);break;case 222:ve=Oe;break;case 15:case 51:z.qpro||(Oe[1].v=Oe[1].v.slice(1));case 13:case 14:case 16:$t==14&&(Oe[2]&112)==112&&(Oe[2]&15)>1&&(Oe[2]&15)<15&&(Oe[1].z=z.dateNF||it[14],z.cellDates&&(Oe[1].t="d",Oe[1].v=Tu(Oe[1].v))),z.qpro&&Oe[3]>be&&(H["!ref"]=Et(Y),Ae[se]=H,ye.push(se),H=z.dense?[]:{},Y={s:{r:0,c:0},e:{r:0,c:0}},be=Oe[3],se=ve||"Sheet"+(be+1),ve="");var Le=z.dense?(H[Oe[0].r]||[])[Oe[0].c]:H[rt(Oe[0])];if(Le){Le.t=Oe[1].t,Le.v=Oe[1].v,Oe[1].z!=null&&(Le.z=Oe[1].z),Oe[1].f!=null&&(Le.f=Oe[1].f);break}z.dense?(H[Oe[0].r]||(H[Oe[0].r]=[]),H[Oe[0].r][Oe[0].c]=Oe[1]):H[rt(Oe[0])]=Oe[1];break}},z);else if(N[2]==26||N[2]==14)z.Enum=K,N[2]==14&&(z.qpro=!0,N.l=0),e(N,function(Oe,Ot,$t){switch($t){case 204:se=Oe;break;case 22:Oe[1].v=Oe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Oe[3]>be&&(H["!ref"]=Et(Y),Ae[se]=H,ye.push(se),H=z.dense?[]:{},Y={s:{r:0,c:0},e:{r:0,c:0}},be=Oe[3],se="Sheet"+(be+1)),ot>0&&Oe[0].r>=ot)break;z.dense?(H[Oe[0].r]||(H[Oe[0].r]=[]),H[Oe[0].r][Oe[0].c]=Oe[1]):H[rt(Oe[0])]=Oe[1],Y.e.c<Oe[0].c&&(Y.e.c=Oe[0].c),Y.e.r<Oe[0].r&&(Y.e.r=Oe[0].r);break;case 27:Oe[14e3]&&(Ye[Oe[14e3][0]]=Oe[14e3][1]);break;case 1537:Ye[Oe[0]]=Oe[1],Oe[0]==be&&(se=Oe[1]);break}},z);else throw new Error("Unrecognized LOTUS BOF "+N[2]);if(H["!ref"]=Et(Y),Ae[ve||se]=H,ye.push(ve||se),!Ye.length)return{SheetNames:ye,Sheets:Ae};for(var Xe={},gt=[],Je=0;Je<Ye.length;++Je)Ae[ye[Je]]?(gt.push(Ye[Je]||ye[Je]),Xe[Ye[Je]]=Ae[Ye[Je]]||Ae[ye[Je]]):(gt.push(Ye[Je]),Xe[Ye[Je]]={"!ref":"A1"});return{SheetNames:gt,Sheets:Xe}}function n(N,P){var z=P||{};if(+z.codepage>=0&&rn(+z.codepage),z.type=="string")throw new Error("Cannot write WK1 to JS string");var H=vh(),se=sr(N["!ref"]),ve=Array.isArray(N),be=[];Ja(H,0,l(1030)),Ja(H,6,h(se));for(var Ae=Math.min(se.e.r,8191),ye=se.s.r;ye<=Ae;++ye)for(var Ye=Br(ye),Y=se.s.c;Y<=se.e.c;++Y){ye===se.s.r&&(be[Y]=Er(Y));var ot=be[Y]+Ye,Xe=ve?(N[ye]||[])[Y]:N[ot];if(!(!Xe||Xe.t=="z"))if(Xe.t=="n")(Xe.v|0)==Xe.v&&Xe.v>=-32768&&Xe.v<=32767?Ja(H,13,y(ye,Y,Xe.v)):Ja(H,14,b(ye,Y,Xe.v));else{var gt=$n(Xe);Ja(H,15,v(ye,Y,gt.slice(0,239)))}}return Ja(H,1),H.end()}function s(N,P){var z=P||{};if(+z.codepage>=0&&rn(+z.codepage),z.type=="string")throw new Error("Cannot write WK3 to JS string");var H=vh();Ja(H,0,o(N));for(var se=0,ve=0;se<N.SheetNames.length;++se)(N.Sheets[N.SheetNames[se]]||{})["!ref"]&&Ja(H,27,G(N.SheetNames[se],ve++));var be=0;for(se=0;se<N.SheetNames.length;++se){var Ae=N.Sheets[N.SheetNames[se]];if(!(!Ae||!Ae["!ref"])){for(var ye=sr(Ae["!ref"]),Ye=Array.isArray(Ae),Y=[],ot=Math.min(ye.e.r,8191),Xe=ye.s.r;Xe<=ot;++Xe)for(var gt=Br(Xe),Je=ye.s.c;Je<=ye.e.c;++Je){Xe===ye.s.r&&(Y[Je]=Er(Je));var Oe=Y[Je]+gt,Ot=Ye?(Ae[Xe]||[])[Je]:Ae[Oe];if(!(!Ot||Ot.t=="z"))if(Ot.t=="n")Ja(H,23,ee(Xe,Je,be,Ot.v));else{var $t=$n(Ot);Ja(H,22,I(Xe,Je,be,$t.slice(0,239)))}}++be}}return Ja(H,1),H.end()}function l(N){var P=br(2);return P.write_shift(2,N),P}function o(N){var P=br(26);P.write_shift(2,4096),P.write_shift(2,4),P.write_shift(4,0);for(var z=0,H=0,se=0,ve=0;ve<N.SheetNames.length;++ve){var be=N.SheetNames[ve],Ae=N.Sheets[be];if(!(!Ae||!Ae["!ref"])){++se;var ye=Fl(Ae["!ref"]);z<ye.e.r&&(z=ye.e.r),H<ye.e.c&&(H=ye.e.c)}}return z>8191&&(z=8191),P.write_shift(2,z),P.write_shift(1,se),P.write_shift(1,H),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(1,1),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(4,0),P}function u(N,P,z){var H={s:{c:0,r:0},e:{c:0,r:0}};return P==8&&z.qpro?(H.s.c=N.read_shift(1),N.l++,H.s.r=N.read_shift(2),H.e.c=N.read_shift(1),N.l++,H.e.r=N.read_shift(2),H):(H.s.c=N.read_shift(2),H.s.r=N.read_shift(2),P==12&&z.qpro&&(N.l+=2),H.e.c=N.read_shift(2),H.e.r=N.read_shift(2),P==12&&z.qpro&&(N.l+=2),H.s.c==65535&&(H.s.c=H.e.c=H.s.r=H.e.r=0),H)}function h(N){var P=br(8);return P.write_shift(2,N.s.c),P.write_shift(2,N.s.r),P.write_shift(2,N.e.c),P.write_shift(2,N.e.r),P}function x(N,P,z){var H=[{c:0,r:0},{t:"n",v:0},0,0];return z.qpro&&z.vers!=20768?(H[0].c=N.read_shift(1),H[3]=N.read_shift(1),H[0].r=N.read_shift(2),N.l+=2):(H[2]=N.read_shift(1),H[0].c=N.read_shift(2),H[0].r=N.read_shift(2)),H}function p(N,P,z){var H=N.l+P,se=x(N,P,z);if(se[1].t="s",z.vers==20768){N.l++;var ve=N.read_shift(1);return se[1].v=N.read_shift(ve,"utf8"),se}return z.qpro&&N.l++,se[1].v=N.read_shift(H-N.l,"cstr"),se}function v(N,P,z){var H=br(7+z.length);H.write_shift(1,255),H.write_shift(2,P),H.write_shift(2,N),H.write_shift(1,39);for(var se=0;se<H.length;++se){var ve=z.charCodeAt(se);H.write_shift(1,ve>=128?95:ve)}return H.write_shift(1,0),H}function _(N,P,z){var H=x(N,P,z);return H[1].v=N.read_shift(2,"i"),H}function y(N,P,z){var H=br(7);return H.write_shift(1,255),H.write_shift(2,P),H.write_shift(2,N),H.write_shift(2,z,"i"),H}function w(N,P,z){var H=x(N,P,z);return H[1].v=N.read_shift(8,"f"),H}function b(N,P,z){var H=br(13);return H.write_shift(1,255),H.write_shift(2,P),H.write_shift(2,N),H.write_shift(8,z,"f"),H}function E(N,P,z){var H=N.l+P,se=x(N,P,z);if(se[1].v=N.read_shift(8,"f"),z.qpro)N.l=H;else{var ve=N.read_shift(2);L(N.slice(N.l,N.l+ve),se),N.l+=ve}return se}function j(N,P,z){var H=P&32768;return P&=-32769,P=(H?N:0)+(P>=8192?P-16384:P),(H?"":"$")+(z?Er(P):Br(P))}var C={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},S=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function L(N,P){Lr(N,0);for(var z=[],H=0,se="",ve="",be="",Ae="";N.l<N.length;){var ye=N[N.l++];switch(ye){case 0:z.push(N.read_shift(8,"f"));break;case 1:ve=j(P[0].c,N.read_shift(2),!0),se=j(P[0].r,N.read_shift(2),!1),z.push(ve+se);break;case 2:{var Ye=j(P[0].c,N.read_shift(2),!0),Y=j(P[0].r,N.read_shift(2),!1);ve=j(P[0].c,N.read_shift(2),!0),se=j(P[0].r,N.read_shift(2),!1),z.push(Ye+Y+":"+ve+se)}break;case 3:if(N.l<N.length){console.error("WK1 premature formula end");return}break;case 4:z.push("("+z.pop()+")");break;case 5:z.push(N.read_shift(2));break;case 6:{for(var ot="";ye=N[N.l++];)ot+=String.fromCharCode(ye);z.push('"'+ot.replace(/"/g,'""')+'"')}break;case 8:z.push("-"+z.pop());break;case 23:z.push("+"+z.pop());break;case 22:z.push("NOT("+z.pop()+")");break;case 20:case 21:Ae=z.pop(),be=z.pop(),z.push(["AND","OR"][ye-20]+"("+be+","+Ae+")");break;default:if(ye<32&&S[ye])Ae=z.pop(),be=z.pop(),z.push(be+S[ye]+Ae);else if(C[ye]){if(H=C[ye][1],H==69&&(H=N[N.l++]),H>z.length){console.error("WK1 bad formula parse 0x"+ye.toString(16)+":|"+z.join("|")+"|");return}var Xe=z.slice(-H);z.length-=H,z.push(C[ye][0]+"("+Xe.join(",")+")")}else return ye<=7?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=24?console.error("WK1 unsupported op "+ye.toString(16)):ye<=30?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=115?console.error("WK1 unsupported function opcode "+ye.toString(16)):console.error("WK1 unrecognized opcode "+ye.toString(16))}}z.length==1?P[1].f=""+z[0]:console.error("WK1 bad formula parse |"+z.join("|")+"|")}function Z(N){var P=[{c:0,r:0},{t:"n",v:0},0];return P[0].r=N.read_shift(2),P[3]=N[N.l++],P[0].c=N[N.l++],P}function W(N,P){var z=Z(N);return z[1].t="s",z[1].v=N.read_shift(P-4,"cstr"),z}function I(N,P,z,H){var se=br(6+H.length);se.write_shift(2,N),se.write_shift(1,z),se.write_shift(1,P),se.write_shift(1,39);for(var ve=0;ve<H.length;++ve){var be=H.charCodeAt(ve);se.write_shift(1,be>=128?95:be)}return se.write_shift(1,0),se}function X(N,P){var z=Z(N);z[1].v=N.read_shift(2);var H=z[1].v>>1;if(z[1].v&1)switch(H&7){case 0:H=(H>>3)*5e3;break;case 1:H=(H>>3)*500;break;case 2:H=(H>>3)/20;break;case 3:H=(H>>3)/200;break;case 4:H=(H>>3)/2e3;break;case 5:H=(H>>3)/2e4;break;case 6:H=(H>>3)/16;break;case 7:H=(H>>3)/64;break}return z[1].v=H,z}function U(N,P){var z=Z(N),H=N.read_shift(4),se=N.read_shift(4),ve=N.read_shift(2);if(ve==65535)return H===0&&se===3221225472?(z[1].t="e",z[1].v=15):H===0&&se===3489660928?(z[1].t="e",z[1].v=42):z[1].v=0,z;var be=ve&32768;return ve=(ve&32767)-16446,z[1].v=(1-be*2)*(se*Math.pow(2,ve+32)+H*Math.pow(2,ve)),z}function ee(N,P,z,H){var se=br(14);if(se.write_shift(2,N),se.write_shift(1,z),se.write_shift(1,P),H==0)return se.write_shift(4,0),se.write_shift(4,0),se.write_shift(2,65535),se;var ve=0,be=0,Ae=0,ye=0;return H<0&&(ve=1,H=-H),be=Math.log2(H)|0,H/=Math.pow(2,be-31),ye=H>>>0,(ye&2147483648)==0&&(H/=2,++be,ye=H>>>0),H-=ye,ye|=2147483648,ye>>>=0,H*=Math.pow(2,32),Ae=H>>>0,se.write_shift(4,Ae),se.write_shift(4,ye),be+=16383+(ve?32768:0),se.write_shift(2,be),se}function te(N,P){var z=U(N);return N.l+=P-14,z}function V(N,P){var z=Z(N),H=N.read_shift(4);return z[1].v=H>>6,z}function ge(N,P){var z=Z(N),H=N.read_shift(8,"f");return z[1].v=H,z}function Re(N,P){var z=ge(N);return N.l+=P-10,z}function Se(N,P){return N[N.l+P-1]==0?N.read_shift(P,"cstr"):""}function ae(N,P){var z=N[N.l++];z>P-1&&(z=P-1);for(var H="";H.length<z;)H+=String.fromCharCode(N[N.l++]);return H}function ue(N,P,z){if(!(!z.qpro||P<21)){var H=N.read_shift(1);N.l+=17,N.l+=1,N.l+=2;var se=N.read_shift(P-21,"cstr");return[H,se]}}function Q(N,P){for(var z={},H=N.l+P;N.l<H;){var se=N.read_shift(2);if(se==14e3){for(z[se]=[0,""],z[se][0]=N.read_shift(2);N[N.l];)z[se][1]+=String.fromCharCode(N[N.l]),N.l++;N.l++}}return z}function G(N,P){var z=br(5+N.length);z.write_shift(2,14e3),z.write_shift(2,P);for(var H=0;H<N.length;++H){var se=N.charCodeAt(H);z[z.l++]=se>127?95:se}return z[z.l++]=0,z}var A={0:{n:"BOF",f:xr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Se},222:{n:"SHEETNAMELP",f:ae},65535:{n:""}},K={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:W},23:{n:"NUMBER17",f:U},24:{n:"NUMBER18",f:X},25:{n:"FORMULA19",f:te},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Q},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:V},38:{n:"??"},39:{n:"NUMBER27",f:ge},40:{n:"FORMULA28",f:Re},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Se},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ue},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}();function mN(e){var t={},r=e.match(Wr),n=0,s=!1;if(r)for(;n!=r.length;++n){var l=Ke(r[n]);switch(l[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!l.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(l.val=="1")break;t.cp=$h[parseInt(l.val,10)];break;case"<outline":if(!l.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=l.val;break;case"<sz":t.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;switch(l.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(l.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(l.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":l.rgb&&(t.color=l.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=l.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=l.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(l[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+l[0])}}return t}var pN=function(){var e=fo("t"),t=fo("rPr");function r(l){var o=l.match(e);if(!o)return{t:"s",v:""};var u={t:"s",v:Tt(o[1])},h=l.match(t);return h&&(u.s=mN(h[1])),u}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(s).map(r).filter(function(u){return u.v})}}(),gN=function(){var t=/(\r\n|\n)/g;function r(s,l,o){var u=[];s.u&&u.push("text-decoration: underline;"),s.uval&&u.push("text-underline-style:"+s.uval+";"),s.sz&&u.push("font-size:"+s.sz+"pt;"),s.outline&&u.push("text-effect: outline;"),s.shadow&&u.push("text-shadow: auto;"),l.push('<span style="'+u.join("")+'">'),s.b&&(l.push("<b>"),o.push("</b>")),s.i&&(l.push("<i>"),o.push("</i>")),s.strike&&(l.push("<s>"),o.push("</s>"));var h=s.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(l.push("<"+h+">"),o.push("</"+h+">")),o.push("</span>"),s}function n(s){var l=[[],s.v,[]];return s.v?(s.s&&r(s.s,l[0],l[2]),l[0].join("")+l[1].replace(t,"<br/>")+l[2].join("")):""}return function(l){return l.map(n).join("")}}(),vN=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,_N=/<(?:\w+:)?r>/,yN=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function cx(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Tt(Vt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Vt(e),r&&(n.h=Jh(n.t))):e.match(_N)&&(n.r=Vt(e),n.t=Tt(Vt((e.replace(yN,"").match(vN)||[]).join("").replace(Wr,""))),r&&(n.h=gN(pN(n.r)))),n):{t:""}}var wN=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,bN=/<(?:\w+:)?(?:si|sstItem)>/g,EN=/<\/(?:\w+:)?(?:si|sstItem)>/;function TN(e,t){var r=[],n="";if(!e)return r;var s=e.match(wN);if(s){n=s[2].replace(bN,"").split(EN);for(var l=0;l!=n.length;++l){var o=cx(n[l].trim(),t);o!=null&&(r[r.length]=o)}s=Ke(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}function SN(e){return[e.read_shift(4),e.read_shift(4)]}function kN(e,t){var r=[],n=!1;return Yn(e,function(l,o,u){switch(u){case 159:r.Count=l[0],r.Unique=l[1];break;case 19:r.push(l);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function zy(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function zn(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function AN(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=zn(e,4),t.U=zn(e,4),t.W=zn(e,4),t}function NN(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),l=[];s-- >0;)l.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=l,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function CN(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(NN(e));return t}function ON(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function DN(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=zn(e,4),t.U=zn(e,4),t.W=zn(e,4),t}function RN(e){var t=DN(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function Gy(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function Vy(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function jN(e){var t=zn(e);switch(t.Minor){case 2:return[t.Minor,IN(e)];case 3:return[t.Minor,MN()];case 4:return[t.Minor,LN(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function IN(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=Gy(e,r),s=Vy(e,e.length-e.l);return{t:"Std",h:n,v:s}}function MN(){throw new Error("File is password-protected: ECMA-376 Extensible")}function LN(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Wr,function(l){var o=Ke(l);switch(vn(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(u){n[u]=o[u]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function FN(e,t){var r={},n=r.EncryptionVersionInfo=zn(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=Gy(e,s),t-=s,r.EncryptionVerifier=Vy(e,t),r}function UN(e){var t={},r=t.EncryptionVersionInfo=zn(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function BN(e){var t=0,r,n=zy(e),s=n.length+1,l,o,u,h,x;for(r=Is(s),r[0]=n.length,l=1;l!=s;++l)r[l]=n[l-1];for(l=s-1;l>=0;--l)o=r[l],u=(t&16384)===0?0:1,h=t<<1&32767,x=u|h,t=x^o;return t^52811}var $y=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},s=function(o,u){return n(o^u)},l=function(o){for(var u=t[o.length-1],h=104,x=o.length-1;x>=0;--x)for(var p=o[x],v=0;v!=7;++v)p&64&&(u^=r[h]),p*=2,--h;return u};return function(o){for(var u=zy(o),h=l(u),x=u.length,p=Is(16),v=0;v!=16;++v)p[v]=0;var _,y,w;for((x&1)===1&&(_=h>>8,p[x]=s(e[0],_),--x,_=h&255,y=u[u.length-1],p[x]=s(y,_));x>0;)--x,_=h>>8,p[x]=s(u[x],_),--x,_=h&255,p[x]=s(u[x],_);for(x=15,w=15-u.length;w>0;)_=h>>8,p[x]=s(e[w],_),--x,--w,_=h&255,p[x]=s(u[x],_),--x,--w;return p}}(),PN=function(e,t,r,n,s){s||(s=t),n||(n=$y(e));var l,o;for(l=0;l!=t.length;++l)o=t[l],o^=n[r],o=(o>>5|o<<3)&255,s[l]=o,++r;return[s,r,n]},HN=function(e){var t=0,r=$y(e);return function(n){var s=PN("",n,t,r);return t=s[1],s[0]}};function zN(e,t,r,n){var s={key:xr(e),verificationBytes:xr(e)};return r.password&&(s.verifier=BN(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=HN(r.password)),s}function GN(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=UN(e):n.Data=FN(e,t),n}function VN(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?GN(e,t-2,n):zN(e,r.biff>=8?t:t-2,r,n),n}var $N=function(){function e(s,l){switch(l.type){case"base64":return t(Na(s),l);case"binary":return t(s,l);case"buffer":return t(_t&&Buffer.isBuffer(s)?s.toString("binary"):bi(s),l);case"array":return t(gi(s),l)}throw new Error("Unrecognized type "+l.type)}function t(s,l){var o=l||{},u=o.dense?[]:{},h=s.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var x={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(p,v){Array.isArray(u)&&(u[v]=[]);for(var _=/\\\w+\b/g,y=0,w,b=-1;w=_.exec(p);){switch(w[0]){case"\\cell":var E=p.slice(y,_.lastIndex-w[0].length);if(E[0]==" "&&(E=E.slice(1)),++b,E.length){var j={v:E,t:"s"};Array.isArray(u)?u[v][b]=j:u[rt({r:v,c:b})]=j}break}y=_.lastIndex}b>x.e.c&&(x.e.c=b)}),u["!ref"]=Et(x),u}function r(s,l){return Fs(e(s,l),l)}function n(s){for(var l=["{\\rtf1\\ansi"],o=sr(s["!ref"]),u,h=Array.isArray(s),x=o.s.r;x<=o.e.r;++x){l.push("\\trowd\\trautofit1");for(var p=o.s.c;p<=o.e.c;++p)l.push("\\cellx"+(p+1));for(l.push("\\pard\\intbl"),p=o.s.c;p<=o.e.c;++p){var v=rt({r:x,c:p});u=h?(s[x]||[])[p]:s[v],!(!u||u.v==null&&(!u.f||u.F))&&(l.push(" "+(u.w||($n(u),u.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function YN(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function mo(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function qN(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),l=Math.min(t,r,n),o=s-l;if(o===0)return[0,0,t];var u=0,h=0,x=s+l;switch(h=o/(x>1?2-x:x),s){case t:u=((r-n)/o+6)%6;break;case r:u=(n-t)/o+2;break;case n:u=(t-r)/o+4;break}return[u/6,h,x/2]}function XN(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),l=n-s/2,o=[l,l,l],u=6*t,h;if(r!==0)switch(u|0){case 0:case 6:h=s*u,o[0]+=s,o[1]+=h;break;case 1:h=s*(2-u),o[0]+=h,o[1]+=s;break;case 2:h=s*(u-2),o[1]+=s,o[2]+=h;break;case 3:h=s*(4-u),o[1]+=h,o[2]+=s;break;case 4:h=s*(u-4),o[2]+=s,o[0]+=h;break;case 5:h=s*(6-u),o[2]+=h,o[0]+=s;break}for(var x=0;x!=3;++x)o[x]=Math.round(o[x]*255);return o}function pu(e,t){if(t===0)return e;var r=qN(YN(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),mo(XN(r))}var Yy=6,WN=15,ZN=1,ea=Yy;function gu(e){return Math.floor((e+Math.round(128/ea)/256)*ea)}function vu(e){return Math.floor((e-5)/ea*100+.5)/100}function bh(e){return Math.round((e*ea+5)/ea*256)/256}function Zd(e){return bh(vu(gu(e)))}function ox(e){var t=Math.abs(e-Zd(e)),r=ea;if(t>.005)for(ea=ZN;ea<WN;++ea)Math.abs(e-Zd(e))<=t&&(t=Math.abs(e-Zd(e)),r=ea);ea=r}function Il(e){e.width?(e.wpx=gu(e.width),e.wch=vu(e.wpx),e.MDW=ea):e.wpx?(e.wch=vu(e.wpx),e.width=bh(e.wch),e.MDW=ea):typeof e.wch=="number"&&(e.width=bh(e.wch),e.wpx=gu(e.width),e.MDW=ea),e.customWidth&&delete e.customWidth}var KN=96,qy=KN;function Xy(e){return e*96/qy}function po(e){return e*qy/96}var JN={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function QN(e,t,r,n){t.Borders=[];var s={},l=!1;(e[0].match(Wr)||[]).forEach(function(o){var u=Ke(o);switch(vn(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},u.diagonalUp&&(s.diagonalUp=Wt(u.diagonalUp)),u.diagonalDown&&(s.diagonalDown=Wt(u.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+u[0]+" in borders")}})}function eC(e,t,r,n){t.Fills=[];var s={},l=!1;(e[0].match(Wr)||[]).forEach(function(o){var u=Ke(o);switch(vn(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":u.patternType&&(s.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),u.indexed&&(s.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(s.bgColor.theme=parseInt(u.theme,10)),u.tint&&(s.bgColor.tint=parseFloat(u.tint)),u.rgb&&(s.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),u.theme&&(s.fgColor.theme=parseInt(u.theme,10)),u.tint&&(s.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(s.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fills")}})}function tC(e,t,r,n){t.Fonts=[];var s={},l=!1;(e[0].match(Wr)||[]).forEach(function(o){var u=Ke(o);switch(vn(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":u.val&&(s.name=Vt(u.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=u.val?Wt(u.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=u.val?Wt(u.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(u.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=u.val?Wt(u.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=u.val?Wt(u.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=u.val?Wt(u.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=u.val?Wt(u.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=u.val?Wt(u.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":u.val&&(s.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(s.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(s.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(s.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=$h[parseInt(u.val,10)];break;case"<color":if(s.color||(s.color={}),u.auto&&(s.color.auto=Wt(u.auto)),u.rgb)s.color.rgb=u.rgb.slice(-6);else if(u.indexed){s.color.index=parseInt(u.indexed,10);var h=fi[s.color.index];s.color.index==81&&(h=fi[1]),h||(h=fi[1]),s.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else u.theme&&(s.color.theme=parseInt(u.theme,10),u.tint&&(s.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=pu(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+u[0]+" in fonts")}})}function rC(e,t,r){t.NumberFmt=[];for(var n=gn(it),s=0;s<n.length;++s)t.NumberFmt[n[s]]=it[n[s]];var l=e[0].match(Wr);if(l)for(s=0;s<l.length;++s){var o=Ke(l[s]);switch(vn(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Tt(Vt(o.formatCode)),h=parseInt(o.numFmtId,10);if(t.NumberFmt[h]=u,h>0){if(h>392){for(h=392;h>60&&t.NumberFmt[h]!=null;--h);t.NumberFmt[h]=u}ui(u,h)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var K0=["numFmtId","fillId","fontId","borderId","xfId"],J0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function aC(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(Wr)||[]).forEach(function(l){var o=Ke(l),u=0;switch(vn(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],u=0;u<K0.length;++u)n[K0[u]]&&(n[K0[u]]=parseInt(n[K0[u]],10));for(u=0;u<J0.length;++u)n[J0[u]]&&(n[J0[u]]=Wt(n[J0[u]]));if(t.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[u]){n.numFmtId=u;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};o.vertical&&(h.vertical=o.vertical),o.horizontal&&(h.horizontal=o.horizontal),o.textRotation!=null&&(h.textRotation=o.textRotation),o.indent&&(h.indent=o.indent),o.wrapText&&(h.wrapText=Wt(o.wrapText)),n.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var nC=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,l=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,h,x){var p={};if(!u)return p;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var v;return(v=u.match(t))&&rC(v,p,x),(v=u.match(s))&&tC(v,p,h,x),(v=u.match(n))&&eC(v,p,h,x),(v=u.match(l))&&QN(v,p,h,x),(v=u.match(r))&&aC(v,p,x),p}}();function sC(e,t){var r=e.read_shift(2),n=qr(e);return[r,n]}function iC(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=p3(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var l=e.read_shift(2);switch(l===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var u=e.read_shift(1);u>0&&(n.family=u);var h=e.read_shift(1);switch(h>0&&(n.charset=h),e.l++,n.color=m3(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=qr(e),n}var lC=Xr;function cC(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}var oC=Xr;function uC(e,t,r){var n={};n.NumberFmt=[];for(var s in it)n.NumberFmt[s]=it[s];n.CellXf=[],n.Fonts=[];var l=[],o=!1;return Yn(e,function(h,x,p){switch(p){case 44:n.NumberFmt[h[0]]=h[1],ui(h[1],h[0]);break;case 43:n.Fonts.push(h),h.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(h.color.rgb=pu(t.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:l[l.length-1]==617&&n.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:l.push(p),o=!0;break;case 38:l.pop(),o=!1;break;default:if(x.T>0)l.push(p);else if(x.T<0)l.pop();else if(!o||r.WTF&&l[l.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),n}var fC=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function dC(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Wr)||[]).forEach(function(s){var l=Ke(s);switch(l[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=l.val;break;case"<a:sysClr":n.rgb=l.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":l[0].charAt(1)==="/"?(t.themeElements.clrScheme[fC.indexOf(l[0])]=n,n={}):n.name=l[0].slice(3,l[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+l[0]+" in clrScheme")}})}function hC(){}function xC(){}var mC=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,pC=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,gC=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function vC(e,t,r){t.themeElements={};var n;[["clrScheme",mC,dC],["fontScheme",pC,hC],["fmtScheme",gC,xC]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var _C=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Wy(e,t){(!e||e.length===0)&&(e=yC());var r,n={};if(!(r=e.match(_C)))throw new Error("themeElements not found in theme");return vC(r[0],n,t),n.raw=e,n}function yC(e,t){var r=[iy];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function wC(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var l=e.slice(e.l);e.l=n;var o;try{o=sy(l,{type:"array"})}catch{return}var u=ka(o,"theme/theme/theme1.xml",!0);if(u)return Wy(u,r)}}function bC(e){return e.read_shift(4)}function EC(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=TC(e,4);break;case 2:t.xclrValue=My(e);break;case 3:t.xclrValue=bC(e);break;case 4:e.l+=4;break}return e.l+=8,t}function TC(e,t){return Xr(e,t)}function SC(e,t){return Xr(e,t)}function kC(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=EC(e);break;case 6:n[1]=SC(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function AC(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),l=[];s-- >0;)l.push(kC(e,r-e.l));return{ixfe:n,ext:l}}function NC(e,t){t.forEach(function(r){r[0]})}function CC(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:qr(e)}}function OC(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function DC(e){return e.l+=4,e.read_shift(4)!=0}function RC(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},l=[],o=!1,u=2;return Yn(e,function(h,x,p){switch(p){case 335:n.Types.push({name:h.name});break;case 51:h.forEach(function(v){u==1?n.Cell.push({type:n.Types[v[0]-1].name,index:v[1]}):u==0&&n.Value.push({type:n.Types[v[0]-1].name,index:v[1]})});break;case 337:u=h?1:0;break;case 338:u=2;break;case 35:l.push(p),o=!0;break;case 36:l.pop(),o=!1;break;default:if(!x.T){if(!o||s.WTF&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),n}function jC(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,l=2,o;return e.replace(Wr,function(u){var h=Ke(u);switch(vn(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var x=0;x<n.Types.length;++x)n.Types[x].name==h.name&&(o=n.Types[x]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":l==1?n.Cell.push({type:n.Types[h.t-1].name,index:+h.v}):l==0&&n.Value.push({type:n.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":l=1;break;case"</cellMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"</valueMetadata>":l=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+h.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return u}),n}function IC(e){var t=[];if(!e)return t;var r=1;return(e.match(Wr)||[]).forEach(function(n){var s=Ke(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function MC(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=rt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function LC(e,t,r){var n=[];return Yn(e,function(l,o,u){switch(u){case 63:n.push(l);break;default:if(!o.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function FC(e,t,r,n){if(!e)return e;var s=n||{},l=!1;Yn(e,function(u,h,x){switch(x){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:l=!0;break;case 36:l=!1;break;default:if(!h.T){if(!l||s.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}},s)}function UC(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function j2(e,t,r,n){var s=Array.isArray(e),l;t.forEach(function(o){var u=ta(o.ref);if(s?(e[u.r]||(e[u.r]=[]),l=e[u.r][u.c]):l=e[o.ref],!l){l={t:"z"},s?e[u.r][u.c]=l:e[o.ref]=l;var h=sr(e["!ref"]||"BDWGO1000001:A1");h.s.r>u.r&&(h.s.r=u.r),h.e.r<u.r&&(h.e.r=u.r),h.s.c>u.c&&(h.s.c=u.c),h.e.c<u.c&&(h.e.c=u.c);var x=Et(h);x!==e["!ref"]&&(e["!ref"]=x)}l.c||(l.c=[]);var p={a:o.author,t:o.t,r:o.r,T:r};o.h&&(p.h=o.h);for(var v=l.c.length-1;v>=0;--v){if(!r&&l.c[v].T)return;r&&!l.c[v].T&&l.c.splice(v,1)}if(r&&n){for(v=0;v<n.length;++v)if(p.a==n[v].id){p.a=n[v].name||p.a;break}}l.c.push(p)})}function BC(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var l=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return l&&l[1]&&l[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?comment[^>]*>/);if(u){var h=Ke(u[0]),x={author:h.authorId&&r[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},p=ta(h.ref);if(!(t.sheetRows&&t.sheetRows<=p.r)){var v=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_=!!v&&!!v[1]&&cx(v[1])||{r:"",t:"",h:""};x.r=_.r,_.r=="<t></t>"&&(_.t=_.h=""),x.t=(_.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(x.h=_.h),n.push(x)}}}}),n}function PC(e,t){var r=[],n=!1,s={},l=0;return e.replace(Wr,function(u,h){var x=Ke(u);switch(vn(x[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:x.personId,guid:x.id,ref:x.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":l=h+u.length;break;case"</text>":s.t=e.slice(l,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+x[0]+" in threaded comments")}return u}),r}function HC(e,t){var r=[],n=!1;return e.replace(Wr,function(l){var o=Ke(l);switch(vn(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return l}),r}function zC(e){var t={};t.iauthor=e.read_shift(4);var r=Ti(e);return t.rfx=r.s,t.ref=rt(r.s),e.l+=16,t}var GC=qr;function VC(e,t){var r=[],n=[],s={},l=!1;return Yn(e,function(u,h,x){switch(x){case 632:n.push(u);break;case 635:s=u;break;case 637:s.t=u.t,s.h=u.h,s.r=u.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!l||t.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}}),r}var $C="application/vnd.ms-office.vbaProject";function YC(e){var t=bt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");bt.utils.cfb_add(t,s,e.FileIndex[n].content)}}),bt.write(t)}function qC(){return{"!type":"dialog"}}function XC(){return{"!type":"dialog"}}function WC(){return{"!type":"macro"}}function ZC(){return{"!type":"macro"}}var Sl=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,l,o){var u=!1,h=!1;l.length==0?h=!0:l.charAt(0)=="["&&(h=!0,l=l.slice(1,-1)),o.length==0?u=!0:o.charAt(0)=="["&&(u=!0,o=o.slice(1,-1));var x=l.length>0?parseInt(l,10)|0:0,p=o.length>0?parseInt(o,10)|0:0;return u?p+=t.c:--p,h?x+=t.r:--x,s+(u?"":"$")+Er(p)+(h?"":"$")+Br(x)}return function(s,l){return t=l,s.replace(e,r)}}(),Zy=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,KC=function(){return function(t,r){return t.replace(Zy,function(n,s,l,o,u,h){var x=rx(o)-(l?0:r.c),p=tx(h)-(u?0:r.r),v=p==0?"":u?p+1:"["+p+"]",_=x==0?"":l?x+1:"["+x+"]";return s+"R"+v+"C"+_})}}();function Ky(e,t){return e.replace(Zy,function(r,n,s,l,o,u){return n+(s=="$"?s+l:Er(rx(l)+t.c))+(o=="$"?o+u:Br(tx(u)+t.r))})}function JC(e,t,r){var n=Fl(t),s=n.s,l=ta(r),o={r:l.r-s.r,c:l.c-s.c};return Ky(e,o)}function QC(e){return e.length!=1}function I2(e){return e.replace(/_xlfn\./g,"")}function dr(e){e.l+=1}function Ms(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Jy(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Qy(e);r.biff==12&&(n=4)}var s=e.read_shift(n),l=e.read_shift(n),o=Ms(e),u=Ms(e);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:l,c:u[0],cRel:u[1],rRel:u[2]}}}function Qy(e){var t=Ms(e),r=Ms(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function eO(e,t,r){if(r.biff<8)return Qy(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),l=Ms(e),o=Ms(e);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function ew(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return tO(e);var n=e.read_shift(r&&r.biff==12?4:2),s=Ms(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function tO(e){var t=Ms(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function rO(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function aO(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return nO(e);var s=e.read_shift(n>=12?4:2),l=e.read_shift(2),o=(l&16384)>>14,u=(l&32768)>>15;if(l&=16383,u==1)for(;s>524287;)s-=1048576;if(o==1)for(;l>8191;)l=l-16384;return{r:s,c:l,cRel:o,rRel:u}}function nO(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function sO(e,t,r){var n=(e[e.l++]&96)>>5,s=Jy(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function iO(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),l=8;if(r)switch(r.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}var o=Jy(e,l,r);return[n,s,o]}function lO(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function cO(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),l=8;if(r)switch(r.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}return e.l+=l,[n,s]}function oO(e,t,r){var n=(e[e.l++]&96)>>5,s=eO(e,t-1,r);return[n,s]}function uO(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function M2(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function fO(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],l=0;l<=n;++l)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function dO(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function hO(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function xO(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function mO(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function tw(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function pO(e){return e.read_shift(2),tw(e)}function gO(e){return e.read_shift(2),tw(e)}function vO(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=ew(e,0,r);return[n,s]}function _O(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=aO(e,0,r);return[n,s]}function yO(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var l=ew(e,0,r);return[n,s,l]}function wO(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[b6[s],nw[s],n]}function bO(e,t,r){var n=e[e.l++],s=e.read_shift(1),l=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:EO(e);return[s,(l[0]===0?nw:w6)[l[1]]]}function EO(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function TO(e,t,r){e.l+=r&&r.biff==2?3:4}function SO(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function kO(e){return e.l++,Si[e.read_shift(1)]}function AO(e){return e.l++,e.read_shift(2)}function NO(e){return e.l++,e.read_shift(1)!==0}function CO(e){return e.l++,$r(e)}function OO(e,t,r){return e.l++,ko(e,t-1,r)}function DO(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=cr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Si[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=$r(e);break;case 2:r[1]=ki(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function RO(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],l=0;l!=n;++l)s.push((r.biff==12?Ti:Su)(e));return s}function jO(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var l=0,o=[];l!=n&&(o[l]=[]);++l)for(var u=0;u!=s;++u)o[l][u]=DO(e,r.biff);return o}function IO(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,l=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,l]}function MO(e,t,r){if(r.biff==5)return LO(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),l=e.read_shift(4);return[n,s,l]}function LO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function FO(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function UO(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function BO(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function PO(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),l=4;if(r)switch(r.biff){case 5:l=15;break;case 12:l=6;break}return e.l+=l,[n,s]}var HO=Xr,zO=Xr,GO=Xr;function No(e,t,r){return e.l+=2,[rO(e)]}function ux(e){return e.l+=6,[]}var VO=No,$O=ux,YO=ux,qO=No;function rw(e){return e.l+=2,[xr(e),e.read_shift(2)&1]}var XO=No,WO=rw,ZO=ux,KO=No,JO=No,QO=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function e6(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),l=e.read_shift(2),o=QO[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:s,C:l}}function t6(e){return e.l+=2,[e.read_shift(4)]}function r6(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function a6(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function n6(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function s6(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function i6(e){return e.l+=4,[0,0]}var L2={1:{n:"PtgExp",f:SO},2:{n:"PtgTbl",f:GO},3:{n:"PtgAdd",f:dr},4:{n:"PtgSub",f:dr},5:{n:"PtgMul",f:dr},6:{n:"PtgDiv",f:dr},7:{n:"PtgPower",f:dr},8:{n:"PtgConcat",f:dr},9:{n:"PtgLt",f:dr},10:{n:"PtgLe",f:dr},11:{n:"PtgEq",f:dr},12:{n:"PtgGe",f:dr},13:{n:"PtgGt",f:dr},14:{n:"PtgNe",f:dr},15:{n:"PtgIsect",f:dr},16:{n:"PtgUnion",f:dr},17:{n:"PtgRange",f:dr},18:{n:"PtgUplus",f:dr},19:{n:"PtgUminus",f:dr},20:{n:"PtgPercent",f:dr},21:{n:"PtgParen",f:dr},22:{n:"PtgMissArg",f:dr},23:{n:"PtgStr",f:OO},26:{n:"PtgSheet",f:r6},27:{n:"PtgEndSheet",f:a6},28:{n:"PtgErr",f:kO},29:{n:"PtgBool",f:NO},30:{n:"PtgInt",f:AO},31:{n:"PtgNum",f:CO},32:{n:"PtgArray",f:uO},33:{n:"PtgFunc",f:wO},34:{n:"PtgFuncVar",f:bO},35:{n:"PtgName",f:IO},36:{n:"PtgRef",f:vO},37:{n:"PtgArea",f:sO},38:{n:"PtgMemArea",f:FO},39:{n:"PtgMemErr",f:HO},40:{n:"PtgMemNoMem",f:zO},41:{n:"PtgMemFunc",f:UO},42:{n:"PtgRefErr",f:BO},43:{n:"PtgAreaErr",f:lO},44:{n:"PtgRefN",f:_O},45:{n:"PtgAreaN",f:oO},46:{n:"PtgMemAreaN",f:n6},47:{n:"PtgMemNoMemN",f:s6},57:{n:"PtgNameX",f:MO},58:{n:"PtgRef3d",f:yO},59:{n:"PtgArea3d",f:iO},60:{n:"PtgRefErr3d",f:PO},61:{n:"PtgAreaErr3d",f:cO},255:{}},l6={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},c6={1:{n:"PtgElfLel",f:rw},2:{n:"PtgElfRw",f:KO},3:{n:"PtgElfCol",f:VO},6:{n:"PtgElfRwV",f:JO},7:{n:"PtgElfColV",f:qO},10:{n:"PtgElfRadical",f:XO},11:{n:"PtgElfRadicalS",f:ZO},13:{n:"PtgElfColS",f:$O},15:{n:"PtgElfColSV",f:YO},16:{n:"PtgElfRadicalLel",f:WO},25:{n:"PtgList",f:e6},29:{n:"PtgSxName",f:t6},255:{}},o6={0:{n:"PtgAttrNoop",f:i6},1:{n:"PtgAttrSemi",f:mO},2:{n:"PtgAttrIf",f:hO},4:{n:"PtgAttrChoose",f:fO},8:{n:"PtgAttrGoto",f:dO},16:{n:"PtgAttrSum",f:TO},32:{n:"PtgAttrBaxcel",f:M2},33:{n:"PtgAttrBaxcel",f:M2},64:{n:"PtgAttrSpace",f:pO},65:{n:"PtgAttrSpaceSemi",f:gO},128:{n:"PtgAttrIfError",f:xO},255:{}};function Co(e,t,r,n){if(n.biff<8)return Xr(e,t);for(var s=e.l+t,l=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=jO(e,0,n),l.push(r[o][1]);break;case"PtgMemArea":r[o][2]=RO(e,r[o][1],n),l.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),l.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=s-e.l,t!==0&&l.push(Xr(e,t)),l}function Oo(e,t,r){for(var n=e.l+t,s,l,o=[];n!=e.l;)t=n-e.l,l=e[e.l],s=L2[l]||L2[l6[l]],(l===24||l===25)&&(s=(l===24?c6:o6)[e[e.l+1]]),!s||!s.f?Xr(e,t):o.push([s.n,s.f(e,t,r)]);return o}function u6(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],l=0;l<n.length;++l){var o=n[l];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var f6={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function d6(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function aw(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function F2(e,t,r){var n=aw(e,t,r);return n=="#REF"?n:d6(n,r)}function Vr(e,t,r,n,s){var l=s&&s.biff||8,o={s:{c:0,r:0}},u=[],h,x,p,v=0,_=0,y,w="";if(!e[0]||!e[0][0])return"";for(var b=-1,E="",j=0,C=e[0].length;j<C;++j){var S=e[0][j];switch(S[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=u.pop(),x=u.pop(),b>=0){switch(e[0][b][1][0]){case 0:E=nr(" ",e[0][b][1][1]);break;case 1:E=nr("\r",e[0][b][1][1]);break;default:if(E="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}x=x+E,b=-1}u.push(x+f6[S[0]]+h);break;case"PtgIsect":h=u.pop(),x=u.pop(),u.push(x+" "+h);break;case"PtgUnion":h=u.pop(),x=u.pop(),u.push(x+","+h);break;case"PtgRange":h=u.pop(),x=u.pop(),u.push(x+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=Xc(S[1][1],o,s),u.push(Wc(p,l));break;case"PtgRefN":p=r?Xc(S[1][1],r,s):S[1][1],u.push(Wc(p,l));break;case"PtgRef3d":v=S[1][1],p=Xc(S[1][2],o,s),w=F2(n,v,s),u.push(w+"!"+Wc(p,l));break;case"PtgFunc":case"PtgFuncVar":var L=S[1][0],Z=S[1][1];L||(L=0),L&=127;var W=L==0?[]:u.slice(-L);u.length-=L,Z==="User"&&(Z=W.shift()),u.push(Z+"("+W.join(",")+")");break;case"PtgBool":u.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(S[1]);break;case"PtgNum":u.push(String(S[1]));break;case"PtgStr":u.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(S[1]);break;case"PtgAreaN":y=g2(S[1][1],r?{s:r}:o,s),u.push(Xd(y,s));break;case"PtgArea":y=g2(S[1][1],o,s),u.push(Xd(y,s));break;case"PtgArea3d":v=S[1][1],y=S[1][2],w=F2(n,v,s),u.push(w+"!"+Xd(y,s));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=S[1][2];var I=(n.names||[])[_-1]||(n[0]||[])[_],X=I?I.Name:"SH33TJSNAME"+String(_);X&&X.slice(0,6)=="_xlfn."&&!s.xlfn&&(X=X.slice(6)),u.push(X);break;case"PtgNameX":var U=S[1][1];_=S[1][2];var ee;if(s.biff<=5)U<0&&(U=-U),n[U]&&(ee=n[U][_]);else{var te="";if(((n[U]||[])[0]||[])[0]==14849||(((n[U]||[])[0]||[])[0]==1025?n[U][_]&&n[U][_].itab>0&&(te=n.SheetNames[n[U][_].itab-1]+"!"):te=n.SheetNames[_-1]+"!"),n[U]&&n[U][_])te+=n[U][_].Name;else if(n[0]&&n[0][_])te+=n[0][_].Name;else{var V=(aw(n,U,s)||"").split(";;");V[_-1]?te=V[_-1]:te+="SH33TJSERRX"}u.push(te);break}ee||(ee={Name:"SH33TJSERRY"}),u.push(ee.Name);break;case"PtgParen":var ge="(",Re=")";if(b>=0){switch(E="",e[0][b][1][0]){case 2:ge=nr(" ",e[0][b][1][1])+ge;break;case 3:ge=nr("\r",e[0][b][1][1])+ge;break;case 4:Re=nr(" ",e[0][b][1][1])+Re;break;case 5:Re=nr("\r",e[0][b][1][1])+Re;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}b=-1}u.push(ge+u.pop()+Re);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":p={c:S[1][1],r:S[1][0]};var Se={c:r.c,r:r.r};if(n.sharedf[rt(p)]){var ae=n.sharedf[rt(p)];u.push(Vr(ae,o,Se,n,s))}else{var ue=!1;for(h=0;h!=n.arrayf.length;++h)if(x=n.arrayf[h],!(p.c<x[0].s.c||p.c>x[0].e.c)&&!(p.r<x[0].s.r||p.r>x[0].e.r)){u.push(Vr(x[1],o,Se,n,s)),ue=!0;break}ue||u.push(S[1])}break;case"PtgArray":u.push("{"+u6(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":b=j;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(S));default:throw new Error("Unrecognized Formula Token: "+String(S))}var Q=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&b>=0&&Q.indexOf(e[0][j][0])==-1){S=e[0][b];var G=!0;switch(S[1][0]){case 4:G=!1;case 0:E=nr(" ",S[1][1]);break;case 5:G=!1;case 1:E=nr("\r",S[1][1]);break;default:if(E="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}u.push((G?E:"")+u.pop()+(G?"":E)),b=-1}}if(u.length>1&&s.WTF)throw new Error("bad formula stack");return u[0]}function h6(e,t,r){var n=e.l+t,s=r.biff==2?1:2,l,o=e.read_shift(s);if(o==65535)return[[],Xr(e,t-2)];var u=Oo(e,o,r);return t!==o+s&&(l=Co(e,t-o-s,u,r)),e.l=n,[u,l]}function x6(e,t,r){var n=e.l+t,s=r.biff==2?1:2,l,o=e.read_shift(s);if(o==65535)return[[],Xr(e,t-2)];var u=Oo(e,o,r);return t!==o+s&&(l=Co(e,t-o-s,u,r)),e.l=n,[u,l]}function m6(e,t,r,n){var s=e.l+t,l=Oo(e,n,r),o;return s!==e.l&&(o=Co(e,s-e.l,l,r)),[l,o]}function p6(e,t,r){var n=e.l+t,s,l=e.read_shift(2),o=Oo(e,l,r);return l==65535?[[],Xr(e,t-2)]:(t!==l+2&&(s=Co(e,n-l-2,o,r)),[o,s])}function g6(e){var t;if(Pn(e,e.l+6)!==65535)return[$r(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Kd(e,t,r){var n=e.l+t,s=_n(e);r.biff==2&&++e.l;var l=g6(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var u=x6(e,n-e.l,r);return{cell:s,val:l[0],formula:u,shared:o>>3&1,tt:l[1]}}function ku(e,t,r){var n=e.read_shift(4),s=Oo(e,n,r),l=e.read_shift(4),o=l>0?Co(e,l,s,r):null;return[s,o]}var v6=ku,Au=ku,_6=ku,y6=ku,w6={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},nw={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},b6={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function U2(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Jd(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Qc={},kl={};function eo(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function sw(e,t,r,n,s,l){try{n.cellNF&&(e.z=it[t])}catch(u){if(n.WTF)throw u}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Dr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(it[t]==null&&ui(EA[t]||"General",t),e.t==="e")e.w=e.w||Si[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=uo(e.v);else if(e.t==="d"){var o=aa(e.v);(o|0)===o?e.w=o.toString(10):e.w=uo(o)}else{if(e.v===void 0)return"";e.w=pi(e.v,kl)}else e.t==="d"?e.w=Ga(t,aa(e.v),kl):e.w=Ga(t,e.v,kl)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&r!=null)try{e.s=l.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=pu(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=pu(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&l.Fills)throw u}}}function E6(e,t){var r=sr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Et(r))}var T6=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,S6=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,k6=/<(?:\w:)?hyperlink [^>]*>/mg,A6=/"(\w*:\w*)"/,N6=/<(?:\w:)?col\b[^>]*[\/]?>/g,C6=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,O6=/<(?:\w:)?pageMargins[^>]*\/>/g,iw=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,D6=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,R6=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function j6(e,t,r,n,s,l,o){if(!e)return e;n||(n={"!id":{}});var u=t.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},x="",p="",v=e.match(S6);v?(x=e.slice(0,v.index),p=e.slice(v.index+v[0].length)):x=p=e;var _=x.match(iw);_?fx(_[0],u,s,r):(_=x.match(D6))&&I6(_[0],_[1]||"",u,s,r);var y=(x.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(y>0){var w=x.slice(y,y+50).match(A6);w&&E6(u,w[1])}var b=x.match(R6);b&&b[1]&&P6(b[1],s);var E=[];if(t.cellStyles){var j=x.match(N6);j&&F6(E,j)}v&&H6(v[1],u,t,h,l,o);var C=p.match(C6);C&&(u["!autofilter"]=U6(C[0]));var S=[],L=p.match(T6);if(L)for(y=0;y!=L.length;++y)S[y]=sr(L[y].slice(L[y].indexOf('"')+1));var Z=p.match(k6);Z&&M6(u,Z,n);var W=p.match(O6);if(W&&(u["!margins"]=L6(Ke(W[0]))),!u["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(u["!ref"]=Et(h)),t.sheetRows>0&&u["!ref"]){var I=sr(u["!ref"]);t.sheetRows<=+I.e.r&&(I.e.r=t.sheetRows-1,I.e.r>h.e.r&&(I.e.r=h.e.r),I.e.r<I.s.r&&(I.s.r=I.e.r),I.e.c>h.e.c&&(I.e.c=h.e.c),I.e.c<I.s.c&&(I.s.c=I.e.c),u["!fullref"]=u["!ref"],u["!ref"]=Et(I))}return E.length>0&&(u["!cols"]=E),S.length>0&&(u["!merges"]=S),u}function fx(e,t,r,n){var s=Ke(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=Tt(Vt(s.codeName)))}function I6(e,t,r,n,s){fx(e.slice(0,e.indexOf(">")),r,n,s)}function M6(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var l=Ke(Vt(t[s]),!0);if(!l.ref)return;var o=((r||{})["!id"]||[])[l.id];o?(l.Target=o.Target,l.location&&(l.Target+="#"+Tt(l.location))):(l.Target="#"+Tt(l.location),o={Target:l.Target,TargetMode:"Internal"}),l.Rel=o,l.tooltip&&(l.Tooltip=l.tooltip,delete l.tooltip);for(var u=sr(l.ref),h=u.s.r;h<=u.e.r;++h)for(var x=u.s.c;x<=u.e.c;++x){var p=rt({c:x,r:h});n?(e[h]||(e[h]=[]),e[h][x]||(e[h][x]={t:"z",v:void 0}),e[h][x].l=l):(e[p]||(e[p]={t:"z",v:void 0}),e[p].l=l)}}}function L6(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function F6(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=Ke(t[n],!0);s.hidden&&(s.hidden=Wt(s.hidden));var l=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,ox(s.width)),Il(s);l<=o;)e[l++]=Ur(s)}}function U6(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var B6=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function P6(e,t){t.Views||(t.Views=[{}]),(e.match(B6)||[]).forEach(function(r,n){var s=Ke(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),Wt(s.rightToLeft)&&(t.Views[n].RTL=!0)})}var H6=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,l=fo("v"),o=fo("f");return function(h,x,p,v,_,y){for(var w=0,b="",E=[],j=[],C=0,S=0,L=0,Z="",W,I,X=0,U=0,ee,te,V=0,ge=0,Re=Array.isArray(y.CellXf),Se,ae=[],ue=[],Q=Array.isArray(x),G=[],A={},K=!1,N=!!p.sheetStubs,P=h.split(t),z=0,H=P.length;z!=H;++z){b=P[z].trim();var se=b.length;if(se!==0){var ve=0;e:for(w=0;w<se;++w)switch(b[w]){case">":if(b[w-1]!="/"){++w;break e}if(p&&p.cellStyles){if(I=Ke(b.slice(ve,w),!0),X=I.r!=null?parseInt(I.r,10):X+1,U=-1,p.sheetRows&&p.sheetRows<X)continue;A={},K=!1,I.ht&&(K=!0,A.hpt=parseFloat(I.ht),A.hpx=po(A.hpt)),I.hidden=="1"&&(K=!0,A.hidden=!0),I.outlineLevel!=null&&(K=!0,A.level=+I.outlineLevel),K&&(G[X-1]=A)}break;case"<":ve=w;break}if(ve>=w)break;if(I=Ke(b.slice(ve,w),!0),X=I.r!=null?parseInt(I.r,10):X+1,U=-1,!(p.sheetRows&&p.sheetRows<X)){v.s.r>X-1&&(v.s.r=X-1),v.e.r<X-1&&(v.e.r=X-1),p&&p.cellStyles&&(A={},K=!1,I.ht&&(K=!0,A.hpt=parseFloat(I.ht),A.hpx=po(A.hpt)),I.hidden=="1"&&(K=!0,A.hidden=!0),I.outlineLevel!=null&&(K=!0,A.level=+I.outlineLevel),K&&(G[X-1]=A)),E=b.slice(w).split(e);for(var be=0;be!=E.length&&E[be].trim().charAt(0)=="<";++be);for(E=E.slice(be),w=0;w!=E.length;++w)if(b=E[w].trim(),b.length!==0){if(j=b.match(r),C=w,S=0,L=0,b="<c "+(b.slice(0,1)=="<"?">":"")+b,j!=null&&j.length===2){for(C=0,Z=j[1],S=0;S!=Z.length&&!((L=Z.charCodeAt(S)-64)<1||L>26);++S)C=26*C+L;--C,U=C}else++U;for(S=0;S!=b.length&&b.charCodeAt(S)!==62;++S);if(++S,I=Ke(b.slice(0,S),!0),I.r||(I.r=rt({r:X-1,c:U})),Z=b.slice(S),W={t:""},(j=Z.match(l))!=null&&j[1]!==""&&(W.v=Tt(j[1])),p.cellFormula){if((j=Z.match(o))!=null&&j[1]!==""){if(W.f=Tt(Vt(j[1])).replace(/\r\n/g,`
`),p.xlfn||(W.f=I2(W.f)),j[0].indexOf('t="array"')>-1)W.F=(Z.match(s)||[])[1],W.F.indexOf(":")>-1&&ae.push([sr(W.F),W.F]);else if(j[0].indexOf('t="shared"')>-1){te=Ke(j[0]);var Ae=Tt(Vt(j[1]));p.xlfn||(Ae=I2(Ae)),ue[parseInt(te.si,10)]=[te,Ae,I.r]}}else(j=Z.match(/<f[^>]*\/>/))&&(te=Ke(j[0]),ue[te.si]&&(W.f=JC(ue[te.si][1],ue[te.si][2],I.r)));var ye=ta(I.r);for(S=0;S<ae.length;++S)ye.r>=ae[S][0].s.r&&ye.r<=ae[S][0].e.r&&ye.c>=ae[S][0].s.c&&ye.c<=ae[S][0].e.c&&(W.F=ae[S][1])}if(I.t==null&&W.v===void 0)if(W.f||W.F)W.v=0,W.t="n";else if(N)W.t="z";else continue;else W.t=I.t||"n";switch(v.s.c>U&&(v.s.c=U),v.e.c<U&&(v.e.c=U),W.t){case"n":if(W.v==""||W.v==null){if(!N)continue;W.t="z"}else W.v=parseFloat(W.v);break;case"s":if(typeof W.v>"u"){if(!N)continue;W.t="z"}else ee=Qc[parseInt(W.v,10)],W.v=ee.t,W.r=ee.r,p.cellHTML&&(W.h=ee.h);break;case"str":W.t="s",W.v=W.v!=null?Vt(W.v):"",p.cellHTML&&(W.h=Jh(W.v));break;case"inlineStr":j=Z.match(n),W.t="s",j!=null&&(ee=cx(j[1]))?(W.v=ee.t,p.cellHTML&&(W.h=ee.h)):W.v="";break;case"b":W.v=Wt(W.v);break;case"d":p.cellDates?W.v=Dr(W.v,1):(W.v=aa(Dr(W.v,1)),W.t="n");break;case"e":(!p||p.cellText!==!1)&&(W.w=W.v),W.v=Ay[W.v];break}if(V=ge=0,Se=null,Re&&I.s!==void 0&&(Se=y.CellXf[I.s],Se!=null&&(Se.numFmtId!=null&&(V=Se.numFmtId),p.cellStyles&&Se.fillId!=null&&(ge=Se.fillId))),sw(W,V,ge,p,_,y),p.cellDates&&Re&&W.t=="n"&&Ll(it[V])&&(W.t="d",W.v=Tu(W.v)),I.cm&&p.xlmeta){var Ye=(p.xlmeta.Cell||[])[+I.cm-1];Ye&&Ye.type=="XLDAPR"&&(W.D=!0)}if(Q){var Y=ta(I.r);x[Y.r]||(x[Y.r]=[]),x[Y.r][Y.c]=W}else x[I.r]=W}}}}G.length>0&&(x["!rows"]=G)}}();function z6(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var l=e.read_shift(1);return e.l=n,l&7&&(r.level=l&7),l&16&&(r.hidden=!0),l&32&&(r.hpt=s/20),r}var G6=Ti;function V6(){}function $6(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=h3(e),r}function Y6(e){var t=$a(e);return[t]}function q6(e){var t=Ei(e);return[t]}function X6(e){var t=$a(e),r=e.read_shift(1);return[t,r,"b"]}function W6(e){var t=Ei(e),r=e.read_shift(1);return[t,r,"b"]}function Z6(e){var t=$a(e),r=e.read_shift(1);return[t,r,"e"]}function K6(e){var t=Ei(e),r=e.read_shift(1);return[t,r,"e"]}function J6(e){var t=$a(e),r=e.read_shift(4);return[t,r,"s"]}function Q6(e){var t=Ei(e),r=e.read_shift(4);return[t,r,"s"]}function eD(e){var t=$a(e),r=$r(e);return[t,r,"n"]}function lw(e){var t=Ei(e),r=$r(e);return[t,r,"n"]}function tD(e){var t=$a(e),r=sx(e);return[t,r,"n"]}function rD(e){var t=Ei(e),r=sx(e);return[t,r,"n"]}function aD(e){var t=$a(e),r=ax(e);return[t,r,"is"]}function nD(e){var t=$a(e),r=qr(e);return[t,r,"str"]}function sD(e){var t=Ei(e),r=qr(e);return[t,r,"str"]}function iD(e,t,r){var n=e.l+t,s=$a(e);s.r=r["!row"];var l=e.read_shift(1),o=[s,l,"b"];if(r.cellFormula){e.l+=2;var u=Au(e,n-e.l,r);o[3]=Vr(u,null,s,r.supbooks,r)}else e.l=n;return o}function lD(e,t,r){var n=e.l+t,s=$a(e);s.r=r["!row"];var l=e.read_shift(1),o=[s,l,"e"];if(r.cellFormula){e.l+=2;var u=Au(e,n-e.l,r);o[3]=Vr(u,null,s,r.supbooks,r)}else e.l=n;return o}function cD(e,t,r){var n=e.l+t,s=$a(e);s.r=r["!row"];var l=$r(e),o=[s,l,"n"];if(r.cellFormula){e.l+=2;var u=Au(e,n-e.l,r);o[3]=Vr(u,null,s,r.supbooks,r)}else e.l=n;return o}function oD(e,t,r){var n=e.l+t,s=$a(e);s.r=r["!row"];var l=qr(e),o=[s,l,"str"];if(r.cellFormula){e.l+=2;var u=Au(e,n-e.l,r);o[3]=Vr(u,null,s,r.supbooks,r)}else e.l=n;return o}var uD=Ti;function fD(e,t){var r=e.l+t,n=Ti(e),s=nx(e),l=qr(e),o=qr(e),u=qr(e);e.l=r;var h={rfx:n,relId:s,loc:l,display:u};return o&&(h.Tooltip=o),h}function dD(){}function hD(e,t,r){var n=e.l+t,s=Ty(e),l=e.read_shift(1),o=[s];if(o[2]=l,r.cellFormula){var u=v6(e,n-e.l,r);o[1]=u}else e.l=n;return o}function xD(e,t,r){var n=e.l+t,s=Ti(e),l=[s];if(r.cellFormula){var o=y6(e,n-e.l,r);l[1]=o,e.l=n}else e.l=n;return l}var mD=["left","right","top","bottom","header","footer"];function pD(e){var t={};return mD.forEach(function(r){t[r]=$r(e)}),t}function gD(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function vD(){}function _D(){}function yD(e,t,r,n,s,l,o){if(!e)return e;var u=t||{};n||(n={"!id":{}});var h=u.dense?[]:{},x,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=!1,_=!1,y,w,b,E,j,C,S,L,Z,W=[];u.biff=12,u["!row"]=0;var I=0,X=!1,U=[],ee={},te=u.supbooks||s.supbooks||[[]];if(te.sharedf=ee,te.arrayf=U,te.SheetNames=s.SheetNames||s.Sheets.map(function(Q){return Q.name}),!u.supbooks&&(u.supbooks=te,s.Names))for(var V=0;V<s.Names.length;++V)te[0][V+1]=s.Names[V];var ge=[],Re=[],Se=!1;_u[16]={n:"BrtShortReal",f:lw};var ae;if(Yn(e,function(G,A,K){if(!_)switch(K){case 148:x=G;break;case 0:y=G,u.sheetRows&&u.sheetRows<=y.r&&(_=!0),L=Br(E=y.r),u["!row"]=y.r,(G.hidden||G.hpt||G.level!=null)&&(G.hpt&&(G.hpx=po(G.hpt)),Re[G.r]=G);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(w={t:G[2]},G[2]){case"n":w.v=G[1];break;case"s":S=Qc[G[1]],w.v=S.t,w.r=S.r;break;case"b":w.v=!!G[1];break;case"e":w.v=G[1],u.cellText!==!1&&(w.w=Si[w.v]);break;case"str":w.t="s",w.v=G[1];break;case"is":w.t="s",w.v=G[1].t;break}if((b=o.CellXf[G[0].iStyleRef])&&sw(w,b.numFmtId,null,u,l,o),j=G[0].c==-1?j+1:G[0].c,u.dense?(h[E]||(h[E]=[]),h[E][j]=w):h[Er(j)+L]=w,u.cellFormula){for(X=!1,I=0;I<U.length;++I){var N=U[I];y.r>=N[0].s.r&&y.r<=N[0].e.r&&j>=N[0].s.c&&j<=N[0].e.c&&(w.F=Et(N[0]),X=!0)}!X&&G.length>3&&(w.f=G[3])}if(p.s.r>y.r&&(p.s.r=y.r),p.s.c>j&&(p.s.c=j),p.e.r<y.r&&(p.e.r=y.r),p.e.c<j&&(p.e.c=j),u.cellDates&&b&&w.t=="n"&&Ll(it[b.numFmtId])){var P=oi(w.v);P&&(w.t="d",w.v=new Date(P.y,P.m-1,P.d,P.H,P.M,P.S,P.u))}ae&&(ae.type=="XLDAPR"&&(w.D=!0),ae=void 0);break;case 1:case 12:if(!u.sheetStubs||v)break;w={t:"z",v:void 0},j=G[0].c==-1?j+1:G[0].c,u.dense?(h[E]||(h[E]=[]),h[E][j]=w):h[Er(j)+L]=w,p.s.r>y.r&&(p.s.r=y.r),p.s.c>j&&(p.s.c=j),p.e.r<y.r&&(p.e.r=y.r),p.e.c<j&&(p.e.c=j),ae&&(ae.type=="XLDAPR"&&(w.D=!0),ae=void 0);break;case 176:W.push(G);break;case 49:ae=((u.xlmeta||{}).Cell||[])[G-1];break;case 494:var z=n["!id"][G.relId];for(z?(G.Target=z.Target,G.loc&&(G.Target+="#"+G.loc),G.Rel=z):G.relId==""&&(G.Target="#"+G.loc),E=G.rfx.s.r;E<=G.rfx.e.r;++E)for(j=G.rfx.s.c;j<=G.rfx.e.c;++j)u.dense?(h[E]||(h[E]=[]),h[E][j]||(h[E][j]={t:"z",v:void 0}),h[E][j].l=G):(C=rt({c:j,r:E}),h[C]||(h[C]={t:"z",v:void 0}),h[C].l=G);break;case 426:if(!u.cellFormula)break;U.push(G),Z=u.dense?h[E][j]:h[Er(j)+L],Z.f=Vr(G[1],p,{r:y.r,c:j},te,u),Z.F=Et(G[0]);break;case 427:if(!u.cellFormula)break;ee[rt(G[0].s)]=G[1],Z=u.dense?h[E][j]:h[Er(j)+L],Z.f=Vr(G[1],p,{r:y.r,c:j},te,u);break;case 60:if(!u.cellStyles)break;for(;G.e>=G.s;)ge[G.e--]={width:G.w/256,hidden:!!(G.flags&1),level:G.level},Se||(Se=!0,ox(G.w/256)),Il(ge[G.e+1]);break;case 161:h["!autofilter"]={ref:Et(G)};break;case 476:h["!margins"]=G;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),G.name&&(s.Sheets[r].CodeName=G.name),(G.above||G.left)&&(h["!outline"]={above:G.above,left:G.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),G.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:v=!0;break;case 36:v=!1;break;case 37:v=!0;break;case 38:v=!1;break;default:if(!A.T){if(!v||u.WTF)throw new Error("Unexpected record 0x"+K.toString(16))}}},u),delete u.supbooks,delete u["!row"],!h["!ref"]&&(p.s.r<2e6||x&&(x.e.r>0||x.e.c>0||x.s.r>0||x.s.c>0))&&(h["!ref"]=Et(x||p)),u.sheetRows&&h["!ref"]){var ue=sr(h["!ref"]);u.sheetRows<=+ue.e.r&&(ue.e.r=u.sheetRows-1,ue.e.r>p.e.r&&(ue.e.r=p.e.r),ue.e.r<ue.s.r&&(ue.s.r=ue.e.r),ue.e.c>p.e.c&&(ue.e.c=p.e.c),ue.e.c<ue.s.c&&(ue.s.c=ue.e.c),h["!fullref"]=h["!ref"],h["!ref"]=Et(ue))}return W.length>0&&(h["!merges"]=W),ge.length>0&&(h["!cols"]=ge),Re.length>0&&(h["!rows"]=Re),h}function wD(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(l){var o=l.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var s=Tt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(l){n=l.replace(/<.*?>/g,"")}),[t,s,n]}function bD(e,t,r,n,s,l){var o=l||{"!type":"chart"};if(!e)return l;var u=0,h=0,x="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(v){var _=wD(v);p.s.r=p.s.c=0,p.e.c=u,x=Er(u),_[0].forEach(function(y,w){o[x+Br(w)]={t:"n",v:y,z:_[1]},h=w}),p.e.r<h&&(p.e.r=h),++u}),u>0&&(o["!ref"]=Et(p)),o}function ED(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o,u=e.match(iw);return u&&fx(u[0],l,s,r),(o=e.match(/drawing r:id="(.*?)"/))&&(l["!rel"]=o[1]),n["!id"][l["!rel"]]&&(l["!drawel"]=n["!id"][l["!rel"]]),l}function TD(e,t){e.l+=10;var r=qr(e);return{name:r}}function SD(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Yn(e,function(h,x,p){switch(p){case 550:l["!rel"]=h;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),h.name&&(s.Sheets[r].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(x.T>0)){if(!(x.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},t),n["!id"][l["!rel"]]&&(l["!drawel"]=n["!id"][l["!rel"]]),l}var cw=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],kD=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],AD=[],ND=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function B2(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var l=t[s];if(n[l[0]]==null)n[l[0]]=l[1];else switch(l[2]){case"bool":typeof n[l[0]]=="string"&&(n[l[0]]=Wt(n[l[0]]));break;case"int":typeof n[l[0]]=="string"&&(n[l[0]]=parseInt(n[l[0]],10));break}}}function P2(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Wt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function ow(e){P2(e.WBProps,cw),P2(e.CalcPr,ND),B2(e.WBView,kD),B2(e.Sheets,AD),kl.date1904=Wt(e.WBProps.date1904)}var CD="][*?/\\".split("");function OD(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return CD.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var DD=/<\w+:workbook/;function RD(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",l={},o=0;if(e.replace(Wr,function(h,x){var p=Ke(h);switch(vn(p[0])){case"<?xml":break;case"<workbook":h.match(DD)&&(s="xmlns"+h.match(/<(\w+):/)[1]),r.xmlns=p[s];break;case"</workbook>":break;case"<fileVersion":delete p[0],r.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":cw.forEach(function(v){if(p[v[0]]!=null)switch(v[2]){case"bool":r.WBProps[v[0]]=Wt(p[v[0]]);break;case"int":r.WBProps[v[0]]=parseInt(p[v[0]],10);break;default:r.WBProps[v[0]]=p[v[0]]}}),p.codeName&&(r.WBProps.CodeName=Vt(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],r.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=Tt(Vt(p.name)),delete p[0],r.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":l={},l.Name=Vt(p.name),p.comment&&(l.Comment=p.comment),p.localSheetId&&(l.Sheet=+p.localSheetId),Wt(p.hidden||"0")&&(l.Hidden=!0),o=x+h.length;break;case"</definedName>":l.Ref=Tt(Vt(e.slice(o,x))),r.Names.push(l);break;case"<definedName/>":break;case"<calcPr":delete p[0],r.CalcPr=p;break;case"<calcPr/>":delete p[0],r.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return h}),ZA.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return ow(r),r}function jD(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=_h(e),r.name=qr(e),r}function ID(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?qr(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function MD(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function LD(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),l=x3(e),o=_6(e,0,r),u=nx(e);e.l=n;var h={Name:l,Ptg:o};return s<268435455&&(h.Sheet=s),u&&(h.Comment=u),h}function FD(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var l=[],o=[[]];return o.SheetNames=[],o.XTI=[],_u[16]={n:"BrtFRTArchID$",f:MD},Yn(e,function(h,x,p){switch(p){case 156:o.SheetNames.push(h.name),r.Sheets.push(h);break;case 153:r.WBProps=h;break;case 39:h.Sheet!=null&&(t.SID=h.Sheet),h.Ref=Vr(h.Ptg,null,null,o,t),delete t.SID,delete h.Ptg,l.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([p,h]):o[0]=[p,h],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(h),o.XTI=o.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(p),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(p),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!x.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},t),ow(r),r.Names=l,r.supbooks=o,r}function UD(e,t,r){return t.slice(-4)===".bin"?FD(e,r):RD(e,r)}function BD(e,t,r,n,s,l,o,u){return t.slice(-4)===".bin"?yD(e,n,r,s,l,o,u):j6(e,n,r,s,l,o,u)}function PD(e,t,r,n,s,l,o,u){return t.slice(-4)===".bin"?SD(e,n,r,s,l):ED(e,n,r,s,l)}function HD(e,t,r,n,s,l,o,u){return t.slice(-4)===".bin"?WC():ZC()}function zD(e,t,r,n,s,l,o,u){return t.slice(-4)===".bin"?qC():XC()}function GD(e,t,r,n){return t.slice(-4)===".bin"?uC(e,r,n):nC(e,r,n)}function VD(e,t,r){return Wy(e,r)}function $D(e,t,r){return t.slice(-4)===".bin"?kN(e,r):TN(e,r)}function YD(e,t,r){return t.slice(-4)===".bin"?VC(e,r):BC(e,r)}function qD(e,t,r){return t.slice(-4)===".bin"?LC(e):IC(e)}function XD(e,t,r,n){return r.slice(-4)===".bin"?FC(e,t,r,n):void 0}function WD(e,t,r){return t.slice(-4)===".bin"?RC(e,t,r):jC(e,t,r)}var uw=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,fw=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ka(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=e.match(uw),l,o,u,h;if(s)for(h=0;h!=s.length;++h)l=s[h].match(fw),(o=l[1].indexOf(":"))===-1?n[l[1]]=l[2].slice(1,l[2].length-1):(l[1].slice(0,6)==="xmlns:"?u="xmlns"+l[1].slice(6):u=l[1].slice(o+1),n[u]=l[2].slice(1,l[2].length-1));return n}function ZD(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(uw),s,l,o,u;if(n)for(u=0;u!=n.length;++u)s=n[u].match(fw),(l=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(l+1),r[o]=s[2].slice(1,s[2].length-1));return r}var to;function KD(e,t){var r=to[e]||Tt(e);return r==="General"?pi(t):Ga(r,t)}function JD(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Wt(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=Dr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Tt(t)]=s}function QD(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Si[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=uo(e.v):e.w=pi(e.v):e.w=KD(t||"General",e.v)}catch(l){if(r.WTF)throw l}try{var n=to[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Ll(n)){var s=oi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(l){if(r.WTF)throw l}}}function eR(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=JN[n.Pattern]||n.Pattern)}e[t.ID]=t}function tR(e,t,r,n,s,l,o,u,h,x){var p="General",v=n.StyleID,_={};x=x||{};var y=[],w=0;for(v===void 0&&u&&(v=u.StyleID),v===void 0&&o&&(v=o.StyleID);l[v]!==void 0&&(l[v].nf&&(p=l[v].nf),l[v].Interior&&y.push(l[v].Interior),!!l[v].Parent);)v=l[v].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Wt(e);break;case"String":n.t="s",n.r=c2(Tt(e)),n.v=e.indexOf("<")>-1?Tt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Dr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Tt(e):n.v<60&&(n.v=n.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Ay[e],x.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=c2(t||e));break}if(QD(n,p,x),x.cellFormula!==!1)if(n.Formula){var b=Tt(n.Formula);b.charCodeAt(0)==61&&(b=b.slice(1)),n.f=Sl(b,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Sl("RC:RC",s):n.ArrayRange&&(n.F=Sl(n.ArrayRange,s),h.push([sr(n.F),n.F]))}else for(w=0;w<h.length;++w)s.r>=h[w][0].s.r&&s.r<=h[w][0].e.r&&s.c>=h[w][0].s.c&&s.c<=h[w][0].e.c&&(n.F=h[w][1]);x.cellStyles&&(y.forEach(function(E){!_.patternType&&E.patternType&&(_.patternType=E.patternType)}),n.s=_),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function rR(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Qd(e,t){var r=t||{};Q_();var n=Bc(Qh(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Vt(n));var s=n.slice(0,1024).toLowerCase(),l=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=Ur(r);return o.type="string",xo.to_workbook(n,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ot){s.indexOf("<"+Ot)>=0&&(l=!0)}),l)return fR(n,r);to={"General Number":"General","General Date":it[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":it[15],"Short Date":it[14],"Long Time":it[19],"Medium Time":it[18],"Short Time":it[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:it[2],Standard:it[4],Percent:it[10],Scientific:it[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,h=[],x,p={},v=[],_=r.dense?[]:{},y="",w={},b={},E=Ka('<Data ss:Type="String">'),j=0,C=0,S=0,L={s:{r:2e6,c:2e6},e:{r:0,c:0}},Z={},W={},I="",X=0,U=[],ee={},te={},V=0,ge=[],Re=[],Se={},ae=[],ue,Q=!1,G=[],A=[],K={},N=0,P=0,z={Sheets:[],WBProps:{date1904:!1}},H={};ho.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var se="";u=ho.exec(n);)switch(u[3]=(se=u[3]).toLowerCase()){case"data":if(se=="data"){if(u[1]==="/"){if((x=h.pop())[0]!==u[3])throw new Error("Bad state: "+x.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break}if(h[h.length-1][1])break;u[1]==="/"?tR(n.slice(j,u.index),I,E,h[h.length-1][0]=="comment"?Se:w,{c:C,r:S},Z,ae[C],b,G,r):(I="",E=Ka(u[0]),j=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(Re.length>0&&(w.c=Re),(!r.sheetRows||r.sheetRows>S)&&w.v!==void 0&&(r.dense?(_[S]||(_[S]=[]),_[S][C]=w):_[Er(C)+Br(S)]=w),w.HRef&&(w.l={Target:Tt(w.HRef)},w.HRefScreenTip&&(w.l.Tooltip=w.HRefScreenTip),delete w.HRef,delete w.HRefScreenTip),(w.MergeAcross||w.MergeDown)&&(N=C+(parseInt(w.MergeAcross,10)|0),P=S+(parseInt(w.MergeDown,10)|0),U.push({s:{c:C,r:S},e:{c:N,r:P}})),!r.sheetStubs)w.MergeAcross?C=N+1:++C;else if(w.MergeAcross||w.MergeDown){for(var ve=C;ve<=N;++ve)for(var be=S;be<=P;++be)(ve>C||be>S)&&(r.dense?(_[be]||(_[be]=[]),_[be][ve]={t:"z"}):_[Er(ve)+Br(be)]={t:"z"});C=N+1}else++C;else w=ZD(u[0]),w.Index&&(C=+w.Index-1),C<L.s.c&&(L.s.c=C),C>L.e.c&&(L.e.c=C),u[0].slice(-2)==="/>"&&++C,Re=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(S<L.s.r&&(L.s.r=S),S>L.e.r&&(L.e.r=S),u[0].slice(-2)==="/>"&&(b=Ka(u[0]),b.Index&&(S=+b.Index-1)),C=0,++S):(b=Ka(u[0]),b.Index&&(S=+b.Index-1),K={},(b.AutoFitHeight=="0"||b.Height)&&(K.hpx=parseInt(b.Height,10),K.hpt=Xy(K.hpx),A[S]=K),b.Hidden=="1"&&(K.hidden=!0,A[S]=K));break;case"worksheet":if(u[1]==="/"){if((x=h.pop())[0]!==u[3])throw new Error("Bad state: "+x.join("|"));v.push(y),L.s.r<=L.e.r&&L.s.c<=L.e.c&&(_["!ref"]=Et(L),r.sheetRows&&r.sheetRows<=L.e.r&&(_["!fullref"]=_["!ref"],L.e.r=r.sheetRows-1,_["!ref"]=Et(L))),U.length&&(_["!merges"]=U),ae.length>0&&(_["!cols"]=ae),A.length>0&&(_["!rows"]=A),p[y]=_}else L={s:{r:2e6,c:2e6},e:{r:0,c:0}},S=C=0,h.push([u[3],!1]),x=Ka(u[0]),y=Tt(x.Name),_=r.dense?[]:{},U=[],G=[],A=[],H={name:y,Hidden:0},z.Sheets.push(H);break;case"table":if(u[1]==="/"){if((x=h.pop())[0]!==u[3])throw new Error("Bad state: "+x.join("|"))}else{if(u[0].slice(-2)=="/>")break;h.push([u[3],!1]),ae=[],Q=!1}break;case"style":u[1]==="/"?eR(Z,W,r):W=Ka(u[0]);break;case"numberformat":W.nf=Tt(Ka(u[0]).Format||"General"),to[W.nf]&&(W.nf=to[W.nf]);for(var Ae=0;Ae!=392&&it[Ae]!=W.nf;++Ae);if(Ae==392){for(Ae=57;Ae!=392;++Ae)if(it[Ae]==null){ui(W.nf,Ae);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(ue=Ka(u[0]),ue.Hidden&&(ue.hidden=!0,delete ue.Hidden),ue.Width&&(ue.wpx=parseInt(ue.Width,10)),!Q&&ue.wpx>10){Q=!0,ea=Yy;for(var ye=0;ye<ae.length;++ye)ae[ye]&&Il(ae[ye])}Q&&Il(ue),ae[ue.Index-1||ae.length]=ue;for(var Ye=0;Ye<+ue.Span;++Ye)ae[ae.length]=Ur(ue);break;case"namedrange":if(u[1]==="/")break;z.Names||(z.Names=[]);var Y=Ke(u[0]),ot={Name:Y.Name,Ref:Sl(Y.RefersTo.slice(1),{r:0,c:0})};z.Sheets.length>0&&(ot.Sheet=z.Sheets.length-1),z.Names.push(ot);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?I+=n.slice(X,u.index):X=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;W.Interior=Ka(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?B3(ee,se,n.slice(V,u.index)):V=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((x=h.pop())[0]!==u[3])throw new Error("Bad state: "+x.join("|"))}else h.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((x=h.pop())[0]!==u[3])throw new Error("Bad state: "+x.join("|"));rR(Se),Re.push(Se)}else h.push([u[3],!1]),x=Ka(u[0]),Se={a:x.Author};break;case"autofilter":if(u[1]==="/"){if((x=h.pop())[0]!==u[3])throw new Error("Bad state: "+x.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var Xe=Ka(u[0]);_["!autofilter"]={ref:Sl(Xe.Range).replace(/\$/g,"")},h.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((x=h.pop())[0]!==u[3])throw new Error("Bad state: "+x.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((x=h.pop())[0]!==u[3])throw new Error("Bad state: "+x.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"null":break;default:if(h.length==0&&u[3]=="document"||h.length==0&&u[3]=="uof")return Y2(n,r);var gt=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:gt=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:gt=!1}break;case"excelworkbook":switch(u[3]){case"date1904":z.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:gt=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:gt=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(V,u.index)){case"SheetHidden":H.Hidden=1;break;case"SheetVeryHidden":H.Hidden=2;break}else V=u.index+u[0].length;break;case"header":_["!margins"]||eo(_["!margins"]={},"xlml"),isNaN(+Ke(u[0]).Margin)||(_["!margins"].header=+Ke(u[0]).Margin);break;case"footer":_["!margins"]||eo(_["!margins"]={},"xlml"),isNaN(+Ke(u[0]).Margin)||(_["!margins"].footer=+Ke(u[0]).Margin);break;case"pagemargins":var Je=Ke(u[0]);_["!margins"]||eo(_["!margins"]={},"xlml"),isNaN(+Je.Top)||(_["!margins"].top=+Je.Top),isNaN(+Je.Left)||(_["!margins"].left=+Je.Left),isNaN(+Je.Right)||(_["!margins"].right=+Je.Right),isNaN(+Je.Bottom)||(_["!margins"].bottom=+Je.Bottom);break;case"displayrighttoleft":z.Views||(z.Views=[]),z.Views[0]||(z.Views[0]={}),z.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:gt=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:gt=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:gt=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:gt=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:gt=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:gt=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:gt=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:gt=!1}break;case"smarttags":break;default:gt=!1;break}if(gt||u[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?JD(te,se,ge,n.slice(V,u.index)):(ge=u,V=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+h.join("|")}var Oe={};return!r.bookSheets&&!r.bookProps&&(Oe.Sheets=p),Oe.SheetNames=v,Oe.Workbook=z,Oe.SSF=Ur(it),Oe.Props=ee,Oe.Custprops=te,Oe}function Eh(e,t){switch(xx(t=t||{}),t.type||"base64"){case"base64":return Qd(Na(e),t);case"binary":case"buffer":case"file":return Qd(e,t);case"array":return Qd(bi(e),t)}}function aR(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=g3(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=v3(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var nR=[60,1084,2066,2165,2175];function sR(e,t,r,n,s){var l=n,o=[],u=r.slice(r.l,r.l+l);if(s&&s.enc&&s.enc.insitu&&u.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(u)}o.push(u),r.l+=l;for(var h=Pn(r,r.l),x=Th[h],p=0;x!=null&&nR.indexOf(h)>-1;)l=Pn(r,r.l+2),p=r.l+4,h==2066?p+=4:(h==2165||h==2175)&&(p+=12),u=r.slice(p,r.l+4+l),o.push(u),r.l+=4+l,x=Th[h=Pn(r,r.l)];var v=Ss(o);Lr(v,0);var _=0;v.lens=[];for(var y=0;y<o.length;++y)v.lens.push(_),_+=o[y].length;if(v.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+v.length+" < "+n;return t.f(v,v.length,s)}function hn(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=it[n])}catch(l){if(t.WTF)throw l}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Si[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=uo(e.v):e.w=pi(e.v):e.w=Ga(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(l){if(t.WTF)throw l}if(t.cellDates&&n&&e.t=="n"&&Ll(it[n]||String(n))){var s=oi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Q0(e,t,r){return{v:e,ixfe:t,t:r}}function iR(e,t){var r={opts:{}},n={},s=t.dense?[]:{},l={},o={},u=null,h=[],x="",p={},v,_="",y,w,b,E,j={},C=[],S,L,Z=[],W=[],I={Sheets:[],WBProps:{date1904:!1},Views:[{}]},X={},U=function(et){return et<8?fi[et]:et<64&&W[et-8]||fi[et]},ee=function(et,Pt,gr){var Dt=Pt.XF.data;if(!(!Dt||!Dt.patternType||!gr||!gr.cellStyles)){Pt.s={},Pt.s.patternType=Dt.patternType;var qt;(qt=mo(U(Dt.icvFore)))&&(Pt.s.fgColor={rgb:qt}),(qt=mo(U(Dt.icvBack)))&&(Pt.s.bgColor={rgb:qt})}},te=function(et,Pt,gr){if(!(K>1)&&!(gr.sheetRows&&et.r>=gr.sheetRows)){if(gr.cellStyles&&Pt.XF&&Pt.XF.data&&ee(et,Pt,gr),delete Pt.ixfe,delete Pt.XF,v=et,_=rt(et),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),et.r<o.s.r&&(o.s.r=et.r),et.c<o.s.c&&(o.s.c=et.c),et.r+1>o.e.r&&(o.e.r=et.r+1),et.c+1>o.e.c&&(o.e.c=et.c+1),gr.cellFormula&&Pt.f){for(var Dt=0;Dt<C.length;++Dt)if(!(C[Dt][0].s.c>et.c||C[Dt][0].s.r>et.r)&&!(C[Dt][0].e.c<et.c||C[Dt][0].e.r<et.r)){Pt.F=Et(C[Dt][0]),(C[Dt][0].s.c!=et.c||C[Dt][0].s.r!=et.r)&&delete Pt.f,Pt.f&&(Pt.f=""+Vr(C[Dt][1],o,et,G,V));break}}gr.dense?(s[et.r]||(s[et.r]=[]),s[et.r][et.c]=Pt):s[_]=Pt}},V={enc:!1,sbcch:0,snames:[],sharedf:j,arrayf:C,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(V.password=t.password);var ge,Re=[],Se=[],ae=[],ue=[],Q=!1,G=[];G.SheetNames=V.snames,G.sharedf=V.sharedf,G.arrayf=V.arrayf,G.names=[],G.XTI=[];var A=0,K=0,N=0,P=[],z=[],H;V.codepage=1200,rn(1200);for(var se=!1;e.l<e.length-1;){var ve=e.l,be=e.read_shift(2);if(be===0&&A===10)break;var Ae=e.l===e.length?0:e.read_shift(2),ye=Th[be];if(ye&&ye.f){if(t.bookSheets&&A===133&&be!==133)break;if(A=be,ye.r===2||ye.r==12){var Ye=e.read_shift(2);if(Ae-=2,!V.enc&&Ye!==be&&((Ye&255)<<8|Ye>>8)!==be)throw new Error("rt mismatch: "+Ye+"!="+be);ye.r==12&&(e.l+=10,Ae-=10)}var Y={};if(be===10?Y=ye.f(e,Ae,V):Y=sR(be,ye,e,Ae,V),K==0&&[9,521,1033,2057].indexOf(A)===-1)continue;switch(be){case 34:r.opts.Date1904=I.WBProps.date1904=Y;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(V.enc||(e.l=0),V.enc=Y,!t.password)throw new Error("File is password-protected");if(Y.valid==null)throw new Error("Encryption scheme unsupported");if(!Y.valid)throw new Error("Password is incorrect");break;case 92:V.lastuser=Y;break;case 66:var ot=Number(Y);switch(ot){case 21010:ot=1200;break;case 32768:ot=1e4;break;case 32769:ot=1252;break}rn(V.codepage=ot),se=!0;break;case 317:V.rrtabid=Y;break;case 25:V.winlocked=Y;break;case 439:r.opts.RefreshAll=Y;break;case 12:r.opts.CalcCount=Y;break;case 16:r.opts.CalcDelta=Y;break;case 17:r.opts.CalcIter=Y;break;case 13:r.opts.CalcMode=Y;break;case 14:r.opts.CalcPrecision=Y;break;case 95:r.opts.CalcSaveRecalc=Y;break;case 15:V.CalcRefMode=Y;break;case 2211:r.opts.FullCalc=Y;break;case 129:Y.fDialog&&(s["!type"]="dialog"),Y.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),Y.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:Z.push(Y);break;case 430:G.push([Y]),G[G.length-1].XTI=[];break;case 35:case 547:G[G.length-1].push(Y);break;case 24:case 536:H={Name:Y.Name,Ref:Vr(Y.rgce,o,null,G,V)},Y.itab>0&&(H.Sheet=Y.itab-1),G.names.push(H),G[0]||(G[0]=[],G[0].XTI=[]),G[G.length-1].push(Y),Y.Name=="_xlnm._FilterDatabase"&&Y.itab>0&&Y.rgce&&Y.rgce[0]&&Y.rgce[0][0]&&Y.rgce[0][0][0]=="PtgArea3d"&&(z[Y.itab-1]={ref:Et(Y.rgce[0][0][1][2])});break;case 22:V.ExternCount=Y;break;case 23:G.length==0&&(G[0]=[],G[0].XTI=[]),G[G.length-1].XTI=G[G.length-1].XTI.concat(Y),G.XTI=G.XTI.concat(Y);break;case 2196:if(V.biff<8)break;H!=null&&(H.Comment=Y[1]);break;case 18:s["!protect"]=Y;break;case 19:Y!==0&&V.WTF&&console.error("Password verifier: "+Y);break;case 133:l[Y.pos]=Y,V.snames.push(Y.name);break;case 10:{if(--K)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=Et(o),t.sheetRows&&t.sheetRows<=o.e.r){var Xe=o.e.r;o.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Et(o),o.e.r=Xe}o.e.r++,o.e.c++}Re.length>0&&(s["!merges"]=Re),Se.length>0&&(s["!objects"]=Se),ae.length>0&&(s["!cols"]=ae),ue.length>0&&(s["!rows"]=ue),I.Sheets.push(X)}x===""?p=s:n[x]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(V.biff===8&&(V.biff={9:2,521:3,1033:4}[be]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Y.BIFFVer]||8),V.biffguess=Y.BIFFVer==0,Y.BIFFVer==0&&Y.dt==4096&&(V.biff=5,se=!0,rn(V.codepage=28591)),V.biff==8&&Y.BIFFVer==0&&Y.dt==16&&(V.biff=2),K++)break;if(s=t.dense?[]:{},V.biff<8&&!se&&(se=!0,rn(V.codepage=t.codepage||1252)),V.biff<5||Y.BIFFVer==0&&Y.dt==4096){x===""&&(x="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var gt={pos:e.l-Ae,name:x};l[gt.pos]=gt,V.snames.push(x)}else x=(l[ve]||{name:""}).name;Y.dt==32&&(s["!type"]="chart"),Y.dt==64&&(s["!type"]="macro"),Re=[],Se=[],V.arrayf=C=[],ae=[],ue=[],Q=!1,X={Hidden:(l[ve]||{hs:0}).hs,name:x}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[Y.r]||[])[Y.c]:s[rt({c:Y.c,r:Y.r})])&&++Y.c,S={ixfe:Y.ixfe,XF:Z[Y.ixfe]||{},v:Y.val,t:"n"},N>0&&(S.z=P[S.ixfe>>8&63]),hn(S,t,r.opts.Date1904),te({c:Y.c,r:Y.r},S,t);break;case 5:case 517:S={ixfe:Y.ixfe,XF:Z[Y.ixfe],v:Y.val,t:Y.t},N>0&&(S.z=P[S.ixfe>>8&63]),hn(S,t,r.opts.Date1904),te({c:Y.c,r:Y.r},S,t);break;case 638:S={ixfe:Y.ixfe,XF:Z[Y.ixfe],v:Y.rknum,t:"n"},N>0&&(S.z=P[S.ixfe>>8&63]),hn(S,t,r.opts.Date1904),te({c:Y.c,r:Y.r},S,t);break;case 189:for(var Je=Y.c;Je<=Y.C;++Je){var Oe=Y.rkrec[Je-Y.c][0];S={ixfe:Oe,XF:Z[Oe],v:Y.rkrec[Je-Y.c][1],t:"n"},N>0&&(S.z=P[S.ixfe>>8&63]),hn(S,t,r.opts.Date1904),te({c:Je,r:Y.r},S,t)}break;case 6:case 518:case 1030:{if(Y.val=="String"){u=Y;break}if(S=Q0(Y.val,Y.cell.ixfe,Y.tt),S.XF=Z[S.ixfe],t.cellFormula){var Ot=Y.formula;if(Ot&&Ot[0]&&Ot[0][0]&&Ot[0][0][0]=="PtgExp"){var $t=Ot[0][0][1][0],Le=Ot[0][0][1][1],Pe=rt({r:$t,c:Le});j[Pe]?S.f=""+Vr(Y.formula,o,Y.cell,G,V):S.F=((t.dense?(s[$t]||[])[Le]:s[Pe])||{}).F}else S.f=""+Vr(Y.formula,o,Y.cell,G,V)}N>0&&(S.z=P[S.ixfe>>8&63]),hn(S,t,r.opts.Date1904),te(Y.cell,S,t),u=Y}break;case 7:case 519:if(u)u.val=Y,S=Q0(Y,u.cell.ixfe,"s"),S.XF=Z[S.ixfe],t.cellFormula&&(S.f=""+Vr(u.formula,o,u.cell,G,V)),N>0&&(S.z=P[S.ixfe>>8&63]),hn(S,t,r.opts.Date1904),te(u.cell,S,t),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{C.push(Y);var Ve=rt(Y[0].s);if(y=t.dense?(s[Y[0].s.r]||[])[Y[0].s.c]:s[Ve],t.cellFormula&&y){if(!u||!Ve||!y)break;y.f=""+Vr(Y[1],o,Y[0],G,V),y.F=Et(Y[0])}}break;case 1212:{if(!t.cellFormula)break;if(_){if(!u)break;j[rt(u.cell)]=Y[0],y=t.dense?(s[u.cell.r]||[])[u.cell.c]:s[rt(u.cell)],(y||{}).f=""+Vr(Y[0],o,v,G,V)}}break;case 253:S=Q0(h[Y.isst].t,Y.ixfe,"s"),h[Y.isst].h&&(S.h=h[Y.isst].h),S.XF=Z[S.ixfe],N>0&&(S.z=P[S.ixfe>>8&63]),hn(S,t,r.opts.Date1904),te({c:Y.c,r:Y.r},S,t);break;case 513:t.sheetStubs&&(S={ixfe:Y.ixfe,XF:Z[Y.ixfe],t:"z"},N>0&&(S.z=P[S.ixfe>>8&63]),hn(S,t,r.opts.Date1904),te({c:Y.c,r:Y.r},S,t));break;case 190:if(t.sheetStubs)for(var $e=Y.c;$e<=Y.C;++$e){var mr=Y.ixfe[$e-Y.c];S={ixfe:mr,XF:Z[mr],t:"z"},N>0&&(S.z=P[S.ixfe>>8&63]),hn(S,t,r.opts.Date1904),te({c:$e,r:Y.r},S,t)}break;case 214:case 516:case 4:S=Q0(Y.val,Y.ixfe,"s"),S.XF=Z[S.ixfe],N>0&&(S.z=P[S.ixfe>>8&63]),hn(S,t,r.opts.Date1904),te({c:Y.c,r:Y.r},S,t);break;case 0:case 512:K===1&&(o=Y);break;case 252:h=Y;break;case 1054:if(V.biff==4){P[N++]=Y[1];for(var Rr=0;Rr<N+163&&it[Rr]!=Y[1];++Rr);Rr>=163&&ui(Y[1],N+163)}else ui(Y[1],Y[0]);break;case 30:{P[N++]=Y;for(var pr=0;pr<N+163&&it[pr]!=Y;++pr);pr>=163&&ui(Y,N+163)}break;case 229:Re=Re.concat(Y);break;case 93:Se[Y.cmo[0]]=V.lastobj=Y;break;case 438:V.lastobj.TxO=Y;break;case 127:V.lastobj.ImData=Y;break;case 440:for(E=Y[0].s.r;E<=Y[0].e.r;++E)for(b=Y[0].s.c;b<=Y[0].e.c;++b)y=t.dense?(s[E]||[])[b]:s[rt({c:b,r:E})],y&&(y.l=Y[1]);break;case 2048:for(E=Y[0].s.r;E<=Y[0].e.r;++E)for(b=Y[0].s.c;b<=Y[0].e.c;++b)y=t.dense?(s[E]||[])[b]:s[rt({c:b,r:E})],y&&y.l&&(y.l.Tooltip=Y[1]);break;case 28:{if(V.biff<=5&&V.biff>=2)break;y=t.dense?(s[Y[0].r]||[])[Y[0].c]:s[rt(Y[0])];var Yt=Se[Y[2]];y||(t.dense?(s[Y[0].r]||(s[Y[0].r]=[]),y=s[Y[0].r][Y[0].c]={t:"z"}):y=s[rt(Y[0])]={t:"z"},o.e.r=Math.max(o.e.r,Y[0].r),o.s.r=Math.min(o.s.r,Y[0].r),o.e.c=Math.max(o.e.c,Y[0].c),o.s.c=Math.min(o.s.c,Y[0].c)),y.c||(y.c=[]),w={a:Y[1],t:Yt.TxO.t},y.c.push(w)}break;case 2173:NC(Z[Y.ixfe],Y.ext);break;case 125:{if(!V.cellStyles)break;for(;Y.e>=Y.s;)ae[Y.e--]={width:Y.w/256,level:Y.level||0,hidden:!!(Y.flags&1)},Q||(Q=!0,ox(Y.w/256)),Il(ae[Y.e+1])}break;case 520:{var yt={};Y.level!=null&&(ue[Y.r]=yt,yt.level=Y.level),Y.hidden&&(ue[Y.r]=yt,yt.hidden=!0),Y.hpt&&(ue[Y.r]=yt,yt.hpt=Y.hpt,yt.hpx=po(Y.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||eo(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[be]]=Y;break;case 161:s["!margins"]||eo(s["!margins"]={}),s["!margins"].header=Y.header,s["!margins"].footer=Y.footer;break;case 574:Y.RTL&&(I.Views[0].RTL=!0);break;case 146:W=Y;break;case 2198:ge=Y;break;case 140:L=Y;break;case 442:x?X.CodeName=Y||X.name:I.WBProps.CodeName=Y||"ThisWorkbook";break}}else ye||console.error("Missing Info for XLS Record 0x"+be.toString(16)),e.l+=Ae}return r.SheetNames=gn(l).sort(function(Qe,et){return Number(Qe)-Number(et)}).map(function(Qe){return l[Qe].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&p["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=p)):r.Preamble=p,r.Sheets&&z.forEach(function(Qe,et){r.Sheets[r.SheetNames[et]]["!autofilter"]=Qe}),r.Strings=h,r.SSF=Ur(it),V.enc&&(r.Encryption=V.enc),ge&&(r.Themes=ge),r.Metadata={},L!==void 0&&(r.Metadata.Country=L),G.names.length>0&&(I.Names=G.names),r.Workbook=I,r}var H2={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function lR(e,t,r){var n=bt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=T2(n,T3,H2.DSI);for(var l in s)t[l]=s[l]}catch(x){if(r.WTF)throw x}var o=bt.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var u=T2(o,S3,H2.SI);for(var h in u)t[h]==null&&(t[h]=u[h])}catch(x){if(r.WTF)throw x}t.HeadingPairs&&t.TitlesOfParts&&(Cy(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function dw(e,t){t||(t={}),xx(t),H_(),t.codepage&&Yh(t.codepage);var r,n;if(e.FullPaths){if(bt.find(e,"/encryption"))throw new Error("File is password-protected");r=bt.find(e,"!CompObj"),n=bt.find(e,"/Workbook")||bt.find(e,"/Book")}else{switch(t.type){case"base64":e=tn(Na(e));break;case"binary":e=tn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Lr(e,0),n={content:e}}var s,l;if(r&&aR(r),t.bookProps&&!t.bookSheets)s={};else{var o=_t?"buffer":"array";if(n&&n.content)s=iR(n.content,t);else if((l=bt.find(e,"PerfectOffice_MAIN"))&&l.content)s=Jc.to_workbook(l.content,(t.type=o,t));else if((l=bt.find(e,"NativeContent_MAIN"))&&l.content)s=Jc.to_workbook(l.content,(t.type=o,t));else throw(l=bt.find(e,"MN0"))&&l.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&bt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=YC(e))}var u={};return e.FullPaths&&lR(e,u,t),s.Props=s.Custprops=u,t.bookFiles&&(s.cfb=e),s}var _u={0:{f:z6},1:{f:Y6},2:{f:tD},3:{f:Z6},4:{f:X6},5:{f:eD},6:{f:nD},7:{f:J6},8:{f:oD},9:{f:cD},10:{f:iD},11:{f:lD},12:{f:q6},13:{f:rD},14:{f:K6},15:{f:W6},16:{f:lw},17:{f:sD},18:{f:Q6},19:{f:ax},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:LD},40:{},42:{},43:{f:iC},44:{f:sC},45:{f:lC},46:{f:oC},47:{f:cC},48:{},49:{f:u3},50:{},51:{f:OC},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Hy},62:{f:aD},63:{f:MC},64:{f:vD},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Xr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:gD},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:$6},148:{f:G6,p:16},151:{f:dD},152:{},153:{f:ID},154:{},155:{},156:{f:jD},157:{},158:{},159:{T:1,f:SN},160:{T:-1},161:{T:1,f:Ti},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:uD},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:CC},336:{T:-1},337:{f:DC,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:_h},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Py},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:hD},427:{f:xD},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:pD},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:V6},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:fD},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:_h},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:GC},633:{T:1},634:{T:-1},635:{T:1,f:zC},636:{T:-1},637:{f:d3},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:TD},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:_D},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Th={6:{f:Kd},10:{f:ys},12:{f:xr},13:{f:xr},14:{f:cr},15:{f:cr},16:{f:$r},17:{f:cr},18:{f:cr},19:{f:xr},20:{f:N2},21:{f:N2},23:{f:Py},24:{f:O2},25:{f:cr},26:{},27:{},28:{f:P5},29:{},34:{f:cr},35:{f:C2},38:{f:$r},39:{f:$r},40:{f:$r},41:{f:$r},42:{f:cr},43:{f:cr},47:{f:VN},49:{f:w5},51:{f:xr},60:{},61:{f:v5},64:{f:cr},65:{f:y5},66:{f:xr},77:{},80:{},81:{},82:{},85:{f:xr},89:{},90:{},91:{},92:{f:u5},93:{f:z5},94:{},95:{f:cr},96:{},97:{},99:{f:cr},125:{f:Hy},128:{f:D5},129:{f:f5},130:{f:xr},131:{f:cr},132:{f:cr},133:{f:d5},134:{},140:{f:X5},141:{f:xr},144:{},146:{f:Z5},151:{},152:{},153:{},154:{},155:{},156:{f:xr},157:{},158:{},160:{f:tN},161:{f:J5},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:A5},190:{f:N5},193:{f:ys},197:{},198:{},199:{},200:{},201:{},202:{f:cr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:xr},220:{},221:{f:cr},222:{},224:{f:O5},225:{f:o5},226:{f:ys},227:{},229:{f:H5},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:h5},253:{f:b5},255:{f:x5},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Iy},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:cr},353:{f:ys},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:j5},431:{f:cr},432:{},433:{},434:{},437:{},438:{f:$5},439:{f:cr},440:{f:Y5},441:{},442:{f:Ao},443:{},444:{f:xr},445:{},446:{},448:{f:ys},449:{f:g5,r:2},450:{f:ys},512:{f:k2},513:{f:eN},515:{f:R5},516:{f:E5},517:{f:A2},519:{f:rN},520:{f:m5},523:{},545:{f:D2},549:{f:S2},566:{},574:{f:_5},638:{f:k5},659:{},1048:{},1054:{f:T5},1084:{},1212:{f:F5},2048:{f:q5},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Z0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ys},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:K5,r:12},2173:{f:AC,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:cr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:L5,r:12},2197:{},2198:{f:wC,r:12},2199:{},2200:{},2201:{},2202:{f:U5,r:12},2203:{f:ys},2204:{},2205:{},2206:{},2207:{},2211:{f:p5},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:xr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Q5},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:W5},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:k2},1:{},2:{f:iN},3:{f:sN},4:{f:nN},5:{f:A2},7:{f:lN},8:{},9:{f:Z0},11:{},22:{f:xr},30:{f:S5},31:{},32:{},33:{f:D2},36:{},37:{f:S2},50:{f:cN},62:{},52:{},67:{},68:{f:xr},69:{},86:{},126:{},127:{f:aN},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:oN},223:{},234:{},354:{},421:{},518:{f:Kd},521:{f:Z0},536:{f:O2},547:{f:C2},561:{},579:{},1030:{f:Kd},1033:{f:Z0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ja(e,t,r,n){var s=t;if(!isNaN(s)){var l=(r||[]).length||0,o=e.next(4);o.write_shift(2,s),o.write_shift(2,l),l>0&&wy(r)&&e.push(r)}}function z2(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var l=e.match(/<\/table/i),o=s.index,u=l&&l.index||e.length,h=RA(e.slice(o,u),/(:?<tr[^>]*>)/i,"<tr>"),x=-1,p=0,v=0,_=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(o=0;o<h.length;++o){var b=h[o].trim(),E=b.slice(0,3).toLowerCase();if(E=="<tr"){if(++x,r.sheetRows&&r.sheetRows<=x){--x;break}p=0;continue}if(!(E!="<td"&&E!="<th")){var j=b.split(/<\/t[dh]>/i);for(u=0;u<j.length;++u){var C=j[u].trim();if(C.match(/<t[dh]/i)){for(var S=C,L=0;S.charAt(0)=="<"&&(L=S.indexOf(">"))>-1;)S=S.slice(L+1);for(var Z=0;Z<w.length;++Z){var W=w[Z];W.s.c==p&&W.s.r<x&&x<=W.e.r&&(p=W.e.c+1,Z=-1)}var I=Ke(C.slice(0,C.indexOf(">")));_=I.colspan?+I.colspan:1,((v=+I.rowspan)>1||_>1)&&w.push({s:{r:x,c:p},e:{r:x+(v||1)-1,c:p+_-1}});var X=I.t||I["data-t"]||"";if(!S.length){p+=_;continue}if(S=cy(S),y.s.r>x&&(y.s.r=x),y.e.r<x&&(y.e.r=x),y.s.c>p&&(y.s.c=p),y.e.c<p&&(y.e.c=p),!S.length){p+=_;continue}var U={t:"s",v:S};r.raw||!S.trim().length||X=="s"||(S==="TRUE"?U={t:"b",v:!0}:S==="FALSE"?U={t:"b",v:!1}:isNaN(nn(S))?isNaN(jl(S).getDate())||(U={t:"d",v:Dr(S)},r.cellDates||(U={t:"n",v:aa(U.v)}),U.z=r.dateNF||it[14]):U={t:"n",v:nn(S)}),r.dense?(n[x]||(n[x]=[]),n[x][p]=U):n[rt({r:x,c:p})]=U,p+=_}}}}return n["!ref"]=Et(y),w.length&&(n["!merges"]=w),n}function cR(e,t,r,n){for(var s=e["!merges"]||[],l=[],o=t.s.c;o<=t.e.c;++o){for(var u=0,h=0,x=0;x<s.length;++x)if(!(s[x].s.r>r||s[x].s.c>o)&&!(s[x].e.r<r||s[x].e.c<o)){if(s[x].s.r<r||s[x].s.c<o){u=-1;break}u=s[x].e.r-s[x].s.r+1,h=s[x].e.c-s[x].s.c+1;break}if(!(u<0)){var p=rt({r,c:o}),v=n.dense?(e[r]||[])[o]:e[p],_=v&&v.v!=null&&(v.h||Jh(v.w||($n(v),v.w)||""))||"",y={};u>1&&(y.rowspan=u),h>1&&(y.colspan=h),n.editable?_='<span contenteditable="true">'+_+"</span>":v&&(y["data-t"]=v&&v.t||"z",v.v!=null&&(y["data-v"]=v.v),v.z!=null&&(y["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+v.l.Target+'">'+_+"</a>")),y.id=(n.id||"sjs")+"-"+p,l.push(XA("td",_,y))}}var w="<tr>";return w+l.join("")+"</tr>"}var oR='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',uR="</body></html>";function fR(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Fs(z2(r[0],t),t);var n=px();return r.forEach(function(s,l){gx(n,z2(s,t),"Sheet"+(l+1))}),n}function dR(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function hR(e,t){var r=t||{},n=r.header!=null?r.header:oR,s=r.footer!=null?r.footer:uR,l=[n],o=Fl(e["!ref"]);r.dense=Array.isArray(e),l.push(dR(e,o,r));for(var u=o.s.r;u<=o.e.r;++u)l.push(cR(e,o,u,r));return l.push("</table>"+s),l.join("")}function hw(e,t,r){var n=r||{},s=0,l=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var o=typeof n.origin=="string"?ta(n.origin):n.origin;s=o.r,l=o.c}var u=t.getElementsByTagName("tr"),h=Math.min(n.sheetRows||1e7,u.length),x={s:{r:0,c:0},e:{r:s,c:l}};if(e["!ref"]){var p=Fl(e["!ref"]);x.s.r=Math.min(x.s.r,p.s.r),x.s.c=Math.min(x.s.c,p.s.c),x.e.r=Math.max(x.e.r,p.e.r),x.e.c=Math.max(x.e.c,p.e.c),s==-1&&(x.e.r=s=p.e.r+1)}var v=[],_=0,y=e["!rows"]||(e["!rows"]=[]),w=0,b=0,E=0,j=0,C=0,S=0;for(e["!cols"]||(e["!cols"]=[]);w<u.length&&b<h;++w){var L=u[w];if(G2(L)){if(n.display)continue;y[b]={hidden:!0}}var Z=L.children;for(E=j=0;E<Z.length;++E){var W=Z[E];if(!(n.display&&G2(W))){var I=W.hasAttribute("data-v")?W.getAttribute("data-v"):W.hasAttribute("v")?W.getAttribute("v"):cy(W.innerHTML),X=W.getAttribute("data-z")||W.getAttribute("z");for(_=0;_<v.length;++_){var U=v[_];U.s.c==j+l&&U.s.r<b+s&&b+s<=U.e.r&&(j=U.e.c+1-l,_=-1)}S=+W.getAttribute("colspan")||1,((C=+W.getAttribute("rowspan")||1)>1||S>1)&&v.push({s:{r:b+s,c:j+l},e:{r:b+s+(C||1)-1,c:j+l+(S||1)-1}});var ee={t:"s",v:I},te=W.getAttribute("data-t")||W.getAttribute("t")||"";I!=null&&(I.length==0?ee.t=te||"z":n.raw||I.trim().length==0||te=="s"||(I==="TRUE"?ee={t:"b",v:!0}:I==="FALSE"?ee={t:"b",v:!1}:isNaN(nn(I))?isNaN(jl(I).getDate())||(ee={t:"d",v:Dr(I)},n.cellDates||(ee={t:"n",v:aa(ee.v)}),ee.z=n.dateNF||it[14]):ee={t:"n",v:nn(I)})),ee.z===void 0&&X!=null&&(ee.z=X);var V="",ge=W.getElementsByTagName("A");if(ge&&ge.length)for(var Re=0;Re<ge.length&&!(ge[Re].hasAttribute("href")&&(V=ge[Re].getAttribute("href"),V.charAt(0)!="#"));++Re);V&&V.charAt(0)!="#"&&(ee.l={Target:V}),n.dense?(e[b+s]||(e[b+s]=[]),e[b+s][j+l]=ee):e[rt({c:j+l,r:b+s})]=ee,x.e.c<j+l&&(x.e.c=j+l),j+=S}}++b}return v.length&&(e["!merges"]=(e["!merges"]||[]).concat(v)),x.e.r=Math.max(x.e.r,b-1+s),e["!ref"]=Et(x),b>=h&&(e["!fullref"]=Et((x.e.r=u.length-w+b-1+s,x))),e}function xw(e,t){var r=t||{},n=r.dense?[]:{};return hw(n,e,t)}function xR(e,t){return Fs(xw(e,t),t)}function G2(e){var t="",r=mR(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function mR(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function pR(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Tt(t.replace(/<[^>]*>/g,""));return[r]}var V2={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function mw(e,t){var r=t||{},n=Qh(e),s=[],l,o,u={name:""},h="",x=0,p,v,_={},y=[],w=r.dense?[]:{},b,E,j={value:""},C="",S=0,L=[],Z=-1,W=-1,I={s:{r:1e6,c:1e7},e:{r:0,c:0}},X=0,U={},ee=[],te={},V=0,ge=0,Re=[],Se=1,ae=1,ue=[],Q={Names:[]},G={},A=["",""],K=[],N={},P="",z=0,H=!1,se=!1,ve=0;for(ho.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");b=ho.exec(n);)switch(b[3]=b[3].replace(/_.*$/,"")){case"table":case"":b[1]==="/"?(I.e.c>=I.s.c&&I.e.r>=I.s.r?w["!ref"]=Et(I):w["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=I.e.r&&(w["!fullref"]=w["!ref"],I.e.r=r.sheetRows-1,w["!ref"]=Et(I)),ee.length&&(w["!merges"]=ee),Re.length&&(w["!rows"]=Re),p.name=p.||p.name,typeof JSON<"u"&&JSON.stringify(p),y.push(p.name),_[p.name]=w,se=!1):b[0].charAt(b[0].length-2)!=="/"&&(p=Ke(b[0],!1),Z=W=-1,I.s.r=I.s.c=1e7,I.e.r=I.e.c=0,w=r.dense?[]:{},ee=[],Re=[],se=!0);break;case"table-row-group":b[1]==="/"?--X:++X;break;case"table-row":case"":if(b[1]==="/"){Z+=Se,Se=1;break}if(v=Ke(b[0],!1),v.?Z=v.-1:Z==-1&&(Z=0),Se=+v["number-rows-repeated"]||1,Se<10)for(ve=0;ve<Se;++ve)X>0&&(Re[Z+ve]={level:X});W=-1;break;case"covered-table-cell":b[1]!=="/"&&++W,r.sheetStubs&&(r.dense?(w[Z]||(w[Z]=[]),w[Z][W]={t:"z"}):w[rt({r:Z,c:W})]={t:"z"}),C="",L=[];break;case"table-cell":case"":if(b[0].charAt(b[0].length-2)==="/")++W,j=Ke(b[0],!1),ae=parseInt(j["number-columns-repeated"]||"1",10),E={t:"z",v:null},j.formula&&r.cellFormula!=!1&&(E.f=U2(Tt(j.formula))),(j.||j["value-type"])=="string"&&(E.t="s",E.v=Tt(j["string-value"]||""),r.dense?(w[Z]||(w[Z]=[]),w[Z][W]=E):w[rt({r:Z,c:W})]=E),W+=ae-1;else if(b[1]!=="/"){++W,C="",S=0,L=[],ae=1;var be=Se?Z+Se-1:Z;if(W>I.e.c&&(I.e.c=W),W<I.s.c&&(I.s.c=W),Z<I.s.r&&(I.s.r=Z),be>I.e.r&&(I.e.r=be),j=Ke(b[0],!1),K=[],N={},E={t:j.||j["value-type"],v:null},r.cellFormula)if(j.formula&&(j.formula=Tt(j.formula)),j["number-matrix-columns-spanned"]&&j["number-matrix-rows-spanned"]&&(V=parseInt(j["number-matrix-rows-spanned"],10)||0,ge=parseInt(j["number-matrix-columns-spanned"],10)||0,te={s:{r:Z,c:W},e:{r:Z+V-1,c:W+ge-1}},E.F=Et(te),ue.push([te,E.F])),j.formula)E.f=U2(j.formula);else for(ve=0;ve<ue.length;++ve)Z>=ue[ve][0].s.r&&Z<=ue[ve][0].e.r&&W>=ue[ve][0].s.c&&W<=ue[ve][0].e.c&&(E.F=ue[ve][1]);switch((j["number-columns-spanned"]||j["number-rows-spanned"])&&(V=parseInt(j["number-rows-spanned"],10)||0,ge=parseInt(j["number-columns-spanned"],10)||0,te={s:{r:Z,c:W},e:{r:Z+V-1,c:W+ge-1}},ee.push(te)),j["number-columns-repeated"]&&(ae=parseInt(j["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=Wt(j["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(j.value);break;case"percentage":E.t="n",E.v=parseFloat(j.value);break;case"currency":E.t="n",E.v=parseFloat(j.value);break;case"date":E.t="d",E.v=Dr(j["date-value"]),r.cellDates||(E.t="n",E.v=aa(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=CA(j["time-value"])/86400,r.cellDates&&(E.t="d",E.v=Tu(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(j.);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",j["string-value"]!=null&&(C=Tt(j["string-value"]),L=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(H=!1,E.t==="s"&&(E.v=C||"",L.length&&(E.R=L),H=S==0),G.Target&&(E.l=G),K.length>0&&(E.c=K,K=[]),C&&r.cellText!==!1&&(E.w=C),H&&(E.t="z",delete E.v),(!H||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=Z))for(var Ae=0;Ae<Se;++Ae){if(ae=parseInt(j["number-columns-repeated"]||"1",10),r.dense)for(w[Z+Ae]||(w[Z+Ae]=[]),w[Z+Ae][W]=Ae==0?E:Ur(E);--ae>0;)w[Z+Ae][W+ae]=Ur(E);else for(w[rt({r:Z+Ae,c:W})]=E;--ae>0;)w[rt({r:Z+Ae,c:W+ae})]=Ur(E);I.e.c<=W&&(I.e.c=W)}ae=parseInt(j["number-columns-repeated"]||"1",10),W+=ae-1,ae=0,E={},C="",L=[]}G={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(b[1]==="/"){if((l=s.pop())[0]!==b[3])throw"Bad state: "+l}else b[0].charAt(b[0].length-2)!=="/"&&s.push([b[3],!0]);break;case"annotation":if(b[1]==="/"){if((l=s.pop())[0]!==b[3])throw"Bad state: "+l;N.t=C,L.length&&(N.R=L),N.a=P,K.push(N)}else b[0].charAt(b[0].length-2)!=="/"&&s.push([b[3],!1]);P="",z=0,C="",S=0,L=[];break;case"creator":b[1]==="/"?P=n.slice(z,b.index):z=b.index+b[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(b[1]==="/"){if((l=s.pop())[0]!==b[3])throw"Bad state: "+l}else b[0].charAt(b[0].length-2)!=="/"&&s.push([b[3],!1]);C="",S=0,L=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(b[1]==="/"){if(U[u.name]=h,(l=s.pop())[0]!==b[3])throw"Bad state: "+l}else b[0].charAt(b[0].length-2)!=="/"&&(h="",u=Ke(b[0],!1),s.push([b[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=Ke(b[0],!1),h+=V2[b[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=Ke(b[0],!1),h+=V2[b[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(b[0].slice(-2)==="/>")break;if(b[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":h+=n.slice(x,b.index);break}else x=b.index+b[0].length;break;case"named-range":o=Ke(b[0],!1),A=Jd(o["cell-range-address"]);var ye={Name:o.name,Ref:A[0]+"!"+A[1]};se&&(ye.Sheet=y.length),Q.Names.push(ye);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(b[1]==="/"&&(!j||!j["string-value"])){var Ye=pR(n.slice(S,b.index));C=(C.length>0?C+`
`:"")+Ye[0]}else Ke(b[0],!1),S=b.index+b[0].length;break;case"s":break;case"database-range":if(b[1]==="/")break;try{A=Jd(Ke(b[0])["target-range-address"]),_[A[0]]["!autofilter"]={ref:A[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(b[1]!=="/"){if(G=Ke(b[0],!1),!G.href)break;G.Target=Tt(G.href),delete G.href,G.Target.charAt(0)=="#"&&G.Target.indexOf(".")>-1?(A=Jd(G.Target.slice(1)),G.Target="#"+A[0]+"!"+A[1]):G.Target.match(/^\.\.[\\\/]/)&&(G.Target=G.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(b[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(b)}}var Y={Sheets:_,SheetNames:y,Workbook:Q};return r.bookSheets&&delete Y.Sheets,Y}function $2(e,t){t=t||{},Pa(e,"META-INF/manifest.xml")&&R3(hr(e,"META-INF/manifest.xml"),t);var r=ka(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=mw(Vt(r),t);return Pa(e,"meta.xml")&&(n.Props=Ny(hr(e,"meta.xml"))),n}function Y2(e,t){return mw(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function dx(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Sh(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Vt(bi(e))}function kh(e){var t=e.reduce(function(s,l){return s+l.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function q2(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function gR(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function go(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Tr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Yr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=go(e,r),l=s&7;s=Math.floor(s/8);var o=0,u;if(s==0)break;switch(l){case 0:{for(var h=r[0];e[r[0]++]>=128;);u=e.slice(h,r[0])}break;case 5:o=4,u=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,u=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=go(e,r),u=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(s," at offset ").concat(n))}var x={data:u,type:l};t[s]==null?t[s]=[x]:t[s].push(x)}return t}function hx(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function vR(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=go(e,n),l=Yr(e.slice(n[0],n[0]+s));n[0]+=s;var o={id:Tr(l[1][0].data),messages:[]};l[2].forEach(function(u){var h=Yr(u.data),x=Tr(h[3][0].data);o.messages.push({meta:h,data:e.slice(n[0],n[0]+x)}),n[0]+=x}),(t=l[3])!=null&&t[0]&&(o.merge=Tr(l[3][0].data)>>>0>0),r.push(o)}return r}function _R(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=go(t,r),s=[];r[0]<t.length;){var l=t[r[0]]&3;if(l==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var u=o-59;o=t[r[0]],u>1&&(o|=t[r[0]+1]<<8),u>2&&(o|=t[r[0]+2]<<16),u>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=u}s.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var h=0,x=0;if(l==1?(x=(t[r[0]]>>2&7)+4,h=(t[r[0]++]&224)<<3,h|=t[r[0]++]):(x=(t[r[0]++]>>2)+1,l==2?(h=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(h=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[kh(s)],h==0)throw new Error("Invalid offset 0");if(h>s[0].length)throw new Error("Invalid offset beyond length");if(x>=h)for(s.push(s[0].slice(-h)),x-=h;x>=s[s.length-1].length;)s.push(s[s.length-1]),x-=s[s.length-1].length;s.push(s[0].slice(-h,-h+x))}}var p=kh(s);if(p.length!=n)throw new Error("Unexpected length: ".concat(p.length," != ").concat(n));return p}function yR(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(_R(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return kh(t)}function wR(e,t,r,n){var s=dx(e),l=s.getUint32(4,!0),o=(n>1?12:8)+q2(l&(n>1?3470:398))*4,u=-1,h=-1,x=NaN,p=new Date(2001,0,1);l&512&&(u=s.getUint32(o,!0),o+=4),o+=q2(l&(n>1?12288:4096))*4,l&16&&(h=s.getUint32(o,!0),o+=4),l&32&&(x=s.getFloat64(o,!0),o+=8),l&64&&(p.setTime(p.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var v;switch(e[2]){case 0:break;case 2:v={t:"n",v:x};break;case 3:v={t:"s",v:t[h]};break;case 5:v={t:"d",v:p};break;case 6:v={t:"b",v:x>0};break;case 7:v={t:"n",v:x/86400};break;case 8:v={t:"e",v:0};break;case 9:if(u>-1)v={t:"s",v:r[u]};else if(h>-1)v={t:"s",v:t[h]};else if(!isNaN(x))v={t:"n",v:x};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return v}function bR(e,t,r){var n=dx(e),s=n.getUint32(8,!0),l=12,o=-1,u=-1,h=NaN,x=NaN,p=new Date(2001,0,1);s&1&&(h=gR(e,l),l+=16),s&2&&(x=n.getFloat64(l,!0),l+=8),s&4&&(p.setTime(p.getTime()+n.getFloat64(l,!0)*1e3),l+=8),s&8&&(u=n.getUint32(l,!0),l+=4),s&16&&(o=n.getUint32(l,!0),l+=4);var v;switch(e[1]){case 0:break;case 2:v={t:"n",v:h};break;case 3:v={t:"s",v:t[u]};break;case 5:v={t:"d",v:p};break;case 6:v={t:"b",v:x>0};break;case 7:v={t:"n",v:x/86400};break;case 8:v={t:"e",v:0};break;case 9:if(o>-1)v={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:v={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return v}function ER(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return wR(e,t,r,e[0]);case 5:return bR(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ds(e){var t=Yr(e);return go(t[1][0].data)}function X2(e,t){var r=Yr(t.data),n=Tr(r[1][0].data),s=r[3],l=[];return(s||[]).forEach(function(o){var u=Yr(o.data),h=Tr(u[1][0].data)>>>0;switch(n){case 1:l[h]=Sh(u[3][0].data);break;case 8:{var x=e[Ds(u[9][0].data)][0],p=Yr(x.data),v=e[Ds(p[1][0].data)][0],_=Tr(v.meta[1][0].data);if(_!=2001)throw new Error("2000 unexpected reference to ".concat(_));var y=Yr(v.data);l[h]=y[3].map(function(w){return Sh(w.data)}).join("")}break}}),l}function TR(e,t){var r,n,s,l,o,u,h,x,p,v,_,y,w,b,E=Yr(e),j=Tr(E[1][0].data)>>>0,C=Tr(E[2][0].data)>>>0,S=((n=(r=E[8])==null?void 0:r[0])==null?void 0:n.data)&&Tr(E[8][0].data)>0||!1,L,Z;if((l=(s=E[7])==null?void 0:s[0])!=null&&l.data&&t!=0)L=(u=(o=E[7])==null?void 0:o[0])==null?void 0:u.data,Z=(x=(h=E[6])==null?void 0:h[0])==null?void 0:x.data;else if((v=(p=E[4])==null?void 0:p[0])!=null&&v.data&&t!=1)L=(y=(_=E[4])==null?void 0:_[0])==null?void 0:y.data,Z=(b=(w=E[3])==null?void 0:w[0])==null?void 0:b.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var W=S?4:1,I=dx(L),X=[],U=0;U<L.length/2;++U){var ee=I.getUint16(U*2,!0);ee<65535&&X.push([U,ee])}if(X.length!=C)throw"Expected ".concat(C," cells, found ").concat(X.length);var te=[];for(U=0;U<X.length-1;++U)te[X[U][0]]=Z.subarray(X[U][1]*W,X[U+1][1]*W);return X.length>=1&&(te[X[X.length-1][0]]=Z.subarray(X[X.length-1][1]*W)),{R:j,cells:te}}function SR(e,t){var r,n=Yr(t.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?Tr(n[7][0].data)>>>0>0?1:0:-1,l=hx(n[5],function(o){return TR(o,s)});return{nrows:Tr(n[4][0].data)>>>0,data:l.reduce(function(o,u){return o[u.R]||(o[u.R]=[]),u.cells.forEach(function(h,x){if(o[u.R][x])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(x));o[u.R][x]=h}),o},[])}}function kR(e,t,r){var n,s=Yr(t.data),l={s:{r:0,c:0},e:{r:0,c:0}};if(l.e.r=(Tr(s[6][0].data)>>>0)-1,l.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(l.e.c=(Tr(s[7][0].data)>>>0)-1,l.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Et(l);var o=Yr(s[4][0].data),u=X2(e,e[Ds(o[4][0].data)][0]),h=(n=o[17])!=null&&n[0]?X2(e,e[Ds(o[17][0].data)][0]):[],x=Yr(o[3][0].data),p=0;x[1].forEach(function(v){var _=Yr(v.data),y=e[Ds(_[2][0].data)][0],w=Tr(y.meta[1][0].data);if(w!=6002)throw new Error("6001 unexpected reference to ".concat(w));var b=SR(e,y);b.data.forEach(function(E,j){E.forEach(function(C,S){var L=rt({r:p+j,c:S}),Z=ER(C,u,h);Z&&(r[L]=Z)})}),p+=b.nrows})}function AR(e,t){var r=Yr(t.data),n={"!ref":"A1"},s=e[Ds(r[2][0].data)],l=Tr(s[0].meta[1][0].data);if(l!=6001)throw new Error("6000 unexpected reference to ".concat(l));return kR(e,s[0],n),n}function NR(e,t){var r,n=Yr(t.data),s={name:(r=n[1])!=null&&r[0]?Sh(n[1][0].data):"",sheets:[]},l=hx(n[2],Ds);return l.forEach(function(o){e[o].forEach(function(u){var h=Tr(u.meta[1][0].data);h==6e3&&s.sheets.push(AR(e,u))})}),s}function CR(e,t){var r=px(),n=Yr(t.data),s=hx(n[1],Ds);if(s.forEach(function(l){e[l].forEach(function(o){var u=Tr(o.meta[1][0].data);if(u==2){var h=NR(e,o);h.sheets.forEach(function(x,p){gx(r,x,p==0?h.name:h.name+"_"+p,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function eh(e){var t,r,n,s,l={},o=[];if(e.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var x;try{x=yR(h.content)}catch(v){return console.log("?? "+h.content.length+" "+(v.message||v))}var p;try{p=vR(x)}catch(v){return console.log("## "+(v.message||v))}p.forEach(function(v){l[v.id]=v.messages,o.push(v.id)})}}),!o.length)throw new Error("File has no messages");var u=((s=(n=(r=(t=l==null?void 0:l[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Tr(l[1][0].meta[1][0].data)==1&&l[1][0];if(u||o.forEach(function(h){l[h].forEach(function(x){var p=Tr(x.meta[1][0].data)>>>0;if(p==1)if(!u)u=x;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return CR(l,u)}function OR(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function xx(e){OR([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function DR(e){return bl.WS.indexOf(e)>-1?"sheet":e==bl.CS?"chart":e==bl.DS?"dialog":e==bl.MS?"macro":e&&e.length?e:"sheet"}function RR(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,DR(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function jR(e,t,r,n,s,l,o,u,h,x,p,v){try{l[n]=Zc(ka(e,r,!0),t);var _=hr(e,t),y;switch(u){case"sheet":y=BD(_,t,s,h,l[n],x,p,v);break;case"chart":if(y=PD(_,t,s,h,l[n],x,p,v),!y||!y["!drawel"])break;var w=Hc(y["!drawel"].Target,t),b=yh(w),E=UC(ka(e,w,!0),Zc(ka(e,b,!0),w)),j=Hc(E,w),C=yh(j);y=bD(ka(e,j,!0),j,h,Zc(ka(e,C,!0),j),x,y);break;case"macro":y=HD(_,t,s,h,l[n],x,p,v);break;case"dialog":y=zD(_,t,s,h,l[n],x,p,v);break;default:throw new Error("Unrecognized sheet type "+u)}o[n]=y;var S=[];l&&l[n]&&gn(l[n]).forEach(function(L){var Z="";if(l[n][L].Type==bl.CMNT){Z=Hc(l[n][L].Target,t);var W=YD(hr(e,Z,!0),Z,h);if(!W||!W.length)return;j2(y,W,!1)}l[n][L].Type==bl.TCMNT&&(Z=Hc(l[n][L].Target,t),S=S.concat(PC(hr(e,Z,!0),h)))}),S&&S.length&&j2(y,S,!0,h.people||[])}catch(L){if(h.WTF)throw L}}function Ua(e){return e.charAt(0)=="/"?e.slice(1):e}function IR(e,t){if(Q_(),t=t||{},xx(t),Pa(e,"META-INF/manifest.xml")||Pa(e,"objectdata.xml"))return $2(e,t);if(Pa(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof eh<"u"){if(e.FileIndex)return eh(e);var r=bt.utils.cfb_new();return i2(e).forEach(function(Re){MA(r,Re,IA(e,Re))}),eh(r)}throw new Error("Unsupported NUMBERS file")}if(!Pa(e,"[Content_Types].xml"))throw Pa(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Pa(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=i2(e),s=O3(ka(e,"[Content_Types].xml")),l=!1,o,u;if(s.workbooks.length===0&&(u="xl/workbook.xml",hr(e,u,!0)&&s.workbooks.push(u)),s.workbooks.length===0){if(u="xl/workbook.bin",!hr(e,u,!0))throw new Error("Could not find workbook");s.workbooks.push(u),l=!0}s.workbooks[0].slice(-3)=="bin"&&(l=!0);var h={},x={};if(!t.bookSheets&&!t.bookProps){if(Qc=[],s.sst)try{Qc=$D(hr(e,Ua(s.sst)),s.sst,t)}catch(Re){if(t.WTF)throw Re}t.cellStyles&&s.themes.length&&(h=VD(ka(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(x=GD(hr(e,Ua(s.style)),s.style,h,t))}s.links.map(function(Re){try{var Se=Zc(ka(e,yh(Ua(Re))),Re);return XD(hr(e,Ua(Re)),Se,Re,t)}catch{}});var p=UD(hr(e,Ua(s.workbooks[0])),s.workbooks[0],t),v={},_="";s.coreprops.length&&(_=hr(e,Ua(s.coreprops[0]),!0),_&&(v=Ny(_)),s.extprops.length!==0&&(_=hr(e,Ua(s.extprops[0]),!0),_&&M3(_,v,t)));var y={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(_=ka(e,Ua(s.custprops[0]),!0),_&&(y=F3(_,t)));var w={};if((t.bookSheets||t.bookProps)&&(p.Sheets?o=p.Sheets.map(function(Se){return Se.name}):v.Worksheets&&v.SheetNames.length>0&&(o=v.SheetNames),t.bookProps&&(w.Props=v,w.Custprops=y),t.bookSheets&&typeof o<"u"&&(w.SheetNames=o),t.bookSheets?w.SheetNames:t.bookProps))return w;o={};var b={};t.bookDeps&&s.calcchain&&(b=qD(hr(e,Ua(s.calcchain)),s.calcchain));var E=0,j={},C,S;{var L=p.Sheets;v.Worksheets=L.length,v.SheetNames=[];for(var Z=0;Z!=L.length;++Z)v.SheetNames[Z]=L[Z].name}var W=l?"bin":"xml",I=s.workbooks[0].lastIndexOf("/"),X=(s.workbooks[0].slice(0,I+1)+"_rels/"+s.workbooks[0].slice(I+1)+".rels").replace(/^\//,"");Pa(e,X)||(X="xl/_rels/workbook."+W+".rels");var U=Zc(ka(e,X,!0),X.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=WD(hr(e,Ua(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=HC(hr(e,Ua(s.people[0])),t)),U&&(U=RR(U,p.Sheets));var ee=hr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=v.Worksheets;++E){var te="sheet";if(U&&U[E]?(C="xl/"+U[E][1].replace(/[\/]?xl\//,""),Pa(e,C)||(C=U[E][1]),Pa(e,C)||(C=X.replace(/_rels\/.*$/,"")+U[E][1]),te=U[E][2]):(C="xl/worksheets/sheet"+(E+1-ee)+"."+W,C=C.replace(/sheet0\./,"sheet.")),S=C.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(E!=t.sheets)continue e;break;case"string":if(v.SheetNames[E].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var V=!1,ge=0;ge!=t.sheets.length;++ge)typeof t.sheets[ge]=="number"&&t.sheets[ge]==E&&(V=1),typeof t.sheets[ge]=="string"&&t.sheets[ge].toLowerCase()==v.SheetNames[E].toLowerCase()&&(V=1);if(!V)continue e}}jR(e,C,S,v.SheetNames[E],E,j,o,te,t,p,h,x)}return w={Directory:s,Workbook:p,Props:v,Custprops:y,Deps:b,Sheets:o,SheetNames:v.SheetNames,Strings:Qc,Styles:x,Themes:h,SSF:Ur(it)},t&&t.bookFiles&&(e.files?(w.keys=n,w.files=e.files):(w.keys=[],w.files={},e.FullPaths.forEach(function(Re,Se){Re=Re.replace(/^Root Entry[\/]/,""),w.keys.push(Re),w.files[Re]=e.FileIndex[Se]}))),t&&t.bookVBA&&(s.vba.length>0?w.vbaraw=hr(e,Ua(s.vba[0]),!0):s.defaults&&s.defaults.bin===$C&&(w.vbaraw=hr(e,"xl/vbaProject.bin",!0))),w}function MR(e,t){var r=t||{},n="Workbook",s=bt.find(e,n);try{if(n="/!DataSpaces/Version",s=bt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(AN(s.content),n="/!DataSpaces/DataSpaceMap",s=bt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=CN(s.content);if(l.length!==1||l[0].comps.length!==1||l[0].comps[0].t!==0||l[0].name!=="StrongEncryptionDataSpace"||l[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=bt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=ON(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=bt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);RN(s.content)}catch{}if(n="/EncryptionInfo",s=bt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=jN(s.content);if(n="/EncryptedPackage",s=bt.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],s.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function mx(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Na(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function LR(e,t){return bt.find(e,"EncryptedPackage")?MR(e,t):dw(e,t)}function FR(e,t){var r,n=e,s=t||{};return s.type||(s.type=_t&&Buffer.isBuffer(e)?"buffer":"base64"),r=sy(n,s),IR(r,s)}function pw(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Eh(e.slice(r),t);default:break e}return xo.to_workbook(e,t)}function UR(e,t){var r="",n=mx(e,t);switch(t.type){case"base64":r=Na(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=gi(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Vt(r)),t.type="binary",pw(r,t)}function BR(e,t){var r=e;return t.type=="base64"&&(r=Na(r)),r=oo.utils.decode(1200,r.slice(2),"str"),t.type="binary",pw(r,t)}function PR(e){return e.match(/[^\x00-\x7F]/)?zc(e):e}function th(e,t,r,n){return n?(r.type="string",xo.to_workbook(e,r)):xo.to_workbook(t,r)}function Ah(e,t){H_();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Ah(new Uint8Array(e),(r=Ur(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],l=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),kl={},r.dateNF&&(kl.dateNF=r.dateNF),r.type||(r.type=_t&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=_t?"buffer":"binary",n=AA(e),typeof Uint8Array<"u"&&!_t&&(r.type="array")),r.type=="string"&&(l=!0,r.type="binary",r.codepage=65001,n=PR(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),u=new Uint8Array(o);if(u.foo="bar",!u.foo)return r=Ur(r),r.type="array",Ah(qh(n),r)}switch((s=mx(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return LR(bt.read(n,r),r);break;case 9:if(s[1]<=8)return dw(n,r);break;case 60:return Eh(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return xN(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return dN.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?FR(n,r):th(e,n,r,l);case 239:return s[3]===60?Eh(n,r):th(e,n,r,l);case 255:if(s[1]===254)return BR(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Jc.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Jc.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return R2.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return $N.to_workbook(n,r);break;case 10:case 13:case 32:return UR(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return uN.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?R2.to_workbook(n,r):th(e,n,r,l)}function HR(e,t,r,n,s,l,o,u){var h=Br(r),x=u.defval,p=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),v=!0,_=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:r,enumerable:!1})}catch{_.__rowNum__=r}else _.__rowNum__=r;if(!o||e[r])for(var y=t.s.c;y<=t.e.c;++y){var w=o?e[r][y]:e[n[y]+h];if(w===void 0||w.t===void 0){if(x===void 0)continue;l[y]!=null&&(_[l[y]]=x);continue}var b=w.v;switch(w.t){case"z":if(b==null)break;continue;case"e":b=b==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(l[y]!=null){if(b==null)if(w.t=="e"&&b===null)_[l[y]]=null;else if(x!==void 0)_[l[y]]=x;else if(p&&b===null)_[l[y]]=null;else continue;else _[l[y]]=p&&(w.t!=="n"||w.t==="n"&&u.rawNumbers!==!1)?b:$n(w,b,u);b!=null&&(v=!1)}}return{row:_,isempty:v}}function Nh(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,l=[],o=0,u="",h={s:{r:0,c:0},e:{r:0,c:0}},x=t||{},p=x.range!=null?x.range:e["!ref"];switch(x.header===1?n=1:x.header==="A"?n=2:Array.isArray(x.header)?n=3:x.header==null&&(n=0),typeof p){case"string":h=sr(p);break;case"number":h=sr(e["!ref"]),h.s.r=p;break;default:h=p}n>0&&(s=0);var v=Br(h.s.r),_=[],y=[],w=0,b=0,E=Array.isArray(e),j=h.s.r,C=0,S={};E&&!e[j]&&(e[j]=[]);var L=x.skipHidden&&e["!cols"]||[],Z=x.skipHidden&&e["!rows"]||[];for(C=h.s.c;C<=h.e.c;++C)if(!(L[C]||{}).hidden)switch(_[C]=Er(C),r=E?e[j][C]:e[_[C]+v],n){case 1:l[C]=C-h.s.c;break;case 2:l[C]=_[C];break;case 3:l[C]=x.header[C-h.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=o=$n(r,null,x),b=S[o]||0,!b)S[o]=1;else{do u=o+"_"+b++;while(S[u]);S[o]=b,S[u]=1}l[C]=u}for(j=h.s.r+s;j<=h.e.r;++j)if(!(Z[j]||{}).hidden){var W=HR(e,h,j,_,n,l,E,x);(W.isempty===!1||(n===1?x.blankrows!==!1:x.blankrows))&&(y[w++]=W.row)}return y.length=w,y}var W2=/"/g;function zR(e,t,r,n,s,l,o,u){for(var h=!0,x=[],p="",v=Br(r),_=t.s.c;_<=t.e.c;++_)if(n[_]){var y=u.dense?(e[r]||[])[_]:e[n[_]+v];if(y==null)p="";else if(y.v!=null){h=!1,p=""+(u.rawNumbers&&y.t=="n"?y.v:$n(y,null,u));for(var w=0,b=0;w!==p.length;++w)if((b=p.charCodeAt(w))===s||b===l||b===34||u.forceQuotes){p='"'+p.replace(W2,'""')+'"';break}p=="ID"&&(p='"ID"')}else y.f!=null&&!y.F?(h=!1,p="="+y.f,p.indexOf(",")>=0&&(p='"'+p.replace(W2,'""')+'"')):p="";x.push(p)}return u.blankrows===!1&&h?null:x.join(o)}function gw(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=sr(e["!ref"]),l=n.FS!==void 0?n.FS:",",o=l.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,h=u.charCodeAt(0),x=new RegExp((l=="|"?"\\|":l)+"+$"),p="",v=[];n.dense=Array.isArray(e);for(var _=n.skipHidden&&e["!cols"]||[],y=n.skipHidden&&e["!rows"]||[],w=s.s.c;w<=s.e.c;++w)(_[w]||{}).hidden||(v[w]=Er(w));for(var b=0,E=s.s.r;E<=s.e.r;++E)(y[E]||{}).hidden||(p=zR(e,s,E,v,o,h,l,n),p!=null&&(n.strip&&(p=p.replace(x,"")),(p||n.blankrows!==!1)&&r.push((b++?u:"")+p)));return delete n.dense,r.join("")}function GR(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=gw(e,t);return r}function VR(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=sr(e["!ref"]),l="",o=[],u,h=[],x=Array.isArray(e);for(u=s.s.c;u<=s.e.c;++u)o[u]=Er(u);for(var p=s.s.r;p<=s.e.r;++p)for(l=Br(p),u=s.s.c;u<=s.e.c;++u)if(t=o[u]+l,r=x?(e[p]||[])[u]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}h[h.length]=t+"="+n}return h}function vw(e,t,r){var n=r||{},s=+!n.skipHeader,l=e||{},o=0,u=0;if(l&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var h=typeof n.origin=="string"?ta(n.origin):n.origin;o=h.r,u=h.c}var x,p={s:{c:0,r:0},e:{c:u,r:o+t.length-1+s}};if(l["!ref"]){var v=sr(l["!ref"]);p.e.c=Math.max(p.e.c,v.e.c),p.e.r=Math.max(p.e.r,v.e.r),o==-1&&(o=v.e.r+1,p.e.r=o+t.length-1+s)}else o==-1&&(o=0,p.e.r=t.length-1+s);var _=n.header||[],y=0;t.forEach(function(b,E){gn(b).forEach(function(j){(y=_.indexOf(j))==-1&&(_[y=_.length]=j);var C=b[j],S="z",L="",Z=rt({c:u+y,r:o+E+s});x=vo(l,Z),C&&typeof C=="object"&&!(C instanceof Date)?l[Z]=C:(typeof C=="number"?S="n":typeof C=="boolean"?S="b":typeof C=="string"?S="s":C instanceof Date?(S="d",n.cellDates||(S="n",C=aa(C)),L=n.dateNF||it[14]):C===null&&n.nullError&&(S="e",C=0),x?(x.t=S,x.v=C,delete x.w,delete x.R,L&&(x.z=L)):l[Z]=x={t:S,v:C},L&&(x.z=L))})}),p.e.c=Math.max(p.e.c,u+_.length-1);var w=Br(o);if(s)for(y=0;y<_.length;++y)l[Er(y+u)+w]={t:"s",v:_[y]};return l["!ref"]=Et(p),l}function $R(e,t){return vw(null,e,t)}function vo(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=ta(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?vo(e,rt(t)):vo(e,rt({r:t,c:r||0}))}function YR(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function px(){return{SheetNames:[],Sheets:{}}}function gx(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var l=r.match(/(^.*?)(\d+)$/);s=l&&+l[2]||0;var o=l&&l[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=o+s)!=-1;++s);}if(OD(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function qR(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=YR(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function XR(e,t){return e.z=t,e}function _w(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function WR(e,t,r){return _w(e,"#"+t,r)}function ZR(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function KR(e,t,r,n){for(var s=typeof t!="string"?t:sr(t),l=typeof t=="string"?t:Et(t),o=s.s.r;o<=s.e.r;++o)for(var u=s.s.c;u<=s.e.c;++u){var h=vo(e,o,u);h.t="n",h.F=l,delete h.v,o==s.s.r&&u==s.s.c&&(h.f=r,n&&(h.D=!0))}return e}var JR={encode_col:Er,encode_row:Br,encode_cell:rt,encode_range:Et,decode_col:rx,decode_row:tx,split_cell:o3,decode_cell:ta,decode_range:Fl,format_cell:$n,sheet_add_aoa:Ey,sheet_add_json:vw,sheet_add_dom:hw,aoa_to_sheet:Ul,json_to_sheet:$R,table_to_sheet:xw,table_to_book:xR,sheet_to_csv:gw,sheet_to_txt:GR,sheet_to_json:Nh,sheet_to_html:hR,sheet_to_formulae:VR,sheet_to_row_object_array:Nh,sheet_get_cell:vo,book_new:px,book_append_sheet:gx,book_set_sheet_visibility:qR,cell_set_number_format:XR,cell_set_hyperlink:_w,cell_set_internal_link:WR,cell_add_comment:ZR,sheet_set_array_formula:KR,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const yw=({matrixData:e,onUpdate:t})=>{const r=(h,x)=>t({...e,headers:e.headers.map((p,v)=>v===h?x:p)}),n=(h,x,p)=>t({...e,rows:e.rows.map((v,_)=>_===h?v.map((y,w)=>w===x?p:y):v)}),s=()=>t({...e,rows:[...e.rows,Array(e.headers.length).fill("")]}),l=h=>t({...e,rows:e.rows.filter((x,p)=>p!==h)}),o=()=>{const h=` ${e.headers.length+1}`;t({headers:[...e.headers,h],rows:e.rows.map(x=>[...x,""])})},u=h=>{e.headers.length<=1||t({headers:e.headers.filter((x,p)=>p!==h),rows:e.rows.map(x=>x.filter((p,v)=>v!==h))})};return d.jsxs("div",{className:"overflow-x-auto p-1 bg-slate-50 rounded-md border",children:[d.jsxs("table",{className:"w-full text-xs border-collapse",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"bg-slate-200",children:[e.headers.map((h,x)=>d.jsx("th",{className:"border border-slate-300 p-0 font-semibold text-slate-700",children:d.jsxs("div",{className:"flex items-center justify-between gap-1 px-1",children:[d.jsx("input",{type:"text",value:h,onChange:p=>r(x,p.target.value),className:"w-full bg-transparent outline-none text-center font-semibold text-slate-800"}),d.jsx("button",{onClick:()=>u(x),className:"text-red-500 hover:text-red-700 opacity-30 hover:opacity-100",title:"",children:d.jsx(za,{className:"w-3 h-3"})})]})},x)),d.jsx("th",{className:"border border-slate-300 p-1 w-10"})]})}),d.jsx("tbody",{children:e.rows.map((h,x)=>d.jsxs("tr",{children:[h.map((p,v)=>d.jsx("td",{className:"border border-slate-300 p-0",children:d.jsx("input",{type:"text",value:p,onChange:_=>n(x,v,_.target.value),className:"w-full bg-white text-slate-900 outline-none p-1 focus:bg-blue-50"})},v)),d.jsx("td",{className:"border border-slate-300 p-1 text-center",children:d.jsx("button",{onClick:()=>l(x),className:"text-red-500 hover:text-red-700",title:"",children:d.jsx(za,{className:"w-3 h-3"})})})]},x))})]}),d.jsxs("div",{className:"flex gap-2 mt-2",children:[d.jsxs("button",{onClick:s,className:"text-xs px-2 py-1 bg-slate-200 hover:bg-slate-300 rounded flex items-center gap-1",children:[d.jsx(di,{className:"w-3 h-3"}),""]}),d.jsxs("button",{onClick:o,className:"text-xs px-2 py-1 bg-slate-200 hover:bg-slate-300 rounded flex items-center gap-1",children:[d.jsx(di,{className:"w-3 h-3"}),""]})]})]})},Z2=e=>{const t=Math.cos(2*Math.PI*e),r=Math.sin(2*Math.PI*e);return[t,r]},QR=({data:e,title:t})=>{const r=e.reduce((o,u)=>o+u.value,0);if(r===0)return d.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"No data for chart"});let n=0;const s=["#4A90E2","#50E3C2","#F5A623","#F8E71C","#7ED321","#9013FE","#BD10E0","#4A4A4A"],l=e.map((o,u)=>{const h=o.value/r,[x,p]=Z2(n);n+=h;const[v,_]=Z2(n),y=h>.5?1:0;return{path:`M ${x} ${p} A 1 1 0 ${y} 1 ${v} ${_} L 0 0`,color:s[u%s.length],label:o.label,value:o.value}});return d.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center bg-white p-2 border rounded-md",children:[d.jsx("h5",{className:"font-bold text-sm mb-2",children:t}),d.jsx("svg",{viewBox:"-1.2 -1.2 2.4 2.4",className:"w-32 h-32 mb-2",children:l.map((o,u)=>d.jsx("path",{d:o.path,fill:o.color},u))}),d.jsx("div",{className:"text-[10px] space-y-0.5 w-full",children:l.map((o,u)=>d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("span",{className:"w-2 h-2 rounded-full mr-1.5",style:{backgroundColor:o.color}}),d.jsx("span",{children:o.label})]}),d.jsxs("span",{children:[o.value," (",(o.value/r*100).toFixed(1),"%)"]})]},u))})]})},e8=({data:e,title:t})=>{if(e.length<2)return d.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"Need at least 2 data points for a line chart."});const r=Math.max(...e.map(n=>n.value),0);return d.jsxs("div",{className:"w-full h-full bg-white p-2 border rounded-md",children:[d.jsx("h5",{className:"text-center font-bold text-sm mb-2",children:t}),d.jsxs("svg",{viewBox:"0 0 100 50",className:"w-full h-40",children:[[0,.25,.5,.75,1].map(n=>d.jsx("line",{x1:"0",y1:50-n*45,x2:"100",y2:50-n*45,stroke:"#f0f0f0",strokeWidth:"0.5"},n)),d.jsx("polyline",{fill:"none",stroke:"#4a90e2",strokeWidth:"1",points:e.map((n,s)=>`${s/(e.length-1)*100},${50-n.value/r*45}`).join(" ")}),e.map((n,s)=>d.jsx("circle",{cx:`${s/(e.length-1)*100}`,cy:`${50-n.value/r*45}`,r:"1.5",fill:"#4a90e2"},s))]})]})},t8=({data:e,title:t})=>{const r=Math.max(...e.map(n=>n.value),0);return r===0?d.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"No data for chart"}):d.jsxs("div",{className:"w-full h-full bg-white p-2 border rounded-md",children:[d.jsx("h5",{className:"text-center font-bold text-sm mb-2",children:t}),d.jsx("div",{className:"space-y-1",children:e.map(n=>d.jsxs("div",{className:"flex items-center text-xs",children:[d.jsx("div",{className:"w-24 truncate pr-2 text-right text-slate-600",children:n.label}),d.jsx("div",{className:"flex-grow bg-slate-200 rounded-full h-4",children:d.jsx("div",{className:"bg-blue-500 h-4 rounded-full text-white text-right pr-1",style:{width:`${n.value/r*100}%`},children:d.jsx("span",{className:"text-[10px]",children:n.value})})})]},n.label))})]})},r8=({actionItem:e,onSave:t,onClose:r,generateUniqueId:n})=>{var j;const[s,l]=re.useState(e.report||{notes:"",attachments:[],matrixData:null}),[o,u]=re.useState("bar"),h=re.useRef(null),x=re.useRef(null),p=C=>{l(S=>({...S,...C}))},v=()=>{t({...e,report:s})},_=C=>{var I;const S=(I=C.target.files)==null?void 0:I[0];if(!S)return;const L=5,Z=L*1024*1024;if(S.size>Z){alert(`${L}MB`),C.target&&(C.target.value="");return}const W=new FileReader;W.onload=X=>{var U;if(typeof((U=X.target)==null?void 0:U.result)=="string"){const ee={id:n("attach"),name:S.name,type:S.type,dataUrl:X.target.result};p({attachments:[...s.attachments||[],ee]})}else alert("")},W.onerror=()=>{alert("")},W.readAsDataURL(S),C.target&&(C.target.value="")},y=C=>{var S;p({attachments:(S=s.attachments)==null?void 0:S.filter(L=>L.id!==C)})},w=C=>{var Z;const S=(Z=C.target.files)==null?void 0:Z[0];if(!S)return;const L=new FileReader;L.onload=W=>{var I;try{const X=(I=W.target)==null?void 0:I.result,U=Ah(X,{type:"array"}),ee=U.SheetNames[0],te=U.Sheets[ee],V=JR.sheet_to_json(te,{header:1});if(!Array.isArray(V)||V.length===0){alert("Excel"),C.target&&(C.target.value="");return}const ge=V[0];if(!Array.isArray(ge)){alert("Excel"),C.target&&(C.target.value="");return}const Re=ge.map(String),Se=V.slice(1),ae=[];for(const ue of Se)if(Array.isArray(ue)){const Q=Array(Re.length).fill("");for(let G=0;G<Re.length;G++)Q[G]=ue[G]!==null&&ue[G]!==void 0?String(ue[G]):"";ae.push(Q)}p({matrixData:{headers:Re,rows:ae}})}catch(X){console.error("Error parsing Excel file:",X),alert(`Excel: ${X instanceof Error?X.message:"Unknown error"}`)}finally{C.target&&(C.target.value="")}},L.readAsArrayBuffer(S)},b=(((j=s.matrixData)==null?void 0:j.rows)||[]).map(C=>({label:C[0],value:parseFloat(C[1])||0})).filter(C=>C.label&&!isNaN(C.value)),E=()=>{if(!s.matrixData||b.length===0)return null;switch(o){case"line":return d.jsx(e8,{data:b,title:""});case"pie":return d.jsx(QR,{data:b,title:""});case"bar":default:return d.jsx(t8,{data:b,title:""})}};return d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[70]",children:d.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[d.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),d.jsx("p",{className:"text-sm text-slate-500",children:e.text})]}),d.jsx("button",{onClick:r,className:"p-1 rounded-full hover:bg-slate-100",children:d.jsx(na,{className:"w-6 h-6 text-slate-500"})})]}),d.jsxs("div",{className:"flex-grow p-5 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-semibold text-slate-700",children:""}),d.jsx("textarea",{value:s.notes,onChange:C=>p({notes:C.target.value}),className:"w-full mt-1 p-2 border rounded-md h-32 bg-slate-50 focus:bg-white text-slate-800",placeholder:"..."})]}),d.jsxs("div",{children:[d.jsxs("h4",{className:"text-sm font-semibold text-slate-700 flex justify-between items-center mb-2",children:["",d.jsx("button",{onClick:()=>{var C;return(C=h.current)==null?void 0:C.click()},className:"p-1 hover:bg-slate-200 rounded-full",children:d.jsx(Ns,{className:"w-5 h-5"})}),d.jsx("input",{type:"file",ref:h,onChange:_,className:"hidden",multiple:!1})]}),d.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 max-h-48 overflow-y-auto border p-2 rounded-md bg-slate-50",children:(s.attachments||[]).map(C=>d.jsxs("div",{className:"relative group border rounded-md overflow-hidden bg-white shadow-sm h-24",children:[d.jsx("a",{href:C.dataUrl,download:C.name,className:"block w-full h-full","aria-label":`Download ${C.name}`,children:C.type.startsWith("image/")?d.jsx("img",{src:C.dataUrl,alt:C.name,className:"w-full h-full object-cover"}):d.jsx("div",{className:"w-full h-full bg-slate-100 flex flex-col items-center justify-center p-2 hover:bg-slate-200",children:d.jsx(Ns,{className:"w-8 h-8 text-slate-500"})})}),d.jsx("div",{className:"absolute bottom-0 w-full bg-black bg-opacity-60 p-1 pointer-events-none",children:d.jsx("p",{className:"text-white text-[10px] truncate",title:C.name,children:C.name})}),d.jsx("button",{onClick:()=>y(C.id),className:"absolute top-1 right-1 bg-black bg-opacity-50 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity z-10",children:d.jsx(za,{className:"w-3 h-3"})})]},C.id))})]})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("h4",{className:"text-sm font-semibold text-slate-700 flex justify-between items-center",children:["",d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("button",{onClick:()=>{var C;return(C=x.current)==null?void 0:C.click()},className:"p-1 hover:bg-slate-200 rounded-full",title:"Excel",children:d.jsx(__,{className:"w-5 h-5 text-green-600"})}),d.jsx("input",{type:"file",ref:x,onChange:w,className:"hidden",accept:".xlsx, .xls, .csv"}),s.matrixData&&b.length>0&&d.jsxs("div",{className:"flex items-center gap-1 rounded-full bg-slate-200 p-0.5",children:[d.jsx("button",{onClick:()=>u("bar"),className:`px-2 py-0.5 rounded-full text-xs ${o==="bar"?"bg-white shadow-sm text-blue-600":"text-slate-600"}`,children:"Bar"}),d.jsx("button",{onClick:()=>u("line"),className:`px-2 py-0.5 rounded-full text-xs ${o==="line"?"bg-white shadow-sm text-blue-600":"text-slate-600"}`,children:"Line"}),d.jsx("button",{onClick:()=>u("pie"),className:`px-2 py-0.5 rounded-full text-xs ${o==="pie"?"bg-white shadow-sm text-blue-600":"text-slate-600"}`,children:"Pie"})]}),d.jsx("button",{onClick:()=>p({matrixData:s.matrixData?null:{headers:["",""],rows:[["",""]]}}),className:"p-1 hover:bg-slate-200 rounded-full",title:s.matrixData?"":"",children:s.matrixData?d.jsx(za,{className:"w-5 h-5 text-red-500"}):d.jsx(Eo,{className:"w-5 h-5"})})]})]}),s.matrixData?d.jsx(yw,{matrixData:s.matrixData,onUpdate:C=>p({matrixData:C})}):null,d.jsx("div",{className:"mt-4",children:E()})]})]}),d.jsxs("footer",{className:"p-5 bg-slate-100 border-t flex justify-end gap-3",children:[d.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50",children:""}),d.jsx("button",{onClick:v,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:""})]})]})})},rh=({value:e,onChange:t,placeholder:r})=>d.jsx("textarea",{value:e,onChange:n=>t(n.target.value),placeholder:r,rows:3,className:"w-full h-full text-sm bg-transparent outline-none p-2 rounded-sm focus:ring-1 focus:ring-blue-500 focus:bg-blue-50 resize-none text-slate-800 placeholder-slate-400"}),a8=({isOpen:e,onClose:t,onSave:r,task:n,generateUniqueId:s})=>{var I;const[l,o]=re.useState([]),[u,h]=re.useState(!1),[x,p]=re.useState(null),[v,_]=re.useState({key:"status",direction:"ascending"});re.useEffect(()=>{var X;e&&o(((X=n.extendedDetails)==null?void 0:X.decisions)||[])},[e,(I=n.extendedDetails)==null?void 0:I.decisions]);const y=re.useMemo(()=>{let X=[...l];return v!==null&&X.sort((U,ee)=>{let te="",V="";switch(v.key){case"status":te=U.status==="undecided"?0:1,V=ee.status==="undecided"?0:1;break;case"date":te=U.date||"9999-12-31",V=ee.date||"9999-12-31";break;default:te=(U[v.key]||"").toLowerCase(),V=(ee[v.key]||"").toLowerCase()}return te<V?v.direction==="ascending"?-1:1:te>V?v.direction==="ascending"?1:-1:0}),X},[l,v]),w=X=>{let U="ascending";v&&v.key===X&&v.direction==="ascending"&&(U="descending"),_({key:X,direction:U})},b=X=>!v||v.key!==X?d.jsx(xi,{className:"w-3 h-3 ml-1 opacity-30 group-hover:opacity-100"}):v.direction==="ascending"?d.jsx(ao,{className:"w-3 h-3 ml-1 text-blue-600"}):d.jsx(xi,{className:"w-3 h-3 ml-1 text-blue-600"}),E=({sortKey:X,label:U,className:ee})=>d.jsx("th",{className:`p-0 border border-slate-300 ${ee||""}`,children:d.jsxs("button",{onClick:()=>w(X),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50 transition-colors",children:[d.jsx("span",{children:U}),b(X)]})}),j=async()=>{h(!0),p(null);try{const U=(await P4(n,l)).map(ee=>ee.id==="NEW"?{...ee,id:s("dec_ai")}:ee);o(U)}catch(X){p(X instanceof Error?X.message:"")}finally{h(!1)}},C=(X,U)=>{o(ee=>ee.map(te=>te.id===X?{...te,...U}:te))},S=(X,U)=>{const ee=l.find(V=>V.id===X);if(!ee)return;const te={status:U};U==="decided"&&!ee.date?te.date=new Date().toISOString().split("T")[0]:U==="undecided"&&(te.date=void 0),C(X,te)},L=X=>{o(U=>U.filter(ee=>ee.id!==X))},Z=()=>{const X={id:s("dec_manual"),question:"",status:"undecided"};o(U=>[X,...U])},W=()=>{r(l)};return e?d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex flex-col p-4 sm:p-6 md:p-8 z-[50]",children:d.jsxs("div",{className:"bg-slate-100 rounded-xl shadow-2xl w-full h-full flex flex-col",children:[d.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-slate-200 bg-white rounded-t-xl",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),d.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[d.jsxs("button",{onClick:j,disabled:u,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-cyan-600 rounded-md hover:bg-cyan-700 disabled:bg-slate-400",children:[u?d.jsx(Fr,{size:"sm",color:"border-white"}):d.jsx(To,{className:"w-5 h-5"}),d.jsx("span",{children:"AI"})]}),d.jsxs("button",{onClick:Z,disabled:u,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-slate-700 bg-slate-200 rounded-md hover:bg-slate-300 disabled:bg-slate-400",children:[d.jsx(Uh,{className:"w-5 h-5"}),d.jsx("span",{children:""})]}),d.jsx("button",{onClick:t,className:"p-1.5 rounded-full hover:bg-slate-100",children:d.jsx(na,{className:"w-6 h-6 text-slate-500"})})]})]}),x&&d.jsx("div",{className:"p-4",children:d.jsx(yi,{message:x})}),d.jsx("main",{className:"flex-grow p-4 overflow-auto",children:d.jsxs("table",{className:"w-full min-w-[1000px] border-collapse text-sm",children:[d.jsx("thead",{className:"sticky top-0 bg-slate-200 z-10",children:d.jsxs("tr",{children:[d.jsx(E,{sortKey:"status",label:"",className:"w-32"}),d.jsx(E,{sortKey:"question",label:" (Question)",className:"w-[25%]"}),d.jsx(E,{sortKey:"decision",label:" (Decision)",className:"w-[25%]"}),d.jsx(E,{sortKey:"reasoning",label:"/",className:"w-[25%]"}),d.jsx(E,{sortKey:"date",label:"",className:"w-36"}),d.jsx("th",{className:"p-2 border border-slate-300 w-16",children:""})]})}),d.jsxs("tbody",{children:[y.map(X=>d.jsxs("tr",{className:"bg-white hover:bg-slate-50 transition-colors",children:[d.jsx("td",{className:"border border-slate-300 align-top p-2",children:d.jsxs("select",{value:X.status,onChange:U=>S(X.id,U.target.value),className:`w-full p-2 rounded-md font-semibold text-xs border ${X.status==="decided"?"bg-green-100 text-green-800 border-green-200":"bg-yellow-100 text-yellow-800 border-yellow-200"}`,children:[d.jsx("option",{value:"undecided",children:""}),d.jsx("option",{value:"decided",children:""})]})}),d.jsx("td",{className:"border border-slate-300",children:d.jsx(rh,{value:X.question||"",onChange:U=>C(X.id,{question:U}),placeholder:""})}),d.jsx("td",{className:"border border-slate-300",children:d.jsx(rh,{value:X.decision||"",onChange:U=>C(X.id,{decision:U}),placeholder:"..."})}),d.jsx("td",{className:"border border-slate-300",children:d.jsx(rh,{value:X.reasoning||"",onChange:U=>C(X.id,{reasoning:U}),placeholder:"..."})}),d.jsx("td",{className:"border border-slate-300 align-top p-2",children:d.jsx("input",{type:"date",value:X.date||"",onChange:U=>C(X.id,{date:U.target.value}),className:"w-full bg-transparent border-b border-dotted border-slate-400 outline-none p-1 text-xs text-slate-600 focus:border-solid focus:border-blue-500 disabled:border-none disabled:bg-slate-100",disabled:X.status==="undecided"})}),d.jsx("td",{className:"border border-slate-300 text-center align-middle",children:d.jsx("button",{onClick:()=>L(X.id),className:"text-red-400 hover:text-red-700 p-1 rounded-full hover:bg-red-100 transition-colors",title:"",children:d.jsx(za,{className:"w-5 h-5"})})})]},X.id)),l.length===0&&d.jsx("tr",{children:d.jsx("td",{colSpan:6,className:"text-center py-12 text-slate-500 bg-white border border-slate-300",children:"AI"})})]})]})}),d.jsxs("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-end gap-3 rounded-b-xl",children:[d.jsx("button",{onClick:t,className:"px-5 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md shadow-sm hover:bg-slate-200",children:""}),d.jsx("button",{onClick:W,className:"px-5 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:""})]})]})}):null},K2=({items:e,taskName:t,onClose:r})=>{var p;const[n,s]=re.useState(null),l=re.useMemo(()=>new Set(e.map(v=>v.subStep.id)).size<=1,[e]),o=re.useMemo(()=>{let v=[...e];return n!==null&&v.sort((_,y)=>{let w="",b="";switch(n.key){case"status":w=_.actionItem.completed,b=y.actionItem.completed;break;case"dueDate":w=_.actionItem.dueDate||"9999-12-31",b=y.actionItem.dueDate||"9999-12-31";break;case"completedDate":w=_.actionItem.completedDate||"9999-12-31",b=y.actionItem.completedDate||"9999-12-31";break;case"text":w=(_.actionItem.text||"").toLowerCase(),b=(y.actionItem.text||"").toLowerCase();break;case"subStep":w=(_.subStep.text||"").toLowerCase(),b=(y.subStep.text||"").toLowerCase();break;case"responsible":w=(_.actionItem.responsible||"").toLowerCase(),b=(y.actionItem.responsible||"").toLowerCase();break}return w<b?n.direction==="ascending"?-1:1:w>b?n.direction==="ascending"?1:-1:0}),v},[e,n]),u=v=>{let _="ascending";n&&n.key===v&&n.direction==="ascending"&&(_="descending"),s({key:v,direction:_})},h=v=>!n||n.key!==v?d.jsx(xi,{className:"w-3 h-3 ml-1 opacity-30 group-hover:opacity-100"}):n.direction==="ascending"?d.jsx(ao,{className:"w-3 h-3 ml-1 text-blue-600"}):d.jsx(xi,{className:"w-3 h-3 ml-1 text-blue-600"}),x=({sortKey:v,label:_,className:y})=>d.jsx("th",{scope:"col",className:`p-0 ${y||""}`,children:d.jsxs("button",{onClick:()=>u(v),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50 transition-colors",children:[d.jsx("span",{children:_}),h(v)]})});return d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[80]",children:d.jsxs("div",{className:"bg-slate-100 rounded-xl shadow-2xl w-full max-w-6xl max-h-[90vh] flex flex-col",children:[d.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-slate-200 bg-white rounded-t-xl",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),d.jsx("p",{className:"text-sm text-slate-500",children:l?`: ${t} / : ${((p=e[0])==null?void 0:p.subStep.text)||""}`:`: ${t}`})]}),d.jsx("button",{onClick:r,className:"p-1.5 rounded-full hover:bg-slate-100",children:d.jsx(na,{className:"w-6 h-6 text-slate-500"})})]}),d.jsx("main",{className:"flex-grow p-4 overflow-auto",children:d.jsxs("table",{className:"w-full border-collapse text-sm",children:[d.jsx("thead",{className:"sticky top-0 bg-slate-200 z-10",children:d.jsxs("tr",{children:[d.jsx(x,{sortKey:"status",label:"",className:"w-28 border border-slate-300"}),d.jsx(x,{sortKey:"text",label:"",className:"w-2/5 border border-slate-300"}),!l&&d.jsx(x,{sortKey:"subStep",label:"",className:"w-1/5 border border-slate-300"}),d.jsx(x,{sortKey:"responsible",label:"",className:"w-40 border border-slate-300"}),d.jsx(x,{sortKey:"dueDate",label:"",className:"w-40 border border-slate-300"}),d.jsx(x,{sortKey:"completedDate",label:"",className:"w-40 border border-slate-300"})]})}),d.jsxs("tbody",{className:"bg-white",children:[o.map(({actionItem:v,subStep:_})=>{var y;return d.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[d.jsx("td",{className:"p-2 border border-slate-300 align-top text-center",children:v.completed?d.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[d.jsx(bo,{className:"w-4 h-4 mr-1"}),""]}):d.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800",children:[d.jsx(wu,{className:"w-4 h-4 mr-1"}),""]})}),d.jsxs("td",{className:"p-2 border border-slate-300 align-top font-medium text-slate-800",children:[v.text,v.report&&Array.isArray(v.report.attachments)&&v.report.attachments.length>0&&d.jsx("div",{className:"mt-2 pt-2 border-t border-slate-200 space-y-1",children:v.report.attachments.map(w=>d.jsxs("a",{href:w.dataUrl,target:"_blank",rel:"noopener noreferrer",download:w.name,className:"flex items-center gap-1.5 text-xs text-blue-600 hover:underline",children:[d.jsx(Ns,{className:"w-3.5 h-3.5"}),d.jsx("span",{children:w.name})]},w.id))}),((y=v.report)==null?void 0:y.notes)&&d.jsx("p",{className:"text-xs text-slate-500 mt-1 pt-1 border-t border-slate-200 whitespace-pre-wrap",children:v.report.notes})]}),!l&&d.jsx("td",{className:"p-2 border border-slate-300 align-top",children:_.text}),d.jsx("td",{className:"p-2 border border-slate-300 align-top",children:v.responsible||""}),d.jsx("td",{className:"p-2 border border-slate-300 align-top",children:v.dueDate||""}),d.jsx("td",{className:"p-2 border border-slate-300 align-top",children:v.completedDate||""})]},v.id)}),e.length===0&&d.jsx("tr",{children:d.jsx("td",{colSpan:l?5:6,className:"text-center py-10 text-slate-500",children:""})})]})]})}),d.jsx("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-end gap-3 rounded-b-xl",children:d.jsx("button",{onClick:r,className:"px-5 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:""})})]})})},n8=({task:e,isOpen:t,onClose:r,onReportGenerated:n})=>{const[s,l]=re.useState(""),[o,u]=re.useState(new Set),[h,x]=re.useState(!1),[p,v]=re.useState(null),_=re.useMemo(()=>{var S,L,Z,W;const C=[];return C.push({id:`task-data-${e.id}`,name:`: ${e.title}`,type:"Task Data",source:{name:`: ${e.title}`,type:"json",content:e}}),(L=(S=e.extendedDetails)==null?void 0:S.attachments)==null||L.forEach(I=>{C.push({id:I.id,name:`: ${I.name}`,type:"Attachment",source:{name:I.name,type:I.type.startsWith("image/")?"image":"text",content:I.dataUrl}})}),(W=(Z=e.extendedDetails)==null?void 0:Z.subSteps)==null||W.forEach(I=>{var X;(X=I.actionItems)==null||X.forEach(U=>{var ee,te,V;(ee=U.report)!=null&&ee.matrixData&&C.push({id:`matrix-${U.id}`,name:`: ${U.text} (${I.text})`,type:"Data Matrix",source:{name:`: ${U.text}`,type:"json",content:U.report.matrixData}}),(V=(te=U.report)==null?void 0:te.attachments)==null||V.forEach(ge=>{C.push({id:ge.id,name:`: ${ge.name} (${U.text})`,type:"Attachment",source:{name:ge.name,type:ge.type.startsWith("image/")?"image":"text",content:ge.dataUrl}})})})}),C},[e]),y=re.useMemo(()=>_.find(C=>C.type==="Task Data"),[_]),w=re.useMemo(()=>_.filter(C=>C.type!=="Task Data"),[_]);re.useEffect(()=>{if(t){const C=new Set;y&&C.add(y.id),u(C)}},[t,y]);const b=C=>{const S=_.find(L=>L.id===C);(S==null?void 0:S.type)!=="Task Data"&&u(L=>{const Z=new Set(L);return Z.has(C)?Z.delete(C):Z.add(C),Z})},E=async()=>{if(!s.trim()){v("");return}if(o.size===0){v("1");return}x(!0),v(null);try{const C=_.filter(L=>o.has(L.id)).map(L=>L.source),S=await C_(C,s);n(S)}catch(C){v(C instanceof Error?C.message:"")}finally{x(!1)}};if(!t)return null;const j=C=>{switch(C){case"Task Data":return d.jsx(hi,{className:"w-5 h-5 text-blue-600"});case"Attachment":return d.jsx(Ns,{className:"w-5 h-5 text-slate-600"});case"Data Matrix":return d.jsx(Eo,{className:"w-5 h-5 text-purple-600"});default:return d.jsx(hi,{className:"w-5 h-5 text-slate-500"})}};return d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[80]",children:d.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl max-h-[90vh] flex flex-col",children:[d.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-5 border-b border-slate-200",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),d.jsx("button",{onClick:r,className:"p-1 rounded-full hover:bg-slate-100",children:d.jsx(na,{className:"w-6 h-6 text-slate-500"})})]}),d.jsxs("main",{className:"flex-grow p-6 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-8",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-lg text-slate-800 mb-3",children:"1. "}),d.jsxs("div",{className:"mb-4",children:[d.jsx("p",{className:"text-xs text-slate-600 font-semibold mb-1",children:":"}),d.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-md bg-slate-200",children:[d.jsx("input",{type:"checkbox",checked:!0,disabled:!0,className:"w-4 h-4 accent-blue-600"}),y&&j(y.type),d.jsx("span",{className:"text-sm text-slate-800 font-medium truncate",title:y==null?void 0:y.name,children:y==null?void 0:y.name})]})]}),w.length>0&&d.jsxs(d.Fragment,{children:[d.jsx("p",{className:"text-xs text-slate-600 font-semibold mb-1",children:" ():"}),d.jsx("div",{className:"bg-slate-50 border rounded-lg p-3 max-h-80 overflow-y-auto space-y-2",children:w.map(C=>d.jsxs("label",{className:"flex items-center gap-3 p-2 rounded-md hover:bg-slate-100 cursor-pointer",children:[d.jsx("input",{type:"checkbox",checked:o.has(C.id),onChange:()=>b(C.id),className:"w-4 h-4 accent-blue-600"}),j(C.type),d.jsx("span",{className:"text-sm text-slate-700 truncate",title:C.name,children:C.name})]},C.id))})]})]}),d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-lg text-slate-800 mb-3",children:"2. "}),d.jsx("textarea",{value:s,onChange:C=>l(C.target.value),placeholder:"",rows:8,className:"w-full p-3 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition text-sm"}),p&&d.jsx("div",{className:"mt-2",children:d.jsx(yi,{message:p})})]})]}),d.jsxs("footer",{className:"flex-shrink-0 p-5 bg-slate-100 border-t flex justify-end items-center gap-4",children:[d.jsx("button",{onClick:r,className:"px-5 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50",children:""}),d.jsxs("button",{onClick:E,disabled:h,className:"flex items-center gap-2 px-6 py-2 text-sm font-medium text-white bg-green-600 rounded-md shadow-sm hover:bg-green-700 disabled:bg-slate-400",children:[h?d.jsx(Fr,{size:"sm",color:"border-white"}):d.jsx(To,{className:"w-5 h-5"}),d.jsx("span",{children:h?"...":""})]})]})]})})},xn=({label:e,name:t,value:r,onChange:n,type:s="text",placeholder:l,rows:o,disabled:u=!1,icon:h,required:x=!1})=>d.jsxs("div",{className:"mb-4",children:[d.jsxs("label",{htmlFor:t,className:"block text-sm font-medium text-slate-700 mb-1 flex items-center",children:[h&&d.jsx("span",{className:"mr-1.5 text-slate-500 w-4 h-4",children:h}),e,x&&d.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),s==="textarea"?d.jsx("textarea",{id:t,name:t,value:r,onChange:n,rows:o||3,placeholder:l,disabled:u,className:"w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm text-slate-900 bg-white placeholder-slate-400 disabled:bg-slate-100"}):d.jsx("input",{type:s,id:t,name:t,value:r,onChange:n,placeholder:l,disabled:u,className:"w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm text-slate-900 bg-white placeholder-slate-400 disabled:bg-slate-100"})]}),s8=Gn.memo(({subStep:e,onRemove:t,onDragStart:r,onClick:n,cardRef:s,isSelected:l,onStartConnection:o,onEndConnection:u})=>{var p,v;const h=_=>{switch(_){case Jr.COMPLETED:return"border-l-4 border-green-500";case Jr.IN_PROGRESS:return"border-l-4 border-blue-500";default:return"border-l-4 border-slate-300"}},x=_=>{_.stopPropagation(),o(e.id,_)};return d.jsxs("div",{ref:s,draggable:!0,onDragStart:_=>r(_,e.id),onClick:n,onMouseUp:_=>{_.stopPropagation(),u(e.id)},className:`substep-card absolute p-2.5 rounded-lg shadow-sm cursor-grab active:cursor-grabbing bg-white border w-56 h-auto min-h-[100px] text-xs flex flex-col hover:shadow-md transition-all duration-200 ${l?"ring-2 ring-blue-500 shadow-lg":"border-slate-300"} ${h(e.status)}`,style:{left:((p=e.position)==null?void 0:p.x)||0,top:((v=e.position)==null?void 0:v.y)||0,touchAction:"none"},children:[d.jsxs("div",{children:[d.jsxs("div",{className:"flex justify-between items-start text-slate-400 mb-1",children:[d.jsxs("span",{className:"font-mono text-[10px] select-none",children:["ID: ...",e.id.slice(-4)]}),d.jsx("button",{onClick:_=>{_.stopPropagation(),t()},className:"text-red-400 hover:text-red-600 p-0.5",title:"",children:d.jsx(za,{className:"w-3.5 h-3.5"})})]}),d.jsx("p",{className:`mb-1 break-words font-semibold text-slate-800 ${e.status===Jr.COMPLETED?"line-through text-slate-500":""}`,children:e.text||""})]}),d.jsx("div",{className:"flex-grow my-1 border-t pt-1 min-h-0",children:d.jsx("div",{className:"text-[10px] text-slate-600 space-y-1 h-full max-h-20 overflow-y-auto pr-1",children:(e.actionItems||[]).length>0?(e.actionItems||[]).map(_=>d.jsxs("div",{className:`flex justify-between items-center ${_.completed?"text-slate-400 line-through":""}`,children:[d.jsx("span",{className:"truncate pr-1",title:_.text,children:_.text}),_.dueDate&&d.jsx("span",{className:"flex-shrink-0 text-slate-500",children:new Date(_.dueDate+"T00:00:00Z").toLocaleDateString("ja-JP",{month:"numeric",day:"numeric"})})]},_.id)):d.jsx("div",{className:"text-center text-slate-400 pt-2",children:""})})}),d.jsx("div",{className:"mt-auto",children:e.dueDate&&d.jsxs("div",{className:"text-[11px] text-orange-600 font-medium flex items-center justify-end",children:[d.jsx(Ph,{className:"w-3 h-3 mr-1"}),": ",new Date(e.dueDate+"T00:00:00Z").toLocaleDateString("ja-JP",{year:"2-digit",month:"numeric",day:"numeric"})]})}),d.jsx("div",{onMouseDown:x,className:"absolute right-[-5px] top-1/2 -translate-y-1/2 w-3 h-3 bg-blue-500 rounded-full cursor-crosshair hover:scale-125 transition-transform",title:""})]})}),i8=Gn.memo(({items:e,onToggle:t,onAdd:r,onUpdate:n,onRemove:s,onOpenReport:l,onOpenTable:o})=>d.jsxs("div",{className:"space-y-2 mt-2",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("h6",{className:"text-sm font-semibold text-slate-600",children:""}),d.jsx("button",{onClick:o,className:"p-1 rounded-full hover:bg-slate-200",title:"",children:d.jsx(Eo,{className:"w-5 h-5 text-slate-500"})})]}),d.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto pr-2",children:e.map(u=>d.jsxs("div",{className:"group bg-slate-50 p-2 rounded-md transition-all border border-transparent hover:border-slate-200",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("button",{onClick:()=>t(u.id),className:"flex-shrink-0",children:u.completed?d.jsx(bo,{className:"w-5 h-5 text-green-600"}):d.jsx(wu,{className:"w-5 h-5 text-slate-400"})}),d.jsx("div",{className:"flex-grow",onDoubleClick:()=>l(u),children:d.jsx("input",{type:"text",value:u.text,onChange:h=>n(u.id,{text:h.target.value}),placeholder:"",className:`w-full text-sm bg-transparent outline-none p-1 rounded-sm focus:ring-1 focus:ring-blue-500 focus:bg-white ${u.completed?"line-through text-slate-500":"text-slate-800"}`})}),d.jsx("button",{onClick:()=>s(u.id),className:"ml-2 text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:d.jsx(za,{className:"w-4 h-4"})})]}),d.jsxs("div",{className:"pl-7 pt-1.5 flex justify-end items-center gap-4 text-xs text-slate-500",children:[u.completed&&u.completedDate?d.jsxs("span",{className:"text-xs text-green-600 font-medium flex items-center mr-auto",children:[d.jsx(wo,{className:"w-4 h-4 mr-1"}),": ",new Date(u.completedDate+"T00:00:00Z").toLocaleDateString("ja-JP")]}):d.jsx("div",{className:"mr-auto"}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("label",{htmlFor:`responsible-${u.id}`,className:"mr-1 flex items-center",title:"",children:d.jsx(y_,{className:"w-4 h-4"})}),d.jsx("input",{type:"text",id:`responsible-${u.id}`,value:u.responsible||"",onChange:h=>n(u.id,{responsible:h.target.value}),className:"bg-transparent border-b border-dotted border-slate-400 outline-none p-0.5 w-24 focus:border-solid focus:border-blue-500 disabled:border-none disabled:text-slate-400",placeholder:"",disabled:u.completed})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("label",{htmlFor:`due-date-${u.id}`,className:"mr-1",children:":"}),d.jsx("input",{type:"date",id:`due-date-${u.id}`,value:u.dueDate||"",onChange:h=>n(u.id,{dueDate:h.target.value}),className:"bg-transparent border-b border-dotted border-slate-400 outline-none p-0.5 w-28 focus:border-solid focus:border-blue-500 disabled:border-none disabled:text-slate-400",style:{colorScheme:"light"},title:"",disabled:u.completed})]})]})]},u.id))}),d.jsxs("button",{onClick:r,className:"mt-1 text-xs text-blue-600 hover:text-blue-800 font-medium flex items-center gap-1",children:[d.jsx(Uh,{className:"w-4 h-4"}),""]})]})),l8=({task:e,onClose:t,onUpdateTaskCoreInfo:r,onUpdateExtendedDetails:n,generateUniqueId:s,projectGoal:l,targetDate:o})=>{var O,B,k,R,M,F,ce,pe,ie,de,he,Ne,De,Me,Ce;if(!e)return null;const[u,h]=re.useState(e),[x,p]=re.useState(e),[v,_]=re.useState("none"),[y,w]=re.useState(!1),[b,E]=re.useState(!1),[j,C]=re.useState(!1),[S,L]=re.useState(!1),[Z,W]=re.useState(!1),[I,X]=re.useState(null),[U,ee]=re.useState(!1),[te,V]=re.useState(!1),[ge,Re]=re.useState([]),[Se,ae]=re.useState([]),[ue,Q]=re.useState(!1),[G,A]=re.useState(null),[K,N]=re.useState([]),P=re.useRef(null),[z,H]=re.useState(new Map),se=re.useRef(null),ve=re.useRef({x:0,y:0}),[be,Ae]=re.useState(null),ye=re.useRef(null),Ye=re.useRef(null),[Y,ot]=re.useState(null),[Xe,gt]=re.useState({x:0,y:0}),[Je,Oe]=re.useState([]),Ot=re.useMemo(()=>JSON.stringify(x)!==JSON.stringify(u),[x,u]),$t=re.useMemo(()=>{var _e;const q=((_e=u.extendedDetails)==null?void 0:_e.decisions)||[];return{decided:q.filter(Te=>Te.status==="decided").length,undecided:q.filter(Te=>Te.status==="undecided").length}},[(O=u.extendedDetails)==null?void 0:O.decisions]);re.useEffect(()=>{h(e),p(e),Re([]),ae([])},[e]),re.useEffect(()=>{var _e;const q=new Map;(((_e=u.extendedDetails)==null?void 0:_e.subSteps)||[]).forEach(Te=>{Te&&Te.id&&q.set(Te.id,z.get(Te.id)||Gn.createRef())}),H(q)},[(B=u.extendedDetails)==null?void 0:B.subSteps]);const Le=re.useCallback(()=>{var _e;if(!P.current){Oe([]);return}const q=[];(((_e=u.extendedDetails)==null?void 0:_e.subSteps)||[]).forEach(Te=>{var Ie,Ue;if((Ie=Te==null?void 0:Te.nextSubStepIds)!=null&&Ie.length){const tt=(Ue=z.get(Te.id))==null?void 0:Ue.current;if(tt&&Te.position){const vt={x:Te.position.x+tt.offsetWidth,y:Te.position.y+tt.offsetHeight/2};Te.nextSubStepIds.forEach(dt=>{var At,Oa;const kt=(At=u.extendedDetails)==null?void 0:At.subSteps.find(er=>er.id===dt),Qt=(Oa=z.get(dt))==null?void 0:Oa.current;if(kt&&Qt&&kt.position){const er={x:kt.position.x,y:kt.position.y+Qt.offsetHeight/2};q.push({id:`subconn-${Te.id}-${dt}`,from:vt,to:er,sourceId:Te.id,targetId:dt})}})}}}),Oe(q)},[(k=u.extendedDetails)==null?void 0:k.subSteps,z]);re.useEffect(()=>{const q=setTimeout(Le,100);return()=>clearTimeout(q)},[Le]);const Pe=re.useCallback(q=>{h(_e=>(Re(Te=>[...Te,_e]),ae([]),q(_e)))},[]),Ve=q=>{Pe(_e=>({..._e,...typeof q=="function"?q(_e):q}))},$e=q=>{Ve(_e=>({extendedDetails:{..._e.extendedDetails,...typeof q=="function"?q(_e.extendedDetails):q}}))},mr=()=>{if(ge.length===0)return;const q=ge[ge.length-1];Re(_e=>_e.slice(0,-1)),ae(_e=>[u,..._e]),h(q)},Rr=()=>{if(Se.length===0)return;const q=Se[0];ae(_e=>_e.slice(1)),Re(_e=>[..._e,u]),h(q)},pr=async()=>{Q(!0),A(null);try{const q=await B4(u);N(q),E(!0)}catch(q){A(q instanceof Error?q.message:"")}finally{Q(!1)}},Yt=q=>{$e(_e=>{const Te=_e.subSteps||[],Ie=Te.length,Ue=q.newSubSteps.map((vt,dt)=>({id:s("sub_ai"),text:vt.title,notes:vt.description,status:Jr.NOT_STARTED,actionItems:[],attachments:[],position:{x:10+(Ie+dt)%4*210,y:Math.floor((Ie+dt)/4)*90+10}}));return{subSteps:[...Te.map(vt=>{const dt=q.newActionItems.filter(Qt=>Qt.targetSubStepId===vt.id);if(dt.length===0)return vt;const kt=dt.map(Qt=>({id:s("action_ai"),text:Qt.title,completed:!1}));return{...vt,actionItems:[...vt.actionItems||[],...kt]}}),...Ue]}}),E(!1)},yt=()=>{var Te,Ie;const q=((Ie=(Te=u.extendedDetails)==null?void 0:Te.subSteps)==null?void 0:Ie.length)||0,_e={id:s("sub_new"),text:"",status:Jr.NOT_STARTED,actionItems:[],attachments:[],position:{x:10+q%4*210,y:Math.floor(q/4)*90+10}};$e(Ue=>({subSteps:[...Ue.subSteps||[],_e]})),Ae(_e.id)},Qe=re.useCallback((q,_e)=>{$e(Te=>({subSteps:(Te.subSteps||[]).map(Ie=>Ie.id===q?{...Ie,...typeof _e=="function"?_e(Ie):_e}:Ie)}))},[$e]),et=re.useCallback(q=>{Ae(_e=>_e===q?null:_e),$e(_e=>({subSteps:(_e.subSteps||[]).filter(Te=>Te.id!==q).map(Te=>{var Ie;return{...Te,nextSubStepIds:(Ie=Te.nextSubStepIds)==null?void 0:Ie.filter(Ue=>Ue!==q)}})}))},[$e]),Pt=()=>{var Bs;const q=(Bs=u.extendedDetails)==null?void 0:Bs.subSteps,_e=P.current;if(!q||q.length===0||!_e)return;const Te=new Map;q.forEach(Lt=>{var vr;const ht=(vr=z.get(Lt.id))==null?void 0:vr.current;Te.set(Lt.id,{width:(ht==null?void 0:ht.offsetWidth)||224,height:(ht==null?void 0:ht.offsetHeight)||100})});const Ie=new Map,Ue=new Map;q.forEach(Lt=>{Ie.set(Lt.id,[]),Ue.set(Lt.id,0)}),q.forEach(Lt=>{(Lt.nextSubStepIds||[]).forEach(ht=>{Ie.has(ht)&&(Ie.get(Lt.id).push(ht),Ue.set(ht,Ue.get(ht)+1))})});const tt=q.filter(Lt=>Ue.get(Lt.id)===0).map(Lt=>Lt.id),vt=[];let dt=0;for(;tt.length>0;){const Lt=tt.length,ht=[];for(let vr=0;vr<Lt;vr++){const Ps=tt.shift();ht.push(Ps),dt++,(Ie.get(Ps)||[]).forEach(qa=>{Ue.set(qa,Ue.get(qa)-1),Ue.get(qa)===0&&tt.push(qa)})}vt.push(ht)}if(dt<q.length){const Lt=new Set(vt.flat()),ht=q.filter(vr=>!Lt.has(vr.id)).map(vr=>vr.id);ht.length>0&&vt.push(ht)}const kt=_e.clientWidth,Qt=60,At=20,Oa=new Map;let er=10,Bl=10,Ai=0;vt.forEach(Lt=>{const vr=Math.max(...Lt.map(pa=>Te.get(pa).width))+Qt;let Ps=Lt.reduce((pa,Do)=>pa+Te.get(Do).height+At,0)-(Lt.length>0?At:0);er>10&&er+vr>kt&&(er=10,Bl+=Ai+At*2,Ai=0);let qa=0;Lt.forEach(pa=>{Oa.set(pa,{x:er,y:Bl+qa}),qa+=Te.get(pa).height+At}),er+=vr,Ai=Math.max(Ai,Ps)});let Kn=0,Ni=0;Oa.forEach((Lt,ht)=>{const vr=Te.get(ht);Kn=Math.max(Kn,Lt.x+vr.width),Ni=Math.max(Ni,Lt.y+vr.height)}),$e(Lt=>({subSteps:(Lt.subSteps||[]).map(ht=>({...ht,position:Oa.get(ht.id)||ht.position})),subStepCanvasSize:{width:Kn+20,height:Ni+20}}))},gr=(q,_e)=>{se.current=_e;const Te=q.currentTarget.getBoundingClientRect();ve.current={x:q.clientX-Te.left,y:q.clientY-Te.top},q.dataTransfer.effectAllowed="move"},Dt=q=>{q.preventDefault(),q.dataTransfer.dropEffect="move"},qt=q=>{var kt;if(q.preventDefault(),!se.current||!P.current)return;const _e=P.current.getBoundingClientRect(),Te=(kt=z.get(se.current))==null?void 0:kt.current;if(!Te)return;const Ie=Te.offsetWidth,Ue=Te.offsetHeight;let tt=q.clientX-_e.left-ve.current.x+P.current.scrollLeft,vt=q.clientY-_e.top-ve.current.y+P.current.scrollTop;const dt=P.current.querySelector(".substep-inner-canvas");dt&&(tt=Math.max(0,Math.min(tt,dt.scrollWidth-Ie)),vt=Math.max(0,Math.min(vt,dt.scrollHeight-Ue))),Qe(se.current,{position:{x:tt,y:vt}}),se.current=null},sa=q=>{X(q),C(!0)},xa=(q,_e)=>{var vt;const Te=(vt=q.target.files)==null?void 0:vt[0];if(!Te)return;const Ie=5,Ue=Ie*1024*1024;if(Te.size>Ue){alert(`${Ie}MB`),q.target&&(q.target.value="");return}const tt=new FileReader;tt.onload=dt=>{var kt;if(typeof((kt=dt.target)==null?void 0:kt.result)=="string"){const Qt={id:s("attach"),name:Te.name,type:Te.type,dataUrl:dt.target.result};_e==="task"?$e(At=>({attachments:[...At.attachments||[],Qt]})):_e==="substep"&&be&&Qe(be,At=>({attachments:[...At.attachments||[],Qt]}))}else alert("")},tt.onerror=()=>{alert("")},tt.readAsDataURL(Te),q.target&&(q.target.value="")},ma=(q,_e)=>{_e==="task"?$e(Te=>{var Ie;return{attachments:(Ie=Te.attachments)==null?void 0:Ie.filter(Ue=>Ue.id!==q)}}):_e==="substep"&&be&&Qe(be,Te=>{var Ie;return{attachments:(Ie=Te.attachments)==null?void 0:Ie.filter(Ue=>Ue.id!==q)}})},or=(q,_e)=>{if(!P.current)return;const Te=P.current.getBoundingClientRect(),Ie={x:_e.clientX-Te.left+P.current.scrollLeft,y:_e.clientY-Te.top+P.current.scrollTop};ot({fromId:q,fromPos:Ie})},sn=q=>{if(!Y)return;const{fromId:_e}=Y;if(_e===q){ot(null);return}Qe(_e,Te=>({...Te,nextSubStepIds:Array.from(new Set([...Te.nextSubStepIds||[],q]))})),ot(null)},Zr=(q,_e)=>{Qe(q,Te=>{var Ie;return{...Te,nextSubStepIds:(Ie=Te.nextSubStepIds)==null?void 0:Ie.filter(Ue=>Ue!==_e)}})},yn=q=>{if(!Y||!P.current)return;const _e=P.current.getBoundingClientRect();gt({x:q.clientX-_e.left+P.current.scrollLeft,y:q.clientY-_e.top+P.current.scrollTop})},Ya=()=>{Y&&ot(null)},ln=(q,_e)=>{Qe(q,Te=>{var Ie;return{actionItems:(Ie=Te.actionItems)==null?void 0:Ie.map(Ue=>Ue.id===_e.id?_e:Ue)}}),C(!1),X(null)},qn=(q,_e,Te)=>{Qe(q,Ie=>{var Ue;return{actionItems:(Ue=Ie.actionItems)==null?void 0:Ue.map(tt=>tt.id===_e?{...tt,...Te}:tt)}})},Xn=(q,_e)=>{$e(Te=>({subSteps:(Te.subSteps||[]).map(Ue=>{var Qt;if(Ue.id!==q)return Ue;const tt=(Qt=Ue.actionItems)==null?void 0:Qt.map(At=>{if(At.id!==_e)return At;const Oa=!At.completed;return{...At,completed:Oa,completedDate:Oa?new Date().toISOString().split("T")[0]:void 0}}),vt=tt==null?void 0:tt.every(At=>At.completed),dt=tt==null?void 0:tt.some(At=>At.completed);let kt=Ue.status;return tt&&tt.length>0?vt?kt=Jr.COMPLETED:dt?kt=Jr.IN_PROGRESS:kt=Jr.NOT_STARTED:kt=Jr.NOT_STARTED,{...Ue,actionItems:tt,status:kt}})}))},wn=q=>{Qe(q,_e=>({actionItems:[..._e.actionItems||[],{id:s("action"),text:"",completed:!1}]}))},bn=(q,_e)=>{Qe(q,Te=>{var Ie;return{actionItems:(Ie=Te.actionItems)==null?void 0:Ie.filter(Ue=>Ue.id!==_e)}})},Wn=()=>{r(u.id,{title:u.title,description:u.description,status:u.status}),n(u.id,u.extendedDetails),t()},Us=q=>{$e({reportDeck:q})},ia=()=>{W(!0)},Kt=q=>{$e({reportDeck:q}),W(!1),w(!0)},Jt=()=>{if(!Ot){t();return}window.confirm(`

OK
`)&&t()},Ca=q=>{$e({decisions:q}),L(!1)},Rt=((M=(R=u.extendedDetails)==null?void 0:R.subSteps)==null?void 0:M.find(q=>q.id===be))||null,Zn=(q,_e)=>d.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 mt-1 max-h-40 overflow-y-auto p-2 border rounded-md bg-slate-50",children:!q||q.length===0?d.jsx("p",{className:"col-span-full text-center text-xs text-slate-400 py-2",children:""}):q.map(Te=>d.jsxs("div",{className:"relative group border rounded-md overflow-hidden bg-white shadow-sm h-20",children:[d.jsx("a",{href:Te.dataUrl,download:Te.name,className:"block w-full h-full","aria-label":`Download ${Te.name}`,children:Te.type.startsWith("image/")?d.jsx("img",{src:Te.dataUrl,alt:Te.name,className:"w-full h-full object-cover"}):d.jsx("div",{className:"w-full h-full bg-slate-100 flex flex-col items-center justify-center p-1 hover:bg-slate-200",children:d.jsx(Ns,{className:"w-8 h-8 text-slate-500"})})}),d.jsx("div",{className:"absolute bottom-0 w-full bg-black bg-opacity-60 p-1 pointer-events-none",children:d.jsx("p",{className:"text-white text-[10px] truncate",title:Te.name,children:Te.name})}),d.jsx("button",{onClick:()=>_e(Te.id),className:"absolute top-1 right-1 bg-black bg-opacity-70 text-white rounded-full p-0.5 opacity-0 group-hover:opacity-100 transition-opacity z-10",children:d.jsx(za,{className:"w-3 h-3"})})]},Te.id))});return y&&((F=u.extendedDetails)!=null&&F.reportDeck)?d.jsx(zh,{tasks:[u],initialDeck:u.extendedDetails.reportDeck,onSave:Us,onClose:()=>w(!1),generateUniqueId:s,projectGoal:l,targetDate:o,reportScope:"task"}):b?d.jsx(Zk,{proposals:K,existingSubSteps:((ce=u.extendedDetails)==null?void 0:ce.subSteps)||[],onConfirm:Yt,onClose:()=>E(!1)}):j&&I&&Rt?d.jsx(r8,{actionItem:I,onSave:q=>ln(Rt.id,q),onClose:()=>C(!1),generateUniqueId:s}):d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"min-h-screen bg-slate-100 flex flex-col",children:[d.jsx("header",{className:"flex-shrink-0 bg-white shadow-md z-10 sticky top-0",children:d.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-5 w-full max-w-screen-2xl mx-auto",children:[d.jsxs("h3",{className:"text-lg sm:text-xl font-bold text-slate-800 truncate pr-2",children:[u.title," - "]}),d.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[d.jsx("button",{onClick:Jt,className:"px-3 sm:px-5 py-2 bg-slate-200 text-slate-700 text-sm font-medium rounded-md hover:bg-slate-300",children:""}),d.jsx("button",{onClick:Wn,className:"px-3 sm:px-5 py-2 bg-blue-600 text-white text-sm font-semibold rounded-md hover:bg-blue-700",children:""}),d.jsx("button",{onClick:ia,className:"px-3 sm:px-5 py-2 bg-purple-600 text-white text-sm font-semibold rounded-md hover:bg-purple-700",children:""})]})]})}),d.jsx("main",{className:"flex-grow p-4 sm:p-6 overflow-hidden w-full max-w-screen-2xl mx-auto",children:d.jsxs("div",{className:"flex gap-6 h-full",children:[d.jsxs("section",{className:`flex flex-col space-y-4 bg-white p-4 rounded-lg shadow-sm border transition-all duration-300 ease-in-out
                  ${v==="info"?"flex-1":v==="none"?"w-[360px] min-w-[360px]":"w-0 p-0 m-0 border-0 overflow-hidden opacity-0"}`,children:[d.jsxs("div",{className:"flex items-center justify-between border-b pb-2",children:[d.jsxs("h4",{className:"text-lg font-semibold text-slate-700 flex items-center",children:[d.jsx(HS,{className:"w-5 h-5 mr-2 text-purple-600"}),""]}),d.jsx("button",{onClick:()=>_(v==="info"?"none":"info"),className:"p-1 text-slate-500 hover:text-blue-600",title:v==="info"?"":"",children:v==="info"?d.jsx(Gd,{className:"w-5 h-5"}):d.jsx(zd,{className:"w-5 h-5"})})]}),d.jsxs("div",{className:"flex-grow overflow-y-auto pr-2",children:[d.jsx(xn,{label:"",name:"title",value:u.title,onChange:q=>Ve({title:q.target.value}),required:!0}),d.jsx(xn,{label:"",name:"description",value:u.description,onChange:q=>Ve({description:q.target.value}),type:"textarea",rows:3,required:!0}),d.jsx(xn,{icon:d.jsx(y_,{}),label:"/",name:"responsible",value:u.extendedDetails.responsible,onChange:q=>$e({responsible:q.target.value})}),d.jsx(xn,{icon:d.jsx(Ph,{}),label:"",name:"dueDate",type:"date",value:u.extendedDetails.dueDate||"",onChange:q=>$e({dueDate:q.target.value})}),d.jsxs("div",{children:[d.jsx(xn,{icon:d.jsx(WS,{}),label:"",name:"resources",value:u.extendedDetails.resources,onChange:q=>$e({resources:q.target.value}),type:"textarea"}),(pe=u.extendedDetails)!=null&&pe.resourceMatrix?d.jsx("div",{className:"mt-2",children:d.jsx(yw,{matrixData:u.extendedDetails.resourceMatrix,onUpdate:q=>$e({resourceMatrix:q})})}):d.jsxs("button",{onClick:()=>$e({resourceMatrix:{headers:["",""],rows:[["",""]]}}),className:"mt-1 text-xs text-blue-600 hover:text-blue-800 font-medium flex items-center gap-1",children:[d.jsx(Eo,{className:"w-4 h-4"}),""]})]}),d.jsx(xn,{icon:d.jsx(XS,{}),label:"",name:"notes",value:u.extendedDetails.notes,onChange:q=>$e({notes:q.target.value}),type:"textarea",rows:4}),d.jsx("div",{className:"pt-4 border-t mt-4",children:d.jsxs("button",{onClick:()=>L(!0),className:"w-full text-left p-3 bg-cyan-50 hover:bg-cyan-100 rounded-lg text-cyan-800 font-semibold flex justify-between items-center",children:[d.jsxs("span",{className:"flex items-center gap-2",children:[d.jsx(T_,{className:"w-5 h-5 text-cyan-600"}),""]}),d.jsxs("div",{className:"flex gap-2 text-xs",children:[d.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-green-200 text-green-800",children:[": ",$t.decided]}),d.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-yellow-200 text-yellow-800",children:[": ",$t.undecided]})]})]})}),d.jsxs("div",{className:"pt-4",children:[d.jsxs("label",{className:"flex items-center justify-between text-sm font-medium text-slate-700 mb-1",children:["",d.jsx("button",{onClick:()=>{var q;return(q=ye.current)==null?void 0:q.click()},className:"p-1 hover:bg-slate-100 rounded-full",title:"",children:d.jsx(Ns,{className:"w-4 h-4 text-slate-600"})})]}),Zn((ie=u.extendedDetails)==null?void 0:ie.attachments,q=>ma(q,"task")),d.jsx("input",{type:"file",ref:ye,onChange:q=>xa(q,"task"),className:"hidden"})]}),d.jsxs("div",{className:"pt-4",children:[d.jsxs("h4",{className:"text-lg font-semibold text-slate-700 mb-3 border-b pb-2 flex items-center",children:[d.jsx(Bh,{className:"w-5 h-5 mr-2 text-yellow-500"}),"AI"]}),d.jsx("button",{onClick:pr,disabled:ue,className:"w-full px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md shadow-sm hover:bg-indigo-700 disabled:bg-slate-400",children:ue?d.jsx(Fr,{size:"sm"}):"AI"}),G&&d.jsx("div",{className:"mt-2",children:d.jsx(yi,{message:G})})]})]})]}),d.jsxs("section",{className:`flex flex-col space-y-4 min-w-0 transition-all duration-300 ease-in-out
                  ${v==="canvas"||v==="none"?"flex-1":"hidden"}`,children:[d.jsxs("div",{className:"flex items-center justify-between border-b pb-2",children:[d.jsxs("h4",{className:"text-lg font-semibold text-slate-700 flex items-center",children:[d.jsx(VS,{className:"w-5 h-5 mr-2 text-blue-600"}),""]}),d.jsxs("div",{className:"flex gap-2 items-center",children:[d.jsx("button",{onClick:mr,disabled:ge.length===0,className:"text-xs px-2 py-1 bg-slate-200 text-slate-700 rounded-md hover:bg-slate-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1",title:"",children:d.jsx(b_,{className:"w-3 h-3"})}),d.jsx("button",{onClick:Rr,disabled:Se.length===0,className:"text-xs px-2 py-1 bg-slate-200 text-slate-700 rounded-md hover:bg-slate-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1",title:"",children:d.jsx(E_,{className:"w-3 h-3"})}),d.jsxs("button",{onClick:yt,className:"text-xs px-2 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 flex items-center gap-1",children:[d.jsx(di,{className:"w-3 h-3"}),""]}),d.jsxs("button",{onClick:Pt,className:"text-xs px-2 py-1 bg-slate-200 text-slate-700 rounded-md hover:bg-slate-300 flex items-center gap-1",title:"",children:[d.jsx(bu,{className:"w-3 h-3"}),""]}),d.jsx("button",{onClick:()=>_(v==="canvas"?"none":"canvas"),className:"p-1 text-slate-500 hover:text-blue-600",title:v==="canvas"?"":"",children:v==="canvas"?d.jsx(Gd,{className:"w-5 h-5"}):d.jsx(zd,{className:"w-5 h-5"})})]})]}),d.jsx("div",{ref:P,onMouseMove:yn,onMouseUp:Ya,onDragOver:Dt,onDrop:qt,className:`substep-canvas relative border rounded-md bg-white p-2 overflow-auto shadow-inner ${v==="canvas"?"":"flex-grow"}`,children:d.jsxs("div",{className:"substep-inner-canvas relative",style:{width:`${((he=(de=u.extendedDetails)==null?void 0:de.subStepCanvasSize)==null?void 0:he.width)||1200}px`,height:`${((De=(Ne=u.extendedDetails)==null?void 0:Ne.subStepCanvasSize)==null?void 0:De.height)||800}px`},children:[(((Me=u.extendedDetails)==null?void 0:Me.subSteps)||[]).map(q=>q?d.jsx(s8,{subStep:q,cardRef:z.get(q.id),isSelected:be===q.id,onClick:()=>Ae(q.id),onRemove:()=>et(q.id),onDragStart:gr,onStartConnection:or,onEndConnection:sn},q.id):null),Je.map(q=>d.jsx(so,{from:q.from,to:q.to,id:q.id,onDelete:()=>Zr(q.sourceId,q.targetId)},q.id)),Y&&d.jsx(so,{from:Y.fromPos,to:Xe,id:"preview-connector"})]})})]}),d.jsxs("section",{className:`flex flex-col space-y-4 bg-white p-4 rounded-lg shadow-sm border transition-all duration-300 ease-in-out
                  ${v==="details"?"flex-1":v==="none"?"w-[360px] min-w-[360px]":"hidden"}`,children:[d.jsx("div",{className:"mb-0",children:d.jsx("button",{onClick:()=>V(!0),className:"w-full text-left p-3 bg-indigo-50 hover:bg-indigo-100 rounded-lg text-indigo-800 font-semibold flex justify-between items-center",children:d.jsxs("span",{className:"flex items-center gap-2",children:[d.jsx(bo,{className:"w-5 h-5 text-indigo-600"}),""]})})}),d.jsxs("div",{className:"flex items-center justify-between border-b pb-2",children:[d.jsx("h5",{className:"text-lg font-semibold text-slate-800",children:""}),d.jsx("button",{onClick:()=>_(v==="details"?"none":"details"),disabled:!Rt,className:"p-1 text-slate-500 hover:text-blue-600 disabled:text-slate-300 disabled:cursor-not-allowed",title:v==="details"?"":"",children:v==="details"?d.jsx(Gd,{className:"w-5 h-5"}):d.jsx(zd,{className:"w-5 h-5"})})]}),d.jsx("div",{className:"flex-grow overflow-y-auto pr-2",children:Rt?d.jsxs("div",{className:"space-y-4",children:[d.jsx(xn,{label:"",name:"text",value:Rt.text,onChange:q=>Qe(Rt.id,{text:q.target.value}),type:"textarea"}),d.jsx(xn,{label:"",name:"responsible",value:Rt.responsible||"",onChange:q=>Qe(Rt.id,{responsible:q.target.value})}),d.jsx(xn,{label:"",name:"dueDate",type:"date",value:Rt.dueDate||"",onChange:q=>Qe(Rt.id,{dueDate:q.target.value})}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:""}),d.jsx("select",{value:Rt.status||Jr.NOT_STARTED,onChange:q=>Qe(Rt.id,{status:q.target.value}),className:"w-full p-2 border rounded-md text-sm bg-white text-slate-900",children:Object.values(Jr).map(q=>d.jsx("option",{value:q,children:q},q))})]}),d.jsx(xn,{label:"",name:"notes",value:Rt.notes||"",onChange:q=>Qe(Rt.id,{notes:q.target.value}),type:"textarea"}),d.jsx(i8,{items:Rt.actionItems||[],onToggle:q=>Xn(Rt.id,q),onAdd:()=>wn(Rt.id),onUpdate:(q,_e)=>qn(Rt.id,q,_e),onRemove:q=>bn(Rt.id,q),onOpenReport:sa,onOpenTable:()=>ee(!0)}),d.jsxs("div",{children:[d.jsxs("label",{className:"flex items-center justify-between text-sm font-medium text-slate-700 mb-1",children:["",d.jsx("button",{onClick:()=>{var q;return(q=Ye.current)==null?void 0:q.click()},className:"p-1 hover:bg-slate-100 rounded-full",title:"",children:d.jsx(Ns,{className:"w-4 h-4 text-slate-600"})})]}),Zn(Rt.attachments,q=>ma(q,"substep")),d.jsx("input",{type:"file",ref:Ye,onChange:q=>xa(q,"substep"),className:"hidden"})]})]}):d.jsx("div",{className:"flex items-center justify-center h-full text-center text-slate-500 text-sm",children:d.jsxs("p",{children:["",d.jsx("br",{}),""]})})})]})]})})]}),S&&d.jsx(a8,{task:u,isOpen:S,onClose:()=>L(!1),onSave:Ca,generateUniqueId:s}),te&&d.jsx(K2,{items:(((Ce=u.extendedDetails)==null?void 0:Ce.subSteps)||[]).flatMap(q=>(q.actionItems||[]).map(_e=>({actionItem:_e,subStep:q}))),taskName:u.title,onClose:()=>V(!1)}),U&&Rt&&d.jsx(K2,{items:(Rt.actionItems||[]).map(q=>({actionItem:q,subStep:Rt})),taskName:u.title,onClose:()=>ee(!1)}),Z&&d.jsx(n8,{task:u,isOpen:Z,onClose:()=>W(!1),onReportGenerated:Kt})]})},c8=({onClose:e,onSubmit:t})=>{const[r,n]=re.useState(""),[s,l]=re.useState(""),[o,u]=re.useState(""),h=x=>{if(x.preventDefault(),!r.trim()){u("");return}if(!s.trim()){u("");return}t({title:r,description:s}),u("")};return d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:d.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg",children:[d.jsxs("header",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),d.jsx("button",{onClick:e,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",title:"","aria-label":"",children:d.jsx(na,{className:"w-6 h-6"})})]}),d.jsxs("form",{onSubmit:h,children:[d.jsxs("div",{className:"p-6 space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"taskTitle",className:"block text-sm font-medium text-slate-700 mb-1",children:""}),d.jsx("input",{type:"text",id:"taskTitle",value:r,onChange:x=>n(x.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base text-slate-800 placeholder-slate-500",placeholder:": "})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"taskDescription",className:"block text-sm font-medium text-slate-700 mb-1",children:""}),d.jsx("textarea",{id:"taskDescription",value:s,onChange:x=>l(x.target.value),rows:3,className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base text-slate-800 placeholder-slate-500",placeholder:": "})]}),o&&d.jsx("p",{className:"text-sm text-red-600",children:o})]}),d.jsxs("footer",{className:"p-6 bg-slate-50 border-t border-slate-200 flex justify-end space-x-3 rounded-b-xl",children:[d.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:""}),d.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:""})]})]})]})})},o8=({onSetApiKey:e,error:t,isLoading:r})=>{const[n,s]=re.useState(""),l=o=>{o.preventDefault(),e(n)};return d.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:[d.jsxs("div",{className:"w-full max-w-md bg-white shadow-2xl rounded-xl p-8",children:[d.jsxs("div",{className:"text-center mb-8",children:[d.jsx(To,{className:"w-12 h-12 mx-auto text-blue-600 mb-4"}),d.jsx("h1",{className:"text-3xl font-bold text-slate-800",children:"AI Project Planner"}),d.jsx("p",{className:"text-slate-600 mt-2",children:"Google Gemini API"})]}),d.jsxs("form",{onSubmit:l,className:"space-y-6",children:[d.jsxs("div",{children:[d.jsxs("label",{htmlFor:"apiKey",className:"block text-sm font-semibold text-slate-700 mb-2 flex items-center",children:[d.jsx(no,{className:"w-5 h-5 mr-2 text-slate-500"}),"Gemini API Key"]}),d.jsx("input",{id:"apiKey",type:"password",value:n,onChange:o=>s(o.target.value),placeholder:"API",className:"w-full px-4 py-3 bg-slate-100 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out text-base text-slate-800 placeholder-slate-400"})]}),t&&d.jsx("p",{className:"text-sm text-red-600 bg-red-100 p-3 rounded-md",children:t}),d.jsx("button",{type:"submit",disabled:r||!n,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-150 ease-in-out flex items-center justify-center",children:r?d.jsx(Fr,{size:"sm"}):""})]}),d.jsxs("div",{className:"text-center mt-6",children:[d.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline",children:"API"}),d.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"API"})]})]}),d.jsx("footer",{className:"mt-8 text-center",children:d.jsx("p",{className:"text-slate-400 text-sm",children:"Powered by Gemini API"})})]})},u8=({isOpen:e,onClose:t,onSuccess:r})=>{const[n,s]=re.useState(!0),[l,o]=re.useState(""),[u,h]=re.useState(""),[x,p]=re.useState(!1),[v,_]=re.useState(null),y=async w=>{w.preventDefault(),p(!0),_(null);try{if(n){const{error:b}=await ar.auth.signInWithPassword({email:l,password:u});if(b)throw b}else{const{error:b}=await ar.auth.signUp({email:l,password:u});if(b)throw b}r()}catch(b){_(b instanceof Error?b.message:"")}finally{p(!1)}};return e?d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[100]",children:d.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md",children:[d.jsxs("header",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[d.jsxs("h3",{className:"text-xl font-bold text-slate-800 flex items-center",children:[d.jsx(no,{className:"w-6 h-6 mr-2 text-blue-600"}),n?"":""]}),d.jsx("button",{onClick:t,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",children:d.jsx(na,{className:"w-5 h-5"})})]}),d.jsxs("form",{onSubmit:y,className:"p-6 space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-700 mb-1",children:""}),d.jsx("input",{type:"email",id:"email",value:l,onChange:w=>o(w.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-700 mb-1",children:""}),d.jsx("input",{type:"password",id:"password",value:u,onChange:w=>h(w.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0,minLength:6})]}),v&&d.jsx("div",{className:"text-sm text-red-600 bg-red-100 p-3 rounded-md",children:v}),d.jsx("button",{type:"submit",disabled:x,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-150 ease-in-out flex items-center justify-center",children:x?d.jsx(Fr,{size:"sm",color:"border-white"}):n?"":""}),d.jsx("div",{className:"text-center",children:d.jsx("button",{type:"button",onClick:()=>s(!n),className:"text-sm text-blue-600 hover:underline",children:n?"":""})})]})]})}):null},f8=({isOpen:e,onClose:t,onSelectProject:r,onCreateNew:n})=>{const[s,l]=re.useState([]),[o,u]=re.useState(!1),[h,x]=re.useState(null),p=async()=>{u(!0),x(null);try{const y=await Bn.getProjects();l(y)}catch(y){x(y instanceof Error?y.message:"")}finally{u(!1)}};re.useEffect(()=>{e&&p()},[e]);const v=async(y,w)=>{if(w.stopPropagation(),!!confirm(""))try{await Bn.deleteProject(y),await p()}catch(b){x(b instanceof Error?b.message:"")}},_=y=>{const w={projectGoal:y.goal,targetDate:y.targetDate,tasks:y.tasks,ganttData:y.ganttData},b=JSON.stringify(w,null,2),E=new Blob([b],{type:"application/json"}),j=URL.createObjectURL(E),C=document.createElement("a");C.href=j,C.download=`${y.title}.json`,document.body.appendChild(C),C.click(),document.body.removeChild(C),URL.revokeObjectURL(j)};return e?d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[100]",children:d.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[d.jsxs("header",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsxs("button",{onClick:n,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[d.jsx(di,{className:"w-5 h-5"}),""]}),d.jsx("button",{onClick:t,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",children:d.jsx(na,{className:"w-6 h-6"})})]})]}),d.jsxs("div",{className:"flex-grow p-6 overflow-y-auto",children:[h&&d.jsx(yi,{message:h}),o?d.jsx("div",{className:"flex items-center justify-center py-12",children:d.jsx(Fr,{size:"lg",text:"..."})}):s.length===0?d.jsxs("div",{className:"text-center py-12",children:[d.jsx("p",{className:"text-slate-500 text-lg mb-4",children:""}),d.jsxs("button",{onClick:n,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 mx-auto",children:[d.jsx(di,{className:"w-5 h-5"}),""]})]}):d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(y=>d.jsxs("div",{onClick:()=>r(y),className:"bg-slate-50 rounded-lg p-4 cursor-pointer hover:bg-slate-100 transition-colors border border-slate-200 hover:border-blue-300",children:[d.jsxs("div",{className:"flex items-start justify-between mb-3",children:[d.jsx("h4",{className:"font-semibold text-slate-800 truncate flex-grow",children:y.title}),d.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[d.jsx("button",{onClick:w=>{w.stopPropagation(),_(y)},className:"p-1 text-slate-500 hover:text-blue-600 rounded",title:"JSON",children:d.jsx(Nl,{className:"w-4 h-4"})}),d.jsx("button",{onClick:w=>v(y.id,w),className:"p-1 text-slate-500 hover:text-red-600 rounded",title:"",children:d.jsx(za,{className:"w-4 h-4"})})]})]}),d.jsxs("div",{className:"space-y-2 text-sm text-slate-600",children:[d.jsxs("p",{className:"flex items-start",children:[d.jsx(Fh,{className:"w-4 h-4 mr-2 text-blue-600 flex-shrink-0 mt-0.5"}),d.jsx("span",{className:"line-clamp-2",children:y.goal})]}),d.jsxs("p",{className:"flex items-center",children:[d.jsx(Lh,{className:"w-4 h-4 mr-2 text-blue-600 flex-shrink-0"}),new Date(y.targetDate+"T00:00:00Z").toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"})]}),d.jsxs("p",{className:"text-xs text-slate-500",children:[": ",y.tasks.length," | : ",new Date(y.updatedAt).toLocaleDateString("ja-JP")]})]})]},y.id))})]})]})}):null},d8=({isOpen:e,onClose:t,onSuccess:r})=>{const[n,s]=re.useState(""),[l,o]=re.useState(!1),[u,h]=re.useState(null),[x,p]=re.useState(!1);re.useEffect(()=>{const y=new URLSearchParams(window.location.search).get("invite");y&&s(y)},[]);const v=async _=>{if(_.preventDefault(),!!n.trim()){o(!0),h(null);try{const y=await Ha.acceptInvitation(n);y.success&&y.projectId?(p(!0),setTimeout(()=>{r(y.projectId),t()},2e3)):h(y.error||"")}catch(y){h(y instanceof Error?y.message:"")}finally{o(!1)}}};return e?d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[100]",children:d.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md",children:[d.jsxs("header",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[d.jsx("h3",{className:"text-xl font-bold text-slate-800",children:""}),d.jsx("button",{onClick:t,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",children:d.jsx(na,{className:"w-6 h-6"})})]}),d.jsx("div",{className:"p-6",children:x?d.jsxs("div",{className:"text-center",children:[d.jsx(wo,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),d.jsx("h4",{className:"text-lg font-semibold text-green-800 mb-2",children:""}),d.jsx("p",{className:"text-slate-600",children:"..."})]}):d.jsxs("form",{onSubmit:v,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"token",className:"block text-sm font-medium text-slate-700 mb-1",children:""}),d.jsx("input",{type:"text",id:"token",value:n,onChange:_=>s(_.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md",placeholder:"",required:!0}),d.jsx("p",{className:"text-xs text-slate-500 mt-1",children:""})]}),u&&d.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-md",children:[d.jsx(El,{className:"w-5 h-5 text-red-500"}),d.jsx("p",{className:"text-sm text-red-700",children:u})]}),d.jsxs("div",{className:"flex gap-3",children:[d.jsx("button",{type:"submit",disabled:l||!n.trim(),className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-slate-400 flex items-center justify-center",children:l?d.jsx(Fr,{size:"sm",color:"border-white"}):""}),d.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 bg-slate-200 text-slate-700 rounded-md hover:bg-slate-300",children:""})]})]})})]})}):null},J2={subSteps:[],resources:"",responsible:"",notes:"",numericalTarget:void 0,dueDate:"",reportDeck:void 0,resourceMatrix:null,attachments:[],decisions:[],subStepCanvasSize:{width:1200,height:800}},h8=e=>({x:10,y:e*90+10});function x8(){const[e,t]=re.useState("input"),[r,n]=re.useState([]),[s,l]=re.useState(null),[o,u]=re.useState(null),[h,x]=re.useState(!1),[p,v]=re.useState(!1),[_,y]=re.useState(!1),[w,b]=re.useState(null),[E,j]=re.useState(!1),[C,S]=re.useState(null),[L,Z]=re.useState(!1),[W,I]=re.useState(!1),[X,U]=re.useState(null),[ee,te]=re.useState(null),[V,ge]=re.useState(!1),[Re,Se]=re.useState(!1),[ae,ue]=re.useState(null);re.useEffect(()=>{(async()=>{const{data:{user:Ve}}=await ar.auth.getUser();U(Ve)})();const{data:{subscription:Pe}}=ar.auth.onAuthStateChange((Ve,$e)=>{U(($e==null?void 0:$e.user)||null)});return()=>Pe.unsubscribe()},[]),re.useEffect(()=>{const Pe=new URLSearchParams(window.location.search).get("invitation");Pe&&(ue(Pe),Se(!0))},[]);const Q=re.useCallback(async Le=>{ee?(b(Le),y(!0)):await G(Le)},[ee]),G=re.useCallback(async Le=>{const Pe=Le.tasks.map(Ve=>({...Ve,extendedDetails:{...J2}}));if(n(Pe),t("flow"),u(null),X)try{const Ve=await Bn.createProject({title:Le.title,goal:Le.goal,targetDate:Le.targetDate,tasks:Pe,ganttData:Le.ganttData||null});te(Ve)}catch(Ve){console.error("Failed to save project:",Ve),u("Failed to save project. You can continue working, but changes won't be saved.")}},[X]),A=re.useCallback(async()=>{w&&(await G(w),b(null)),y(!1)},[w,G]),K=re.useCallback(Le=>{l(Le)},[]),N=re.useCallback(async Le=>{const Pe=r.map(Ve=>Ve.id===Le.id?Le:Ve);if(n(Pe),l(Le),ee&&X)try{await Bn.updateProject(ee.id,{tasks:Pe,lastModifiedBy:X.id}),await Ha.logActivity(ee.id,X.id,"task_updated",{taskId:Le.id,taskTitle:Le.title})}catch(Ve){console.error("Failed to update project:",Ve),u("Failed to save changes. Please try again.")}},[r,ee,X]),P=re.useCallback(async Le=>{const Pe={...Le,id:Date.now().toString(),extendedDetails:{...J2}},Ve=[...r,Pe];if(n(Ve),v(!1),ee&&X)try{await Bn.updateProject(ee.id,{tasks:Ve,lastModifiedBy:X.id}),await Ha.logActivity(ee.id,X.id,"task_created",{taskId:Pe.id,taskTitle:Pe.title})}catch($e){console.error("Failed to save new task:",$e),u("Failed to save new task. Please try again.")}},[r,ee,X]),z=re.useCallback(async Le=>{const Pe=r.filter(Ve=>Ve.id!==Le);if(n(Pe),l(null),ee&&X)try{await Bn.updateProject(ee.id,{tasks:Pe,lastModifiedBy:X.id});const Ve=r.find($e=>$e.id===Le);await Ha.logActivity(ee.id,X.id,"task_deleted",{taskId:Le,taskTitle:(Ve==null?void 0:Ve.title)||"Unknown"})}catch(Ve){console.error("Failed to delete task:",Ve),u("Failed to delete task. Please try again.")}},[r,ee,X]),H=re.useCallback(()=>{t("input"),n([]),l(null),u(null),te(null)},[]),se=re.useCallback(async Le=>{try{te(Le),n(Le.tasks||[]),t("flow"),ge(!1),u(null)}catch(Pe){console.error("Failed to load project:",Pe),u("Failed to load project. Please try again.")}},[]),ve=re.useCallback(Le=>{S(Le),j(!0)},[]),be=re.useCallback(async Le=>{if(!s)return;const Pe={...s,extendedDetails:{...s.extendedDetails,reportDeck:Le}};await N(Pe),S(Le)},[s,N]),Ae=re.useCallback(async Le=>{if(!s)return;const Pe={...s,extendedDetails:{...s.extendedDetails,subSteps:Le}};await N(Pe)},[s,N]),ye=re.useCallback(async(Le,Pe)=>{if(!s)return;const Ve={id:Date.now().toString(),title:Le,description:Pe,status:"pending",position:h8(s.extendedDetails.subSteps.length)},$e=[...s.extendedDetails.subSteps,Ve];await Ae($e)},[s,Ae]),Ye=re.useCallback(async Le=>{if(!s)return;const Pe=s.extendedDetails.subSteps.filter(Ve=>Ve.id!==Le);await Ae(Pe)},[s,Ae]),Y=re.useCallback(async(Le,Pe)=>{if(!s)return;const Ve=s.extendedDetails.subSteps.map($e=>$e.id===Le?{...$e,status:Pe}:$e);await Ae(Ve)},[s,Ae]),ot=re.useCallback(async Le=>{if(!s)return;const Pe={...Le,id:Date.now().toString()},Ve={...s,extendedDetails:{...s.extendedDetails,attachments:[...s.extendedDetails.attachments,Pe]}};await N(Ve)},[s,N]),Xe=re.useCallback(async Le=>{if(!s)return;const Pe={...s,extendedDetails:{...s.extendedDetails,attachments:s.extendedDetails.attachments.filter(Ve=>Ve.id!==Le)}};await N(Pe)},[s,N]),gt=re.useCallback(async Le=>{if(!s)return;const Pe={...Le,id:Date.now().toString()},Ve={...s,extendedDetails:{...s.extendedDetails,decisions:[...s.extendedDetails.decisions,Pe]}};await N(Ve)},[s,N]),Je=re.useCallback(async(Le,Pe)=>{if(!s)return;const Ve={...s,extendedDetails:{...s.extendedDetails,decisions:s.extendedDetails.decisions.map($e=>$e.id===Le?{...$e,...Pe}:$e)}};await N(Ve)},[s,N]),Oe=re.useCallback(async Le=>{if(!s)return;const Pe={...s,extendedDetails:{...s.extendedDetails,decisions:s.extendedDetails.decisions.filter(Ve=>Ve.id!==Le)}};await N(Pe)},[s,N]),Ot=re.useCallback(async Le=>{if(!s)return;const Pe={...s,extendedDetails:{...s.extendedDetails,subStepCanvasSize:Le}};await N(Pe)},[s,N]),$t=re.useCallback(()=>{Se(!1),ue(null),window.history.replaceState({},document.title,window.location.pathname)},[]);return E&&C?d.jsx(zh,{slideDeck:C,onSave:be,onClose:()=>j(!1)}):d.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e==="input"&&d.jsx(n4,{onProjectGenerated:Q,onError:u,onLoadingChange:x,onShowApiKeyModal:()=>Z(!0),onShowAuth:()=>I(!0),onShowProjectList:()=>ge(!0),user:X,currentProject:ee}),e==="flow"&&d.jsx(Wk,{tasks:r,onTaskClick:K,onNewProject:H,onAddTask:()=>v(!0),onShowAuth:()=>I(!0),onShowProjectList:()=>ge(!0),user:X,currentProject:ee}),o&&d.jsx(yi,{message:o,onClose:()=>u(null)}),s&&d.jsx(l8,{task:s,onClose:()=>l(null),onUpdate:N,onDelete:z,onOpenSlideEditor:ve,onSubStepUpdate:Ae,onSubStepAdd:ye,onSubStepDelete:Ye,onSubStepStatusChange:Y,onAttachmentAdd:ot,onAttachmentDelete:Xe,onDecisionAdd:gt,onDecisionUpdate:Je,onDecisionDelete:Oe,onCanvasSizeUpdate:Ot}),p&&d.jsx(c8,{onClose:()=>v(!1),onAdd:P}),_&&d.jsx(O_,{onConfirm:A,onCancel:()=>{y(!1),b(null)}}),L&&d.jsx(o8,{onClose:()=>Z(!1)}),W&&d.jsx(u8,{onClose:()=>I(!1)}),V&&d.jsx(f8,{onClose:()=>ge(!1),onLoadProject:se,user:X}),Re&&ae&&d.jsx(d8,{token:ae,onClose:()=>{Se(!1),ue(null)},onAccepted:$t}),h&&d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white p-6 rounded-lg",children:[d.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),d.jsx("p",{className:"mt-2 text-gray-600",children:"Generating project plan..."})]})})]})}const ww=document.getElementById("root");if(!ww)throw new Error("Could not find root element to mount to");const m8=LE.createRoot(ww);m8.render(d.jsx(Gn.StrictMode,{children:d.jsx(x8,{})}));
